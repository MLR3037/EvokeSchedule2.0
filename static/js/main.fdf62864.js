/*! For license information please see main.fdf62864.js.LICENSE.txt */
(()=>{"use strict";var e={85:(e,t,n)=>{var r=n(340),o=n(950),i=n(119);function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function d(e){if(l(e)!==e)throw Error(a(188))}function h(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=h(e)))return t;e=e.sibling}return null}var g=Object.assign,f=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),p=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),w=Symbol.for("react.consumer"),k=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),T=Symbol.for("react.lazy");Symbol.for("react.scope");var I=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var P=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var E=Symbol.iterator;function _(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=E&&e[E]||e["@@iterator"])?e:null}var N=Symbol.for("react.client.reference");function R(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===N?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case y:return"Fragment";case b:return"Profiler";case v:return"StrictMode";case S:return"Suspense";case x:return"SuspenseList";case I:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case p:return"Portal";case k:return e.displayName||"Context";case w:return(e._context.displayName||"Context")+".Consumer";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:R(e.type)||"Memo";case T:t=e._payload,e=e._init;try{return R(e(t))}catch(n){}}return null}var M=Array.isArray,O=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,j=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L={pending:!1,data:null,method:null,action:null},q=[],D=-1;function z(e){return{current:e}}function F(e){0>D||(e.current=q[D],q[D]=null,D--)}function U(e,t){D++,q[D]=e.current,e.current=t}var H,B,K=z(null),W=z(null),V=z(null),G=z(null);function Q(e,t){switch(U(V,t),U(W,e),U(K,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?yd(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=vd(t=yd(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}F(K),U(K,e)}function Y(){F(K),F(W),F(V)}function J(e){null!==e.memoizedState&&U(G,e);var t=K.current,n=vd(t,e.type);t!==n&&(U(W,e),U(K,n))}function $(e){W.current===e&&(F(K),F(W)),G.current===e&&(F(G),uh._currentValue=L)}function X(e){if(void 0===H)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);H=t&&t[1]||"",B=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+H+e+B}var Z=!1;function ee(e,t){if(!e||Z)return"";Z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(o){var r=o}Reflect.construct(e,[],n)}else{try{n.call()}catch(i){r=i}e.call(n.prototype)}}else{try{throw Error()}catch(a){r=a}(n=e())&&"function"===typeof n.catch&&n.catch(function(){})}}catch(s){if(s&&r&&"string"===typeof s.stack)return[s.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var o=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");o&&o.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var i=r.DetermineComponentFrameRoot(),a=i[0],s=i[1];if(a&&s){var l=a.split("\n"),c=s.split("\n");for(o=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;o<c.length&&!c[o].includes("DetermineComponentFrameRoot");)o++;if(r===l.length||o===c.length)for(r=l.length-1,o=c.length-1;1<=r&&0<=o&&l[r]!==c[o];)o--;for(;1<=r&&0<=o;r--,o--)if(l[r]!==c[o]){if(1!==r||1!==o)do{if(r--,0>--o||l[r]!==c[o]){var u="\n"+l[r].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=r&&0<=o);break}}}finally{Z=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?X(n):""}function te(e,t){switch(e.tag){case 26:case 27:case 5:return X(e.type);case 16:return X("Lazy");case 13:return e.child!==t&&null!==t?X("Suspense Fallback"):X("Suspense");case 19:return X("SuspenseList");case 0:case 15:return ee(e.type,!1);case 11:return ee(e.type.render,!1);case 1:return ee(e.type,!0);case 31:return X("Activity");default:return""}}function ne(e){try{var t="",n=null;do{t+=te(e,n),n=e,e=e.return}while(e);return t}catch(r){return"\nError generating stack: "+r.message+"\n"+r.stack}}var re=Object.prototype.hasOwnProperty,oe=r.unstable_scheduleCallback,ie=r.unstable_cancelCallback,ae=r.unstable_shouldYield,se=r.unstable_requestPaint,le=r.unstable_now,ce=r.unstable_getCurrentPriorityLevel,ue=r.unstable_ImmediatePriority,de=r.unstable_UserBlockingPriority,he=r.unstable_NormalPriority,ge=r.unstable_LowPriority,fe=r.unstable_IdlePriority,me=r.log,pe=r.unstable_setDisableYieldValue,ye=null,ve=null;function be(e){if("function"===typeof me&&pe(e),ve&&"function"===typeof ve.setStrictMode)try{ve.setStrictMode(ye,e)}catch(t){}}var we=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(ke(e)/Ce|0)|0},ke=Math.log,Ce=Math.LN2;var Se=256,xe=262144,Ae=4194304;function Te(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ie(e,t,n){var r=e.pendingLanes;if(0===r)return 0;var o=0,i=e.suspendedLanes,a=e.pingedLanes;e=e.warmLanes;var s=134217727&r;return 0!==s?0!==(r=s&~i)?o=Te(r):0!==(a&=s)?o=Te(a):n||0!==(n=s&~e)&&(o=Te(n)):0!==(s=r&~i)?o=Te(s):0!==a?o=Te(a):n||0!==(n=r&~e)&&(o=Te(n)),0===o?0:0!==t&&t!==o&&0===(t&i)&&((i=o&-o)>=(n=t&-t)||32===i&&0!==(4194048&n))?t:o}function Pe(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Ee(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function _e(){var e=Ae;return 0===(62914560&(Ae<<=1))&&(Ae=4194304),e}function Ne(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Re(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Me(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-we(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|261930&n}function Oe(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-we(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}function je(e,t){var n=t&-t;return 0!==((n=0!==(42&n)?1:Le(n))&(e.suspendedLanes|t))?0:n}function Le(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function qe(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function De(){var e=j.p;return 0!==e?e:void 0===(e=window.event)?32:Th(e.type)}function ze(e,t){var n=j.p;try{return j.p=e,t()}finally{j.p=n}}var Fe=Math.random().toString(36).slice(2),Ue="__reactFiber$"+Fe,He="__reactProps$"+Fe,Be="__reactContainer$"+Fe,Ke="__reactEvents$"+Fe,We="__reactListeners$"+Fe,Ve="__reactHandles$"+Fe,Ge="__reactResources$"+Fe,Qe="__reactMarker$"+Fe;function Ye(e){delete e[Ue],delete e[He],delete e[Ke],delete e[We],delete e[Ve]}function Je(e){var t=e[Ue];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Be]||n[Ue]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Ld(e);null!==e;){if(n=e[Ue])return n;e=Ld(e)}return t}n=(e=n).parentNode}return null}function $e(e){if(e=e[Ue]||e[Be]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function Xe(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(a(33))}function Ze(e){var t=e[Ge];return t||(t=e[Ge]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function et(e){e[Qe]=!0}var tt=new Set,nt={};function rt(e,t){ot(e,t),ot(e+"Capture",t)}function ot(e,t){for(nt[e]=t,e=0;e<t.length;e++)tt.add(t[e])}var it=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),at={},st={};function lt(e,t,n){if(o=t,re.call(st,o)||!re.call(at,o)&&(it.test(o)?st[o]=!0:(at[o]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var o}function ct(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function ut(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function dt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ht(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function gt(e){if(!e._valueTracker){var t=ht(e)?"checked":"value";e._valueTracker=function(e,t,n){var r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var o=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){n=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e,t,""+e[t])}}function ft(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ht(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function mt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var pt=/[\n"\\]/g;function yt(e){return e.replace(pt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function vt(e,t,n,r,o,i,a,s){e.name="",null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a?e.type=a:e.removeAttribute("type"),null!=t?"number"===a?(0===t&&""===e.value||e.value!=t)&&(e.value=""+dt(t)):e.value!==""+dt(t)&&(e.value=""+dt(t)):"submit"!==a&&"reset"!==a||e.removeAttribute("value"),null!=t?wt(e,a,dt(t)):null!=n?wt(e,a,dt(n)):null!=r&&e.removeAttribute("value"),null==o&&null!=i&&(e.defaultChecked=!!i),null!=o&&(e.checked=o&&"function"!==typeof o&&"symbol"!==typeof o),null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s?e.name=""+dt(s):e.removeAttribute("name")}function bt(e,t,n,r,o,i,a,s){if(null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i&&(e.type=i),null!=t||null!=n){if(!("submit"!==i&&"reset"!==i||void 0!==t&&null!==t))return void gt(e);n=null!=n?""+dt(n):"",t=null!=t?""+dt(t):n,s||t===e.value||(e.value=t),e.defaultValue=t}r="function"!==typeof(r=null!=r?r:o)&&"symbol"!==typeof r&&!!r,e.checked=s?e.checked:!!r,e.defaultChecked=!!r,null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a&&(e.name=a),gt(e)}function wt(e,t,n){"number"===t&&mt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function kt(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+dt(n),t=null,o=0;o<e.length;o++){if(e[o].value===n)return e[o].selected=!0,void(r&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function Ct(e,t,n){null==t||((t=""+dt(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+dt(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function St(e,t,n,r){if(null==t){if(null!=r){if(null!=n)throw Error(a(92));if(M(r)){if(1<r.length)throw Error(a(93));r=r[0]}n=r}null==n&&(n=""),t=n}n=dt(t),e.defaultValue=n,(r=e.textContent)===n&&""!==r&&null!==r&&(e.value=r),gt(e)}function xt(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var At=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Tt(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!==typeof n||0===n||At.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function It(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(a(62));if(e=e.style,null!=n){for(var r in n)!n.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var o in t)r=t[o],t.hasOwnProperty(o)&&n[o]!==r&&Tt(e,o,r)}else for(var i in t)t.hasOwnProperty(i)&&Tt(e,i,t[i])}function Pt(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Et=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),_t=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Nt(e){return _t.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Rt(){}var Mt=null;function Ot(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var jt=null,Lt=null;function qt(e){var t=$e(e);if(t&&(e=t.stateNode)){var n=e[He]||null;e:switch(e=t.stateNode,t.type){case"input":if(vt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+yt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=r[He]||null;if(!o)throw Error(a(90));vt(r,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name)}}for(t=0;t<n.length;t++)(r=n[t]).form===e.form&&ft(r)}break e;case"textarea":Ct(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&kt(e,!!n.multiple,t,!1)}}}var Dt=!1;function zt(e,t,n){if(Dt)return e(t,n);Dt=!0;try{return e(t)}finally{if(Dt=!1,(null!==jt||null!==Lt)&&(Zc(),jt&&(t=jt,e=Lt,Lt=jt=null,qt(t),e)))for(t=0;t<e.length;t++)qt(e[t])}}function Ft(e,t){var n=e.stateNode;if(null===n)return null;var r=n[He]||null;if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Ut=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),Ht=!1;if(Ut)try{var Bt={};Object.defineProperty(Bt,"passive",{get:function(){Ht=!0}}),window.addEventListener("test",Bt,Bt),window.removeEventListener("test",Bt,Bt)}catch($h){Ht=!1}var Kt=null,Wt=null,Vt=null;function Gt(){if(Vt)return Vt;var e,t,n=Wt,r=n.length,o="value"in Kt?Kt.value:Kt.textContent,i=o.length;for(e=0;e<r&&n[e]===o[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===o[i-t];t++);return Vt=o.slice(e,1<t?1-t:void 0)}function Qt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Yt(){return!0}function Jt(){return!1}function $t(e){function t(t,n,r,o,i){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=o,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(o):o[a]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?Yt:Jt,this.isPropagationStopped=Jt,this}return g(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Yt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Yt)},persist:function(){},isPersistent:Yt}),t}var Xt,Zt,en,tn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nn=$t(tn),rn=g({},tn,{view:0,detail:0}),on=$t(rn),an=g({},rn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==en&&(en&&"mousemove"===e.type?(Xt=e.screenX-en.screenX,Zt=e.screenY-en.screenY):Zt=Xt=0,en=e),Xt)},movementY:function(e){return"movementY"in e?e.movementY:Zt}}),sn=$t(an),ln=$t(g({},an,{dataTransfer:0})),cn=$t(g({},rn,{relatedTarget:0})),un=$t(g({},tn,{animationName:0,elapsedTime:0,pseudoElement:0})),dn=$t(g({},tn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),hn=$t(g({},tn,{data:0})),gn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=mn[e])&&!!t[e]}function yn(){return pn}var vn=$t(g({},rn,{key:function(e){if(e.key){var t=gn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Qt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?fn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yn,charCode:function(e){return"keypress"===e.type?Qt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Qt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),bn=$t(g({},an,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),wn=$t(g({},rn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yn})),kn=$t(g({},tn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Cn=$t(g({},an,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Sn=$t(g({},tn,{newState:0,oldState:0})),xn=[9,13,27,32],An=Ut&&"CompositionEvent"in window,Tn=null;Ut&&"documentMode"in document&&(Tn=document.documentMode);var In=Ut&&"TextEvent"in window&&!Tn,Pn=Ut&&(!An||Tn&&8<Tn&&11>=Tn),En=String.fromCharCode(32),_n=!1;function Nn(e,t){switch(e){case"keyup":return-1!==xn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Rn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Mn=!1;var On={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!On[e.type]:"textarea"===t}function Ln(e,t,n,r){jt?Lt?Lt.push(r):Lt=[r]:jt=r,0<(t=rd(t,"onChange")).length&&(n=new nn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var qn=null,Dn=null;function zn(e){Yu(e,0)}function Fn(e){if(ft(Xe(e)))return e}function Un(e,t){if("change"===e)return t}var Hn=!1;if(Ut){var Bn;if(Ut){var Kn="oninput"in document;if(!Kn){var Wn=document.createElement("div");Wn.setAttribute("oninput","return;"),Kn="function"===typeof Wn.oninput}Bn=Kn}else Bn=!1;Hn=Bn&&(!document.documentMode||9<document.documentMode)}function Vn(){qn&&(qn.detachEvent("onpropertychange",Gn),Dn=qn=null)}function Gn(e){if("value"===e.propertyName&&Fn(Dn)){var t=[];Ln(t,Dn,e,Ot(e)),zt(zn,t)}}function Qn(e,t,n){"focusin"===e?(Vn(),Dn=n,(qn=t).attachEvent("onpropertychange",Gn)):"focusout"===e&&Vn()}function Yn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Fn(Dn)}function Jn(e,t){if("click"===e)return Fn(t)}function $n(e,t){if("input"===e||"change"===e)return Fn(t)}var Xn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Zn(e,t){if(Xn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!re.call(t,o)||!Xn(e[o],t[o]))return!1}return!0}function er(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function tr(e,t){var n,r=er(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=er(r)}}function nr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?nr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function rr(e){for(var t=mt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=mt((e=t.contentWindow).document)}return t}function or(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var ir=Ut&&"documentMode"in document&&11>=document.documentMode,ar=null,sr=null,lr=null,cr=!1;function ur(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;cr||null==ar||ar!==mt(r)||("selectionStart"in(r=ar)&&or(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},lr&&Zn(lr,r)||(lr=r,0<(r=rd(sr,"onSelect")).length&&(t=new nn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=ar)))}function dr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var hr={animationend:dr("Animation","AnimationEnd"),animationiteration:dr("Animation","AnimationIteration"),animationstart:dr("Animation","AnimationStart"),transitionrun:dr("Transition","TransitionRun"),transitionstart:dr("Transition","TransitionStart"),transitioncancel:dr("Transition","TransitionCancel"),transitionend:dr("Transition","TransitionEnd")},gr={},fr={};function mr(e){if(gr[e])return gr[e];if(!hr[e])return e;var t,n=hr[e];for(t in n)if(n.hasOwnProperty(t)&&t in fr)return gr[e]=n[t];return e}Ut&&(fr=document.createElement("div").style,"AnimationEvent"in window||(delete hr.animationend.animation,delete hr.animationiteration.animation,delete hr.animationstart.animation),"TransitionEvent"in window||delete hr.transitionend.transition);var pr=mr("animationend"),yr=mr("animationiteration"),vr=mr("animationstart"),br=mr("transitionrun"),wr=mr("transitionstart"),kr=mr("transitioncancel"),Cr=mr("transitionend"),Sr=new Map,xr="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ar(e,t){Sr.set(e,t),rt(t,[e])}xr.push("scrollEnd");var Tr="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},Ir=[],Pr=0,Er=0;function _r(){for(var e=Pr,t=Er=Pr=0;t<e;){var n=Ir[t];Ir[t++]=null;var r=Ir[t];Ir[t++]=null;var o=Ir[t];Ir[t++]=null;var i=Ir[t];if(Ir[t++]=null,null!==r&&null!==o){var a=r.pending;null===a?o.next=o:(o.next=a.next,a.next=o),r.pending=o}0!==i&&Or(n,o,i)}}function Nr(e,t,n,r){Ir[Pr++]=e,Ir[Pr++]=t,Ir[Pr++]=n,Ir[Pr++]=r,Er|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Rr(e,t,n,r){return Nr(e,t,n,r),jr(e)}function Mr(e,t){return Nr(e,null,null,t),jr(e)}function Or(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var o=!1,i=e.return;null!==i;)i.childLanes|=n,null!==(r=i.alternate)&&(r.childLanes|=n),22===i.tag&&(null===(e=i.stateNode)||1&e._visibility||(o=!0)),e=i,i=i.return;return 3===e.tag?(i=e.stateNode,o&&null!==t&&(o=31-we(n),null===(r=(e=i.hiddenUpdates)[o])?e[o]=[t]:r.push(t),t.lane=536870912|n),i):null}function jr(e){if(50<Kc)throw Kc=0,Wc=null,Error(a(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Lr={};function qr(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dr(e,t,n,r){return new qr(e,t,n,r)}function zr(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Fr(e,t){var n=e.alternate;return null===n?((n=Dr(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Ur(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Hr(e,t,n,r,o,i){var s=0;if(r=e,"function"===typeof e)zr(e)&&(s=1);else if("string"===typeof e)s=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,K.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case I:return(e=Dr(31,n,t,o)).elementType=I,e.lanes=i,e;case y:return Br(n.children,o,i,t);case v:s=8,o|=24;break;case b:return(e=Dr(12,n,t,2|o)).elementType=b,e.lanes=i,e;case S:return(e=Dr(13,n,t,o)).elementType=S,e.lanes=i,e;case x:return(e=Dr(19,n,t,o)).elementType=x,e.lanes=i,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case k:s=10;break e;case w:s=9;break e;case C:s=11;break e;case A:s=14;break e;case T:s=16,r=null;break e}s=29,n=Error(a(130,null===e?"null":typeof e,"")),r=null}return(t=Dr(s,n,t,o)).elementType=e,t.type=r,t.lanes=i,t}function Br(e,t,n,r){return(e=Dr(7,e,r,t)).lanes=n,e}function Kr(e,t,n){return(e=Dr(6,e,null,t)).lanes=n,e}function Wr(e){var t=Dr(18,null,null,0);return t.stateNode=e,t}function Vr(e,t,n){return(t=Dr(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Gr=new WeakMap;function Qr(e,t){if("object"===typeof e&&null!==e){var n=Gr.get(e);return void 0!==n?n:(t={value:e,source:t,stack:ne(t)},Gr.set(e,t),t)}return{value:e,source:t,stack:ne(t)}}var Yr=[],Jr=0,$r=null,Xr=0,Zr=[],eo=0,to=null,no=1,ro="";function oo(e,t){Yr[Jr++]=Xr,Yr[Jr++]=$r,$r=e,Xr=t}function io(e,t,n){Zr[eo++]=no,Zr[eo++]=ro,Zr[eo++]=to,to=e;var r=no;e=ro;var o=32-we(r)-1;r&=~(1<<o),n+=1;var i=32-we(t)+o;if(30<i){var a=o-o%5;i=(r&(1<<a)-1).toString(32),r>>=a,o-=a,no=1<<32-we(t)+o|n<<o|r,ro=i+e}else no=1<<i|n<<o|r,ro=e}function ao(e){null!==e.return&&(oo(e,1),io(e,1,0))}function so(e){for(;e===$r;)$r=Yr[--Jr],Yr[Jr]=null,Xr=Yr[--Jr],Yr[Jr]=null;for(;e===to;)to=Zr[--eo],Zr[eo]=null,ro=Zr[--eo],Zr[eo]=null,no=Zr[--eo],Zr[eo]=null}function lo(e,t){Zr[eo++]=no,Zr[eo++]=ro,Zr[eo++]=to,no=t.id,ro=t.overflow,to=e}var co=null,uo=null,ho=!1,go=null,fo=!1,mo=Error(a(519));function po(e){throw Co(Qr(Error(a(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),mo}function yo(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[Ue]=e,t[He]=r,n){case"dialog":Ju("cancel",t),Ju("close",t);break;case"iframe":case"object":case"embed":Ju("load",t);break;case"video":case"audio":for(n=0;n<Gu.length;n++)Ju(Gu[n],t);break;case"source":Ju("error",t);break;case"img":case"image":case"link":Ju("error",t),Ju("load",t);break;case"details":Ju("toggle",t);break;case"input":Ju("invalid",t),bt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0);break;case"select":Ju("invalid",t);break;case"textarea":Ju("invalid",t),St(t,r.value,r.defaultValue,r.children)}"string"!==typeof(n=r.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||cd(t.textContent,n)?(null!=r.popover&&(Ju("beforetoggle",t),Ju("toggle",t)),null!=r.onScroll&&Ju("scroll",t),null!=r.onScrollEnd&&Ju("scrollend",t),null!=r.onClick&&(t.onclick=Rt),t=!0):t=!1,t||po(e,!0)}function vo(e){for(co=e.return;co;)switch(co.tag){case 5:case 31:case 13:return void(fo=!1);case 27:case 3:return void(fo=!0);default:co=co.return}}function bo(e){if(e!==co)return!1;if(!ho)return vo(e),ho=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||bd(e.type,e.memoizedProps)),t=!t),t&&uo&&po(e),vo(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));uo=jd(e)}else if(31===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));uo=jd(e)}else 27===n?(n=uo,Td(e.type)?(e=Od,Od=null,uo=e):uo=n):uo=co?Md(e.stateNode.nextSibling):null;return!0}function wo(){uo=co=null,ho=!1}function ko(){var e=go;return null!==e&&(null===_c?_c=e:_c.push.apply(_c,e),go=null),e}function Co(e){null===go?go=[e]:go.push(e)}var So=z(null),xo=null,Ao=null;function To(e,t,n){U(So,t._currentValue),t._currentValue=n}function Io(e){e._currentValue=So.current,F(So)}function Po(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Eo(e,t,n,r){var o=e.child;for(null!==o&&(o.return=e);null!==o;){var i=o.dependencies;if(null!==i){var s=o.child;i=i.firstContext;e:for(;null!==i;){var l=i;i=o;for(var c=0;c<t.length;c++)if(l.context===t[c]){i.lanes|=n,null!==(l=i.alternate)&&(l.lanes|=n),Po(i.return,n,e),r||(s=null);break e}i=l.next}}else if(18===o.tag){if(null===(s=o.return))throw Error(a(341));s.lanes|=n,null!==(i=s.alternate)&&(i.lanes|=n),Po(s,n,e),s=null}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===e){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}}function _o(e,t,n,r){e=null;for(var o=t,i=!1;null!==o;){if(!i)if(0!==(524288&o.flags))i=!0;else if(0!==(262144&o.flags))break;if(10===o.tag){var s=o.alternate;if(null===s)throw Error(a(387));if(null!==(s=s.memoizedProps)){var l=o.type;Xn(o.pendingProps.value,s.value)||(null!==e?e.push(l):e=[l])}}else if(o===G.current){if(null===(s=o.alternate))throw Error(a(387));s.memoizedState.memoizedState!==o.memoizedState.memoizedState&&(null!==e?e.push(uh):e=[uh])}o=o.return}null!==e&&Eo(t,e,n,r),t.flags|=262144}function No(e){for(e=e.firstContext;null!==e;){if(!Xn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ro(e){xo=e,Ao=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Mo(e){return jo(xo,e)}function Oo(e,t){return null===xo&&Ro(e),jo(e,t)}function jo(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===Ao){if(null===e)throw Error(a(308));Ao=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Ao=Ao.next=t;return n}var Lo="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},qo=r.unstable_scheduleCallback,Do=r.unstable_NormalPriority,zo={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Fo(){return{controller:new Lo,data:new Map,refCount:0}}function Uo(e){e.refCount--,0===e.refCount&&qo(Do,function(){e.controller.abort()})}var Ho=null,Bo=0,Ko=0,Wo=null;function Vo(){if(0===--Bo&&null!==Ho){null!==Wo&&(Wo.status="fulfilled");var e=Ho;Ho=null,Ko=0,Wo=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Go=O.S;O.S=function(e,t){Mc=le(),"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Ho){var n=Ho=[];Bo=0,Ko=Hu(),Wo={status:"pending",value:void 0,then:function(e){n.push(e)}}}Bo++,t.then(Vo,Vo)}(0,t),null!==Go&&Go(e,t)};var Qo=z(null);function Yo(){var e=Qo.current;return null!==e?e:fc.pooledCache}function Jo(e,t){U(Qo,null===t?Qo.current:t.pool)}function $o(){var e=Yo();return null===e?null:{parent:zo._currentValue,pool:e}}var Xo=Error(a(460)),Zo=Error(a(474)),ei=Error(a(542)),ti={then:function(){}};function ni(e){return"fulfilled"===(e=e.status)||"rejected"===e}function ri(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Rt,Rt),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw si(e=t.reason),e;default:if("string"===typeof t.status)t.then(Rt,Rt);else{if(null!==(e=fc)&&100<e.shellSuspendCounter)throw Error(a(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw si(e=t.reason),e}throw ii=t,Xo}}function oi(e){try{return(0,e._init)(e._payload)}catch(t){if(null!==t&&"object"===typeof t&&"function"===typeof t.then)throw ii=t,Xo;throw t}}var ii=null;function ai(){if(null===ii)throw Error(a(459));var e=ii;return ii=null,e}function si(e){if(e===Xo||e===ei)throw Error(a(483))}var li=null,ci=0;function ui(e){var t=ci;return ci+=1,null===li&&(li=[]),ri(li,e,t)}function di(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function hi(e,t){if(t.$$typeof===f)throw Error(a(525));throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function gi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function o(e,t){return(e=Fr(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=67108866,n):r:(t.flags|=67108866,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Kr(n,e.mode,r)).return=e,t):((t=o(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===y?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===T&&oi(i)===t.type)?(di(t=o(t,n.props),n),t.return=e,t):(di(t=Hr(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Vr(n,e.mode,r)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function d(e,t,n,r,i){return null===t||7!==t.tag?((t=Br(n,e.mode,r,i)).return=e,t):((t=o(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Kr(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case m:return di(n=Hr(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case p:return(t=Vr(t,e.mode,n)).return=e,t;case T:return h(e,t=oi(t),n)}if(M(t)||_(t))return(t=Br(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return h(e,ui(t),n);if(t.$$typeof===k)return h(e,Oo(e,t),n);hi(e,t)}return null}function g(e,t,n,r){var o=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==o?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case m:return n.key===o?c(e,t,n,r):null;case p:return n.key===o?u(e,t,n,r):null;case T:return g(e,t,n=oi(n),r)}if(M(n)||_(n))return null!==o?null:d(e,t,n,r,null);if("function"===typeof n.then)return g(e,t,ui(n),r);if(n.$$typeof===k)return g(e,t,Oo(e,n),r);hi(e,n)}return null}function f(e,t,n,r,o){if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return l(t,e=e.get(n)||null,""+r,o);if("object"===typeof r&&null!==r){switch(r.$$typeof){case m:return c(t,e=e.get(null===r.key?n:r.key)||null,r,o);case p:return u(t,e=e.get(null===r.key?n:r.key)||null,r,o);case T:return f(e,t,n,r=oi(r),o)}if(M(r)||_(r))return d(t,e=e.get(n)||null,r,o,null);if("function"===typeof r.then)return f(e,t,n,ui(r),o);if(r.$$typeof===k)return f(e,t,n,Oo(t,r),o);hi(t,r)}return null}function v(l,c,u,d){if("object"===typeof u&&null!==u&&u.type===y&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case m:e:{for(var b=u.key;null!==c;){if(c.key===b){if((b=u.type)===y){if(7===c.tag){n(l,c.sibling),(d=o(c,u.props.children)).return=l,l=d;break e}}else if(c.elementType===b||"object"===typeof b&&null!==b&&b.$$typeof===T&&oi(b)===c.type){n(l,c.sibling),di(d=o(c,u.props),u),d.return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}u.type===y?((d=Br(u.props.children,l.mode,d,u.key)).return=l,l=d):(di(d=Hr(u.type,u.key,u.props,null,l.mode,d),u),d.return=l,l=d)}return s(l);case p:e:{for(b=u.key;null!==c;){if(c.key===b){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){n(l,c.sibling),(d=o(c,u.children||[])).return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}(d=Vr(u,l.mode,d)).return=l,l=d}return s(l);case T:return v(l,c,u=oi(u),d)}if(M(u))return function(o,a,s,l){for(var c=null,u=null,d=a,m=a=0,p=null;null!==d&&m<s.length;m++){d.index>m?(p=d,d=null):p=d.sibling;var y=g(o,d,s[m],l);if(null===y){null===d&&(d=p);break}e&&d&&null===y.alternate&&t(o,d),a=i(y,a,m),null===u?c=y:u.sibling=y,u=y,d=p}if(m===s.length)return n(o,d),ho&&oo(o,m),c;if(null===d){for(;m<s.length;m++)null!==(d=h(o,s[m],l))&&(a=i(d,a,m),null===u?c=d:u.sibling=d,u=d);return ho&&oo(o,m),c}for(d=r(d);m<s.length;m++)null!==(p=f(d,o,m,s[m],l))&&(e&&null!==p.alternate&&d.delete(null===p.key?m:p.key),a=i(p,a,m),null===u?c=p:u.sibling=p,u=p);return e&&d.forEach(function(e){return t(o,e)}),ho&&oo(o,m),c}(l,c,u,d);if(_(u)){if("function"!==typeof(b=_(u)))throw Error(a(150));return function(o,s,l,c){if(null==l)throw Error(a(151));for(var u=null,d=null,m=s,p=s=0,y=null,v=l.next();null!==m&&!v.done;p++,v=l.next()){m.index>p?(y=m,m=null):y=m.sibling;var b=g(o,m,v.value,c);if(null===b){null===m&&(m=y);break}e&&m&&null===b.alternate&&t(o,m),s=i(b,s,p),null===d?u=b:d.sibling=b,d=b,m=y}if(v.done)return n(o,m),ho&&oo(o,p),u;if(null===m){for(;!v.done;p++,v=l.next())null!==(v=h(o,v.value,c))&&(s=i(v,s,p),null===d?u=v:d.sibling=v,d=v);return ho&&oo(o,p),u}for(m=r(m);!v.done;p++,v=l.next())null!==(v=f(m,o,p,v.value,c))&&(e&&null!==v.alternate&&m.delete(null===v.key?p:v.key),s=i(v,s,p),null===d?u=v:d.sibling=v,d=v);return e&&m.forEach(function(e){return t(o,e)}),ho&&oo(o,p),u}(l,c,u=b.call(u),d)}if("function"===typeof u.then)return v(l,c,ui(u),d);if(u.$$typeof===k)return v(l,c,Oo(l,u),d);hi(l,u)}return"string"===typeof u&&""!==u||"number"===typeof u||"bigint"===typeof u?(u=""+u,null!==c&&6===c.tag?(n(l,c.sibling),(d=o(c,u)).return=l,l=d):(n(l,c),(d=Kr(u,l.mode,d)).return=l,l=d),s(l)):n(l,c)}return function(e,t,n,r){try{ci=0;var o=v(e,t,n,r);return li=null,o}catch(a){if(a===Xo||a===ei)throw a;var i=Dr(29,a,null,e.mode);return i.lanes=r,i.return=e,i}}}var fi=gi(!0),mi=gi(!1),pi=!1;function yi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function vi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function bi(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function wi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&gc)){var o=r.pending;return null===o?t.next=t:(t.next=o.next,o.next=t),r.pending=t,t=jr(e),Or(e,null,n),t}return Nr(e,r,t,n),jr(e)}function ki(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Oe(e,n)}}function Ci(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var o=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var a={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===i?o=i=a:i=i.next=a,n=n.next}while(null!==n);null===i?o=i=t:i=i.next=t}else o=i=t;return n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Si=!1;function xi(){if(Si){if(null!==Wo)throw Wo}}function Ai(e,t,n,r){Si=!1;var o=e.updateQueue;pi=!1;var i=o.firstBaseUpdate,a=o.lastBaseUpdate,s=o.shared.pending;if(null!==s){o.shared.pending=null;var l=s,c=l.next;l.next=null,null===a?i=c:a.next=c,a=l;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=l))}if(null!==i){var d=o.baseState;for(a=0,u=c=l=null,s=i;;){var h=-536870913&s.lane,f=h!==s.lane;if(f?(pc&h)===h:(r&h)===h){0!==h&&h===Ko&&(Si=!0),null!==u&&(u=u.next={lane:0,tag:s.tag,payload:s.payload,callback:null,next:null});e:{var m=e,p=s;h=t;var y=n;switch(p.tag){case 1:if("function"===typeof(m=p.payload)){d=m.call(y,d,h);break e}d=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(h="function"===typeof(m=p.payload)?m.call(y,d,h):m)||void 0===h)break e;d=g({},d,h);break e;case 2:pi=!0}}null!==(h=s.callback)&&(e.flags|=64,f&&(e.flags|=8192),null===(f=o.callbacks)?o.callbacks=[h]:f.push(h))}else f={lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=f,l=d):u=u.next=f,a|=h;if(null===(s=s.next)){if(null===(s=o.shared.pending))break;s=(f=s).next,f.next=null,o.lastBaseUpdate=f,o.shared.pending=null}}null===u&&(l=d),o.baseState=l,o.firstBaseUpdate=c,o.lastBaseUpdate=u,null===i&&(o.shared.lanes=0),xc|=a,e.lanes=a,e.memoizedState=d}}function Ti(e,t){if("function"!==typeof e)throw Error(a(191,e));e.call(t)}function Ii(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)Ti(n[e],t)}var Pi=z(null),Ei=z(0);function _i(e,t){U(Ei,e=Cc),U(Pi,t),Cc=e|t.baseLanes}function Ni(){U(Ei,Cc),U(Pi,Pi.current)}function Ri(){Cc=Ei.current,F(Pi),F(Ei)}var Mi=z(null),Oi=null;function ji(e){var t=e.alternate;U(Fi,1&Fi.current),U(Mi,e),null===Oi&&(null===t||null!==Pi.current||null!==t.memoizedState)&&(Oi=e)}function Li(e){U(Fi,Fi.current),U(Mi,e),null===Oi&&(Oi=e)}function qi(e){22===e.tag?(U(Fi,Fi.current),U(Mi,e),null===Oi&&(Oi=e)):Di()}function Di(){U(Fi,Fi.current),U(Mi,Mi.current)}function zi(e){F(Mi),Oi===e&&(Oi=null),F(Fi)}var Fi=z(0);function Ui(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Nd(n)||Rd(n)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(0!==(128&t.flags))return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Hi=0,Bi=null,Ki=null,Wi=null,Vi=!1,Gi=!1,Qi=!1,Yi=0,Ji=0,$i=null,Xi=0;function Zi(){throw Error(a(321))}function ea(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Xn(e[n],t[n]))return!1;return!0}function ta(e,t,n,r,o,i){return Hi=i,Bi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,O.H=null===e||null===e.memoizedState?ps:ys,Qi=!1,i=n(r,o),Qi=!1,Gi&&(i=ra(t,n,r,o)),na(e),i}function na(e){O.H=ms;var t=null!==Ki&&null!==Ki.next;if(Hi=0,Wi=Ki=Bi=null,Vi=!1,Ji=0,$i=null,t)throw Error(a(300));null===e||Ms||null!==(e=e.dependencies)&&No(e)&&(Ms=!0)}function ra(e,t,n,r){Bi=e;var o=0;do{if(Gi&&($i=null),Ji=0,Gi=!1,25<=o)throw Error(a(301));if(o+=1,Wi=Ki=null,null!=e.updateQueue){var i=e.updateQueue;i.lastEffect=null,i.events=null,i.stores=null,null!=i.memoCache&&(i.memoCache.index=0)}O.H=vs,i=t(n,r)}while(Gi);return i}function oa(){var e=O.H,t=e.useState()[0];return t="function"===typeof t.then?ua(t):t,e=e.useState()[0],(null!==Ki?Ki.memoizedState:null)!==e&&(Bi.flags|=1024),t}function ia(){var e=0!==Yi;return Yi=0,e}function aa(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function sa(e){if(Vi){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Vi=!1}Hi=0,Wi=Ki=Bi=null,Gi=!1,Ji=Yi=0,$i=null}function la(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Wi?Bi.memoizedState=Wi=e:Wi=Wi.next=e,Wi}function ca(){if(null===Ki){var e=Bi.alternate;e=null!==e?e.memoizedState:null}else e=Ki.next;var t=null===Wi?Bi.memoizedState:Wi.next;if(null!==t)Wi=t,Ki=e;else{if(null===e){if(null===Bi.alternate)throw Error(a(467));throw Error(a(310))}e={memoizedState:(Ki=e).memoizedState,baseState:Ki.baseState,baseQueue:Ki.baseQueue,queue:Ki.queue,next:null},null===Wi?Bi.memoizedState=Wi=e:Wi=Wi.next=e}return Wi}function ua(e){var t=Ji;return Ji+=1,null===$i&&($i=[]),e=ri($i,e,t),t=Bi,null===(null===Wi?t.memoizedState:Wi.next)&&(t=t.alternate,O.H=null===t||null===t.memoizedState?ps:ys),e}function da(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return ua(e);if(e.$$typeof===k)return Mo(e)}throw Error(a(438,String(e)))}function ha(e){var t=null,n=Bi.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=Bi.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},Bi.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=P;return t.index++,n}function ga(e,t){return"function"===typeof t?t(e):t}function fa(e){return ma(ca(),Ki,e)}function ma(e,t,n){var r=e.queue;if(null===r)throw Error(a(311));r.lastRenderedReducer=n;var o=e.baseQueue,i=r.pending;if(null!==i){if(null!==o){var s=o.next;o.next=i.next,i.next=s}t.baseQueue=o=i,r.pending=null}if(i=e.baseState,null===o)e.memoizedState=i;else{var l=s=null,c=null,u=t=o.next,d=!1;do{var h=-536870913&u.lane;if(h!==u.lane?(pc&h)===h:(Hi&h)===h){var g=u.revertLane;if(0===g)null!==c&&(c=c.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),h===Ko&&(d=!0);else{if((Hi&g)===g){u=u.next,g===Ko&&(d=!0);continue}h={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=h,s=i):c=c.next=h,Bi.lanes|=g,xc|=g}h=u.action,Qi&&n(i,h),i=u.hasEagerState?u.eagerState:n(i,h)}else g={lane:h,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=g,s=i):c=c.next=g,Bi.lanes|=h,xc|=h;u=u.next}while(null!==u&&u!==t);if(null===c?s=i:c.next=l,!Xn(i,e.memoizedState)&&(Ms=!0,d&&null!==(n=Wo)))throw n;e.memoizedState=i,e.baseState=s,e.baseQueue=c,r.lastRenderedState=i}return null===o&&(r.lanes=0),[e.memoizedState,r.dispatch]}function pa(e){var t=ca(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,i=t.memoizedState;if(null!==o){n.pending=null;var s=o=o.next;do{i=e(i,s.action),s=s.next}while(s!==o);Xn(i,t.memoizedState)||(Ms=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function ya(e,t,n){var r=Bi,o=ca(),i=ho;if(i){if(void 0===n)throw Error(a(407));n=n()}else n=t();var s=!Xn((Ki||o).memoizedState,n);if(s&&(o.memoizedState=n,Ms=!0),o=o.queue,Ha(wa.bind(null,r,o,e),[e]),o.getSnapshot!==t||s||null!==Wi&&1&Wi.memoizedState.tag){if(r.flags|=2048,qa(9,{destroy:void 0},ba.bind(null,r,o,n,t),null),null===fc)throw Error(a(349));i||0!==(127&Hi)||va(r,t,n)}return n}function va(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=Bi.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},Bi.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function ba(e,t,n,r){t.value=n,t.getSnapshot=r,ka(t)&&Ca(e)}function wa(e,t,n){return n(function(){ka(t)&&Ca(e)})}function ka(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Xn(e,n)}catch(r){return!0}}function Ca(e){var t=Mr(e,2);null!==t&&Qc(t,e,2)}function Sa(e){var t=la();if("function"===typeof e){var n=e;if(e=n(),Qi){be(!0);try{n()}finally{be(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ga,lastRenderedState:e},t}function xa(e,t,n,r){return e.baseState=n,ma(e,Ki,"function"===typeof r?r:ga)}function Aa(e,t,n,r,o){if(hs(e))throw Error(a(485));if(null!==(e=t.action)){var i={payload:o,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){i.listeners.push(e)}};null!==O.T?n(!0):i.isTransition=!1,r(i),null===(n=t.pending)?(i.next=t.pending=i,Ta(t,i)):(i.next=n.next,t.pending=n.next=i)}}function Ta(e,t){var n=t.action,r=t.payload,o=e.state;if(t.isTransition){var i=O.T,a={};O.T=a;try{var s=n(o,r),l=O.S;null!==l&&l(a,s),Ia(e,t,s)}catch(c){Ea(e,t,c)}finally{null!==i&&null!==a.types&&(i.types=a.types),O.T=i}}else try{Ia(e,t,i=n(o,r))}catch(u){Ea(e,t,u)}}function Ia(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then(function(n){Pa(e,t,n)},function(n){return Ea(e,t,n)}):Pa(e,t,n)}function Pa(e,t,n){t.status="fulfilled",t.value=n,_a(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,Ta(e,n)))}function Ea(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,_a(t),t=t.next}while(t!==r)}e.action=null}function _a(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Na(e,t){return t}function Ra(e,t){if(ho){var n=fc.formState;if(null!==n){e:{var r=Bi;if(ho){if(uo){t:{for(var o=uo,i=fo;8!==o.nodeType;){if(!i){o=null;break t}if(null===(o=Md(o.nextSibling))){o=null;break t}}o="F!"===(i=o.data)||"F"===i?o:null}if(o){uo=Md(o.nextSibling),r="F!"===o.data;break e}}po(r)}r=!1}r&&(t=n[0])}}return(n=la()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Na,lastRenderedState:t},n.queue=r,n=cs.bind(null,Bi,r),r.dispatch=n,r=Sa(!1),i=ds.bind(null,Bi,!1,r.queue),o={state:t,dispatch:null,action:e,pending:null},(r=la()).queue=o,n=Aa.bind(null,Bi,o,i,n),o.dispatch=n,r.memoizedState=e,[t,n,!1]}function Ma(e){return Oa(ca(),Ki,e)}function Oa(e,t,n){if(t=ma(e,t,Na)[0],e=fa(ga)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var r=ua(t)}catch(a){if(a===Xo)throw ei;throw a}else r=t;var o=(t=ca()).queue,i=o.dispatch;return n!==t.memoizedState&&(Bi.flags|=2048,qa(9,{destroy:void 0},ja.bind(null,o,n),null)),[r,i,e]}function ja(e,t){e.action=t}function La(e){var t=ca(),n=Ki;if(null!==n)return Oa(t,n,e);ca(),t=t.memoizedState;var r=(n=ca()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function qa(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},null===(t=Bi.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},Bi.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Da(){return ca().memoizedState}function za(e,t,n,r){var o=la();Bi.flags|=e,o.memoizedState=qa(1|t,{destroy:void 0},n,void 0===r?null:r)}function Fa(e,t,n,r){var o=ca();r=void 0===r?null:r;var i=o.memoizedState.inst;null!==Ki&&null!==r&&ea(r,Ki.memoizedState.deps)?o.memoizedState=qa(t,i,n,r):(Bi.flags|=e,o.memoizedState=qa(1|t,i,n,r))}function Ua(e,t){za(8390656,8,e,t)}function Ha(e,t){Fa(2048,8,e,t)}function Ba(e){var t=ca().memoizedState;return function(e){Bi.flags|=4;var t=Bi.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},Bi.updateQueue=t,t.events=[e];else{var n=t.events;null===n?t.events=[e]:n.push(e)}}({ref:t,nextImpl:e}),function(){if(0!==(2&gc))throw Error(a(440));return t.impl.apply(void 0,arguments)}}function Ka(e,t){return Fa(4,2,e,t)}function Wa(e,t){return Fa(4,4,e,t)}function Va(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function Ga(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,Fa(4,4,Va.bind(null,t,e),n)}function Qa(){}function Ya(e,t){var n=ca();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&ea(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ja(e,t){var n=ca();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&ea(t,r[1]))return r[0];if(r=e(),Qi){be(!0);try{e()}finally{be(!1)}}return n.memoizedState=[r,t],r}function $a(e,t,n){return void 0===n||0!==(1073741824&Hi)&&0===(261930&pc)?e.memoizedState=t:(e.memoizedState=n,e=Gc(),Bi.lanes|=e,xc|=e,n)}function Xa(e,t,n,r){return Xn(n,t)?n:null!==Pi.current?(e=$a(e,n,r),Xn(e,t)||(Ms=!0),e):0===(42&Hi)||0!==(1073741824&Hi)&&0===(261930&pc)?(Ms=!0,e.memoizedState=n):(e=Gc(),Bi.lanes|=e,xc|=e,t)}function Za(e,t,n,r,o){var i=j.p;j.p=0!==i&&8>i?i:8;var a=O.T,s={};O.T=s,ds(e,!1,t,n);try{var l=o(),c=O.S;if(null!==c&&c(s,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)us(e,t,function(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){r.status="fulfilled",r.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(r.status="rejected",r.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),r}(l,r),Vc());else us(e,t,r,Vc())}catch(u){us(e,t,{then:function(){},status:"rejected",reason:u},Vc())}finally{j.p=i,null!==a&&null!==s.types&&(a.types=s.types),O.T=a}}function es(){}function ts(e,t,n,r){if(5!==e.tag)throw Error(a(476));var o=ns(e).queue;Za(e,o,t,L,null===n?es:function(){return rs(e),n(r)})}function ns(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:L,baseState:L,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ga,lastRenderedState:L},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ga,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function rs(e){var t=ns(e);null===t.next&&(t=e.alternate.memoizedState),us(e,t.next.queue,{},Vc())}function os(){return Mo(uh)}function is(){return ca().memoizedState}function as(){return ca().memoizedState}function ss(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Vc(),r=wi(t,e=bi(n),n);return null!==r&&(Qc(r,t,n),ki(r,t,n)),t={cache:Fo()},void(e.payload=t)}t=t.return}}function ls(e,t,n){var r=Vc();n={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},hs(e)?gs(t,n):null!==(n=Rr(e,t,n,r))&&(Qc(n,e,r),fs(n,t,r))}function cs(e,t,n){us(e,t,n,Vc())}function us(e,t,n,r){var o={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(hs(e))gs(t,o);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=i(a,n);if(o.hasEagerState=!0,o.eagerState=s,Xn(s,a))return Nr(e,t,o,0),null===fc&&_r(),!1}catch(l){}if(null!==(n=Rr(e,t,o,r)))return Qc(n,e,r),fs(n,t,r),!0}return!1}function ds(e,t,n,r){if(r={lane:2,revertLane:Hu(),gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},hs(e)){if(t)throw Error(a(479))}else null!==(t=Rr(e,n,r,2))&&Qc(t,e,2)}function hs(e){var t=e.alternate;return e===Bi||null!==t&&t===Bi}function gs(e,t){Gi=Vi=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function fs(e,t,n){if(0!==(4194048&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Oe(e,n)}}var ms={readContext:Mo,use:da,useCallback:Zi,useContext:Zi,useEffect:Zi,useImperativeHandle:Zi,useLayoutEffect:Zi,useInsertionEffect:Zi,useMemo:Zi,useReducer:Zi,useRef:Zi,useState:Zi,useDebugValue:Zi,useDeferredValue:Zi,useTransition:Zi,useSyncExternalStore:Zi,useId:Zi,useHostTransitionStatus:Zi,useFormState:Zi,useActionState:Zi,useOptimistic:Zi,useMemoCache:Zi,useCacheRefresh:Zi};ms.useEffectEvent=Zi;var ps={readContext:Mo,use:da,useCallback:function(e,t){return la().memoizedState=[e,void 0===t?null:t],e},useContext:Mo,useEffect:Ua,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,za(4194308,4,Va.bind(null,t,e),n)},useLayoutEffect:function(e,t){return za(4194308,4,e,t)},useInsertionEffect:function(e,t){za(4,2,e,t)},useMemo:function(e,t){var n=la();t=void 0===t?null:t;var r=e();if(Qi){be(!0);try{e()}finally{be(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=la();if(void 0!==n){var o=n(t);if(Qi){be(!0);try{n(t)}finally{be(!1)}}}else o=t;return r.memoizedState=r.baseState=o,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:o},r.queue=e,e=e.dispatch=ls.bind(null,Bi,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},la().memoizedState=e},useState:function(e){var t=(e=Sa(e)).queue,n=cs.bind(null,Bi,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Qa,useDeferredValue:function(e,t){return $a(la(),e,t)},useTransition:function(){var e=Sa(!1);return e=Za.bind(null,Bi,e.queue,!0,!1),la().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=Bi,o=la();if(ho){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===fc)throw Error(a(349));0!==(127&pc)||va(r,t,n)}o.memoizedState=n;var i={value:n,getSnapshot:t};return o.queue=i,Ua(wa.bind(null,r,i,e),[e]),r.flags|=2048,qa(9,{destroy:void 0},ba.bind(null,r,i,n,t),null),n},useId:function(){var e=la(),t=fc.identifierPrefix;if(ho){var n=ro;t="_"+t+"R_"+(n=(no&~(1<<32-we(no)-1)).toString(32)+n),0<(n=Yi++)&&(t+="H"+n.toString(32)),t+="_"}else t="_"+t+"r_"+(n=Xi++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:os,useFormState:Ra,useActionState:Ra,useOptimistic:function(e){var t=la();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=ds.bind(null,Bi,!0,n),n.dispatch=t,[e,t]},useMemoCache:ha,useCacheRefresh:function(){return la().memoizedState=ss.bind(null,Bi)},useEffectEvent:function(e){var t=la(),n={impl:e};return t.memoizedState=n,function(){if(0!==(2&gc))throw Error(a(440));return n.impl.apply(void 0,arguments)}}},ys={readContext:Mo,use:da,useCallback:Ya,useContext:Mo,useEffect:Ha,useImperativeHandle:Ga,useInsertionEffect:Ka,useLayoutEffect:Wa,useMemo:Ja,useReducer:fa,useRef:Da,useState:function(){return fa(ga)},useDebugValue:Qa,useDeferredValue:function(e,t){return Xa(ca(),Ki.memoizedState,e,t)},useTransition:function(){var e=fa(ga)[0],t=ca().memoizedState;return["boolean"===typeof e?e:ua(e),t]},useSyncExternalStore:ya,useId:is,useHostTransitionStatus:os,useFormState:Ma,useActionState:Ma,useOptimistic:function(e,t){return xa(ca(),0,e,t)},useMemoCache:ha,useCacheRefresh:as};ys.useEffectEvent=Ba;var vs={readContext:Mo,use:da,useCallback:Ya,useContext:Mo,useEffect:Ha,useImperativeHandle:Ga,useInsertionEffect:Ka,useLayoutEffect:Wa,useMemo:Ja,useReducer:pa,useRef:Da,useState:function(){return pa(ga)},useDebugValue:Qa,useDeferredValue:function(e,t){var n=ca();return null===Ki?$a(n,e,t):Xa(n,Ki.memoizedState,e,t)},useTransition:function(){var e=pa(ga)[0],t=ca().memoizedState;return["boolean"===typeof e?e:ua(e),t]},useSyncExternalStore:ya,useId:is,useHostTransitionStatus:os,useFormState:La,useActionState:La,useOptimistic:function(e,t){var n=ca();return null!==Ki?xa(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:ha,useCacheRefresh:as};function bs(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:g({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}vs.useEffectEvent=Ba;var ws={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Vc(),o=bi(r);o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=wi(e,o,r))&&(Qc(t,e,r),ki(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Vc(),o=bi(r);o.tag=1,o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=wi(e,o,r))&&(Qc(t,e,r),ki(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Vc(),r=bi(n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=wi(e,r,n))&&(Qc(t,e,n),ki(t,e,n))}};function ks(e,t,n,r,o,i,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,a):!t.prototype||!t.prototype.isPureReactComponent||(!Zn(n,r)||!Zn(o,i))}function Cs(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ws.enqueueReplaceState(t,t.state,null)}function Ss(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var o in n===t&&(n=g({},n)),e)void 0===n[o]&&(n[o]=e[o]);return n}function xs(e){Tr(e)}function As(e){console.error(e)}function Ts(e){Tr(e)}function Is(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Ps(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function Es(e,t,n){return(n=bi(n)).tag=3,n.payload={element:null},n.callback=function(){Is(e,t)},n}function _s(e){return(e=bi(e)).tag=3,e}function Ns(e,t,n,r){var o=n.type.getDerivedStateFromError;if("function"===typeof o){var i=r.value;e.payload=function(){return o(i)},e.callback=function(){Ps(t,n,r)}}var a=n.stateNode;null!==a&&"function"===typeof a.componentDidCatch&&(e.callback=function(){Ps(t,n,r),"function"!==typeof o&&(null===Lc?Lc=new Set([this]):Lc.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var Rs=Error(a(461)),Ms=!1;function Os(e,t,n,r){t.child=null===e?mi(t,null,n,r):fi(t,e.child,n,r)}function js(e,t,n,r,o){n=n.render;var i=t.ref;if("ref"in r){var a={};for(var s in r)"ref"!==s&&(a[s]=r[s])}else a=r;return Ro(t),r=ta(e,t,n,a,i,o),s=ia(),null===e||Ms?(ho&&s&&ao(t),t.flags|=1,Os(e,t,r,o),t.child):(aa(e,t,o),ol(e,t,o))}function Ls(e,t,n,r,o){if(null===e){var i=n.type;return"function"!==typeof i||zr(i)||void 0!==i.defaultProps||null!==n.compare?((e=Hr(n.type,null,r,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,qs(e,t,i,r,o))}if(i=e.child,!il(e,o)){var a=i.memoizedProps;if((n=null!==(n=n.compare)?n:Zn)(a,r)&&e.ref===t.ref)return ol(e,t,o)}return t.flags|=1,(e=Fr(i,r)).ref=t.ref,e.return=t,t.child=e}function qs(e,t,n,r,o){if(null!==e){var i=e.memoizedProps;if(Zn(i,r)&&e.ref===t.ref){if(Ms=!1,t.pendingProps=r=i,!il(e,o))return t.lanes=e.lanes,ol(e,t,o);0!==(131072&e.flags)&&(Ms=!0)}}return Ks(e,t,n,r,o)}function Ds(e,t,n,r){var o=r.children,i=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===r.mode){if(0!==(128&t.flags)){if(i=null!==i?i.baseLanes|n:n,null!==e){for(r=t.child=e.child,o=0;null!==r;)o=o|r.lanes|r.childLanes,r=r.sibling;r=o&~i}else r=0,t.child=null;return Fs(e,t,i,n,r)}if(0===(536870912&n))return r=t.lanes=536870912,Fs(e,t,null!==i?i.baseLanes|n:n,n,r);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Jo(0,null!==i?i.cachePool:null),null!==i?_i(t,i):Ni(),qi(t)}else null!==i?(Jo(0,i.cachePool),_i(t,i),Di(),t.memoizedState=null):(null!==e&&Jo(0,null),Ni(),Di());return Os(e,t,o,n),t.child}function zs(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Fs(e,t,n,r,o){var i=Yo();return i=null===i?null:{parent:zo._currentValue,pool:i},t.memoizedState={baseLanes:n,cachePool:i},null!==e&&Jo(0,null),Ni(),qi(t),null!==e&&_o(e,t,r,!0),t.childLanes=o,null}function Us(e,t){return(t=Zs({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function Hs(e,t,n){return fi(t,e.child,null,n),(e=Us(t,t.pendingProps)).flags|=2,zi(t),t.memoizedState=null,e}function Bs(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(a(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Ks(e,t,n,r,o){return Ro(t),n=ta(e,t,n,r,void 0,o),r=ia(),null===e||Ms?(ho&&r&&ao(t),t.flags|=1,Os(e,t,n,o),t.child):(aa(e,t,o),ol(e,t,o))}function Ws(e,t,n,r,o,i){return Ro(t),t.updateQueue=null,n=ra(t,r,n,o),na(e),r=ia(),null===e||Ms?(ho&&r&&ao(t),t.flags|=1,Os(e,t,n,i),t.child):(aa(e,t,i),ol(e,t,i))}function Vs(e,t,n,r,o){if(Ro(t),null===t.stateNode){var i=Lr,a=n.contextType;"object"===typeof a&&null!==a&&(i=Mo(a)),i=new n(r,i),t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,i.updater=ws,t.stateNode=i,i._reactInternals=t,(i=t.stateNode).props=r,i.state=t.memoizedState,i.refs={},yi(t),a=n.contextType,i.context="object"===typeof a&&null!==a?Mo(a):Lr,i.state=t.memoizedState,"function"===typeof(a=n.getDerivedStateFromProps)&&(bs(t,n,a,r),i.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(a=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),a!==i.state&&ws.enqueueReplaceState(i,i.state,null),Ai(t,r,i,o),xi(),i.state=t.memoizedState),"function"===typeof i.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){i=t.stateNode;var s=t.memoizedProps,l=Ss(n,s);i.props=l;var c=i.context,u=n.contextType;a=Lr,"object"===typeof u&&null!==u&&(a=Mo(u));var d=n.getDerivedStateFromProps;u="function"===typeof d||"function"===typeof i.getSnapshotBeforeUpdate,s=t.pendingProps!==s,u||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(s||c!==a)&&Cs(t,i,r,a),pi=!1;var h=t.memoizedState;i.state=h,Ai(t,r,i,o),xi(),c=t.memoizedState,s||h!==c||pi?("function"===typeof d&&(bs(t,n,d,r),c=t.memoizedState),(l=pi||ks(t,n,l,r,h,c,a))?(u||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),i.props=r,i.state=c,i.context=a,r=l):("function"===typeof i.componentDidMount&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,vi(e,t),u=Ss(n,a=t.memoizedProps),i.props=u,d=t.pendingProps,h=i.context,c=n.contextType,l=Lr,"object"===typeof c&&null!==c&&(l=Mo(c)),(c="function"===typeof(s=n.getDerivedStateFromProps)||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(a!==d||h!==l)&&Cs(t,i,r,l),pi=!1,h=t.memoizedState,i.state=h,Ai(t,r,i,o),xi();var g=t.memoizedState;a!==d||h!==g||pi||null!==e&&null!==e.dependencies&&No(e.dependencies)?("function"===typeof s&&(bs(t,n,s,r),g=t.memoizedState),(u=pi||ks(t,n,u,r,h,g,l)||null!==e&&null!==e.dependencies&&No(e.dependencies))?(c||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(r,g,l),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(r,g,l)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=g),i.props=r,i.state=g,i.context=l,r=u):("function"!==typeof i.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return i=r,Bs(e,t),r=0!==(128&t.flags),i||r?(i=t.stateNode,n=r&&"function"!==typeof n.getDerivedStateFromError?null:i.render(),t.flags|=1,null!==e&&r?(t.child=fi(t,e.child,null,o),t.child=fi(t,null,n,o)):Os(e,t,n,o),t.memoizedState=i.state,e=t.child):e=ol(e,t,o),e}function Gs(e,t,n,r){return wo(),t.flags|=256,Os(e,t,n,r),t.child}var Qs={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ys(e){return{baseLanes:e,cachePool:$o()}}function Js(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=Ic),e}function $s(e,t,n){var r,o=t.pendingProps,i=!1,s=0!==(128&t.flags);if((r=s)||(r=(null===e||null!==e.memoizedState)&&0!==(2&Fi.current)),r&&(i=!0,t.flags&=-129),r=0!==(32&t.flags),t.flags&=-33,null===e){if(ho){if(i?ji(t):Di(),(e=uo)?null!==(e=null!==(e=_d(e,fo))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==to?{id:no,overflow:ro}:null,retryLane:536870912,hydrationErrors:null},(n=Wr(e)).return=t,t.child=n,co=t,uo=null):e=null,null===e)throw po(t);return Rd(e)?t.lanes=32:t.lanes=536870912,null}var l=o.children;return o=o.fallback,i?(Di(),l=Zs({mode:"hidden",children:l},i=t.mode),o=Br(o,i,n,null),l.return=t,o.return=t,l.sibling=o,t.child=l,(o=t.child).memoizedState=Ys(n),o.childLanes=Js(e,r,n),t.memoizedState=Qs,zs(null,o)):(ji(t),Xs(t,l))}var c=e.memoizedState;if(null!==c&&null!==(l=c.dehydrated)){if(s)256&t.flags?(ji(t),t.flags&=-257,t=el(e,t,n)):null!==t.memoizedState?(Di(),t.child=e.child,t.flags|=128,t=null):(Di(),l=o.fallback,i=t.mode,o=Zs({mode:"visible",children:o.children},i),(l=Br(l,i,n,null)).flags|=2,o.return=t,l.return=t,o.sibling=l,t.child=o,fi(t,e.child,null,n),(o=t.child).memoizedState=Ys(n),o.childLanes=Js(e,r,n),t.memoizedState=Qs,t=zs(null,o));else if(ji(t),Rd(l)){if(r=l.nextSibling&&l.nextSibling.dataset)var u=r.dgst;r=u,(o=Error(a(419))).stack="",o.digest=r,Co({value:o,source:null,stack:null}),t=el(e,t,n)}else if(Ms||_o(e,t,n,!1),r=0!==(n&e.childLanes),Ms||r){if(null!==(r=fc)&&(0!==(o=je(r,n))&&o!==c.retryLane))throw c.retryLane=o,Mr(e,o),Qc(r,e,o),Rs;Nd(l)||au(),t=el(e,t,n)}else Nd(l)?(t.flags|=192,t.child=e.child,t=null):(e=c.treeContext,uo=Md(l.nextSibling),co=t,ho=!0,go=null,fo=!1,null!==e&&lo(t,e),(t=Xs(t,o.children)).flags|=4096);return t}return i?(Di(),l=o.fallback,i=t.mode,u=(c=e.child).sibling,(o=Fr(c,{mode:"hidden",children:o.children})).subtreeFlags=65011712&c.subtreeFlags,null!==u?l=Fr(u,l):(l=Br(l,i,n,null)).flags|=2,l.return=t,o.return=t,o.sibling=l,t.child=o,zs(null,o),o=t.child,null===(l=e.child.memoizedState)?l=Ys(n):(null!==(i=l.cachePool)?(c=zo._currentValue,i=i.parent!==c?{parent:c,pool:c}:i):i=$o(),l={baseLanes:l.baseLanes|n,cachePool:i}),o.memoizedState=l,o.childLanes=Js(e,r,n),t.memoizedState=Qs,zs(e.child,o)):(ji(t),e=(n=e.child).sibling,(n=Fr(n,{mode:"visible",children:o.children})).return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n)}function Xs(e,t){return(t=Zs({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Zs(e,t){return(e=Dr(22,e,null,t)).lanes=0,e}function el(e,t,n){return fi(t,e.child,null,n),(e=Xs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function tl(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Po(e.return,t,n)}function nl(e,t,n,r,o,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o,treeForkCount:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=o,a.treeForkCount=i)}function rl(e,t,n){var r=t.pendingProps,o=r.revealOrder,i=r.tail;r=r.children;var a=Fi.current,s=0!==(2&a);if(s?(a=1&a|2,t.flags|=128):a&=1,U(Fi,a),Os(e,t,r,n),r=ho?Xr:0,!s&&null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&tl(e,n,t);else if(19===e.tag)tl(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(o){case"forwards":for(n=t.child,o=null;null!==n;)null!==(e=n.alternate)&&null===Ui(e)&&(o=n),n=n.sibling;null===(n=o)?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),nl(t,!1,o,n,i,r);break;case"backwards":case"unstable_legacy-backwards":for(n=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===Ui(e)){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}nl(t,!0,n,null,i,r);break;case"together":nl(t,!1,null,null,void 0,r);break;default:t.memoizedState=null}return t.child}function ol(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),xc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(_o(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Fr(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Fr(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function il(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!No(e))}function al(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Ms=!0;else{if(!il(e,n)&&0===(128&t.flags))return Ms=!1,function(e,t,n){switch(t.tag){case 3:Q(t,t.stateNode.containerInfo),To(0,zo,e.memoizedState.cache),wo();break;case 27:case 5:J(t);break;case 4:Q(t,t.stateNode.containerInfo);break;case 10:To(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,Li(t),null;break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(ji(t),t.flags|=128,null):0!==(n&t.child.childLanes)?$s(e,t,n):(ji(t),null!==(e=ol(e,t,n))?e.sibling:null);ji(t);break;case 19:var o=0!==(128&e.flags);if((r=0!==(n&t.childLanes))||(_o(e,t,n,!1),r=0!==(n&t.childLanes)),o){if(r)return rl(e,t,n);t.flags|=128}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),U(Fi,Fi.current),r)break;return null;case 22:return t.lanes=0,Ds(e,t,n,t.pendingProps);case 24:To(0,zo,e.memoizedState.cache)}return ol(e,t,n)}(e,t,n);Ms=0!==(131072&e.flags)}else Ms=!1,ho&&0!==(1048576&t.flags)&&io(t,Xr,t.index);switch(t.lanes=0,t.tag){case 16:e:{var r=t.pendingProps;if(e=oi(t.elementType),t.type=e,"function"!==typeof e){if(void 0!==e&&null!==e){var o=e.$$typeof;if(o===C){t.tag=11,t=js(null,t,e,r,n);break e}if(o===A){t.tag=14,t=Ls(null,t,e,r,n);break e}}throw t=R(e)||e,Error(a(306,t,""))}zr(e)?(r=Ss(e,r),t.tag=1,t=Vs(null,t,e,r,n)):(t.tag=0,t=Ks(null,t,e,r,n))}return t;case 0:return Ks(e,t,t.type,t.pendingProps,n);case 1:return Vs(e,t,r=t.type,o=Ss(r,t.pendingProps),n);case 3:e:{if(Q(t,t.stateNode.containerInfo),null===e)throw Error(a(387));r=t.pendingProps;var i=t.memoizedState;o=i.element,vi(e,t),Ai(t,r,null,n);var s=t.memoizedState;if(r=s.cache,To(0,zo,r),r!==i.cache&&Eo(t,[zo],n,!0),xi(),r=s.element,i.isDehydrated){if(i={element:r,isDehydrated:!1,cache:s.cache},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Gs(e,t,r,n);break e}if(r!==o){Co(o=Qr(Error(a(424)),t)),t=Gs(e,t,r,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(uo=Md(e.firstChild),co=t,ho=!0,go=null,fo=!0,n=mi(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(wo(),r===o){t=ol(e,t,n);break e}Os(e,t,r,n)}t=t.child}return t;case 26:return Bs(e,t),null===e?(n=Wd(t.type,null,t.pendingProps,null))?t.memoizedState=n:ho||(n=t.type,e=t.pendingProps,(r=pd(V.current).createElement(n))[Ue]=t,r[He]=e,hd(r,n,e),et(r),t.stateNode=r):t.memoizedState=Wd(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return J(t),null===e&&ho&&(r=t.stateNode=qd(t.type,t.pendingProps,V.current),co=t,fo=!0,o=uo,Td(t.type)?(Od=o,uo=Md(r.firstChild)):uo=o),Os(e,t,t.pendingProps.children,n),Bs(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&ho&&((o=r=uo)&&(null!==(r=function(e,t,n,r){for(;1===e.nodeType;){var o=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[Qe])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(i=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(i!==o.rel||e.getAttribute("href")!==(null==o.href||""===o.href?null:o.href)||e.getAttribute("crossorigin")!==(null==o.crossOrigin?null:o.crossOrigin)||e.getAttribute("title")!==(null==o.title?null:o.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((i=e.getAttribute("src"))!==(null==o.src?null:o.src)||e.getAttribute("type")!==(null==o.type?null:o.type)||e.getAttribute("crossorigin")!==(null==o.crossOrigin?null:o.crossOrigin))&&i&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var i=null==o.name?null:""+o.name;if("hidden"===o.type&&e.getAttribute("name")===i)return e}if(null===(e=Md(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,fo))?(t.stateNode=r,co=t,uo=Md(r.firstChild),fo=!1,o=!0):o=!1),o||po(t)),J(t),o=t.type,i=t.pendingProps,s=null!==e?e.memoizedProps:null,r=i.children,bd(o,i)?r=null:null!==s&&bd(o,s)&&(t.flags|=32),null!==t.memoizedState&&(o=ta(e,t,oa,null,null,n),uh._currentValue=o),Bs(e,t),Os(e,t,r,n),t.child;case 6:return null===e&&ho&&((e=n=uo)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=Md(e.nextSibling)))return null}return e}(n,t.pendingProps,fo))?(t.stateNode=n,co=t,uo=null,e=!0):e=!1),e||po(t)),null;case 13:return $s(e,t,n);case 4:return Q(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=fi(t,null,r,n):Os(e,t,r,n),t.child;case 11:return js(e,t,t.type,t.pendingProps,n);case 7:return Os(e,t,t.pendingProps,n),t.child;case 8:case 12:return Os(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,To(0,t.type,r.value),Os(e,t,r.children,n),t.child;case 9:return o=t.type._context,r=t.pendingProps.children,Ro(t),r=r(o=Mo(o)),t.flags|=1,Os(e,t,r,n),t.child;case 14:return Ls(e,t,t.type,t.pendingProps,n);case 15:return qs(e,t,t.type,t.pendingProps,n);case 19:return rl(e,t,n);case 31:return function(e,t,n){var r=t.pendingProps,o=0!==(128&t.flags);if(t.flags&=-129,null===e){if(ho){if("hidden"===r.mode)return e=Us(t,r),t.lanes=536870912,zs(null,e);if(Li(t),(e=uo)?null!==(e=null!==(e=_d(e,fo))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==to?{id:no,overflow:ro}:null,retryLane:536870912,hydrationErrors:null},(n=Wr(e)).return=t,t.child=n,co=t,uo=null):e=null,null===e)throw po(t);return t.lanes=536870912,null}return Us(t,r)}var i=e.memoizedState;if(null!==i){var s=i.dehydrated;if(Li(t),o)if(256&t.flags)t.flags&=-257,t=Hs(e,t,n);else{if(null===t.memoizedState)throw Error(a(558));t.child=e.child,t.flags|=128,t=null}else if(Ms||_o(e,t,n,!1),o=0!==(n&e.childLanes),Ms||o){if(null!==(r=fc)&&0!==(s=je(r,n))&&s!==i.retryLane)throw i.retryLane=s,Mr(e,s),Qc(r,e,s),Rs;au(),t=Hs(e,t,n)}else e=i.treeContext,uo=Md(s.nextSibling),co=t,ho=!0,go=null,fo=!1,null!==e&&lo(t,e),(t=Us(t,r)).flags|=4096;return t}return(e=Fr(e.child,{mode:r.mode,children:r.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,n);case 22:return Ds(e,t,n,t.pendingProps);case 24:return Ro(t),r=Mo(zo),null===e?(null===(o=Yo())&&(o=fc,i=Fo(),o.pooledCache=i,i.refCount++,null!==i&&(o.pooledCacheLanes|=n),o=i),t.memoizedState={parent:r,cache:o},yi(t),To(0,zo,o)):(0!==(e.lanes&n)&&(vi(e,t),Ai(t,null,null,n),xi()),o=e.memoizedState,i=t.memoizedState,o.parent!==r?(o={parent:r,cache:r},t.memoizedState=o,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=o),To(0,zo,r)):(r=i.cache,To(0,zo,r),r!==o.cache&&Eo(t,[zo],n,!0))),Os(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(a(156,t.tag))}function sl(e){e.flags|=4}function ll(e,t,n,r,o){if((t=0!==(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&o)===o)if(e.stateNode.complete)e.flags|=8192;else{if(!ru())throw ii=ti,Zo;e.flags|=8192}}else e.flags&=-16777217}function cl(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!oh(t)){if(!ru())throw ii=ti,Zo;e.flags|=8192}}function ul(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?_e():536870912,e.lanes|=t,Pc|=t)}function dl(e,t){if(!ho)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function hl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=65011712&o.subtreeFlags,r|=65011712&o.flags,o.return=e,o=o.sibling;else for(o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function gl(e,t,n){var r=t.pendingProps;switch(so(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return hl(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Io(zo),Y(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(bo(t)?sl(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,ko())),hl(t),null;case 26:var o=t.type,i=t.memoizedState;return null===e?(sl(t),null!==i?(hl(t),cl(t,i)):(hl(t),ll(t,o,0,0,n))):i?i!==e.memoizedState?(sl(t),hl(t),cl(t,i)):(hl(t),t.flags&=-16777217):((e=e.memoizedProps)!==r&&sl(t),hl(t),ll(t,o,0,0,n)),null;case 27:if($(t),n=V.current,o=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&sl(t);else{if(!r){if(null===t.stateNode)throw Error(a(166));return hl(t),null}e=K.current,bo(t)?yo(t):(e=qd(o,r,n),t.stateNode=e,sl(t))}return hl(t),null;case 5:if($(t),o=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&sl(t);else{if(!r){if(null===t.stateNode)throw Error(a(166));return hl(t),null}if(i=K.current,bo(t))yo(t);else{var s=pd(V.current);switch(i){case 1:i=s.createElementNS("http://www.w3.org/2000/svg",o);break;case 2:i=s.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;default:switch(o){case"svg":i=s.createElementNS("http://www.w3.org/2000/svg",o);break;case"math":i=s.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;case"script":(i=s.createElement("div")).innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i="string"===typeof r.is?s.createElement("select",{is:r.is}):s.createElement("select"),r.multiple?i.multiple=!0:r.size&&(i.size=r.size);break;default:i="string"===typeof r.is?s.createElement(o,{is:r.is}):s.createElement(o)}}i[Ue]=t,i[He]=r;e:for(s=t.child;null!==s;){if(5===s.tag||6===s.tag)i.appendChild(s.stateNode);else if(4!==s.tag&&27!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;null===s.sibling;){if(null===s.return||s.return===t)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}t.stateNode=i;e:switch(hd(i,o,r),o){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&sl(t)}}return hl(t),ll(t,t.type,null===e||e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&sl(t);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));if(e=V.current,bo(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(o=co))switch(o.tag){case 27:case 5:r=o.memoizedProps}e[Ue]=t,(e=!!(e.nodeValue===n||null!==r&&!0===r.suppressHydrationWarning||cd(e.nodeValue,n)))||po(t,!0)}else(e=pd(e).createTextNode(r))[Ue]=t,t.stateNode=e}return hl(t),null;case 31:if(n=t.memoizedState,null===e||null!==e.memoizedState){if(r=bo(t),null!==n){if(null===e){if(!r)throw Error(a(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(a(557));e[Ue]=t}else wo(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;hl(t),e=!1}else n=ko(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return 256&t.flags?(zi(t),t):(zi(t),null);if(0!==(128&t.flags))throw Error(a(558))}return hl(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(o=bo(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(a(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(a(317));o[Ue]=t}else wo(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;hl(t),o=!1}else o=ko(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=o),o=!0;if(!o)return 256&t.flags?(zi(t),t):(zi(t),null)}return zi(t),0!==(128&t.flags)?(t.lanes=n,t):(n=null!==r,e=null!==e&&null!==e.memoizedState,n&&(o=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(o=r.alternate.memoizedState.cachePool.pool),i=null,null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(i=r.memoizedState.cachePool.pool),i!==o&&(r.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),ul(t,t.updateQueue),hl(t),null);case 4:return Y(),null===e&&Zu(t.stateNode.containerInfo),hl(t),null;case 10:return Io(t.type),hl(t),null;case 19:if(F(Fi),null===(r=t.memoizedState))return hl(t),null;if(o=0!==(128&t.flags),null===(i=r.rendering))if(o)dl(r,!1);else{if(0!==Sc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(i=Ui(e))){for(t.flags|=128,dl(r,!1),e=i.updateQueue,t.updateQueue=e,ul(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Ur(n,e),n=n.sibling;return U(Fi,1&Fi.current|2),ho&&oo(t,r.treeForkCount),t.child}e=e.sibling}null!==r.tail&&le()>Oc&&(t.flags|=128,o=!0,dl(r,!1),t.lanes=4194304)}else{if(!o)if(null!==(e=Ui(i))){if(t.flags|=128,o=!0,e=e.updateQueue,t.updateQueue=e,ul(t,e),dl(r,!0),null===r.tail&&"hidden"===r.tailMode&&!i.alternate&&!ho)return hl(t),null}else 2*le()-r.renderingStartTime>Oc&&536870912!==n&&(t.flags|=128,o=!0,dl(r,!1),t.lanes=4194304);r.isBackwards?(i.sibling=t.child,t.child=i):(null!==(e=r.last)?e.sibling=i:t.child=i,r.last=i)}return null!==r.tail?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=le(),e.sibling=null,n=Fi.current,U(Fi,o?1&n|2:1&n),ho&&oo(t,r.treeForkCount),e):(hl(t),null);case 22:case 23:return zi(t),Ri(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?0!==(536870912&n)&&0===(128&t.flags)&&(hl(t),6&t.subtreeFlags&&(t.flags|=8192)):hl(t),null!==(n=t.updateQueue)&&ul(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&F(Qo),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Io(zo),hl(t),null;case 25:case 30:return null}throw Error(a(156,t.tag))}function fl(e,t){switch(so(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Io(zo),Y(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return $(t),null;case 31:if(null!==t.memoizedState){if(zi(t),null===t.alternate)throw Error(a(340));wo()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(zi(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));wo()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return F(Fi),null;case 4:return Y(),null;case 10:return Io(t.type),null;case 22:case 23:return zi(t),Ri(),null!==e&&F(Qo),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Io(zo),null;default:return null}}function ml(e,t){switch(so(t),t.tag){case 3:Io(zo),Y();break;case 26:case 27:case 5:$(t);break;case 4:Y();break;case 31:null!==t.memoizedState&&zi(t);break;case 13:zi(t);break;case 19:F(Fi);break;case 10:Io(t.type);break;case 22:case 23:zi(t),Ri(),null!==e&&F(Qo);break;case 24:Io(zo)}}function pl(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var o=r.next;n=o;do{if((n.tag&e)===e){r=void 0;var i=n.create,a=n.inst;r=i(),a.destroy=r}n=n.next}while(n!==o)}}catch(s){Su(t,t.return,s)}}function yl(e,t,n){try{var r=t.updateQueue,o=null!==r?r.lastEffect:null;if(null!==o){var i=o.next;r=i;do{if((r.tag&e)===e){var a=r.inst,s=a.destroy;if(void 0!==s){a.destroy=void 0,o=t;var l=n,c=s;try{c()}catch(u){Su(o,l,u)}}}r=r.next}while(r!==i)}}catch(u){Su(t,t.return,u)}}function vl(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{Ii(t,n)}catch(r){Su(e,e.return,r)}}}function bl(e,t,n){n.props=Ss(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){Su(e,t,r)}}function wl(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode}"function"===typeof n?e.refCleanup=n(r):n.current=r}}catch(o){Su(e,t,o)}}function kl(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"===typeof r)try{r()}catch(o){Su(e,t,o)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(i){Su(e,t,i)}else n.current=null}function Cl(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(o){Su(e,e.return,o)}}function Sl(e,t,n){try{var r=e.stateNode;!function(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var o=null,i=null,s=null,l=null,c=null,u=null,d=null;for(f in n){var h=n[f];if(n.hasOwnProperty(f)&&null!=h)switch(f){case"checked":case"value":break;case"defaultValue":c=h;default:r.hasOwnProperty(f)||ud(e,t,f,null,r,h)}}for(var g in r){var f=r[g];if(h=n[g],r.hasOwnProperty(g)&&(null!=f||null!=h))switch(g){case"type":i=f;break;case"name":o=f;break;case"checked":u=f;break;case"defaultChecked":d=f;break;case"value":s=f;break;case"defaultValue":l=f;break;case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(a(137,t));break;default:f!==h&&ud(e,t,g,f,r,h)}}return void vt(e,s,l,c,u,d,i,o);case"select":for(i in f=s=l=g=null,n)if(c=n[i],n.hasOwnProperty(i)&&null!=c)switch(i){case"value":break;case"multiple":f=c;default:r.hasOwnProperty(i)||ud(e,t,i,null,r,c)}for(o in r)if(i=r[o],c=n[o],r.hasOwnProperty(o)&&(null!=i||null!=c))switch(o){case"value":g=i;break;case"defaultValue":l=i;break;case"multiple":s=i;default:i!==c&&ud(e,t,o,i,r,c)}return t=l,n=s,r=f,void(null!=g?kt(e,!!n,g,!1):!!r!==!!n&&(null!=t?kt(e,!!n,t,!0):kt(e,!!n,n?[]:"",!1)));case"textarea":for(l in f=g=null,n)if(o=n[l],n.hasOwnProperty(l)&&null!=o&&!r.hasOwnProperty(l))switch(l){case"value":case"children":break;default:ud(e,t,l,null,r,o)}for(s in r)if(o=r[s],i=n[s],r.hasOwnProperty(s)&&(null!=o||null!=i))switch(s){case"value":g=o;break;case"defaultValue":f=o;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=o)throw Error(a(91));break;default:o!==i&&ud(e,t,s,o,r,i)}return void Ct(e,g,f);case"option":for(var m in n)if(g=n[m],n.hasOwnProperty(m)&&null!=g&&!r.hasOwnProperty(m))if("selected"===m)e.selected=!1;else ud(e,t,m,null,r,g);for(c in r)if(g=r[c],f=n[c],r.hasOwnProperty(c)&&g!==f&&(null!=g||null!=f))if("selected"===c)e.selected=g&&"function"!==typeof g&&"symbol"!==typeof g;else ud(e,t,c,g,r,f);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var p in n)g=n[p],n.hasOwnProperty(p)&&null!=g&&!r.hasOwnProperty(p)&&ud(e,t,p,null,r,g);for(u in r)if(g=r[u],f=n[u],r.hasOwnProperty(u)&&g!==f&&(null!=g||null!=f))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=g)throw Error(a(137,t));break;default:ud(e,t,u,g,r,f)}return;default:if(Pt(t)){for(var y in n)g=n[y],n.hasOwnProperty(y)&&void 0!==g&&!r.hasOwnProperty(y)&&dd(e,t,y,void 0,r,g);for(d in r)g=r[d],f=n[d],!r.hasOwnProperty(d)||g===f||void 0===g&&void 0===f||dd(e,t,d,g,r,f);return}}for(var v in n)g=n[v],n.hasOwnProperty(v)&&null!=g&&!r.hasOwnProperty(v)&&ud(e,t,v,null,r,g);for(h in r)g=r[h],f=n[h],!r.hasOwnProperty(h)||g===f||null==g&&null==f||ud(e,t,h,g,r,f)}(r,e.type,n,t),r[He]=t}catch(o){Su(e,e.return,o)}}function xl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&Td(e.type)||4===e.tag}function Al(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||xl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&Td(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Tl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Rt));else if(4!==r&&(27===r&&Td(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(Tl(e,t,n),e=e.sibling;null!==e;)Tl(e,t,n),e=e.sibling}function Il(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&(27===r&&Td(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(Il(e,t,n),e=e.sibling;null!==e;)Il(e,t,n),e=e.sibling}function Pl(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,o=t.attributes;o.length;)t.removeAttributeNode(o[0]);hd(t,r,n),t[Ue]=e,t[He]=n}catch(i){Su(e,e.return,i)}}var El=!1,_l=!1,Nl=!1,Rl="function"===typeof WeakSet?WeakSet:Set,Ml=null;function Ol(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:Ql(e,n),4&r&&pl(5,n);break;case 1:if(Ql(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(a){Su(n,n.return,a)}else{var o=Ss(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(o,t,e.__reactInternalSnapshotBeforeUpdate)}catch(s){Su(n,n.return,s)}}64&r&&vl(n),512&r&&wl(n,n.return);break;case 3:if(Ql(e,n),64&r&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{Ii(e,t)}catch(a){Su(n,n.return,a)}}break;case 27:null===t&&4&r&&Pl(n);case 26:case 5:Ql(e,n),null===t&&4&r&&Cl(n),512&r&&wl(n,n.return);break;case 12:Ql(e,n);break;case 31:Ql(e,n),4&r&&Fl(e,n);break;case 13:Ql(e,n),4&r&&Ul(e,n),64&r&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==n.readyState)t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}(e,n=Iu.bind(null,n))));break;case 22:if(!(r=null!==n.memoizedState||El)){t=null!==t&&null!==t.memoizedState||_l,o=El;var i=_l;El=r,(_l=t)&&!i?Jl(e,n,0!==(8772&n.subtreeFlags)):Ql(e,n),El=o,_l=i}break;case 30:break;default:Ql(e,n)}}function jl(e){var t=e.alternate;null!==t&&(e.alternate=null,jl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Ye(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Ll=null,ql=!1;function Dl(e,t,n){for(n=n.child;null!==n;)zl(e,t,n),n=n.sibling}function zl(e,t,n){if(ve&&"function"===typeof ve.onCommitFiberUnmount)try{ve.onCommitFiberUnmount(ye,n)}catch(i){}switch(n.tag){case 26:_l||kl(n,t),Dl(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:_l||kl(n,t);var r=Ll,o=ql;Td(n.type)&&(Ll=n.stateNode,ql=!1),Dl(e,t,n),Dd(n.stateNode),Ll=r,ql=o;break;case 5:_l||kl(n,t);case 6:if(r=Ll,o=ql,Ll=null,Dl(e,t,n),ql=o,null!==(Ll=r))if(ql)try{(9===Ll.nodeType?Ll.body:"HTML"===Ll.nodeName?Ll.ownerDocument.body:Ll).removeChild(n.stateNode)}catch(a){Su(n,t,a)}else try{Ll.removeChild(n.stateNode)}catch(a){Su(n,t,a)}break;case 18:null!==Ll&&(ql?(Id(9===(e=Ll).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Kh(e)):Id(Ll,n.stateNode));break;case 4:r=Ll,o=ql,Ll=n.stateNode.containerInfo,ql=!0,Dl(e,t,n),Ll=r,ql=o;break;case 0:case 11:case 14:case 15:yl(2,n,t),_l||yl(4,n,t),Dl(e,t,n);break;case 1:_l||(kl(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount&&bl(n,t,r)),Dl(e,t,n);break;case 21:Dl(e,t,n);break;case 22:_l=(r=_l)||null!==n.memoizedState,Dl(e,t,n),_l=r;break;default:Dl(e,t,n)}}function Fl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&null!==(e=e.memoizedState))){e=e.dehydrated;try{Kh(e)}catch(n){Su(t,t.return,n)}}}function Ul(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Kh(e)}catch(n){Su(t,t.return,n)}}function Hl(e,t){var n=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Rl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Rl),t;default:throw Error(a(435,e.tag))}}(e);t.forEach(function(t){if(!n.has(t)){n.add(t);var r=Pu.bind(null,e,t);t.then(r,r)}})}function Bl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var o=n[r],i=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 27:if(Td(l.type)){Ll=l.stateNode,ql=!1;break e}break;case 5:Ll=l.stateNode,ql=!1;break e;case 3:case 4:Ll=l.stateNode.containerInfo,ql=!0;break e}l=l.return}if(null===Ll)throw Error(a(160));zl(i,s,o),Ll=null,ql=!1,null!==(i=o.alternate)&&(i.return=null),o.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)Wl(t,e),t=t.sibling}var Kl=null;function Wl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Bl(t,e),Vl(e),4&r&&(yl(3,e,e.return),pl(3,e),yl(5,e,e.return));break;case 1:Bl(t,e),Vl(e),512&r&&(_l||null===n||kl(n,n.return)),64&r&&El&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r))));break;case 26:var o=Kl;if(Bl(t,e),Vl(e),512&r&&(_l||null===n||kl(n,n.return)),4&r){var i=null!==n?n.memoizedState:null;if(r=e.memoizedState,null===n)if(null===r)if(null===e.stateNode){e:{r=e.type,n=e.memoizedProps,o=o.ownerDocument||o;t:switch(r){case"title":(!(i=o.getElementsByTagName("title")[0])||i[Qe]||i[Ue]||"http://www.w3.org/2000/svg"===i.namespaceURI||i.hasAttribute("itemprop"))&&(i=o.createElement(r),o.head.insertBefore(i,o.querySelector("head > title"))),hd(i,r,n),i[Ue]=e,et(i),r=i;break e;case"link":var s=nh("link","href",o).get(r+(n.href||""));if(s)for(var l=0;l<s.length;l++)if((i=s[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&i.getAttribute("rel")===(null==n.rel?null:n.rel)&&i.getAttribute("title")===(null==n.title?null:n.title)&&i.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){s.splice(l,1);break t}hd(i=o.createElement(r),r,n),o.head.appendChild(i);break;case"meta":if(s=nh("meta","content",o).get(r+(n.content||"")))for(l=0;l<s.length;l++)if((i=s[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&i.getAttribute("name")===(null==n.name?null:n.name)&&i.getAttribute("property")===(null==n.property?null:n.property)&&i.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&i.getAttribute("charset")===(null==n.charSet?null:n.charSet)){s.splice(l,1);break t}hd(i=o.createElement(r),r,n),o.head.appendChild(i);break;default:throw Error(a(468,r))}i[Ue]=e,et(i),r=i}e.stateNode=r}else rh(o,e.type,e.stateNode);else e.stateNode=$d(o,r,e.memoizedProps);else i!==r?(null===i?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):i.count--,null===r?rh(o,e.type,e.stateNode):$d(o,r,e.memoizedProps)):null===r&&null!==e.stateNode&&Sl(e,e.memoizedProps,n.memoizedProps)}break;case 27:Bl(t,e),Vl(e),512&r&&(_l||null===n||kl(n,n.return)),null!==n&&4&r&&Sl(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Bl(t,e),Vl(e),512&r&&(_l||null===n||kl(n,n.return)),32&e.flags){o=e.stateNode;try{xt(o,"")}catch(m){Su(e,e.return,m)}}4&r&&null!=e.stateNode&&Sl(e,o=e.memoizedProps,null!==n?n.memoizedProps:o),1024&r&&(Nl=!0);break;case 6:if(Bl(t,e),Vl(e),4&r){if(null===e.stateNode)throw Error(a(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(m){Su(e,e.return,m)}}break;case 3:if(th=null,o=Kl,Kl=Ud(t.containerInfo),Bl(t,e),Kl=o,Vl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Kh(t.containerInfo)}catch(m){Su(e,e.return,m)}Nl&&(Nl=!1,Gl(e));break;case 4:r=Kl,Kl=Ud(e.stateNode.containerInfo),Bl(t,e),Vl(e),Kl=r;break;case 12:default:Bl(t,e),Vl(e);break;case 31:case 19:Bl(t,e),Vl(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Hl(e,r)));break;case 13:Bl(t,e),Vl(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(Rc=le()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Hl(e,r)));break;case 22:o=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,u=El,d=_l;if(El=u||o,_l=d||c,Bl(t,e),_l=d,El=u,Vl(e),8192&r)e:for(t=e.stateNode,t._visibility=o?-2&t._visibility:1|t._visibility,o&&(null===n||c||El||_l||Yl(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(i=c.stateNode,o)"function"===typeof(s=i.style).setProperty?s.setProperty("display","none","important"):s.display="none";else{l=c.stateNode;var h=c.memoizedProps.style,g=void 0!==h&&null!==h&&h.hasOwnProperty("display")?h.display:null;l.style.display=null==g||"boolean"===typeof g?"":(""+g).trim()}}catch(m){Su(c,c.return,m)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=o?"":c.memoizedProps}catch(m){Su(c,c.return,m)}}}else if(18===t.tag){if(null===n){c=t;try{var f=c.stateNode;o?Pd(f,!0):Pd(c.stateNode,!1)}catch(m){Su(c,c.return,m)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(n=r.retryQueue)&&(r.retryQueue=null,Hl(e,n))));case 30:case 21:}}function Vl(e){var t=e.flags;if(2&t){try{for(var n,r=e.return;null!==r;){if(xl(r)){n=r;break}r=r.return}if(null==n)throw Error(a(160));switch(n.tag){case 27:var o=n.stateNode;Il(e,Al(e),o);break;case 5:var i=n.stateNode;32&n.flags&&(xt(i,""),n.flags&=-33),Il(e,Al(e),i);break;case 3:case 4:var s=n.stateNode.containerInfo;Tl(e,Al(e),s);break;default:throw Error(a(161))}}catch(l){Su(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Gl(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Gl(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Ql(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Ol(e,t.alternate,t),t=t.sibling}function Yl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:yl(4,t,t.return),Yl(t);break;case 1:kl(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&bl(t,t.return,n),Yl(t);break;case 27:Dd(t.stateNode);case 26:case 5:kl(t,t.return),Yl(t);break;case 22:null===t.memoizedState&&Yl(t);break;default:Yl(t)}e=e.sibling}}function Jl(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,o=e,i=t,a=i.flags;switch(i.tag){case 0:case 11:case 15:Jl(o,i,n),pl(4,i);break;case 1:if(Jl(o,i,n),"function"===typeof(o=(r=i).stateNode).componentDidMount)try{o.componentDidMount()}catch(c){Su(r,r.return,c)}if(null!==(o=(r=i).updateQueue)){var s=r.stateNode;try{var l=o.shared.hiddenCallbacks;if(null!==l)for(o.shared.hiddenCallbacks=null,o=0;o<l.length;o++)Ti(l[o],s)}catch(c){Su(r,r.return,c)}}n&&64&a&&vl(i),wl(i,i.return);break;case 27:Pl(i);case 26:case 5:Jl(o,i,n),n&&null===r&&4&a&&Cl(i),wl(i,i.return);break;case 12:Jl(o,i,n);break;case 31:Jl(o,i,n),n&&4&a&&Fl(o,i);break;case 13:Jl(o,i,n),n&&4&a&&Ul(o,i);break;case 22:null===i.memoizedState&&Jl(o,i,n),wl(i,i.return);break;case 30:break;default:Jl(o,i,n)}t=t.sibling}}function $l(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Uo(n))}function Xl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Uo(e))}function Zl(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)ec(e,t,n,r),t=t.sibling}function ec(e,t,n,r){var o=t.flags;switch(t.tag){case 0:case 11:case 15:Zl(e,t,n,r),2048&o&&pl(9,t);break;case 1:case 31:case 13:default:Zl(e,t,n,r);break;case 3:Zl(e,t,n,r),2048&o&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Uo(e)));break;case 12:if(2048&o){Zl(e,t,n,r),e=t.stateNode;try{var i=t.memoizedProps,a=i.id,s=i.onPostCommit;"function"===typeof s&&s(a,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){Su(t,t.return,l)}}else Zl(e,t,n,r);break;case 23:break;case 22:i=t.stateNode,a=t.alternate,null!==t.memoizedState?2&i._visibility?Zl(e,t,n,r):nc(e,t):2&i._visibility?Zl(e,t,n,r):(i._visibility|=2,tc(e,t,n,r,0!==(10256&t.subtreeFlags)||!1)),2048&o&&$l(a,t);break;case 24:Zl(e,t,n,r),2048&o&&Xl(t.alternate,t)}}function tc(e,t,n,r,o){for(o=o&&(0!==(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var i=e,a=t,s=n,l=r,c=a.flags;switch(a.tag){case 0:case 11:case 15:tc(i,a,s,l,o),pl(8,a);break;case 23:break;case 22:var u=a.stateNode;null!==a.memoizedState?2&u._visibility?tc(i,a,s,l,o):nc(i,a):(u._visibility|=2,tc(i,a,s,l,o)),o&&2048&c&&$l(a.alternate,a);break;case 24:tc(i,a,s,l,o),o&&2048&c&&Xl(a.alternate,a);break;default:tc(i,a,s,l,o)}t=t.sibling}}function nc(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,o=r.flags;switch(r.tag){case 22:nc(n,r),2048&o&&$l(r.alternate,r);break;case 24:nc(n,r),2048&o&&Xl(r.alternate,r);break;default:nc(n,r)}t=t.sibling}}var rc=8192;function oc(e,t,n){if(e.subtreeFlags&rc)for(e=e.child;null!==e;)ic(e,t,n),e=e.sibling}function ic(e,t,n){switch(e.tag){case 26:oc(e,t,n),e.flags&rc&&null!==e.memoizedState&&function(e,t,n,r){if("stylesheet"===n.type&&("string"!==typeof r.media||!1!==matchMedia(r.media).matches)&&0===(4&n.state.loading)){if(null===n.instance){var o=Vd(r.href),i=t.querySelector(Gd(o));if(i)return null!==(t=i._p)&&"object"===typeof t&&"function"===typeof t.then&&(e.count++,e=ah.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=i,void et(i);i=t.ownerDocument||t,r=Qd(r),(o=zd.get(o))&&Zd(r,o),et(i=i.createElement("link"));var a=i;a._p=new Promise(function(e,t){a.onload=e,a.onerror=t}),hd(i,"link",r),n.instance=i}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&0===(3&n.state.loading)&&(e.count++,n=ah.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}(n,Kl,e.memoizedState,e.memoizedProps);break;case 5:default:oc(e,t,n);break;case 3:case 4:var r=Kl;Kl=Ud(e.stateNode.containerInfo),oc(e,t,n),Kl=r;break;case 22:null===e.memoizedState&&(null!==(r=e.alternate)&&null!==r.memoizedState?(r=rc,rc=16777216,oc(e,t,n),rc=r):oc(e,t,n))}}function ac(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function sc(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Ml=r,uc(r,e)}ac(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)lc(e),e=e.sibling}function lc(e){switch(e.tag){case 0:case 11:case 15:sc(e),2048&e.flags&&yl(9,e,e.return);break;case 3:case 12:default:sc(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,cc(e)):sc(e)}}function cc(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Ml=r,uc(r,e)}ac(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:yl(8,t,t.return),cc(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,cc(t));break;default:cc(t)}e=e.sibling}}function uc(e,t){for(;null!==Ml;){var n=Ml;switch(n.tag){case 0:case 11:case 15:yl(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Uo(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,Ml=r;else e:for(n=e;null!==Ml;){var o=(r=Ml).sibling,i=r.return;if(jl(r),r===n){Ml=null;break e}if(null!==o){o.return=i,Ml=o;break e}Ml=i}}}var dc={getCacheForType:function(e){var t=Mo(zo),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Mo(zo).controller.signal}},hc="function"===typeof WeakMap?WeakMap:Map,gc=0,fc=null,mc=null,pc=0,yc=0,vc=null,bc=!1,wc=!1,kc=!1,Cc=0,Sc=0,xc=0,Ac=0,Tc=0,Ic=0,Pc=0,Ec=null,_c=null,Nc=!1,Rc=0,Mc=0,Oc=1/0,jc=null,Lc=null,qc=0,Dc=null,zc=null,Fc=0,Uc=0,Hc=null,Bc=null,Kc=0,Wc=null;function Vc(){return 0!==(2&gc)&&0!==pc?pc&-pc:null!==O.T?Hu():De()}function Gc(){if(0===Ic)if(0===(536870912&pc)||ho){var e=xe;0===(3932160&(xe<<=1))&&(xe=262144),Ic=e}else Ic=536870912;return null!==(e=Mi.current)&&(e.flags|=32),Ic}function Qc(e,t,n){(e!==fc||2!==yc&&9!==yc)&&null===e.cancelPendingCommit||(tu(e,0),Xc(e,pc,Ic,!1)),Re(e,n),0!==(2&gc)&&e===fc||(e===fc&&(0===(2&gc)&&(Ac|=n),4===Sc&&Xc(e,pc,Ic,!1)),ju(e))}function Yc(e,t,n){if(0!==(6&gc))throw Error(a(327));for(var r=!n&&0===(127&t)&&0===(t&e.expiredLanes)||Pe(e,t),o=r?function(e,t){var n=gc;gc|=2;var r=ou(),o=iu();fc!==e||pc!==t?(jc=null,Oc=le()+500,tu(e,t)):wc=Pe(e,t);e:for(;;)try{if(0!==yc&&null!==mc){t=mc;var i=vc;t:switch(yc){case 1:yc=0,vc=null,hu(e,t,i,1);break;case 2:case 9:if(ni(i)){yc=0,vc=null,du(t);break}t=function(){2!==yc&&9!==yc||fc!==e||(yc=7),ju(e)},i.then(t,t);break e;case 3:yc=7;break e;case 4:yc=5;break e;case 7:ni(i)?(yc=0,vc=null,du(t)):(yc=0,vc=null,hu(e,t,i,7));break;case 5:var s=null;switch(mc.tag){case 26:s=mc.memoizedState;case 5:case 27:var l=mc;if(s?oh(s):l.stateNode.complete){yc=0,vc=null;var c=l.sibling;if(null!==c)mc=c;else{var u=l.return;null!==u?(mc=u,gu(u)):mc=null}break t}}yc=0,vc=null,hu(e,t,i,5);break;case 6:yc=0,vc=null,hu(e,t,i,6);break;case 8:eu(),Sc=6;break e;default:throw Error(a(462))}}cu();break}catch(d){nu(e,d)}return Ao=xo=null,O.H=r,O.A=o,gc=n,null!==mc?0:(fc=null,pc=0,_r(),Sc)}(e,t):su(e,t,!0),i=r;;){if(0===o){wc&&!r&&Xc(e,t,0,!1);break}if(n=e.current.alternate,!i||$c(n)){if(2===o){if(i=t,e.errorRecoveryDisabledLanes&i)var s=0;else s=0!==(s=-536870913&e.pendingLanes)?s:536870912&s?536870912:0;if(0!==s){t=s;e:{var l=e;o=Ec;var c=l.current.memoizedState.isDehydrated;if(c&&(tu(l,s).flags|=256),2!==(s=su(l,s,!1))){if(kc&&!c){l.errorRecoveryDisabledLanes|=i,Ac|=i,o=4;break e}i=_c,_c=o,null!==i&&(null===_c?_c=i:_c.push.apply(_c,i))}o=s}if(i=!1,2!==o)continue}}if(1===o){tu(e,0),Xc(e,t,0,!0);break}e:{switch(r=e,i=o){case 0:case 1:throw Error(a(345));case 4:if((4194048&t)!==t)break;case 6:Xc(r,t,Ic,!bc);break e;case 2:_c=null;break;case 3:case 5:break;default:throw Error(a(329))}if((62914560&t)===t&&10<(o=Rc+300-le())){if(Xc(r,t,Ic,!bc),0!==Ie(r,0,!0))break e;Fc=t,r.timeoutHandle=kd(Jc.bind(null,r,n,_c,jc,Nc,t,Ic,Ac,Pc,bc,i,"Throttled",-0,0),o)}else Jc(r,n,_c,jc,Nc,t,Ic,Ac,Pc,bc,i,null,-0,0)}break}o=su(e,t,!1),i=!1}ju(e)}function Jc(e,t,n,r,o,i,a,s,l,c,u,d,h,g){if(e.timeoutHandle=-1,8192&(d=t.subtreeFlags)||16785408===(16785408&d)){ic(t,i,d={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Rt});var f=(62914560&i)===i?Rc-le():(4194048&i)===i?Mc-le():0;if(null!==(f=function(e,t){return e.stylesheets&&0===e.count&&lh(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var r=setTimeout(function(){if(e.stylesheets&&lh(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===ih&&(ih=62500*function(){if("function"===typeof performance.getEntriesByType){for(var e=0,t=0,n=performance.getEntriesByType("resource"),r=0;r<n.length;r++){var o=n[r],i=o.transferSize,a=o.initiatorType,s=o.duration;if(i&&s&&gd(a)){for(a=0,s=o.responseEnd,r+=1;r<n.length;r++){var l=n[r],c=l.startTime;if(c>s)break;var u=l.transferSize,d=l.initiatorType;u&&gd(d)&&(a+=u*((l=l.responseEnd)<s?1:(s-c)/(l-c)))}if(--r,t+=8*(i+a)/(o.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&"number"===typeof(e=navigator.connection.downlink)?e:5}());var o=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&lh(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>ih?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(r),clearTimeout(o)}}:null}(d,f)))return Fc=i,e.cancelPendingCommit=f(mu.bind(null,e,t,i,n,r,o,a,s,l,u,d,null,h,g)),void Xc(e,i,a,!c)}mu(e,t,i,n,r,o,a,s,l)}function $c(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var o=n[r],i=o.getSnapshot;o=o.value;try{if(!Xn(i(),o))return!1}catch(a){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Xc(e,t,n,r){t&=~Tc,t&=~Ac,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var o=t;0<o;){var i=31-we(o),a=1<<i;r[i]=-1,o&=~a}0!==n&&Me(e,n,t)}function Zc(){return 0!==(6&gc)||(Lu(0,!1),!1)}function eu(){if(null!==mc){if(0===yc)var e=mc.return;else Ao=xo=null,sa(e=mc),li=null,ci=0,e=mc;for(;null!==e;)ml(e.alternate,e),e=e.return;mc=null}}function tu(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,Cd(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Fc=0,eu(),fc=e,mc=n=Fr(e.current,null),pc=t,yc=0,vc=null,bc=!1,wc=Pe(e,t),kc=!1,Pc=Ic=Tc=Ac=xc=Sc=0,_c=Ec=null,Nc=!1,0!==(8&t)&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var o=31-we(r),i=1<<o;t|=e[o],r&=~i}return Cc=t,_r(),n}function nu(e,t){Bi=null,O.H=ms,t===Xo||t===ei?(t=ai(),yc=3):t===Zo?(t=ai(),yc=4):yc=t===Rs?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,vc=t,null===mc&&(Sc=1,Is(e,Qr(t,e.current)))}function ru(){var e=Mi.current;return null===e||((4194048&pc)===pc?null===Oi:((62914560&pc)===pc||0!==(536870912&pc))&&e===Oi)}function ou(){var e=O.H;return O.H=ms,null===e?ms:e}function iu(){var e=O.A;return O.A=dc,e}function au(){Sc=4,bc||(4194048&pc)!==pc&&null!==Mi.current||(wc=!0),0===(134217727&xc)&&0===(134217727&Ac)||null===fc||Xc(fc,pc,Ic,!1)}function su(e,t,n){var r=gc;gc|=2;var o=ou(),i=iu();fc===e&&pc===t||(jc=null,tu(e,t)),t=!1;var a=Sc;e:for(;;)try{if(0!==yc&&null!==mc){var s=mc,l=vc;switch(yc){case 8:eu(),a=6;break e;case 3:case 2:case 9:case 6:null===Mi.current&&(t=!0);var c=yc;if(yc=0,vc=null,hu(e,s,l,c),n&&wc){a=0;break e}break;default:c=yc,yc=0,vc=null,hu(e,s,l,c)}}lu(),a=Sc;break}catch(u){nu(e,u)}return t&&e.shellSuspendCounter++,Ao=xo=null,gc=r,O.H=o,O.A=i,null===mc&&(fc=null,pc=0,_r()),a}function lu(){for(;null!==mc;)uu(mc)}function cu(){for(;null!==mc&&!ae();)uu(mc)}function uu(e){var t=al(e.alternate,e,Cc);e.memoizedProps=e.pendingProps,null===t?gu(e):mc=t}function du(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Ws(n,t,t.pendingProps,t.type,void 0,pc);break;case 11:t=Ws(n,t,t.pendingProps,t.type.render,t.ref,pc);break;case 5:sa(t);default:ml(n,t),t=al(n,t=mc=Ur(t,Cc),Cc)}e.memoizedProps=e.pendingProps,null===t?gu(e):mc=t}function hu(e,t,n,r){Ao=xo=null,sa(t),li=null,ci=0;var o=t.return;try{if(function(e,t,n,r,o){if(n.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){if(null!==(t=n.alternate)&&_o(t,n,o,!0),null!==(n=Mi.current)){switch(n.tag){case 31:case 13:return null===Oi?au():null===n.alternate&&0===Sc&&(Sc=3),n.flags&=-257,n.flags|=65536,n.lanes=o,r===ti?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),xu(e,r,o)),!1;case 22:return n.flags|=65536,r===ti?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),xu(e,r,o)),!1}throw Error(a(435,n.tag))}return xu(e,r,o),au(),!1}if(ho)return null!==(t=Mi.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=o,r!==mo&&Co(Qr(e=Error(a(422),{cause:r}),n))):(r!==mo&&Co(Qr(t=Error(a(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,o&=-o,e.lanes|=o,r=Qr(r,n),Ci(e,o=Es(e.stateNode,r,o)),4!==Sc&&(Sc=2)),!1;var i=Error(a(520),{cause:r});if(i=Qr(i,n),null===Ec?Ec=[i]:Ec.push(i),4!==Sc&&(Sc=2),null===t)return!0;r=Qr(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=o&-o,n.lanes|=e,Ci(n,e=Es(n.stateNode,r,e)),!1;case 1:if(t=n.type,i=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==i&&"function"===typeof i.componentDidCatch&&(null===Lc||!Lc.has(i))))return n.flags|=65536,o&=-o,n.lanes|=o,Ns(o=_s(o),e,n,r),Ci(n,o),!1}n=n.return}while(null!==n);return!1}(e,o,t,n,pc))return Sc=1,Is(e,Qr(n,e.current)),void(mc=null)}catch(i){if(null!==o)throw mc=o,i;return Sc=1,Is(e,Qr(n,e.current)),void(mc=null)}32768&t.flags?(ho||1===r?e=!0:wc||0!==(536870912&pc)?e=!1:(bc=e=!0,(2===r||9===r||3===r||6===r)&&(null!==(r=Mi.current)&&13===r.tag&&(r.flags|=16384))),fu(t,e)):gu(t)}function gu(e){var t=e;do{if(0!==(32768&t.flags))return void fu(t,bc);e=t.return;var n=gl(t.alternate,t,Cc);if(null!==n)return void(mc=n);if(null!==(t=t.sibling))return void(mc=t);mc=t=e}while(null!==t);0===Sc&&(Sc=5)}function fu(e,t){do{var n=fl(e.alternate,e);if(null!==n)return n.flags&=32767,void(mc=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(mc=e);mc=e=n}while(null!==e);Sc=6,mc=null}function mu(e,t,n,r,o,i,s,l,c){e.cancelPendingCommit=null;do{wu()}while(0!==qc);if(0!==(6&gc))throw Error(a(327));if(null!==t){if(t===e.current)throw Error(a(177));if(i=t.lanes|t.childLanes,function(e,t,n,r,o,i){var a=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var s=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=a&~n;0<n;){var u=31-we(n),d=1<<u;s[u]=0,l[u]=-1;var h=c[u];if(null!==h)for(c[u]=null,u=0;u<h.length;u++){var g=h[u];null!==g&&(g.lane&=-536870913)}n&=~d}0!==r&&Me(e,r,0),0!==i&&0===o&&0!==e.tag&&(e.suspendedLanes|=i&~(a&~t))}(e,n,i|=Er,s,l,c),e===fc&&(mc=fc=null,pc=0),zc=t,Dc=e,Fc=n,Uc=i,Hc=o,Bc=r,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,oe(he,function(){return ku(),null})):(e.callbackNode=null,e.callbackPriority=0),r=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||r){r=O.T,O.T=null,o=j.p,j.p=2,s=gc,gc|=4;try{!function(e,t){if(e=e.containerInfo,fd=bh,or(e=rr(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var o=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch(p){n=null;break e}var s=0,l=-1,c=-1,u=0,d=0,h=e,g=null;t:for(;;){for(var f;h!==n||0!==o&&3!==h.nodeType||(l=s+o),h!==i||0!==r&&3!==h.nodeType||(c=s+r),3===h.nodeType&&(s+=h.nodeValue.length),null!==(f=h.firstChild);)g=h,h=f;for(;;){if(h===e)break t;if(g===n&&++u===o&&(l=s),g===i&&++d===r&&(c=s),null!==(f=h.nextSibling))break;g=(h=g).parentNode}h=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(md={focusedElem:e,selectionRange:n},bh=!1,Ml=t;null!==Ml;)if(e=(t=Ml).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ml=e;else for(;null!==Ml;){switch(i=(t=Ml).alternate,e=t.flags,t.tag){case 0:if(0!==(4&e)&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(n=0;n<e.length;n++)(o=e[n]).ref.impl=o.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==i){e=void 0,n=t,o=i.memoizedProps,i=i.memoizedState,r=n.stateNode;try{var m=Ss(n.type,o);e=r.getSnapshotBeforeUpdate(m,i),r.__reactInternalSnapshotBeforeUpdate=e}catch(y){Su(n,n.return,y)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))Ed(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Ed(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(a(163))}if(null!==(e=t.sibling)){e.return=t.return,Ml=e;break}Ml=t.return}}(e,t)}finally{gc=s,j.p=o,O.T=r}}qc=1,pu(),yu(),vu()}}function pu(){if(1===qc){qc=0;var e=Dc,t=zc,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=O.T,O.T=null;var r=j.p;j.p=2;var o=gc;gc|=4;try{Wl(t,e);var i=md,a=rr(e.containerInfo),s=i.focusedElem,l=i.selectionRange;if(a!==s&&s&&s.ownerDocument&&nr(s.ownerDocument.documentElement,s)){if(null!==l&&or(s)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in s)s.selectionStart=c,s.selectionEnd=Math.min(u,s.value.length);else{var d=s.ownerDocument||document,h=d&&d.defaultView||window;if(h.getSelection){var g=h.getSelection(),f=s.textContent.length,m=Math.min(l.start,f),p=void 0===l.end?m:Math.min(l.end,f);!g.extend&&m>p&&(a=p,p=m,m=a);var y=tr(s,m),v=tr(s,p);if(y&&v&&(1!==g.rangeCount||g.anchorNode!==y.node||g.anchorOffset!==y.offset||g.focusNode!==v.node||g.focusOffset!==v.offset)){var b=d.createRange();b.setStart(y.node,y.offset),g.removeAllRanges(),m>p?(g.addRange(b),g.extend(v.node,v.offset)):(b.setEnd(v.node,v.offset),g.addRange(b))}}}}for(d=[],g=s;g=g.parentNode;)1===g.nodeType&&d.push({element:g,left:g.scrollLeft,top:g.scrollTop});for("function"===typeof s.focus&&s.focus(),s=0;s<d.length;s++){var w=d[s];w.element.scrollLeft=w.left,w.element.scrollTop=w.top}}bh=!!fd,md=fd=null}finally{gc=o,j.p=r,O.T=n}}e.current=t,qc=2}}function yu(){if(2===qc){qc=0;var e=Dc,t=zc,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=O.T,O.T=null;var r=j.p;j.p=2;var o=gc;gc|=4;try{Ol(e,t.alternate,t)}finally{gc=o,j.p=r,O.T=n}}qc=3}}function vu(){if(4===qc||3===qc){qc=0,se();var e=Dc,t=zc,n=Fc,r=Bc;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?qc=5:(qc=0,zc=Dc=null,bu(e,e.pendingLanes));var o=e.pendingLanes;if(0===o&&(Lc=null),qe(n),t=t.stateNode,ve&&"function"===typeof ve.onCommitFiberRoot)try{ve.onCommitFiberRoot(ye,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==r){t=O.T,o=j.p,j.p=2,O.T=null;try{for(var i=e.onRecoverableError,a=0;a<r.length;a++){var s=r[a];i(s.value,{componentStack:s.stack})}}finally{O.T=t,j.p=o}}0!==(3&Fc)&&wu(),ju(e),o=e.pendingLanes,0!==(261930&n)&&0!==(42&o)?e===Wc?Kc++:(Kc=0,Wc=e):Kc=0,Lu(0,!1)}}function bu(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Uo(t)))}function wu(){return pu(),yu(),vu(),ku()}function ku(){if(5!==qc)return!1;var e=Dc,t=Uc;Uc=0;var n=qe(Fc),r=O.T,o=j.p;try{j.p=32>n?32:n,O.T=null,n=Hc,Hc=null;var i=Dc,s=Fc;if(qc=0,zc=Dc=null,Fc=0,0!==(6&gc))throw Error(a(331));var l=gc;if(gc|=4,lc(i.current),ec(i,i.current,s,n),gc=l,Lu(0,!1),ve&&"function"===typeof ve.onPostCommitFiberRoot)try{ve.onPostCommitFiberRoot(ye,i)}catch(c){}return!0}finally{j.p=o,O.T=r,bu(e,t)}}function Cu(e,t,n){t=Qr(n,t),null!==(e=wi(e,t=Es(e.stateNode,t,2),2))&&(Re(e,2),ju(e))}function Su(e,t,n){if(3===e.tag)Cu(e,e,n);else for(;null!==t;){if(3===t.tag){Cu(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Lc||!Lc.has(r))){e=Qr(n,e),null!==(r=wi(t,n=_s(2),2))&&(Ns(n,r,t,e),Re(r,2),ju(r));break}}t=t.return}}function xu(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new hc;var o=new Set;r.set(t,o)}else void 0===(o=r.get(t))&&(o=new Set,r.set(t,o));o.has(n)||(kc=!0,o.add(n),e=Au.bind(null,e,t,n),t.then(e,e))}function Au(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,fc===e&&(pc&n)===n&&(4===Sc||3===Sc&&(62914560&pc)===pc&&300>le()-Rc?0===(2&gc)&&tu(e,0):Tc|=n,Pc===pc&&(Pc=0)),ju(e)}function Tu(e,t){0===t&&(t=_e()),null!==(e=Mr(e,t))&&(Re(e,t),ju(e))}function Iu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Tu(e,n)}function Pu(e,t){var n=0;switch(e.tag){case 31:case 13:var r=e.stateNode,o=e.memoizedState;null!==o&&(n=o.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(a(314))}null!==r&&r.delete(t),Tu(e,n)}var Eu=null,_u=null,Nu=!1,Ru=!1,Mu=!1,Ou=0;function ju(e){e!==_u&&null===e.next&&(null===_u?Eu=_u=e:_u=_u.next=e),Ru=!0,Nu||(Nu=!0,xd(function(){0!==(6&gc)?oe(ue,qu):Du()}))}function Lu(e,t){if(!Mu&&Ru){Mu=!0;do{for(var n=!1,r=Eu;null!==r;){if(!t)if(0!==e){var o=r.pendingLanes;if(0===o)var i=0;else{var a=r.suspendedLanes,s=r.pingedLanes;i=(1<<31-we(42|e)+1)-1,i=201326741&(i&=o&~(a&~s))?201326741&i|1:i?2|i:0}0!==i&&(n=!0,Uu(r,i))}else i=pc,0===(3&(i=Ie(r,r===fc?i:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||Pe(r,i)||(n=!0,Uu(r,i));r=r.next}}while(n);Mu=!1}}function qu(){Du()}function Du(){Ru=Nu=!1;var e=0;0!==Ou&&function(){var e=window.event;if(e&&"popstate"===e.type)return e!==wd&&(wd=e,!0);return wd=null,!1}()&&(e=Ou);for(var t=le(),n=null,r=Eu;null!==r;){var o=r.next,i=zu(r,t);0===i?(r.next=null,null===n?Eu=o:n.next=o,null===o&&(_u=n)):(n=r,(0!==e||0!==(3&i))&&(Ru=!0)),r=o}0!==qc&&5!==qc||Lu(e,!1),0!==Ou&&(Ou=0)}function zu(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,i=-62914561&e.pendingLanes;0<i;){var a=31-we(i),s=1<<a,l=o[a];-1===l?0!==(s&n)&&0===(s&r)||(o[a]=Ee(s,t)):l<=t&&(e.expiredLanes|=s),i&=~s}if(n=pc,n=Ie(e,e===(t=fc)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===n||e===t&&(2===yc||9===yc)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&ie(r),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||Pe(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&ie(r),qe(n)){case 2:case 8:n=de;break;case 32:default:n=he;break;case 268435456:n=fe}return r=Fu.bind(null,e),n=oe(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&ie(r),e.callbackPriority=2,e.callbackNode=null,2}function Fu(e,t){if(0!==qc&&5!==qc)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(wu()&&e.callbackNode!==n)return null;var r=pc;return 0===(r=Ie(e,e===fc?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Yc(e,r,t),zu(e,le()),null!=e.callbackNode&&e.callbackNode===n?Fu.bind(null,e):null)}function Uu(e,t){if(wu())return null;Yc(e,t,!0)}function Hu(){if(0===Ou){var e=Ko;0===e&&(e=Se,0===(261888&(Se<<=1))&&(Se=256)),Ou=e}return Ou}function Bu(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:Nt(""+e)}function Ku(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Wu=0;Wu<xr.length;Wu++){var Vu=xr[Wu];Ar(Vu.toLowerCase(),"on"+(Vu[0].toUpperCase()+Vu.slice(1)))}Ar(pr,"onAnimationEnd"),Ar(yr,"onAnimationIteration"),Ar(vr,"onAnimationStart"),Ar("dblclick","onDoubleClick"),Ar("focusin","onFocus"),Ar("focusout","onBlur"),Ar(br,"onTransitionRun"),Ar(wr,"onTransitionStart"),Ar(kr,"onTransitionCancel"),Ar(Cr,"onTransitionEnd"),ot("onMouseEnter",["mouseout","mouseover"]),ot("onMouseLeave",["mouseout","mouseover"]),ot("onPointerEnter",["pointerout","pointerover"]),ot("onPointerLeave",["pointerout","pointerover"]),rt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),rt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),rt("onBeforeInput",["compositionend","keypress","textInput","paste"]),rt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),rt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),rt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qu=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Gu));function Yu(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==i&&o.isPropagationStopped())break e;i=s,o.currentTarget=c;try{i(o)}catch(u){Tr(u)}o.currentTarget=null,i=l}else for(a=0;a<r.length;a++){if(l=(s=r[a]).instance,c=s.currentTarget,s=s.listener,l!==i&&o.isPropagationStopped())break e;i=s,o.currentTarget=c;try{i(o)}catch(u){Tr(u)}o.currentTarget=null,i=l}}}}function Ju(e,t){var n=t[Ke];void 0===n&&(n=t[Ke]=new Set);var r=e+"__bubble";n.has(r)||(ed(t,e,2,!1),n.add(r))}function $u(e,t,n){var r=0;t&&(r|=4),ed(n,e,r,t)}var Xu="_reactListening"+Math.random().toString(36).slice(2);function Zu(e){if(!e[Xu]){e[Xu]=!0,tt.forEach(function(t){"selectionchange"!==t&&(Qu.has(t)||$u(t,!1,e),$u(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Xu]||(t[Xu]=!0,$u("selectionchange",!1,t))}}function ed(e,t,n,r){switch(Th(t)){case 2:var o=wh;break;case 8:o=kh;break;default:o=Ch}n=o.bind(null,t,n,e),o=void 0,!Ht||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(o=!0),r?void 0!==o?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):void 0!==o?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function td(e,t,n,r,o){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var s=r.stateNode.containerInfo;if(s===o)break;if(4===a)for(a=r.return;null!==a;){var c=a.tag;if((3===c||4===c)&&a.stateNode.containerInfo===o)return;a=a.return}for(;null!==s;){if(null===(a=Je(s)))return;if(5===(c=a.tag)||6===c||26===c||27===c){r=i=a;continue e}s=s.parentNode}}r=r.return}zt(function(){var r=i,o=Ot(n),a=[];e:{var s=Sr.get(e);if(void 0!==s){var c=nn,u=e;switch(e){case"keypress":if(0===Qt(n))break e;case"keydown":case"keyup":c=vn;break;case"focusin":u="focus",c=cn;break;case"focusout":u="blur",c=cn;break;case"beforeblur":case"afterblur":c=cn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=sn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=ln;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=wn;break;case pr:case yr:case vr:c=un;break;case Cr:c=kn;break;case"scroll":case"scrollend":c=on;break;case"wheel":c=Cn;break;case"copy":case"cut":case"paste":c=dn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=bn;break;case"toggle":case"beforetoggle":c=Sn}var d=0!==(4&t),h=!d&&("scroll"===e||"scrollend"===e),g=d?null!==s?s+"Capture":null:s;d=[];for(var f,m=r;null!==m;){var p=m;if(f=p.stateNode,5!==(p=p.tag)&&26!==p&&27!==p||null===f||null===g||null!=(p=Ft(m,g))&&d.push(nd(m,p,f)),h)break;m=m.return}0<d.length&&(s=new c(s,u,null,n,o),a.push({event:s,listeners:d}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===Mt||!(u=n.relatedTarget||n.fromElement)||!Je(u)&&!u[Be])&&(c||s)&&(s=o.window===o?o:(s=o.ownerDocument)?s.defaultView||s.parentWindow:window,c?(c=r,null!==(u=(u=n.relatedTarget||n.toElement)?Je(u):null)&&(h=l(u),d=u.tag,u!==h||5!==d&&27!==d&&6!==d)&&(u=null)):(c=null,u=r),c!==u)){if(d=sn,p="onMouseLeave",g="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(d=bn,p="onPointerLeave",g="onPointerEnter",m="pointer"),h=null==c?s:Xe(c),f=null==u?s:Xe(u),(s=new d(p,m+"leave",c,n,o)).target=h,s.relatedTarget=f,p=null,Je(o)===r&&((d=new d(g,m+"enter",u,n,o)).target=f,d.relatedTarget=h,p=d),h=p,c&&u)e:{for(d=od,m=u,f=0,p=g=c;p;p=d(p))f++;p=0;for(var y=m;y;y=d(y))p++;for(;0<f-p;)g=d(g),f--;for(;0<p-f;)m=d(m),p--;for(;f--;){if(g===m||null!==m&&g===m.alternate){d=g;break e}g=d(g),m=d(m)}d=null}else d=null;null!==c&&id(a,s,c,d,!1),null!==u&&null!==h&&id(a,h,u,d,!0)}if("select"===(c=(s=r?Xe(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===c&&"file"===s.type)var v=Un;else if(jn(s))if(Hn)v=$n;else{v=Yn;var b=Qn}else!(c=s.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==s.type&&"radio"!==s.type?r&&Pt(r.elementType)&&(v=Un):v=Jn;switch(v&&(v=v(e,r))?Ln(a,v,n,o):(b&&b(e,s,r),"focusout"===e&&r&&"number"===s.type&&null!=r.memoizedProps.value&&wt(s,"number",s.value)),b=r?Xe(r):window,e){case"focusin":(jn(b)||"true"===b.contentEditable)&&(ar=b,sr=r,lr=null);break;case"focusout":lr=sr=ar=null;break;case"mousedown":cr=!0;break;case"contextmenu":case"mouseup":case"dragend":cr=!1,ur(a,n,o);break;case"selectionchange":if(ir)break;case"keydown":case"keyup":ur(a,n,o)}var w;if(An)e:{switch(e){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Mn?Nn(e,n)&&(k="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(k="onCompositionStart");k&&(Pn&&"ko"!==n.locale&&(Mn||"onCompositionStart"!==k?"onCompositionEnd"===k&&Mn&&(w=Gt()):(Wt="value"in(Kt=o)?Kt.value:Kt.textContent,Mn=!0)),0<(b=rd(r,k)).length&&(k=new hn(k,e,null,n,o),a.push({event:k,listeners:b}),w?k.data=w:null!==(w=Rn(n))&&(k.data=w))),(w=In?function(e,t){switch(e){case"compositionend":return Rn(t);case"keypress":return 32!==t.which?null:(_n=!0,En);case"textInput":return(e=t.data)===En&&_n?null:e;default:return null}}(e,n):function(e,t){if(Mn)return"compositionend"===e||!An&&Nn(e,t)?(e=Gt(),Vt=Wt=Kt=null,Mn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Pn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(k=rd(r,"onBeforeInput")).length&&(b=new hn("onBeforeInput","beforeinput",null,n,o),a.push({event:b,listeners:k}),b.data=w)),function(e,t,n,r,o){if("submit"===t&&n&&n.stateNode===o){var i=Bu((o[He]||null).action),a=r.submitter;a&&null!==(t=(t=a[He]||null)?Bu(t.formAction):a.getAttribute("formAction"))&&(i=t,a=null);var s=new nn("action","action",null,r,o);e.push({event:s,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==Ou){var e=a?Ku(o,a):new FormData(o);ts(n,{pending:!0,data:e,method:o.method,action:i},null,e)}}else"function"===typeof i&&(s.preventDefault(),e=a?Ku(o,a):new FormData(o),ts(n,{pending:!0,data:e,method:o.method,action:i},i,e))},currentTarget:o}]})}}(a,e,r,n,o)}Yu(a,t)})}function nd(e,t,n){return{instance:e,listener:t,currentTarget:n}}function rd(e,t){for(var n=t+"Capture",r=[];null!==e;){var o=e,i=o.stateNode;if(5!==(o=o.tag)&&26!==o&&27!==o||null===i||(null!=(o=Ft(e,n))&&r.unshift(nd(e,o,i)),null!=(o=Ft(e,t))&&r.push(nd(e,o,i))),3===e.tag)return r;e=e.return}return[]}function od(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function id(e,t,n,r,o){for(var i=t._reactName,a=[];null!==n&&n!==r;){var s=n,l=s.alternate,c=s.stateNode;if(s=s.tag,null!==l&&l===r)break;5!==s&&26!==s&&27!==s||null===c||(l=c,o?null!=(c=Ft(n,i))&&a.unshift(nd(n,c,l)):o||null!=(c=Ft(n,i))&&a.push(nd(n,c,l))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var ad=/\r\n?/g,sd=/\u0000|\uFFFD/g;function ld(e){return("string"===typeof e?e:""+e).replace(ad,"\n").replace(sd,"")}function cd(e,t){return t=ld(t),ld(e)===t}function ud(e,t,n,r,o,i){switch(n){case"children":"string"===typeof r?"body"===t||"textarea"===t&&""===r||xt(e,r):("number"===typeof r||"bigint"===typeof r)&&"body"!==t&&xt(e,""+r);break;case"className":ct(e,"class",r);break;case"tabIndex":ct(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":ct(e,n,r);break;case"style":It(e,r,i);break;case"data":if("object"!==t){ct(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==r||"function"===typeof r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=Nt(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if("function"===typeof r){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof i&&("formAction"===n?("input"!==t&&ud(e,t,"name",o.name,o,null),ud(e,t,"formEncType",o.formEncType,o,null),ud(e,t,"formMethod",o.formMethod,o,null),ud(e,t,"formTarget",o.formTarget,o,null)):(ud(e,t,"encType",o.encType,o,null),ud(e,t,"method",o.method,o,null),ud(e,t,"target",o.target,o,null))),null==r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=Nt(""+r),e.setAttribute(n,r);break;case"onClick":null!=r&&(e.onclick=Rt);break;case"onScroll":null!=r&&Ju("scroll",e);break;case"onScrollEnd":null!=r&&Ju("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(a(61));if(null!=(n=r.__html)){if(null!=o.children)throw Error(a(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"muted":e.muted=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"===typeof r||"boolean"===typeof r||"symbol"===typeof r){e.removeAttribute("xlink:href");break}n=Nt(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===r?e.setAttribute(n,""):!1!==r&&null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":null==r||"function"===typeof r||"symbol"===typeof r||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":Ju("beforetoggle",e),Ju("toggle",e),lt(e,"popover",r);break;case"xlinkActuate":ut(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":ut(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":ut(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":ut(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":ut(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":ut(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":ut(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":ut(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":ut(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":lt(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&lt(e,n=Et.get(n)||n,r)}}function dd(e,t,n,r,o,i){switch(n){case"style":It(e,r,i);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(a(61));if(null!=(n=r.__html)){if(null!=o.children)throw Error(a(60));e.innerHTML=n}}break;case"children":"string"===typeof r?xt(e,r):("number"===typeof r||"bigint"===typeof r)&&xt(e,""+r);break;case"onScroll":null!=r&&Ju("scroll",e);break;case"onScrollEnd":null!=r&&Ju("scrollend",e);break;case"onClick":null!=r&&(e.onclick=Rt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:nt.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(o=n.endsWith("Capture"),t=n.slice(2,o?n.length-7:void 0),"function"===typeof(i=null!=(i=e[He]||null)?i[n]:null)&&e.removeEventListener(t,i,o),"function"!==typeof r)?n in e?e[n]=r:!0===r?e.setAttribute(n,""):lt(e,n,r):("function"!==typeof i&&null!==i&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,o)))}}function hd(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ju("error",e),Ju("load",e);var r,o=!1,i=!1;for(r in n)if(n.hasOwnProperty(r)){var s=n[r];if(null!=s)switch(r){case"src":o=!0;break;case"srcSet":i=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:ud(e,t,r,s,n,null)}}return i&&ud(e,t,"srcSet",n.srcSet,n,null),void(o&&ud(e,t,"src",n.src,n,null));case"input":Ju("invalid",e);var l=r=s=i=null,c=null,u=null;for(o in n)if(n.hasOwnProperty(o)){var d=n[o];if(null!=d)switch(o){case"name":i=d;break;case"type":s=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":r=d;break;case"defaultValue":l=d;break;case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(a(137,t));break;default:ud(e,t,o,d,n,null)}}return void bt(e,r,l,c,u,s,i,!1);case"select":for(i in Ju("invalid",e),o=s=r=null,n)if(n.hasOwnProperty(i)&&null!=(l=n[i]))switch(i){case"value":r=l;break;case"defaultValue":s=l;break;case"multiple":o=l;default:ud(e,t,i,l,n,null)}return t=r,n=s,e.multiple=!!o,void(null!=t?kt(e,!!o,t,!1):null!=n&&kt(e,!!o,n,!0));case"textarea":for(s in Ju("invalid",e),r=i=o=null,n)if(n.hasOwnProperty(s)&&null!=(l=n[s]))switch(s){case"value":o=l;break;case"defaultValue":i=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(a(91));break;default:ud(e,t,s,l,n,null)}return void St(e,o,i,r);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(o=n[c]))if("selected"===c)e.selected=o&&"function"!==typeof o&&"symbol"!==typeof o;else ud(e,t,c,o,n,null);return;case"dialog":Ju("beforetoggle",e),Ju("toggle",e),Ju("cancel",e),Ju("close",e);break;case"iframe":case"object":Ju("load",e);break;case"video":case"audio":for(o=0;o<Gu.length;o++)Ju(Gu[o],e);break;case"image":Ju("error",e),Ju("load",e);break;case"details":Ju("toggle",e);break;case"embed":case"source":case"link":Ju("error",e),Ju("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(o=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:ud(e,t,u,o,n,null)}return;default:if(Pt(t)){for(d in n)n.hasOwnProperty(d)&&(void 0!==(o=n[d])&&dd(e,t,d,o,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(o=n[l])&&ud(e,t,l,o,n,null))}function gd(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}var fd=null,md=null;function pd(e){return 9===e.nodeType?e:e.ownerDocument}function yd(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function vd(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function bd(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var wd=null;var kd="function"===typeof setTimeout?setTimeout:void 0,Cd="function"===typeof clearTimeout?clearTimeout:void 0,Sd="function"===typeof Promise?Promise:void 0,xd="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof Sd?function(e){return Sd.resolve(null).then(e).catch(Ad)}:kd;function Ad(e){setTimeout(function(){throw e})}function Td(e){return"head"===e}function Id(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&8===o.nodeType)if("/$"===(n=o.data)||"/&"===n){if(0===r)return e.removeChild(o),void Kh(t);r--}else if("$"===n||"$?"===n||"$~"===n||"$!"===n||"&"===n)r++;else if("html"===n)Dd(e.ownerDocument.documentElement);else if("head"===n){Dd(n=e.ownerDocument.head);for(var i=n.firstChild;i;){var a=i.nextSibling,s=i.nodeName;i[Qe]||"SCRIPT"===s||"STYLE"===s||"LINK"===s&&"stylesheet"===i.rel.toLowerCase()||n.removeChild(i),i=a}}else"body"===n&&Dd(e.ownerDocument.body);n=o}while(n);Kh(t)}function Pd(e,t){var n=e;e=0;do{var r=n.nextSibling;if(1===n.nodeType?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",""===n.getAttribute("style")&&n.removeAttribute("style")):3===n.nodeType&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===e)break;e--}else"$"!==n&&"$?"!==n&&"$~"!==n&&"$!"!==n||e++;n=r}while(n)}function Ed(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Ed(n),Ye(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function _d(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=Md(e.nextSibling)))return null}return e}function Nd(e){return"$?"===e.data||"$~"===e.data}function Rd(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function Md(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var Od=null;function jd(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n||"/&"===n){if(0===t)return Md(e.nextSibling);t--}else"$"!==n&&"$!"!==n&&"$?"!==n&&"$~"!==n&&"&"!==n||t++}e=e.nextSibling}return null}function Ld(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n||"$~"===n||"&"===n){if(0===t)return e;t--}else"/$"!==n&&"/&"!==n||t++}e=e.previousSibling}return null}function qd(e,t,n){switch(t=pd(n),e){case"html":if(!(e=t.documentElement))throw Error(a(452));return e;case"head":if(!(e=t.head))throw Error(a(453));return e;case"body":if(!(e=t.body))throw Error(a(454));return e;default:throw Error(a(451))}}function Dd(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Ye(e)}var zd=new Map,Fd=new Set;function Ud(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Hd=j.d;j.d={f:function(){var e=Hd.f(),t=Zc();return e||t},r:function(e){var t=$e(e);null!==t&&5===t.tag&&"form"===t.type?rs(t):Hd.r(e)},D:function(e){Hd.D(e),Kd("dns-prefetch",e,null)},C:function(e,t){Hd.C(e,t),Kd("preconnect",e,t)},L:function(e,t,n){Hd.L(e,t,n);var r=Bd;if(r&&e&&t){var o='link[rel="preload"][as="'+yt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(o+='[imagesrcset="'+yt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(o+='[imagesizes="'+yt(n.imageSizes)+'"]')):o+='[href="'+yt(e)+'"]';var i=o;switch(t){case"style":i=Vd(e);break;case"script":i=Yd(e)}zd.has(i)||(e=g({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),zd.set(i,e),null!==r.querySelector(o)||"style"===t&&r.querySelector(Gd(i))||"script"===t&&r.querySelector(Jd(i))||(hd(t=r.createElement("link"),"link",e),et(t),r.head.appendChild(t)))}},m:function(e,t){Hd.m(e,t);var n=Bd;if(n&&e){var r=t&&"string"===typeof t.as?t.as:"script",o='link[rel="modulepreload"][as="'+yt(r)+'"][href="'+yt(e)+'"]',i=o;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":i=Yd(e)}if(!zd.has(i)&&(e=g({rel:"modulepreload",href:e},t),zd.set(i,e),null===n.querySelector(o))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Jd(i)))return}hd(r=n.createElement("link"),"link",e),et(r),n.head.appendChild(r)}}},X:function(e,t){Hd.X(e,t);var n=Bd;if(n&&e){var r=Ze(n).hoistableScripts,o=Yd(e),i=r.get(o);i||((i=n.querySelector(Jd(o)))||(e=g({src:e,async:!0},t),(t=zd.get(o))&&eh(e,t),et(i=n.createElement("script")),hd(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},r.set(o,i))}},S:function(e,t,n){Hd.S(e,t,n);var r=Bd;if(r&&e){var o=Ze(r).hoistableStyles,i=Vd(e);t=t||"default";var a=o.get(i);if(!a){var s={loading:0,preload:null};if(a=r.querySelector(Gd(i)))s.loading=5;else{e=g({rel:"stylesheet",href:e,"data-precedence":t},n),(n=zd.get(i))&&Zd(e,n);var l=a=r.createElement("link");et(l),hd(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){s.loading|=1}),l.addEventListener("error",function(){s.loading|=2}),s.loading|=4,Xd(a,t,r)}a={type:"stylesheet",instance:a,count:1,state:s},o.set(i,a)}}},M:function(e,t){Hd.M(e,t);var n=Bd;if(n&&e){var r=Ze(n).hoistableScripts,o=Yd(e),i=r.get(o);i||((i=n.querySelector(Jd(o)))||(e=g({src:e,async:!0,type:"module"},t),(t=zd.get(o))&&eh(e,t),et(i=n.createElement("script")),hd(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},r.set(o,i))}}};var Bd="undefined"===typeof document?null:document;function Kd(e,t,n){var r=Bd;if(r&&"string"===typeof t&&t){var o=yt(t);o='link[rel="'+e+'"][href="'+o+'"]',"string"===typeof n&&(o+='[crossorigin="'+n+'"]'),Fd.has(o)||(Fd.add(o),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(o)&&(hd(t=r.createElement("link"),"link",e),et(t),r.head.appendChild(t)))}}function Wd(e,t,n,r){var o,i,s,l,c=(c=V.current)?Ud(c):null;if(!c)throw Error(a(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=Vd(n.href),(r=(n=Ze(c).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=Vd(n.href);var u=Ze(c).hoistableStyles,d=u.get(e);if(d||(c=c.ownerDocument||c,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,d),(u=c.querySelector(Gd(e)))&&!u._p&&(d.instance=u,d.state.loading=5),zd.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},zd.set(e,n),u||(o=c,i=e,s=n,l=d.state,o.querySelector('link[rel="preload"][as="style"]['+i+"]")?l.loading=1:(i=o.createElement("link"),l.preload=i,i.addEventListener("load",function(){return l.loading|=1}),i.addEventListener("error",function(){return l.loading|=2}),hd(i,"link",s),et(i),o.head.appendChild(i))))),t&&null===r)throw Error(a(528,""));return d}if(t&&null!==r)throw Error(a(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Yd(n),(r=(n=Ze(c).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,e))}}function Vd(e){return'href="'+yt(e)+'"'}function Gd(e){return'link[rel="stylesheet"]['+e+"]"}function Qd(e){return g({},e,{"data-precedence":e.precedence,precedence:null})}function Yd(e){return'[src="'+yt(e)+'"]'}function Jd(e){return"script[async]"+e}function $d(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+yt(n.href)+'"]');if(r)return t.instance=r,et(r),r;var o=g({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return et(r=(e.ownerDocument||e).createElement("style")),hd(r,"style",o),Xd(r,n.precedence,e),t.instance=r;case"stylesheet":o=Vd(n.href);var i=e.querySelector(Gd(o));if(i)return t.state.loading|=4,t.instance=i,et(i),i;r=Qd(n),(o=zd.get(o))&&Zd(r,o),et(i=(e.ownerDocument||e).createElement("link"));var s=i;return s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),hd(i,"link",r),t.state.loading|=4,Xd(i,n.precedence,e),t.instance=i;case"script":return i=Yd(n.src),(o=e.querySelector(Jd(i)))?(t.instance=o,et(o),o):(r=n,(o=zd.get(i))&&eh(r=g({},n),o),et(o=(e=e.ownerDocument||e).createElement("script")),hd(o,"link",r),e.head.appendChild(o),t.instance=o);case"void":return null;default:throw Error(a(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,Xd(r,n.precedence,e));return t.instance}function Xd(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),o=r.length?r[r.length-1]:null,i=o,a=0;a<r.length;a++){var s=r[a];if(s.dataset.precedence===t)i=s;else if(i!==o)break}i?i.parentNode.insertBefore(e,i.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Zd(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function eh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var th=null;function nh(e,t,n){if(null===th){var r=new Map,o=th=new Map;o.set(n,r)}else(r=(o=th).get(n))||(r=new Map,o.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),o=0;o<n.length;o++){var i=n[o];if(!(i[Qe]||i[Ue]||"link"===e&&"stylesheet"===i.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==i.namespaceURI){var a=i.getAttribute(t)||"";a=e+a;var s=r.get(a);s?s.push(i):r.set(a,[i])}}return r}function rh(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function oh(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var ih=0;function ah(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)lh(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var sh=null;function lh(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,sh=new Map,t.forEach(ch,e),sh=null,ah.call(e))}function ch(e,t){if(!(4&t.state.loading)){var n=sh.get(e);if(n)var r=n.get(null);else{n=new Map,sh.set(e,n);for(var o=e.querySelectorAll("link[data-precedence],style[data-precedence]"),i=0;i<o.length;i++){var a=o[i];"LINK"!==a.nodeName&&"not all"===a.getAttribute("media")||(n.set(a.dataset.precedence,a),r=a)}r&&n.set(null,r)}a=(o=t.instance).getAttribute("data-precedence"),(i=n.get(a)||r)===r&&n.set(null,o),n.set(a,o),this.count++,r=ah.bind(this),o.addEventListener("load",r),o.addEventListener("error",r),i?i.parentNode.insertBefore(o,i.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(o,e.firstChild),t.state.loading|=4}}var uh={$$typeof:k,Provider:null,Consumer:null,_currentValue:L,_currentValue2:L,_threadCount:0};function dh(e,t,n,r,o,i,a,s,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ne(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ne(0),this.hiddenUpdates=Ne(null),this.identifierPrefix=r,this.onUncaughtError=o,this.onCaughtError=i,this.onRecoverableError=a,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function hh(e,t,n,r,o,i,a,s,l,c,u,d){return e=new dh(e,t,n,a,l,c,u,d,s),t=1,!0===i&&(t|=24),i=Dr(3,null,null,t),e.current=i,i.stateNode=e,(t=Fo()).refCount++,e.pooledCache=t,t.refCount++,i.memoizedState={element:r,isDehydrated:n,cache:t},yi(i),e}function gh(e){return e?e=Lr:Lr}function fh(e,t,n,r,o,i){o=gh(o),null===r.context?r.context=o:r.pendingContext=o,(r=bi(t)).payload={element:n},null!==(i=void 0===i?null:i)&&(r.callback=i),null!==(n=wi(e,r,t))&&(Qc(n,0,t),ki(n,e,t))}function mh(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function ph(e,t){mh(e,t),(e=e.alternate)&&mh(e,t)}function yh(e){if(13===e.tag||31===e.tag){var t=Mr(e,67108864);null!==t&&Qc(t,0,67108864),ph(e,67108864)}}function vh(e){if(13===e.tag||31===e.tag){var t=Vc(),n=Mr(e,t=Le(t));null!==n&&Qc(n,0,t),ph(e,t)}}var bh=!0;function wh(e,t,n,r){var o=O.T;O.T=null;var i=j.p;try{j.p=2,Ch(e,t,n,r)}finally{j.p=i,O.T=o}}function kh(e,t,n,r){var o=O.T;O.T=null;var i=j.p;try{j.p=8,Ch(e,t,n,r)}finally{j.p=i,O.T=o}}function Ch(e,t,n,r){if(bh){var o=Sh(r);if(null===o)td(e,t,r,xh,n),jh(e,r);else if(function(e,t,n,r,o){switch(t){case"focusin":return Ph=Lh(Ph,e,t,n,r,o),!0;case"dragenter":return Eh=Lh(Eh,e,t,n,r,o),!0;case"mouseover":return _h=Lh(_h,e,t,n,r,o),!0;case"pointerover":var i=o.pointerId;return Nh.set(i,Lh(Nh.get(i)||null,e,t,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,Rh.set(i,Lh(Rh.get(i)||null,e,t,n,r,o)),!0}return!1}(o,e,t,n,r))r.stopPropagation();else if(jh(e,r),4&t&&-1<Oh.indexOf(e)){for(;null!==o;){var i=$e(o);if(null!==i)switch(i.tag){case 3:if((i=i.stateNode).current.memoizedState.isDehydrated){var a=Te(i.pendingLanes);if(0!==a){var s=i;for(s.pendingLanes|=2,s.entangledLanes|=2;a;){var l=1<<31-we(a);s.entanglements[1]|=l,a&=~l}ju(i),0===(6&gc)&&(Oc=le()+500,Lu(0,!1))}}break;case 31:case 13:null!==(s=Mr(i,2))&&Qc(s,0,2),Zc(),ph(i,2)}if(null===(i=Sh(r))&&td(e,t,r,xh,n),i===o)break;o=i}null!==o&&r.stopPropagation()}else td(e,t,r,null,n)}}function Sh(e){return Ah(e=Ot(e))}var xh=null;function Ah(e){if(xh=null,null!==(e=Je(e))){var t=l(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=c(t)))return e;e=null}else if(31===n){if(null!==(e=u(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return xh=e,null}function Th(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ce()){case ue:return 2;case de:return 8;case he:case ge:return 32;case fe:return 268435456;default:return 32}default:return 32}}var Ih=!1,Ph=null,Eh=null,_h=null,Nh=new Map,Rh=new Map,Mh=[],Oh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function jh(e,t){switch(e){case"focusin":case"focusout":Ph=null;break;case"dragenter":case"dragleave":Eh=null;break;case"mouseover":case"mouseout":_h=null;break;case"pointerover":case"pointerout":Nh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rh.delete(t.pointerId)}}function Lh(e,t,n,r,o,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[o]},null!==t&&(null!==(t=$e(t))&&yh(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o),e)}function qh(e){var t=Je(e.target);if(null!==t){var n=l(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=c(n)))return e.blockedOn=t,void ze(e.priority,function(){vh(n)})}else if(31===t){if(null!==(t=u(n)))return e.blockedOn=t,void ze(e.priority,function(){vh(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Dh(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Sh(e.nativeEvent);if(null!==n)return null!==(t=$e(n))&&yh(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);Mt=r,n.target.dispatchEvent(r),Mt=null,t.shift()}return!0}function zh(e,t,n){Dh(e)&&n.delete(t)}function Fh(){Ih=!1,null!==Ph&&Dh(Ph)&&(Ph=null),null!==Eh&&Dh(Eh)&&(Eh=null),null!==_h&&Dh(_h)&&(_h=null),Nh.forEach(zh),Rh.forEach(zh)}function Uh(e,t){e.blockedOn===t&&(e.blockedOn=null,Ih||(Ih=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Fh)))}var Hh=null;function Bh(e){Hh!==e&&(Hh=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Hh===e&&(Hh=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],o=e[t+2];if("function"!==typeof r){if(null===Ah(r||n))continue;break}var i=$e(n);null!==i&&(e.splice(t,3),t-=3,ts(i,{pending:!0,data:o,method:n.method,action:r},r,o))}}))}function Kh(e){function t(t){return Uh(t,e)}null!==Ph&&Uh(Ph,e),null!==Eh&&Uh(Eh,e),null!==_h&&Uh(_h,e),Nh.forEach(t),Rh.forEach(t);for(var n=0;n<Mh.length;n++){var r=Mh[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<Mh.length&&null===(n=Mh[0]).blockedOn;)qh(n),null===n.blockedOn&&Mh.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var o=n[r],i=n[r+1],a=o[He]||null;if("function"===typeof i)a||Bh(n);else if(a){var s=null;if(i&&i.hasAttribute("formAction")){if(o=i,a=i[He]||null)s=a.formAction;else if(null!==Ah(o))continue}else s=a.action;"function"===typeof s?n[r+1]=s:(n.splice(r,3),r-=3),Bh(n)}}}function Wh(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return o=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==o&&(o(),o=null),r||setTimeout(n,20)}function n(){if(!r&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"===typeof navigation){var r=!1,o=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){r=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==o&&(o(),o=null)}}}function Vh(e){this._internalRoot=e}function Gh(e){this._internalRoot=e}Gh.prototype.render=Vh.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));fh(t.current,Vc(),e,t,null,null)},Gh.prototype.unmount=Vh.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;fh(e.current,2,null,e,null,null),Zc(),t[Be]=null}},Gh.prototype.unstable_scheduleHydration=function(e){if(e){var t=De();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Mh.length&&0!==t&&t<Mh[n].priority;n++);Mh.splice(n,0,e),0===n&&qh(e)}};var Qh=o.version;if("19.2.0"!==Qh)throw Error(a(527,Qh,"19.2.0"));j.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(null===o)break;var i=o.alternate;if(null===i){if(null!==(r=o.return)){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return d(o),e;if(i===r)return d(o),t;i=i.sibling}throw Error(a(188))}if(n.return!==r.return)n=o,r=i;else{for(var s=!1,c=o.child;c;){if(c===n){s=!0,n=o,r=i;break}if(c===r){s=!0,r=o,n=i;break}c=c.sibling}if(!s){for(c=i.child;c;){if(c===n){s=!0,n=i,r=o;break}if(c===r){s=!0,r=i,n=o;break}c=c.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?h(e):null)?null:e.stateNode};var Yh={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.2.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Jh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jh.isDisabled&&Jh.supportsFiber)try{ye=Jh.inject(Yh),ve=Jh}catch(Xh){}}t.createRoot=function(e,t){if(!s(e))throw Error(a(299));var n=!1,r="",o=xs,i=As,l=Ts;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(o=t.onUncaughtError),void 0!==t.onCaughtError&&(i=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError)),t=hh(e,1,!1,null,0,n,r,null,o,i,l,Wh),e[Be]=t.current,Zu(e),new Vh(t)},t.hydrateRoot=function(e,t,n){if(!s(e))throw Error(a(299));var r=!1,o="",i=xs,l=As,c=Ts,u=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onUncaughtError&&(i=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.formState&&(u=n.formState)),(t=hh(e,1,!0,t,0,r,o,u,i,l,c,Wh)).context=gh(null),n=t.current,(o=bi(r=Le(r=Vc()))).callback=null,wi(n,o,r),n=r,t.current.lanes=n,Re(t,n),ju(t),e[Be]=t.current,Zu(e),new Gh(t)},t.version="19.2.0"},119:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(863)},340:(e,t,n)=>{e.exports=n(487)},352:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(85)},414:(e,t,n)=>{e.exports=n(916)},487:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,o=e[r];if(!(0<i(o,t)))break e;e[r]=t,e[n]=o,n=r}}function r(e){return 0===e.length?null:e[0]}function o(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,o=e.length,a=o>>>1;r<a;){var s=2*(r+1)-1,l=e[s],c=s+1,u=e[c];if(0>i(l,n))c<o&&0>i(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[s]=n,r=s);else{if(!(c<o&&0>i(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],u=[],d=1,h=null,g=3,f=!1,m=!1,p=!1,y=!1,v="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,w="undefined"!==typeof setImmediate?setImmediate:null;function k(e){for(var t=r(u);null!==t;){if(null===t.callback)o(u);else{if(!(t.startTime<=e))break;o(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function C(e){if(p=!1,k(e),!m)if(null!==r(c))m=!0,x||(x=!0,S());else{var t=r(u);null!==t&&R(C,t.startTime-e)}}var S,x=!1,A=-1,T=5,I=-1;function P(){return!!y||!(t.unstable_now()-I<T)}function E(){if(y=!1,x){var e=t.unstable_now();I=e;var n=!0;try{e:{m=!1,p&&(p=!1,b(A),A=-1),f=!0;var i=g;try{t:{for(k(e),h=r(c);null!==h&&!(h.expirationTime>e&&P());){var a=h.callback;if("function"===typeof a){h.callback=null,g=h.priorityLevel;var s=a(h.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof s){h.callback=s,k(e),n=!0;break t}h===r(c)&&o(c),k(e)}else o(c);h=r(c)}if(null!==h)n=!0;else{var l=r(u);null!==l&&R(C,l.startTime-e),n=!1}}break e}finally{h=null,g=i,f=!1}n=void 0}}finally{n?S():x=!1}}}if("function"===typeof w)S=function(){w(E)};else if("undefined"!==typeof MessageChannel){var _=new MessageChannel,N=_.port2;_.port1.onmessage=E,S=function(){N.postMessage(null)}}else S=function(){v(E,0)};function R(e,n){A=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_next=function(e){switch(g){case 1:case 2:case 3:var t=3;break;default:t=g}var n=g;g=t;try{return e()}finally{g=n}},t.unstable_requestPaint=function(){y=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=g;g=e;try{return t()}finally{g=n}},t.unstable_scheduleCallback=function(e,o,i){var a=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?a+i:a:i=a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:o,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>a?(e.sortIndex=i,n(u,e),null===r(c)&&e===r(u)&&(p?(b(A),A=-1):p=!0,R(C,i-a))):(e.sortIndex=s,n(c,e),m||f||(m=!0,x||(x=!0,S()))),e},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(e){var t=g;return function(){var n=g;g=t;try{return e.apply(this,arguments)}finally{g=n}}}},863:(e,t,n)=>{var r=n(950);function o(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var a={d:{f:i,r:function(){throw Error(o(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},s=Symbol.for("react.portal");var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(o(299));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:s,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=l.T,n=a.p;try{if(l.T=null,a.p=2,e)return e()}finally{l.T=t,a.p=n,a.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,a.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&a.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin),o="string"===typeof t.integrity?t.integrity:void 0,i="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?a.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:o,fetchPriority:i}):"script"===n&&a.d.X(e,{crossOrigin:r,integrity:o,fetchPriority:i,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=c(t.as,t.crossOrigin);a.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&a.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin);a.d.L(e,n,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=c(t.as,t.crossOrigin);a.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else a.d.m(e)},t.requestFormReset=function(e){a.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return l.H.useFormState(e,t,n)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.2.0"},916:(e,t)=>{var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function o(e,t,r){var o=null;if(void 0!==r&&(o=""+r),void 0!==t.key&&(o=""+t.key),"key"in t)for(var i in r={},t)"key"!==i&&(r[i]=t[i]);else r=t;return t=r.ref,{$$typeof:n,type:e,key:o,ref:void 0!==t?t:null,props:r}}t.Fragment=r,t.jsx=o,t.jsxs=o},950:(e,t,n)=>{e.exports=n(983)},983:(e,t)=>{var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),f=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,y={};function v(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||m}function b(){}function w(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||m}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=v.prototype;var k=w.prototype=new b;k.constructor=w,p(k,v.prototype),k.isPureReactComponent=!0;var C=Array.isArray;function S(){}var x={H:null,A:null,T:null,S:null},A=Object.prototype.hasOwnProperty;function T(e,t,r){var o=r.ref;return{$$typeof:n,type:e,key:t,ref:void 0!==o?o:null,props:r}}function I(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var P=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function _(e,t,o,i,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(s){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0;break;case h:return _((u=e._init)(e._payload),t,o,i,a)}}if(u)return a=a(e),u=""===i?"."+E(e,0):i,C(a)?(o="",null!=u&&(o=u.replace(P,"$&/")+"/"),_(a,t,o,"",function(e){return e})):null!=a&&(I(a)&&(l=a,c=o+(null==a.key||e&&e.key===a.key?"":(""+a.key).replace(P,"$&/")+"/")+u,a=T(l.type,c,l.props)),t.push(a)),1;u=0;var d,g=""===i?".":i+":";if(C(e))for(var m=0;m<e.length;m++)u+=_(i=e[m],t,o,s=g+E(i,m),a);else if("function"===typeof(m=null===(d=e)||"object"!==typeof d?null:"function"===typeof(d=f&&d[f]||d["@@iterator"])?d:null))for(e=m.call(e),m=0;!(i=e.next()).done;)u+=_(i=i.value,t,o,s=g+E(i,m++),a);else if("object"===s){if("function"===typeof e.then)return _(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(S,S):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,o,i,a);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function N(e,t,n){if(null==e)return e;var r=[],o=0;return _(e,r,"","",function(e){return t.call(n,e,o++)}),r}function R(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var M="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},O={map:N,forEach:function(e,t,n){N(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return N(e,function(){t++}),t},toArray:function(e){return N(e,function(e){return e})||[]},only:function(e){if(!I(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};t.Activity=g,t.Children=O,t.Component=v,t.Fragment=o,t.Profiler=a,t.PureComponent=w,t.StrictMode=i,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=x,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return x.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cacheSignal=function(){return null},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=p({},e.props),o=e.key;if(null!=t)for(i in void 0!==t.key&&(o=""+t.key),t)!A.call(t,i)||"key"===i||"__self"===i||"__source"===i||"ref"===i&&void 0===t.ref||(r[i]=t[i]);var i=arguments.length-2;if(1===i)r.children=n;else if(1<i){for(var a=Array(i),s=0;s<i;s++)a[s]=arguments[s+2];r.children=a}return T(e.type,o,r)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:s,_context:e},e},t.createElement=function(e,t,n){var r,o={},i=null;if(null!=t)for(r in void 0!==t.key&&(i=""+t.key),t)A.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(o[r]=t[r]);var a=arguments.length-2;if(1===a)o.children=n;else if(1<a){for(var s=Array(a),l=0;l<a;l++)s[l]=arguments[l+2];o.children=s}if(e&&e.defaultProps)for(r in a=e.defaultProps)void 0===o[r]&&(o[r]=a[r]);return T(e,i,o)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=I,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:R}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=x.T,n={};x.T=n;try{var r=e(),o=x.S;null!==o&&o(n,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(S,M)}catch(i){M(i)}finally{null!==t&&null!==n.types&&(t.types=n.types),x.T=t}},t.unstable_useCacheRefresh=function(){return x.H.useCacheRefresh()},t.use=function(e){return x.H.use(e)},t.useActionState=function(e,t,n){return x.H.useActionState(e,t,n)},t.useCallback=function(e,t){return x.H.useCallback(e,t)},t.useContext=function(e){return x.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return x.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return x.H.useEffect(e,t)},t.useEffectEvent=function(e){return x.H.useEffectEvent(e)},t.useId=function(){return x.H.useId()},t.useImperativeHandle=function(e,t,n){return x.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return x.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return x.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return x.H.useMemo(e,t)},t.useOptimistic=function(e,t){return x.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return x.H.useReducer(e,t,n)},t.useRef=function(e){return x.H.useRef(e)},t.useState=function(e){return x.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return x.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return x.H.useTransition()},t.version="19.2.0"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,r)=>(n.f[r](e,t),t),[])),n.u=e=>"static/js/"+e+".2765b8c2.chunk.js",n.miniCssF=e=>{},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="evoke-schedule:";n.l=(r,o,i,a)=>{if(e[r])e[r].push(o);else{var s,l;if(void 0!==i)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+i){s=d;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+i),s.src=r),e[r]=[o];var h=(t,n)=>{s.onerror=s.onload=null,clearTimeout(g);var o=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach(e=>e(n)),t)return t(n)},g=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),l&&document.head.appendChild(s)}}})(),n.p="/EvokeSchedule2.0/",(()=>{var e={792:0};n.f.j=(t,r)=>{var o=n.o(e,t)?e[t]:void 0;if(0!==o)if(o)r.push(o[2]);else{var i=new Promise((n,r)=>o=e[t]=[n,r]);r.push(o[2]=i);var a=n.p+n.u(t),s=new Error;n.l(a,r=>{if(n.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var i=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+a+")",s.name="ChunkLoadError",s.type=i,s.request=a,o[1](s)}},"chunk-"+t,t)}};var t=(t,r)=>{var o,i,a=r[0],s=r[1],l=r[2],c=0;if(a.some(t=>0!==e[t])){for(o in s)n.o(s,o)&&(n.m[o]=s[o]);if(l)l(n)}for(t&&t(r);c<a.length;c++)i=a[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0},r=self.webpackChunkevoke_schedule=self.webpackChunkevoke_schedule||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=n(950),o=n(352);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:t+""}function s(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){s(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function u(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}const d=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},h=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim()};var g={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const f=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],m=(0,r.forwardRef)((e,t)=>{let{color:n="currentColor",size:o=24,strokeWidth:i=2,absoluteStrokeWidth:a,className:s="",children:l,iconNode:d}=e,m=u(e,f);return(0,r.createElement)("svg",c(c(c({ref:t},g),{},{width:o,height:o,stroke:n,strokeWidth:a?24*Number(i)/Number(o):i,className:h("lucide",s)},!l&&!(e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(m)&&{"aria-hidden":"true"}),m),[...d.map(e=>{let[t,n]=e;return(0,r.createElement)(t,n)}),...Array.isArray(l)?l:[l]])}),p=["className"],y=(e,t)=>{const n=(0,r.forwardRef)((n,o)=>{let{className:i}=n,a=u(n,p);return(0,r.createElement)(m,c({ref:o,iconNode:t,className:h("lucide-".concat((s=d(e),s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase())),"lucide-".concat(e),i)},a));var s});return n.displayName=d(e),n},v=y("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),b=y("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),w=y("log-in",[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]]),k=y("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),C=y("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),S=y("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),x=y("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),A=y("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),T=y("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),I=y("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),P=y("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),E=y("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),_=y("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),N={RBT:{level:1,name:"RBT"},BS:{level:2,name:"Behavior Specialist"},BCBA:{level:3,name:"BCBA"},EA:{level:4,name:"Educational Assistant"},MHA:{level:5,name:"Mental Health Assistant"},CC:{level:6,name:"Clinical Coordinator"},Trainer:{level:7,name:"Trainer"},Teacher:{level:8,name:"Teacher"},Director:{level:9,name:"Director"}},R=N,M={PRIMARY:"Primary",SECONDARY:"Secondary"},O={PRIMARY:{AM:{start:"8:45",end:"11:30"},PM:{start:"12:00",end:"15:00"}},SECONDARY:{AM:{start:"8:45",end:"12:00"},PM:{start:"12:30",end:"15:00"}}},j={ONE_TO_ONE:"1:1",TWO_TO_ONE:"2:1",ONE_TO_TWO:"1:2"};class L{constructor(e){let{id:t,name:n,role:r,email:o="",userId:i=null,staffPerson:a=null,primaryProgram:s=!1,secondaryProgram:l=!1,isActive:c=!0}=e;this.id=t,this.name=n,this.role=r,this.email=o,this.userId=i,this.staffPerson=a,"string"===typeof s?(this.primaryProgram=!0,this.primaryProgramType=s):(this.primaryProgram=s,this.primaryProgramType=s?M.PRIMARY:null),"string"===typeof l?(this.secondaryProgram=!0,this.secondaryProgramType=l):(this.secondaryProgram=l,this.secondaryProgramType=l?M.SECONDARY:null),this.isActive=c}getRoleLevel(){var e;return(null===(e=N[this.role])||void 0===e?void 0:e.level)||0}canWorkProgram(e){return e===M.PRIMARY||"Primary"===e?this.primaryProgram:(e===M.SECONDARY||"Secondary"===e)&&this.secondaryProgram}canDo1To1Sessions(){return!["Teacher","Trainer","Director"].includes(this.role)}}class q{constructor(e){let{id:t,name:n,program:r,ratio:o,ratioAM:i=j.ONE_TO_ONE,ratioPM:a=j.ONE_TO_ONE,isActive:s=!0,team:l=[],teamIds:c=[],pairedWith:u=null}=e;this.id=t,this.name=n,this.program=r,o?(this.ratioAM=o,this.ratioPM=o,this.ratio=o):(this.ratioAM=i,this.ratioPM=a,this.ratio=i),this.isActive=s,this.team=l,this.teamIds=c.length>0?c:l.map(e=>e.id).filter(Boolean),this.pairedWith=u}requiresMultipleStaff(){return("AM"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"AM")?this.ratioAM:this.ratioPM)===j.TWO_TO_ONE}getSessionRatio(e){return"AM"===e?this.ratioAM:this.ratioPM}isSmallGroup(){return("AM"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"AM")?this.ratioAM:this.ratioPM)===j.ONE_TO_TWO}isPaired(){return null!==this.pairedWith&&void 0!==this.pairedWith}getPairedStudent(e){if(!this.isPaired())return null;return e.find(e=>e.id==this.pairedWith||e.id===this.pairedWith)||null}}class D{constructor(e){let{id:t,staffId:n,studentId:r,session:o,program:i,date:a,isLocked:s=!1,assignedBy:l="auto"}=e;this.id=t,this.staffId=n,this.studentId=r,this.session=o,this.program=i,this.date=a,this.isLocked=s,this.assignedBy=l}getSessionTimes(){return O[this.program.toUpperCase()][this.session]}}class z{constructor(e){let{date:t,assignments:n=[],lockedAssignments:r=new Set,isFinalized:o=!1}=e;this.date=t,this.assignments=n,this.lockedAssignments=r,this.isFinalized=o}getAssignmentsForSession(e,t){return this.assignments.filter(n=>n.session===e&&n.program.toLowerCase()===t.toLowerCase())}getStaffAssignments(e){return this.assignments.filter(t=>t.staffId===e)}getStudentAssignments(e){return this.assignments.filter(t=>t.studentId===e)}isStaffAvailable(e,t,n){return!this.assignments.filter(e=>e.session===t).some(t=>t.staffId===e)}hasStaffWorkedWithStudentToday(e,t){return this.assignments.some(n=>n.staffId===e&&n.studentId===t)}addAssignment(e){this.assignments.push(e)}removeAssignment(e){this.assignments=this.assignments.filter(t=>t.id!==e)}lockAssignment(e){this.lockedAssignments.add(e)}unlockAssignment(e){this.lockedAssignments.delete(e)}isAssignmentLocked(e){return this.lockedAssignments.has(e)}}class F{static validateAssignment(e,t,n,r){const o=[],i=n.find(t=>t.id===e.staffId);return i?(i.canWorkProgram(e.program)||o.push("".concat(i.name," is not assigned to ").concat(e.program," program")),t.isStaffAvailable(e.staffId,e.session,e.program)||o.push("".concat(i.name," is already assigned in ").concat(e.session," session")),t.hasStaffWorkedWithStudentToday(e.staffId,e.studentId)&&o.push("".concat(i.name," has already worked with this student today")),o):(o.push("Staff member not found"),o)}static validateSchedule(e,t,n){const r=[];for(const i of e.assignments){const o=new z({date:e.date,assignments:e.assignments.filter(e=>e.id!==i.id),lockedAssignments:e.lockedAssignments,isFinalized:e.isFinalized}),a=this.validateAssignment(i,o,t,n);r.push(...a.map(e=>"Assignment ".concat(i.id,": ").concat(e)))}const o={};for(const i of e.assignments){const e=n.find(e=>e.id===i.studentId);if(e){const t="".concat(i.session,"-").concat(i.program,"-").concat(e.id);o[t]=(o[t]||0)+1;(e.getSessionRatio?e.getSessionRatio(i.session):e.ratio)===j.TWO_TO_ONE&&o[t]<2&&r.push("".concat(e.name," requires 2:1 ratio but only has ").concat(o[t]," staff assigned"))}}return r}}class U{static generateAssignmentId(){return"assignment_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}static formatDate(e){return e.toISOString().split("T")[0]}static sortStaffByHierarchy(e){return[...e].sort((e,t)=>e.getRoleLevel()-t.getRoleLevel())}static getAvailableStaffForStudent(e,t,n,r,o){return r.filter(r=>{if(!r.isActive)return!1;if(!r.canWorkProgram(n))return!1;if(!o.isStaffAvailable(r.id,t,n))return!1;if(o.hasStaffWorkedWithStudentToday(r.id,e.id))return!1;return!(("AM"===t?e.ratioAM:e.ratioPM)===j.ONE_TO_ONE&&!r.canDo1To1Sessions())})}}const H={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},B=200,K=400,W=400,V=499,G=500,Q=599,Y="GET",J="POST",$=[H.OPENID_SCOPE,H.PROFILE_SCOPE,H.OFFLINE_ACCESS_SCOPE],X=[...$,H.EMAIL_SCOPE],Z="Content-Type",ee="Content-Length",te="Retry-After",ne="X-AnchorMailbox",re="x-ms-request-id",oe="x-ms-httpver",ie="active-account-filters",ae="common",se="organizations",le="consumers",ce="access_token",ue="xms_cc",de="login",he="select_account",ge="consent",fe="none",me="no_session",pe="code",ye="id_token token refresh_token",ve="query",be="fragment",we="query",ke="authorization_code",Ce="refresh_token",Se="MSSTS",xe="ADFS",Ae="Generic",Te="-",Ie=".",Pe={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},Ee="appmetadata",_e="1",Ne="authority-metadata",Re=86400,Me="config",Oe="cache",je="network",Le="hardcoded_values",qe={SCHEMA_VERSION:5,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},De={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},ze=60,Fe=3600,Ue="throttling",He="retry-after, h429",Be="invalid_grant",Ke="client_mismatch",We="1",Ve="3",Ge="4",Qe="2",Ye="4",Je="5",$e="0",Xe="1",Ze="2",et="3",tt="4",nt="pop";var rt;!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(rt||(rt={}));class ot{constructor(e,t,n){this.level=rt.Info;const r=e||ot.createDefaultLoggerOptions();this.localCallback=r.loggerCallback||(()=>{}),this.piiLoggingEnabled=r.piiLoggingEnabled||!1,this.level="number"===typeof r.logLevel?r.logLevel:rt.Info,this.correlationId=r.correlationId||H.EMPTY_STRING,this.packageName=t||H.EMPTY_STRING,this.packageVersion=n||H.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:rt.Info}}clone(e,t,n){return new ot({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const n=(new Date).toUTCString(),r="[".concat(n,"] : [").concat(t.correlationId||this.correlationId||"","]"),o="".concat(r," : ").concat(this.packageName,"@").concat(this.packageVersion," : ").concat(rt[t.logLevel]," - ").concat(e);this.executeCallback(t.logLevel,o,t.containsPii||!1)}executeCallback(e,t,n){this.localCallback&&this.localCallback(e,t,n)}error(e,t){this.logMessage(e,{logLevel:rt.Error,containsPii:!1,correlationId:t||H.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:rt.Error,containsPii:!0,correlationId:t||H.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:rt.Warning,containsPii:!1,correlationId:t||H.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:rt.Warning,containsPii:!0,correlationId:t||H.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:rt.Info,containsPii:!1,correlationId:t||H.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:rt.Info,containsPii:!0,correlationId:t||H.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:rt.Verbose,containsPii:!1,correlationId:t||H.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:rt.Verbose,containsPii:!0,correlationId:t||H.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:rt.Trace,containsPii:!1,correlationId:t||H.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:rt.Trace,containsPii:!0,correlationId:t||H.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}const it="AAD",at="OIDC",st="EAR",lt="none",ct="unexpected_error",ut="post_request_failed",dt={[ct]:"Unexpected error in authentication.",[ut]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class ht extends Error{constructor(e,t,n){super(t?"".concat(e,": ").concat(t):e),Object.setPrototypeOf(this,ht.prototype),this.errorCode=e||H.EMPTY_STRING,this.errorMessage=t||H.EMPTY_STRING,this.subError=n||H.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function gt(e,t){return new ht(e,t?"".concat(dt[e]," ").concat(t):dt[e])}const ft="client_info_decoding_error",mt="client_info_empty_error",pt="token_parsing_error",yt="null_or_empty_token",vt="endpoints_resolution_error",bt="network_error",wt="openid_config_error",kt="hash_not_deserialized",Ct="invalid_state",St="state_mismatch",xt="state_not_found",At="nonce_mismatch",Tt="auth_time_not_found",It="max_age_transpired",Pt="multiple_matching_tokens",Et="multiple_matching_accounts",_t="multiple_matching_appMetadata",Nt="request_cannot_be_made",Rt="cannot_remove_empty_scope",Mt="cannot_append_scopeset",Ot="empty_input_scopeset",jt="device_code_polling_cancelled",Lt="device_code_expired",qt="device_code_unknown_error",Dt="no_account_in_silent_request",zt="invalid_cache_record",Ft="invalid_cache_environment",Ut="no_account_found",Ht="no_crypto_object",Bt="unexpected_credential_type",Kt="invalid_assertion",Wt="invalid_client_credential",Vt="token_refresh_required",Gt="user_timeout_reached",Qt="token_claims_cnf_required_for_signedjwt",Yt="authorization_code_missing_from_server_response",Jt="binding_key_not_removed",$t="end_session_endpoint_not_supported",Xt="key_id_missing",Zt="no_network_connectivity",en="user_canceled",tn="missing_tenant_id_error",nn="method_not_implemented",rn="nested_app_auth_bridge_disabled",on={[ft]:"The client info could not be parsed/decoded correctly",[mt]:"The client info was empty",[pt]:"Token cannot be parsed",[yt]:"The token is null or empty",[vt]:"Endpoints cannot be resolved",[bt]:"Network request failed",[wt]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[kt]:"The hash parameters could not be deserialized",[Ct]:"State was not the expected format",[St]:"State mismatch error",[xt]:"State not found",[At]:"Nonce mismatch error",[Tt]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[It]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[Pt]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[Et]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[_t]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[Nt]:"Token request cannot be made without authorization code or refresh token.",[Rt]:"Cannot remove null or empty scope from ScopeSet",[Mt]:"Cannot append ScopeSet",[Ot]:"Empty input ScopeSet cannot be processed",[jt]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[Lt]:"Device code is expired.",[qt]:"Device code stopped polling for unknown reasons.",[Dt]:"Please pass an account object, silent flow is not supported without account information",[zt]:"Cache record object was null or undefined.",[Ft]:"Invalid environment when attempting to create cache entry",[Ut]:"No account found in cache for given key.",[Ht]:"No crypto object detected.",[Bt]:"Unexpected credential type.",[Kt]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[Wt]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[Vt]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[Gt]:"User defined timeout for device code polling reached",[Qt]:"Cannot generate a POP jwt if the token_claims are not populated",[Yt]:"Server response does not contain an authorization code to proceed",[Jt]:"Could not remove the credential's binding key from storage.",[$t]:"The provided authority does not support logout",[Xt]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[Zt]:"No network connectivity. Check your internet connection.",[en]:"User cancelled the flow.",[tn]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[nn]:"This method has not been implemented",[rn]:"The nested app auth bridge is disabled"};class an extends ht{constructor(e,t){super(e,t?"".concat(on[e],": ").concat(t):on[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,an.prototype)}}function sn(e,t){return new an(e,t)}const ln={createNewGuid:()=>{throw sn(nn)},base64Decode:()=>{throw sn(nn)},base64Encode:()=>{throw sn(nn)},base64UrlEncode:()=>{throw sn(nn)},encodeKid:()=>{throw sn(nn)},async getPublicKeyThumbprint(){throw sn(nn)},async removeTokenBindingKey(){throw sn(nn)},async clearKeystore(){throw sn(nn)},async signJwt(){throw sn(nn)},async hashString(){throw sn(nn)}},cn="@azure/msal-common",un="15.13.0",dn="redirect_uri_empty",hn="claims_request_parsing_error",gn="authority_uri_insecure",fn="url_parse_error",mn="empty_url_error",pn="empty_input_scopes_error",yn="invalid_claims",vn="token_request_empty",bn="logout_request_empty",wn="invalid_code_challenge_method",kn="pkce_params_missing",Cn="invalid_cloud_discovery_metadata",Sn="invalid_authority_metadata",xn="untrusted_authority",An="missing_ssh_jwk",Tn="missing_ssh_kid",In="missing_nonce_authentication_header",Pn="invalid_authentication_header",En="cannot_set_OIDCOptions",_n="cannot_allow_platform_broker",Nn="authority_mismatch",Rn="invalid_request_method_for_EAR",Mn="invalid_authorize_post_body_parameters",On={[dn]:"A redirect URI is required for all calls, and none has been set.",[hn]:"Could not parse the given claims request object.",[gn]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[fn]:"URL could not be parsed into appropriate segments.",[mn]:"URL was empty or null.",[pn]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[yn]:"Given claims parameter must be a stringified JSON object.",[vn]:"Token request was empty and not found in cache.",[bn]:"The logout request was null or undefined.",[wn]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[kn]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[Cn]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[Sn]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[xn]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[An]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[Tn]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[In]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[Pn]:"Invalid authentication header provided",[En]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[_n]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[Nn]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority.",[Mn]:"Invalid authorize post body parameters provided. If you are using authorizePostBodyParameters, the request method must be POST. Please check the request method and parameters.",[Rn]:"Invalid request method for EAR protocol mode. The request method cannot be GET when using EAR protocol mode. Please change the request method to POST."};class jn extends ht{constructor(e){super(e,On[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,jn.prototype)}}function Ln(e){return new jn(e)}class qn{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return 0===Object.keys(t).length}catch(t){}return!0}static startsWith(e,t){return 0===e.indexOf(t)}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},n=e.split("&"),r=e=>decodeURIComponent(e.replace(/\+/g," "));return n.forEach(e=>{if(e.trim()){const[n,o]=e.split(/=(.+)/g,2);n&&o&&(t[r(n)]=r(o))}}),t}static trimArrayEntries(e){return e.map(e=>e.trim())}static removeEmptyStringsFromArray(e){return e.filter(e=>!!e)}static jsonParseHelper(e){try{return JSON.parse(e)}catch(t){return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}class Dn{constructor(e){const t=e?qn.trimArrayEntries([...e]):[],n=t?qn.removeEmptyStringsFromArray(t):[];if(!n||!n.length)throw Ln(pn);this.scopes=new Set,n.forEach(e=>this.scopes.add(e))}static fromString(e){const t=(e||H.EMPTY_STRING).split(" ");return new Dn(t)}static createSearchScopes(e){const t=e&&e.length>0?e:[...$],n=new Dn(t);return n.containsOnlyOIDCScopes()?n.removeScope(H.OFFLINE_ACCESS_SCOPE):n.removeOIDCScopes(),n}containsScope(e){const t=this.printScopesLowerCase().split(" "),n=new Dn(t);return!!e&&n.scopes.has(e.toLowerCase())}containsScopeSet(e){return!(!e||e.scopes.size<=0)&&(this.scopes.size>=e.scopes.size&&e.asArray().every(e=>this.containsScope(e)))}containsOnlyOIDCScopes(){let e=0;return X.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(e=>this.appendScope(e))}catch(t){throw sn(Mt)}}removeScope(e){if(!e)throw sn(Rt);this.scopes.delete(e.trim())}removeOIDCScopes(){X.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw sn(Ot);const t=new Set;return e.scopes.forEach(e=>t.add(e.toLowerCase())),this.scopes.forEach(e=>t.add(e.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw sn(Ot);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),n=e.getScopeCount(),r=this.getScopeCount();return t.size<r+n}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){if(this.scopes){return this.asArray().join(" ")}return H.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}const zn=["isHomeTenant"],Fn=["isHomeTenant"];function Un(e,t){return!!e&&!!t&&e===t.split(".")[1]}function Hn(e,t,n,r){if(r){const{oid:t,sub:n,tid:o,name:i,tfp:a,acr:s,preferred_username:l,upn:c,login_hint:u}=r,d=o||a||s||"";return{tenantId:d,localAccountId:t||n||"",name:i,username:l||c||"",loginHint:u,isHomeTenant:Un(d,e)}}return{tenantId:n,localAccountId:t,username:"",isHomeTenant:Un(n,e)}}function Bn(e,t,n,r){let o=e;if(t){const{isHomeTenant:n}=t,r=u(t,zn);o=c(c({},e),r)}if(n){const t=Hn(e.homeAccountId,e.localAccountId,e.tenantId,n),{isHomeTenant:i}=t,a=u(t,Fn);return o=c(c(c({},o),a),{},{idTokenClaims:n,idToken:r}),o}return o}function Kn(e,t){const n=function(e){if(!e)throw sn(yt);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw sn(pt);return t[2]}(e);try{const e=t(n);return JSON.parse(e)}catch(r){throw sn(pt)}}function Wn(e,t){if(0===t||Date.now()-3e5>e+t)throw sn(It)}function Vn(e){if(!e)return e;let t=e.toLowerCase();return qn.endsWith(t,"?")?t=t.slice(0,-1):qn.endsWith(t,"?/")&&(t=t.slice(0,-2)),qn.endsWith(t,"/")||(t+="/"),t}function Gn(e){return e.startsWith("#/")?e.substring(2):e.startsWith("#")||e.startsWith("?")?e.substring(1):e}function Qn(e){if(!e||e.indexOf("=")<0)return null;try{const t=Gn(e),n=Object.fromEntries(new URLSearchParams(t));if(n.code||n.ear_jwe||n.error||n.error_description||n.state)return n}catch(t){throw sn(kt)}return null}function Yn(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;const r=new Array;return e.forEach((e,o)=>{!t&&n&&o in n?r.push("".concat(o,"=").concat(e)):r.push("".concat(o,"=").concat(encodeURIComponent(e)))}),r.join("&")}function Jn(e){if(!e)return e;const t=e.split("#")[0];try{const e=new URL(t);return Vn(e.origin+e.pathname+e.search)}catch(n){return Vn(t)}}class $n{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw Ln(mn);e.includes("#")||(this._urlString=$n.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return qn.endsWith(t,"?")?t=t.slice(0,-1):qn.endsWith(t,"?/")&&(t=t.slice(0,-2)),qn.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch(t){throw Ln(fn)}if(!e.HostNameAndPort||!e.PathSegments)throw Ln(fn);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw Ln(gn)}static appendQueryString(e,t){return t?e.indexOf("?")<0?"".concat(e,"?").concat(t):"".concat(e,"&").concat(t):e}static removeHashFromUrl(e){return $n.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),n=t.PathSegments;return!e||0===n.length||n[0]!==ae&&n[0]!==se||(n[0]=e),$n.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Ln(fn);const n={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let r=n.AbsolutePath.split("/");return r=r.filter(e=>e&&e.length>0),n.PathSegments=r,n.QueryString&&n.QueryString.endsWith("/")&&(n.QueryString=n.QueryString.substring(0,n.QueryString.length-1)),n}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=e.match(t);if(!n)throw Ln(fn);return n[2]}static getAbsoluteUrl(e,t){if(e[0]===H.FORWARD_SLASH){const n=new $n(t).getUrlComponents();return n.Protocol+"//"+n.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new $n(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!Qn(e)}}const Xn={"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},Zn={metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},er=new Set;function tr(e,t,n,r){if(null===r||void 0===r||r.trace("getAliasesFromMetadata called with source: ".concat(n)),e&&t){const o=nr(t,e);if(o)return null===r||void 0===r||r.trace("getAliasesFromMetadata: found cloud discovery metadata in ".concat(n,", returning aliases")),o.aliases;null===r||void 0===r||r.trace("getAliasesFromMetadata: did not find cloud discovery metadata in ".concat(n))}return null}function nr(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(r.aliases.includes(t))return r}return null}Zn.metadata.forEach(e=>{e.aliases.forEach(e=>{er.add(e)})});const rr="cache_quota_exceeded",or="cache_error_unknown",ir={[rr]:"Exceeded cache storage capacity.",[or]:"Unexpected error occurred when using cache storage."};class ar extends ht{constructor(e,t){const n=t||(ir[e]?ir[e]:ir[or]);super("".concat(e,": ").concat(n)),Object.setPrototypeOf(this,ar.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=n}}function sr(e){return e instanceof Error?"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name||e.message.includes("exceeded the quota")?new ar(rr):new ar(e.name,e.message):new ar(or)}class lr{constructor(e,t,n,r,o){this.clientId=e,this.cryptoImpl=t,this.commonLogger=n.clone(cn,un),this.staticAuthorityOptions=o,this.performanceClient=r}getAllAccounts(e,t){return this.buildTenantProfiles(this.getAccountsFilteredBy(e,t),t,e)}getAccountInfoFilteredBy(e,t){if(0===Object.keys(e).length||Object.values(e).every(e=>!e))return this.commonLogger.warning("getAccountInfoFilteredBy: Account filter is empty or invalid, returning null"),null;const n=this.getAllAccounts(e,t);if(n.length>1){return n.sort(e=>e.idTokenClaims?-1:1)[0]}return 1===n.length?n[0]:null}getBaseAccountInfo(e,t){const n=this.getAccountsFilteredBy(e,t);return n.length>0?n[0].getAccountInfo():null}buildTenantProfiles(e,t,n){return e.flatMap(e=>this.getTenantProfilesFromAccountEntity(e,t,null===n||void 0===n?void 0:n.tenantId,n))}getTenantedAccountInfoByFilter(e,t,n,r,o){let i,a=null;if(o&&!this.tenantProfileMatchesFilter(n,o))return null;const s=this.getIdToken(e,r,t,n.tenantId);return s&&(i=Kn(s.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(i,o))?null:(a=Bn(e,n,i,null===s||void 0===s?void 0:s.secret),a)}getTenantProfilesFromAccountEntity(e,t,n,r){const o=e.getAccountInfo();let i=o.tenantProfiles||new Map;const a=this.getTokenKeys();if(n){const e=i.get(n);if(!e)return[];i=new Map([[n,e]])}const s=[];return i.forEach(e=>{const n=this.getTenantedAccountInfoByFilter(o,a,e,t,r);n&&s.push(n)}),s}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId))&&((!t.name||e.name===t.name)&&(void 0===t.isHomeTenant||e.isHomeTenant===t.isHomeTenant))}idTokenClaimsMatchTenantProfileFilter(e,t){if(t){if(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId))return!1;if(t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint))return!1;if(t.username&&!this.matchUsername(e.preferred_username,t.username))return!1;if(t.name&&!this.matchName(e,t.name))return!1;if(t.sid&&!this.matchSid(e,t.sid))return!1}return!0}async saveCacheRecord(e,t,n){if(!e)throw sn(zt);try{e.account&&await this.setAccount(e.account,t),e.idToken&&!1!==(null===n||void 0===n?void 0:n.idToken)&&await this.setIdTokenCredential(e.idToken,t),e.accessToken&&!1!==(null===n||void 0===n?void 0:n.accessToken)&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&!1!==(null===n||void 0===n?void 0:n.refreshToken)&&await this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata,t)}catch(o){var r;throw null===(r=this.commonLogger)||void 0===r||r.error("CacheManager.saveCacheRecord: failed"),o instanceof ht?o:sr(o)}}async saveAccessToken(e,t){const n={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},r=this.getTokenKeys(),o=Dn.fromString(e.target);r.accessToken.forEach(e=>{if(!this.accessTokenKeyMatchesFilter(e,n,!1))return;const r=this.getAccessTokenCredential(e,t);if(r&&this.credentialMatchesFilter(r,n)){Dn.fromString(r.target).intersectingScopeSets(o)&&this.removeAccessToken(e,t)}}),await this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e,t){const n=this.getAccountKeys(),r=[];return n.forEach(n=>{var o;const i=this.getAccount(n,t);if(!i)return;if(e.homeAccountId&&!this.matchHomeAccountId(i,e.homeAccountId))return;if(e.username&&!this.matchUsername(i.username,e.username))return;if(e.environment&&!this.matchEnvironment(i,e.environment))return;if(e.realm&&!this.matchRealm(i,e.realm))return;if(e.nativeAccountId&&!this.matchNativeAccountId(i,e.nativeAccountId))return;if(e.authorityType&&!this.matchAuthorityType(i,e.authorityType))return;const a={localAccountId:null===e||void 0===e?void 0:e.localAccountId,name:null===e||void 0===e?void 0:e.name},s=null===(o=i.tenantProfiles)||void 0===o?void 0:o.filter(e=>this.tenantProfileMatchesFilter(e,a));s&&0===s.length||r.push(i)}),r}credentialMatchesFilter(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"===typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===Pe.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===De.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0}getAppMetadataFilteredBy(e){const t=this.getKeys(),n={};return t.forEach(t=>{if(!this.isAppMetadata(t))return;const r=this.getAppMetadata(t);r&&(e.environment&&!this.matchEnvironment(r,e.environment)||e.clientId&&!this.matchClientId(r,e.clientId)||(n[t]=r))}),n}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let n=null;return t.forEach(t=>{if(!this.isAuthorityMetadata(t)||-1===t.indexOf(this.clientId))return;const r=this.getAuthorityMetadata(t);r&&-1!==r.aliases.indexOf(e)&&(n=r)}),n}removeAllAccounts(e){this.getAllAccounts({},e).forEach(t=>{this.removeAccount(t,e)})}removeAccount(e,t){this.removeAccountContext(e,t);this.getAccountKeys().filter(t=>t.includes(e.homeAccountId)&&t.includes(e.environment)).forEach(e=>{this.removeItem(e,t),this.performanceClient.incrementFields({accountsRemoved:1},t)})}removeAccountContext(e,t){const n=this.getTokenKeys(),r=t=>t.includes(e.homeAccountId)&&t.includes(e.environment);n.idToken.filter(r).forEach(e=>{this.removeIdToken(e,t)}),n.accessToken.filter(r).forEach(e=>{this.removeAccessToken(e,t)}),n.refreshToken.filter(r).forEach(e=>{this.removeRefreshToken(e,t)})}removeAccessToken(e,t){const n=this.getAccessTokenCredential(e,t);if(this.removeItem(e,t),this.performanceClient.incrementFields({accessTokensRemoved:1},t),!n||n.credentialType.toLowerCase()!==Pe.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()||n.tokenType!==De.POP)return;const r=n.keyId;r&&this.cryptoImpl.removeTokenBindingKey(r).catch(()=>{var e;this.commonLogger.error("Failed to remove token binding key ".concat(r),t),null===(e=this.performanceClient)||void 0===e||e.incrementFields({removeTokenBindingKeyFailure:1},t)})}removeAppMetadata(e){return this.getKeys().forEach(t=>{this.isAppMetadata(t)&&this.removeItem(t,e)}),!0}getIdToken(e,t,n,r,o){this.commonLogger.trace("CacheManager - getIdToken called");const i={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:Pe.ID_TOKEN,clientId:this.clientId,realm:r},a=this.getIdTokensByFilter(i,t,n),s=a.size;if(s<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(s>1){let n=a;if(!r){const t=new Map;a.forEach((n,r)=>{n.realm===e.tenantId&&t.set(r,n)});const r=t.size;if(r<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),a.values().next().value;if(1===r)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),t.values().next().value;n=t}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),n.forEach((e,n)=>{this.removeIdToken(n,t)}),o&&t&&o.addFields({multiMatchedID:a.size},t),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),a.values().next().value}getIdTokensByFilter(e,t,n){const r=n&&n.idToken||this.getTokenKeys().idToken,o=new Map;return r.forEach(n=>{if(!this.idTokenKeyMatchesFilter(n,c({clientId:this.clientId},e)))return;const r=this.getIdTokenCredential(n,t);r&&this.credentialMatchesFilter(r,e)&&o.set(n,r)}),o}idTokenKeyMatchesFilter(e,t){const n=e.toLowerCase();return(!t.clientId||-1!==n.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==n.indexOf(t.homeAccountId.toLowerCase()))}removeIdToken(e,t){this.removeItem(e,t)}removeRefreshToken(e,t){this.removeItem(e,t)}getAccessToken(e,t,n,r){const o=t.correlationId;this.commonLogger.trace("CacheManager - getAccessToken called",o);const i=Dn.createSearchScopes(t.scopes),a=t.authenticationScheme||De.BEARER,s=a&&a.toLowerCase()!==De.BEARER.toLowerCase()?Pe.ACCESS_TOKEN_WITH_AUTH_SCHEME:Pe.ACCESS_TOKEN,l={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:s,clientId:this.clientId,realm:r||e.tenantId,target:i,tokenType:a,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},c=n&&n.accessToken||this.getTokenKeys().accessToken,u=[];c.forEach(e=>{if(this.accessTokenKeyMatchesFilter(e,l,!0)){const t=this.getAccessTokenCredential(e,o);t&&this.credentialMatchesFilter(t,l)&&u.push(t)}});const d=u.length;return d<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found",o),null):d>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them",o),u.forEach(e=>{this.removeAccessToken(this.generateCredentialKey(e),o)}),this.performanceClient.addFields({multiMatchedAT:u.length},o),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token",o),u[0])}accessTokenKeyMatchesFilter(e,t,n){const r=e.toLowerCase();if(t.clientId&&-1===r.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===r.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===r.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===r.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target){const e=t.target.asArray();for(let t=0;t<e.length;t++){if(n&&!r.includes(e[t].toLowerCase()))return!1;if(!n&&r.includes(e[t].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e,t){const n=this.getTokenKeys(),r=[];return n.accessToken.forEach(n=>{if(!this.accessTokenKeyMatchesFilter(n,e,!0))return;const o=this.getAccessTokenCredential(n,t);o&&this.credentialMatchesFilter(o,e)&&r.push(o)}),r}getRefreshToken(e,t,n,r,o){this.commonLogger.trace("CacheManager - getRefreshToken called");const i=t?_e:void 0,a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:Pe.REFRESH_TOKEN,clientId:this.clientId,familyId:i},s=r&&r.refreshToken||this.getTokenKeys().refreshToken,l=[];s.forEach(e=>{if(this.refreshTokenKeyMatchesFilter(e,a)){const t=this.getRefreshTokenCredential(e,n);t&&this.credentialMatchesFilter(t,a)&&l.push(t)}});const c=l.length;return c<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(c>1&&o&&n&&o.addFields({multiMatchedRT:c},n),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),l[0])}refreshTokenKeyMatchesFilter(e,t){const n=e.toLowerCase();return(!t.familyId||-1!==n.indexOf(t.familyId.toLowerCase()))&&(!(!t.familyId&&t.clientId&&-1===n.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==n.indexOf(t.homeAccountId.toLowerCase())))}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},n=this.getAppMetadataFilteredBy(t),r=Object.keys(n).map(e=>n[e]),o=r.length;if(o<1)return null;if(o>1)throw sn(_t);return r[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!(!t||t.familyId!==_e)}matchHomeAccountId(e,t){return!("string"!==typeof e.homeAccountId||t!==e.homeAccountId)}matchLocalAccountIdFromTokenClaims(e,t){return t===(e.oid||e.sub)}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){var n;return!(t.toLowerCase()!==(null===(n=e.name)||void 0===n?void 0:n.toLowerCase()))}matchUsername(e,t){return!(!e||"string"!==typeof e||(null===t||void 0===t?void 0:t.toLowerCase())!==e.toLowerCase())}matchUserAssertionHash(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const n=function(e,t){let n;const r=e.canonicalAuthority;if(r){var o;const i=new $n(r).getUrlComponents().HostNameAndPort;n=tr(i,null===(o=e.cloudDiscoveryMetadata)||void 0===o?void 0:o.metadata,Me,t)||tr(i,Zn.metadata,Le,t)||e.knownAuthorities}return n||[]}(this.staticAuthorityOptions,this.commonLogger);if(n.includes(t)&&n.includes(e.environment))return!0}const n=this.getAuthorityMetadataByAlias(t);return!!(n&&n.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!(!e.clientId||t!==e.clientId)}matchFamilyId(e,t){return!(!e.familyId||t!==e.familyId)}matchRealm(e,t){var n;return!((null===(n=e.realm)||void 0===n?void 0:n.toLowerCase())!==t.toLowerCase())}matchNativeAccountId(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||(e.preferred_username===t||e.upn===t)}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!(!e.authorityType||t.toLowerCase()!==e.authorityType.toLowerCase())}matchTarget(e,t){if(e.credentialType!==Pe.ACCESS_TOKEN&&e.credentialType!==Pe.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)return!1;return Dn.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!(!e.tokenType||e.tokenType!==t)}matchKeyId(e,t){return!(!e.keyId||e.keyId!==t)}isAppMetadata(e){return-1!==e.indexOf(Ee)}isAuthorityMetadata(e){return-1!==e.indexOf(Ne)}generateAuthorityMetadataCacheKey(e){return"".concat(Ne,"-").concat(this.clientId,"-").concat(e)}static toObject(e,t){for(const n in t)e[n]=t[n];return e}}class cr extends lr{async setAccount(){throw sn(nn)}getAccount(){throw sn(nn)}async setIdTokenCredential(){throw sn(nn)}getIdTokenCredential(){throw sn(nn)}async setAccessTokenCredential(){throw sn(nn)}getAccessTokenCredential(){throw sn(nn)}async setRefreshTokenCredential(){throw sn(nn)}getRefreshTokenCredential(){throw sn(nn)}setAppMetadata(){throw sn(nn)}getAppMetadata(){throw sn(nn)}setServerTelemetry(){throw sn(nn)}getServerTelemetry(){throw sn(nn)}setAuthorityMetadata(){throw sn(nn)}getAuthorityMetadata(){throw sn(nn)}getAuthorityMetadataKeys(){throw sn(nn)}setThrottlingCache(){throw sn(nn)}getThrottlingCache(){throw sn(nn)}removeItem(){throw sn(nn)}getKeys(){throw sn(nn)}getAccountKeys(){throw sn(nn)}getTokenKeys(){throw sn(nn)}generateCredentialKey(){throw sn(nn)}generateAccountKey(){throw sn(nn)}}const ur="acquireTokenByCode",dr="acquireTokenByRefreshToken",hr="acquireTokenSilent",gr="acquireTokenSilentAsync",fr="acquireTokenPopup",mr="acquireTokenPreRedirect",pr="acquireTokenRedirect",yr="cryptoOptsGetPublicKeyThumbprint",vr="cryptoOptsSignJwt",br="silentCacheClientAcquireToken",wr="silentIframeClientAcquireToken",kr="awaitConcurrentIframe",Cr="silentRefreshClientAcquireToken",Sr="ssoSilent",xr="standardInteractionClientGetDiscoveredAuthority",Ar="nativeInteractionClientAcquireToken",Tr="networkClientSendPostRequestAsync",Ir="refreshTokenClientExecutePostToTokenEndpoint",Pr="authorizationCodeClientExecutePostToTokenEndpoint",Er="refreshTokenClientExecuteTokenRequest",_r="refreshTokenClientAcquireToken",Nr="refreshTokenClientAcquireTokenWithCachedRefreshToken",Rr="refreshTokenClientAcquireTokenByRefreshToken",Mr="refreshTokenClientCreateTokenRequestBody",Or="acquireTokenFromCache",jr="silentFlowClientAcquireCachedToken",Lr="silentFlowClientGenerateResultFromCacheRecord",qr="acquireTokenBySilentIframe",Dr="initializeBaseRequest",zr="initializeSilentRequest",Fr="initializeClientApplication",Ur="initializeCache",Hr="silentIframeClientTokenHelper",Br="silentHandlerInitiateAuthRequest",Kr="silentHandlerMonitorIframeForHash",Wr="silentHandlerLoadFrame",Vr="silentHandlerLoadFrameSync",Gr="standardInteractionClientCreateAuthCodeClient",Qr="standardInteractionClientGetClientConfiguration",Yr="standardInteractionClientInitializeAuthorizationRequest",Jr="getAuthCodeUrl",$r="getStandardParams",Xr="handleCodeResponseFromServer",Zr="handleCodeResponse",eo="handleResponseEar",to="handleResponsePlatformBroker",no="handleResponseCode",ro="updateTokenEndpointAuthority",oo="authClientAcquireToken",io="authClientExecuteTokenRequest",ao="authClientCreateTokenRequestBody",so="popTokenGenerateCnf",lo="popTokenGenerateKid",co="handleServerTokenResponse",uo="deserializeResponse",ho="authorityFactoryCreateDiscoveredInstance",go="authorityResolveEndpointsAsync",fo="authorityGetCloudDiscoveryMetadataFromNetwork",mo="authorityUpdateCloudDiscoveryMetadata",po="authorityGetEndpointMetadataFromNetwork",yo="authorityUpdateEndpointMetadata",vo="authorityUpdateMetadataWithRegionalInformation",bo="regionDiscoveryDetectRegion",wo="regionDiscoveryGetRegionFromIMDS",ko="regionDiscoveryGetCurrentVersion",Co="acquireTokenByCodeAsync",So="handleRedirectPromise",xo="handleNativeRedirectPromise",Ao="nativeMessageHandlerHandshake",To="removeHiddenIframe",Io="clearTokensAndKeysWithClaims",Po="cacheManagerGetRefreshToken",Eo="importExistingCache",_o="setUserData",No="localStorageUpdated",Ro="generatePkceCodes",Mo="generateCodeVerifier",Oo="generateCodeChallengeFromVerifier",jo="sha256Digest",Lo="getRandomValues",qo="generateHKDF",Do="generateBaseKey",zo="base64Decode",Fo="urlEncodeArr",Uo="encrypt",Ho="decrypt",Bo="generateEarKey",Ko="decryptEarResponse",Wo=(new Map([[ur,"ATByCode"],[dr,"ATByRT"],[hr,"ATS"],[gr,"ATSAsync"],[fr,"ATPopup"],[pr,"ATRedirect"],[yr,"CryptoGetPKThumb"],[vr,"CryptoSignJwt"],[br,"SltCacheClientAT"],[wr,"SltIframeClientAT"],[Cr,"SltRClientAT"],[Sr,"SsoSlt"],[xr,"StdIntClientGetDiscAuth"],["fetchAccountIdWithNativeBroker","FetchAccIdWithNtvBroker"],[Ar,"NtvIntClientAT"],["baseClientCreateTokenRequestHeaders","BaseClientCreateTReqHead"],[Tr,"NetClientSendPost"],[Ir,"RTClientExecPost"],[Pr,"AuthCodeClientExecPost"],["brokerHandshake","BrokerHandshake"],["acquireTokenByRefreshTokenInBroker","ATByRTInBroker"],["acquireTokenByBroker","ATByBroker"],[Er,"RTClientExecTReq"],[_r,"RTClientAT"],[Nr,"RTClientATWithCachedRT"],[Rr,"RTClientATByRT"],[Mr,"RTClientCreateTReqBody"],[Or,"ATFromCache"],[jr,"SltFlowClientATCached"],[Lr,"SltFlowClientGenResFromCache"],[qr,"ATBySltIframe"],[Dr,"InitBaseReq"],[zr,"InitSltReq"],[Fr,"InitClientApplication"],[Ur,"InitCache"],[Eo,"importCache"],[_o,"setUserData"],[No,"localStorageUpdated"],[Hr,"SIClientTHelper"],[Br,"SHandlerInitAuthReq"],[Kr,"SltHandlerMonitorIframeForHash"],[Wr,"SHandlerLoadFrame"],[Vr,"SHandlerLoadFrameSync"],[Gr,"StdIntClientCreateAuthCodeClient"],[Qr,"StdIntClientGetClientConf"],[Yr,"StdIntClientInitAuthReq"],[Jr,"GetAuthCodeUrl"],[Xr,"HandleCodeResFromServer"],[Zr,"HandleCodeResp"],[eo,"HandleRespEar"],[no,"HandleRespCode"],[to,"HandleRespPlatBroker"],[ro,"UpdTEndpointAuth"],[oo,"AuthClientAT"],[io,"AuthClientExecTReq"],[ao,"AuthClientCreateTReqBody"],[so,"PopTGenCnf"],[lo,"PopTGenKid"],[co,"HandleServerTRes"],[uo,"DeserializeRes"],[ho,"AuthFactCreateDiscInst"],[go,"AuthResolveEndpointsAsync"],["authorityResolveEndpointsFromLocalSources","AuthResolveEndpointsFromLocal"],[fo,"AuthGetCDMetaFromNet"],[mo,"AuthUpdCDMeta"],[po,"AuthUpdCDMetaFromNet"],[yo,"AuthUpdEndpointMeta"],[vo,"AuthUpdMetaWithRegInfo"],[bo,"RegDiscDetectReg"],[wo,"RegDiscGetRegFromIMDS"],[ko,"RegDiscGetCurrentVer"],[Co,"ATByCodeAsync"],["getEndpointMetadataFromNetwork","GetEndpointMetaFromNet"],["getCloudDiscoveryMetadataFromNetworkMeasurement","GetCDMetaFromNet"],[So,"HandleRedirectPromise"],[xo,"HandleNtvRedirectPromise"],["updateCloudDiscoveryMetadataMeasurement","UpdateCDMeta"],["usernamePasswordClientAcquireToken","UserPassClientAT"],[Ao,"NtvMsgHandlerHandshake"],["nativeGenerateAuthResult","NtvGenAuthRes"],[To,"RemoveHiddenIframe"],[Io,"ClearTAndKeysWithClaims"],[Po,"CacheManagerGetRT"],[Ro,"GenPkceCodes"],[Mo,"GenCodeVerifier"],[Oo,"GenCodeChallengeFromVerifier"],[jo,"Sha256Digest"],[Lo,"GetRandomValues"],[qo,"genHKDF"],[Do,"genBaseKey"],[zo,"b64Decode"],[Fo,"urlEncArr"],[Uo,"encrypt"],[Ho,"decrypt"],[Bo,"genEarKey"],[Ko,"decryptEarResp"]]),1);new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status","multiMatchedAT","multiMatchedID","multiMatchedRT","unencryptedCacheCount","encryptedCacheExpiredCount","oldAccountCount","oldAccessCount","oldIdCount","oldRefreshCount","currAccountCount","currAccessCount","currIdCount","currRefreshCount","expiredCacheRemovedCount","upgradedCacheCount"]);class Vo{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class Go{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:Wo,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new Vo}}startPerformanceMeasurement(){return new Vo}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}const Qo={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},Yo={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:rt.Info,correlationId:H.EMPTY_STRING},Jo={claimsBasedCachingEnabled:!1},$o={async sendGetRequestAsync(){throw sn(nn)},async sendPostRequestAsync(){throw sn(nn)}},Xo={sku:H.SKU,version:un,cpu:H.EMPTY_STRING,os:H.EMPTY_STRING},Zo={clientSecret:H.EMPTY_STRING,clientAssertion:void 0},ei={azureCloudInstance:lt,tenant:"".concat(H.DEFAULT_COMMON_TENANT)},ti={application:{appName:"",appVersion:""}};function ni(e){return e.authOptions.authority.options.protocolMode===at}const ri={sendGetRequestAsync:()=>Promise.reject(sn(nn)),sendPostRequestAsync:()=>Promise.reject(sn(nn))},oi="invalid_grant",ii=483,ai=600,si="msal",li=30,ci="msal.js.browser",ui="53ee284d-920a-4b59-9d30-a60315b26836",di="ppnbnpeolgkicgegkbkbjmhlideopiji",hi="MATS",gi="MicrosoftEntra",fi="DOM API",mi="get-token-and-sign-out",pi="PlatformAuthDOMHandler",yi="PlatformAuthExtensionHandler",vi="Handshake",bi="HandshakeResponse",wi="GetToken",ki="Response",Ci="localStorage",Si="sessionStorage",xi="memoryStorage",Ai="GET",Ti="POST",Ii="signin",Pi="signout",Ei="request.origin",_i="urlHash",Ni="request.params",Ri="code.verifier",Mi="interaction.status",Oi="request.native",ji="wrapper.sku",Li="wrapper.version",qi=861,Di=862,zi=863,Fi=865,Ui=866,Hi=61,Bi=961,Ki=962;var Wi;!function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(Wi||(Wi={}));const Vi={scopes:$},Gi="msal.db",Qi="".concat(Gi,".keys"),Yi=0,Ji=1,$i=2,Xi=3,Zi=4,ea=5,ta=[Yi,ea,Zi],na="pkce_not_created",ra="ear_jwk_empty",oa="ear_jwe_empty",ia="crypto_nonexistent",aa="empty_navigate_uri",sa="hash_empty_error",la="no_state_in_hash",ca="hash_does_not_contain_known_properties",ua="unable_to_parse_state",da="state_interaction_type_mismatch",ha="interaction_in_progress",ga="popup_window_error",fa="empty_window_error",ma="user_cancelled",pa="monitor_popup_timeout",ya="monitor_window_timeout",va="redirect_in_iframe",ba="block_iframe_reload",wa="block_nested_popups",ka="iframe_closed_prematurely",Ca="silent_logout_unsupported",Sa="no_account_error",xa="silent_prompt_value_error",Aa="no_token_request_cache_error",Ta="unable_to_parse_token_request_cache_error",Ia="auth_request_not_set_error",Pa="invalid_cache_type",Ea="non_browser_environment",_a="database_not_open",Na="no_network_connectivity",Ra="post_request_failed",Ma="get_request_failed",Oa="failed_to_parse_response",ja="unable_to_load_token",La="crypto_key_not_found",qa="auth_code_required",Da="auth_code_or_nativeAccountId_required",za="spa_code_and_nativeAccountId_present",Fa="database_unavailable",Ua="unable_to_acquire_token_from_native_platform",Ha="native_handshake_timeout",Ba="native_extension_not_installed",Ka="native_connection_not_established",Wa="uninitialized_public_client_application",Va="native_prompt_not_supported",Ga="invalid_base64_string",Qa="invalid_pop_token_request",Ya="failed_to_build_headers",Ja="failed_to_parse_headers",$a="failed_to_decrypt_ear_response",Xa="timed_out",Za="For more visit: aka.ms/msaljs/browser-errors",es={[na]:"The PKCE code challenge and verifier could not be generated.",[ra]:"No EAR encryption key provided. This is unexpected.",[oa]:"Server response does not contain ear_jwe property. This is unexpected.",[ia]:"The crypto object or function is not available.",[aa]:"Navigation URI is empty. Please check stack trace for more info.",[sa]:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ".concat(Za),[la]:"Hash does not contain state. Please verify that the request originated from msal.",[ca]:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ".concat(Za),[ua]:"Unable to parse state. Please verify that the request originated from msal.",[da]:"Hash contains state but the interaction type does not match the caller.",[ha]:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ".concat(Za),[ga]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[fa]:"window.open returned null or undefined window object.",[ma]:"User cancelled the flow.",[pa]:"Token acquisition in popup failed due to timeout.  ".concat(Za),[ya]:"Token acquisition in iframe failed due to timeout.  ".concat(Za),[va]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[ba]:"Request was blocked inside an iframe because MSAL detected an authentication response.  ".concat(Za),[wa]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[ka]:"The iframe being monitored was closed prematurely.",[Ca]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[Sa]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[xa]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[Aa]:"No token request found in cache.",[Ta]:"The cached token request could not be parsed.",[Ia]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[Pa]:"Invalid cache type",[Ea]:"Login and token requests are not supported in non-browser environments.",[_a]:"Database is not open!",[Na]:"No network connectivity. Check your internet connection.",[Ra]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[Ma]:"Network request failed. Please check the network trace to determine root cause.",[Oa]:"Failed to parse network response. Check network trace.",[ja]:"Error loading token to cache.",[La]:"Cryptographic Key or Keypair not found in browser storage.",[qa]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[Da]:"An authorization code or nativeAccountId must be provided to this flow.",[za]:"Request cannot contain both spa code and native account id.",[Fa]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[Ua]:"Unable to acquire token from native platform.  ".concat(Za),[Ha]:"Timed out while attempting to establish connection to browser extension",[Ba]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[Ka]:"Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ".concat(Za),[Wa]:"You must call and await the initialize function before attempting to call any other MSAL API.  ".concat(Za),[Va]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[Ga]:"Invalid base64 encoded string.",[Qa]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[Ya]:"Failed to build request headers object.",[Ja]:"Failed to parse response headers",[$a]:"Failed to decrypt ear response",[Xa]:"The request timed out."};class ts extends ht{constructor(e,t){super(e,es[e],t),Object.setPrototypeOf(this,ts.prototype),this.name="BrowserAuthError"}}function ns(e,t){return new ts(e,t)}class rs{navigateInternal(e,t){return rs.defaultNavigateWindow(e,t)}navigateExternal(e,t){return rs.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((e,n)=>{setTimeout(()=>{n(ns(Xa,"failed_to_redirect"))},t.timeout)})}}class os extends ht{constructor(e,t,n){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,os.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=n}}function is(e,t,n,r){return e.errorMessage="".concat(e.errorMessage,", additionalErrorInfo: error.name:").concat(null===r||void 0===r?void 0:r.name,", error.message:").concat(null===r||void 0===r?void 0:r.message),new os(e,t,n)}class as{async sendGetRequestAsync(e,t){let n,r={},o=0;const i=ss(t);try{n=await fetch(e,{method:Ai,headers:i})}catch(a){throw is(ns(window.navigator.onLine?Ma:Na),void 0,void 0,a)}r=ls(n.headers);try{return o=n.status,{headers:r,body:await n.json(),status:o}}catch(a){throw is(ns(Oa),o,r,a)}}async sendPostRequestAsync(e,t){const n=t&&t.body||"",r=ss(t);let o,i=0,a={};try{o=await fetch(e,{method:Ti,headers:r,body:n})}catch(s){throw is(ns(window.navigator.onLine?Ra:Na),void 0,void 0,s)}a=ls(o.headers);try{return i=o.status,{headers:a,body:await o.json(),status:i}}catch(s){throw is(ns(Oa),i,a,s)}}}function ss(e){try{const t=new Headers;if(!e||!e.headers)return t;const n=e.headers;return Object.entries(n).forEach(e=>{let[n,r]=e;t.append(n,r)}),t}catch(t){throw is(ns(Ya),void 0,void 0,t)}}function ls(e){try{const t={};return e.forEach((e,n)=>{t[n]=e}),t}catch(t){throw ns(Ja)}}const cs="client_id",us="redirect_uri",ds="token_type",hs="req_cnf",gs="return_spa_code",fs="x-client-xtra-sku",ms="brk_client_id",ps="brk_redirect_uri",ys="instance_aware";function vs(e,t,n){if(!t)return;const r=e.get(cs);r&&e.has(ms)&&(null===n||void 0===n||n.addFields({embeddedClientId:r,embeddedRedirectUri:e.get(us)},t))}function bs(e,t){e.set("response_type",t)}function ws(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:$;!n||r.includes("openid")||t.includes("openid")||r.push("openid");const o=n?[...t||[],...r]:t||[],i=new Dn(o);e.set("scope",i.printScopes())}function ks(e,t){e.set(cs,t)}function Cs(e,t){e.set(us,t)}function Ss(e,t){e.set("login_hint",t)}function xs(e,t){e.set(ne,"UPN:".concat(t))}function As(e,t){e.set(ne,"Oid:".concat(t.uid,"@").concat(t.utid))}function Ts(e,t){e.set("sid",t)}function Is(e,t,n){const r=Fs(t,n);try{JSON.parse(r)}catch(o){throw Ln(yn)}e.set("claims",r)}function Ps(e,t){e.set("client-request-id",t)}function Es(e,t){e.set("x-client-SKU",t.sku),e.set("x-client-VER",t.version),t.os&&e.set("x-client-OS",t.os),t.cpu&&e.set("x-client-CPU",t.cpu)}function _s(e,t){null!==t&&void 0!==t&&t.appName&&e.set("x-app-name",t.appName),null!==t&&void 0!==t&&t.appVersion&&e.set("x-app-ver",t.appVersion)}function Ns(e,t){t&&e.set("state",t)}function Rs(e,t,n){if(!t||!n)throw Ln(kn);e.set("code_challenge",t),e.set("code_challenge_method",n)}function Ms(e,t){e.set("client_secret",t)}function Os(e,t){t&&e.set("client_assertion",t)}function js(e,t){t&&e.set("client_assertion_type",t)}function Ls(e,t){e.set("grant_type",t)}function qs(e){e.set("client_info","1")}function Ds(e){e.has(ys)||e.set(ys,"true")}function zs(e,t){Object.entries(t).forEach(t=>{let[n,r]=t;!e.has(n)&&r&&e.set(n,r)})}function Fs(e,t){let n;if(e)try{n=JSON.parse(e)}catch(r){throw Ln(yn)}else n={};return t&&t.length>0&&(n.hasOwnProperty(ce)||(n[ce]={}),n[ce][ue]={values:t}),JSON.stringify(n)}function Us(e,t){t&&(e.set(ds,De.POP),e.set(hs,t))}function Hs(e,t){t&&(e.set(ds,De.SSH),e.set(hs,t))}function Bs(e,t){e.set("x-client-current-telemetry",t.generateCurrentRequestHeaderValue()),e.set("x-client-last-telemetry",t.generateLastRequestHeaderValue())}function Ks(e){e.set("x-ms-lib-capability",He)}function Ws(e,t,n){e.has(ms)||e.set(ms,t),e.has(ps)||e.set(ps,n)}function Vs(e){return encodeURIComponent(Qs(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function Gs(e){return Ys(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Qs(e){return Ys((new TextEncoder).encode(e))}function Ys(e){const t=Array.from(e,e=>String.fromCodePoint(e)).join("");return btoa(t)}function Js(e){return(new TextDecoder).decode($s(e))}function $s(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw ns(Ga)}const n=atob(t);return Uint8Array.from(n,e=>e.codePointAt(0)||0)}const Xs="AES-GCM",Zs="HKDF",el="SHA-256",tl=new Uint8Array([1,0,1]),nl="0123456789abcdef",rl=new Uint32Array(1),ol="raw",il="encrypt",al="decrypt",sl={name:"RSASSA-PKCS1-v1_5",hash:el,modulusLength:2048,publicExponent:tl};async function ll(e,t,n){null===t||void 0===t||t.addQueueMeasurement(jo,n);const r=(new TextEncoder).encode(e);return window.crypto.subtle.digest(el,r)}function cl(e){return window.crypto.getRandomValues(e)}function ul(){return window.crypto.getRandomValues(rl),rl[0]}function dl(){const e=Date.now(),t=1024*ul()+(1023&ul()),n=new Uint8Array(16),r=Math.trunc(t/2**30),o=t&2**30-1,i=ul();n[0]=e/2**40,n[1]=e/2**32,n[2]=e/2**24,n[3]=e/65536,n[4]=e/256,n[5]=e,n[6]=112|r>>>8,n[7]=r,n[8]=128|o>>>24,n[9]=o>>>16,n[10]=o>>>8,n[11]=o,n[12]=i>>>24,n[13]=i>>>16,n[14]=i>>>8,n[15]=i;let a="";for(let s=0;s<n.length;s++)a+=nl.charAt(n[s]>>>4),a+=nl.charAt(15&n[s]),3!==s&&5!==s&&7!==s&&9!==s||(a+="-");return a}async function hl(e){return window.crypto.subtle.exportKey("jwk",e)}async function gl(){const e=await ml(),t={alg:"dir",kty:"oct",k:Gs(new Uint8Array(e))};return Qs(JSON.stringify(t))}async function fl(e,t){const n=t.split(".");if(5!==n.length)throw ns($a,"jwe_length");const r=await async function(e){const t=Js(e),n=$s(JSON.parse(t).k);return window.crypto.subtle.importKey(ol,n,Xs,!1,[al])}(e).catch(()=>{throw ns($a,"import_key")});try{const e=(new TextEncoder).encode(n[0]),t=$s(n[2]),o=$s(n[3]),i=$s(n[4]),a=8*i.byteLength,s=new Uint8Array(o.length+i.length);s.set(o),s.set(i,o.length);const l=await window.crypto.subtle.decrypt({name:Xs,iv:t,tagLength:a,additionalData:e},r,s);return(new TextDecoder).decode(l)}catch(o){throw ns($a,"decrypt")}}async function ml(){const e=await window.crypto.subtle.generateKey({name:Xs,length:256},!0,[il,al]);return window.crypto.subtle.exportKey(ol,e)}async function pl(e){return window.crypto.subtle.importKey(ol,e,Zs,!1,["deriveKey"])}async function yl(e,t,n){return window.crypto.subtle.deriveKey({name:Zs,salt:t,hash:el,info:(new TextEncoder).encode(n)},e,{name:Xs,length:256},!1,[il,al])}async function vl(e,t,n){const r=(new TextEncoder).encode(t),o=window.crypto.getRandomValues(new Uint8Array(16)),i=await yl(e,o,n),a=await window.crypto.subtle.encrypt({name:Xs,iv:new Uint8Array(12)},i,r);return{data:Gs(new Uint8Array(a)),nonce:Gs(o)}}async function bl(e,t,n,r){const o=$s(r),i=await yl(e,$s(t),n),a=await window.crypto.subtle.decrypt({name:Xs,iv:new Uint8Array(12)},i,o);return(new TextDecoder).decode(a)}async function wl(e){const t=await ll(e);return Gs(new Uint8Array(t))}const kl="storage_not_supported",Cl="stubbed_public_client_application_called",Sl="in_mem_redirect_unavailable",xl={[kl]:"Given storage configuration option was not supported.",[Cl]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[Sl]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};class Al extends ht{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,Al.prototype)}}function Tl(e){return new Al(e,xl[e])}function Il(e){e.location.hash="","function"===typeof e.history.replaceState&&e.history.replaceState(null,"","".concat(e.location.origin).concat(e.location.pathname).concat(e.location.search))}function Pl(){return window.parent!==window}function El(){return"undefined"!==typeof window&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function _l(){if("undefined"!==typeof window&&window.opener&&window.opener!==window&&"string"===typeof window.name&&0===window.name.indexOf("".concat(si,".")))throw ns(wa)}function Nl(){if("undefined"===typeof window)throw ns(Ea)}function Rl(e){if(!e)throw ns(Wa)}function Ml(e){Nl(),function(){if($n.hashContainsKnownProperties(window.location.hash)&&Pl())throw ns(ba)}(),_l(),Rl(e)}function Ol(e,t){if(Ml(e),function(e){if(Pl()&&!e)throw ns(va)}(t.system.allowRedirectInIframe),t.cache.cacheLocation===xi&&!t.cache.storeAuthStateInCookie)throw Tl(Sl)}function jl(e){const t=document.createElement("link");t.rel="preconnect",t.href=new URL(e).origin,t.crossOrigin="anonymous",document.head.appendChild(t),window.setTimeout(()=>{try{document.head.removeChild(t)}catch(e){}},1e4)}const Ll=1e4;const ql="4.25.0",Dl="msal",zl="browser",Fl="".concat(Dl,".").concat(zl,".log.level"),Ul="".concat(Dl,".").concat(zl,".log.pii"),Hl=("".concat(Dl,".").concat(zl,".performance.enabled"),"".concat(Dl,".").concat(zl,".platform.auth.dom")),Bl="".concat(Dl,".version"),Kl="account.keys",Wl="token.keys";function Vl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return e<1?"".concat(Dl,".").concat(Kl):"".concat(Dl,".").concat(e,".").concat(Kl)}function Gl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t<1?"".concat(Dl,".").concat(Wl,".").concat(e):"".concat(Dl,".").concat(t,".").concat(Wl,".").concat(e)}class Ql{static loggerCallback(e,t){switch(e){case rt.Error:return void console.error(t);case rt.Info:return void console.info(t);case rt.Verbose:return void console.debug(t);case rt.Warning:return void console.warn(t);default:return void console.log(t)}}constructor(e){var t,n;let r;this.browserEnvironment="undefined"!==typeof window,this.config=function(e,t){let{auth:n,cache:r,system:o,telemetry:i}=e;const a={clientId:H.EMPTY_STRING,authority:"".concat(H.DEFAULT_AUTHORITY),knownAuthorities:[],cloudDiscoveryMetadata:H.EMPTY_STRING,authorityMetadata:H.EMPTY_STRING,redirectUri:"undefined"!==typeof window?El():"",postLogoutRedirectUri:H.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:it,OIDCOptions:{serverResponseType:be,defaultScopes:[H.OPENID_SCOPE,H.PROFILE_SCOPE,H.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:lt,tenant:H.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1,encodeExtraQueryParams:!1},s={cacheLocation:Si,cacheRetentionDays:5,temporaryCacheLocation:Si,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!r||r.cacheLocation!==Ci),claimsBasedCachingEnabled:!1},l={loggerCallback:()=>{},logLevel:rt.Info,piiLoggingEnabled:!1},u=c(c({},Qo),{},{loggerOptions:l,networkClient:t?new as:ri,navigationClient:new rs,loadFrameTimeout:0,windowHashTimeout:(null===o||void 0===o?void 0:o.loadFrameTimeout)||6e4,iframeHashTimeout:(null===o||void 0===o?void 0:o.loadFrameTimeout)||Ll,navigateFrameWait:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowPlatformBroker:!1,nativeBrokerHandshakeTimeout:(null===o||void 0===o?void 0:o.nativeBrokerHandshakeTimeout)||2e3,pollIntervalMilliseconds:li}),d=c(c(c({},u),o),{},{loggerOptions:(null===o||void 0===o?void 0:o.loggerOptions)||l}),h={application:{appName:H.EMPTY_STRING,appVersion:H.EMPTY_STRING},client:new Go};(null===n||void 0===n?void 0:n.protocolMode)!==at&&null!==n&&void 0!==n&&n.OIDCOptions&&new ot(d.loggerOptions).warning(JSON.stringify(Ln(En)));if(null!==n&&void 0!==n&&n.protocolMode&&n.protocolMode===at&&null!==d&&void 0!==d&&d.allowPlatformBroker)throw Ln(_n);return{auth:c(c(c({},a),n),{},{OIDCOptions:c(c({},a.OIDCOptions),null===n||void 0===n?void 0:n.OIDCOptions)}),cache:c(c({},s),r),system:d,telemetry:c(c({},h),i)}}(e,this.browserEnvironment);try{r=window[Si]}catch(u){}const o=null===(t=r)||void 0===t?void 0:t.getItem(Fl),i=null===(n=r)||void 0===n||null===(n=n.getItem(Ul))||void 0===n?void 0:n.toLowerCase(),a="true"===i||"false"!==i&&void 0,s=c({},this.config.system.loggerOptions),l=o&&Object.keys(rt).includes(o)?rt[o]:void 0;l&&(s.loggerCallback=Ql.loggerCallback,s.logLevel=l),void 0!==a&&(s.piiLoggingEnabled=a),this.logger=new ot(s,"@azure/msal-browser",ql),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}class Yl extends Ql{getModuleName(){return Yl.MODULE_NAME}getId(){return Yl.ID}async initialize(){return this.available="undefined"!==typeof window,this.available}}Yl.MODULE_NAME="",Yl.ID="StandardOperatingContext";const Jl="missing_kid_error",$l="missing_alg_error",Xl={[Jl]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[$l]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class Zl extends ht{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,Zl.prototype)}}function ec(e){return new Zl(e,Xl[e])}class tc{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw ec(Jl);if(!e.alg)throw ec($l);const t=new tc({typ:e.typ||nt,kid:e.kid,alg:e.alg});return JSON.stringify(t)}}class nc{constructor(){this.dbName=Gi,this.version=1,this.tableName=Qi,this.dbOpen=!1}async open(){return new Promise((e,t)=>{const n=window.indexedDB.open(this.dbName,this.version);n.addEventListener("upgradeneeded",e=>{e.target.result.createObjectStore(this.tableName)}),n.addEventListener("success",t=>{const n=t;this.db=n.target.result,this.dbOpen=!0,e()}),n.addEventListener("error",()=>t(ns(Fa)))})}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(ns(_a));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);r.addEventListener("success",e=>{const n=e;this.closeConnection(),t(n.target.result)}),r.addEventListener("error",e=>{this.closeConnection(),n(e)})})}async setItem(e,t){return await this.validateDbIsOpen(),new Promise((n,r)=>{if(!this.db)return r(ns(_a));const o=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);o.addEventListener("success",()=>{this.closeConnection(),n()}),o.addEventListener("error",e=>{this.closeConnection(),r(e)})})}async removeItem(e){return await this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(ns(_a));const r=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);r.addEventListener("success",()=>{this.closeConnection(),t()}),r.addEventListener("error",e=>{this.closeConnection(),n(e)})})}async getKeys(){return await this.validateDbIsOpen(),new Promise((e,t)=>{if(!this.db)return t(ns(_a));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();n.addEventListener("success",t=>{const n=t;this.closeConnection(),e(n.target.result)}),n.addEventListener("error",e=>{this.closeConnection(),t(e)})})}async containsKey(e){return await this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(ns(_a));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);r.addEventListener("success",e=>{const n=e;this.closeConnection(),t(1===n.target.result)}),r.addEventListener("error",e=>{this.closeConnection(),n(e)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,t)=>{const n=window.indexedDB.deleteDatabase(Gi),r=setTimeout(()=>t(!1),200);n.addEventListener("success",()=>(clearTimeout(r),e(!0))),n.addEventListener("blocked",()=>(clearTimeout(r),e(!0))),n.addEventListener("error",()=>(clearTimeout(r),t(!1)))})}}class rc{constructor(){this.cache=new Map}async initialize(){}getItem(e){return this.cache.get(e)||null}getUserData(e){return this.getItem(e)}setItem(e,t){this.cache.set(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach((t,n)=>{e.push(n)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}decryptData(){return Promise.resolve(null)}}class oc{constructor(e){this.inMemoryCache=new rc,this.indexedDBCache=new nc,this.logger=e}handleDatabaseAccessError(e){if(!(e instanceof ts&&e.errorCode===Fa))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(n){this.handleDatabaseAccessError(n)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(n){this.handleDatabaseAccessError(n)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(t){this.handleDatabaseAccessError(t)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(0===e.length)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(t){this.handleDatabaseAccessError(t)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(n){this.handleDatabaseAccessError(n)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}class ic{constructor(e,t,n){this.logger=e,function(e){if(!window)throw ns(Ea);if(!window.crypto)throw ns(ia);if(!e&&!window.crypto.subtle)throw ns(ia,"crypto_subtle_undefined")}(null!==n&&void 0!==n&&n),this.cache=new oc(this.logger),this.performanceClient=t}createNewGuid(){return dl()}base64Encode(e){return Qs(e)}base64Decode(e){return Js(e)}base64UrlEncode(e){return Vs(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){var t;const n=null===(t=this.performanceClient)||void 0===t?void 0:t.startMeasurement(yr,e.correlationId),r=await async function(e,t){return window.crypto.subtle.generateKey(sl,e,t)}(ic.EXTRACTABLE,ic.POP_KEY_USAGES),o=await hl(r.publicKey),i=ac({e:o.e,kty:o.kty,n:o.n}),a=await this.hashString(i),s=await hl(r.privateKey),l=await async function(e,t,n){return window.crypto.subtle.importKey("jwk",e,sl,t,n)}(s,!1,["sign"]);return await this.cache.setItem(a,{privateKey:l,publicKey:r.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),n&&n.end({success:!0}),a}async removeTokenBindingKey(e){await this.cache.removeItem(e);if(await this.cache.containsKey(e))throw sn(Jt)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error("Clearing keystore failed with error: ".concat(e.message)):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,n,r){var o;const i=null===(o=this.performanceClient)||void 0===o?void 0:o.startMeasurement(vr,r),a=await this.cache.getItem(t);if(!a)throw ns(La);const s=await hl(a.publicKey),l=ac(s),u=Vs(JSON.stringify({kid:t})),d=Vs(tc.getShrHeaderString(c(c({},null===n||void 0===n?void 0:n.header),{},{alg:s.alg,kid:u})));e.cnf={jwk:JSON.parse(l)};const h=Vs(JSON.stringify(e)),g="".concat(d,".").concat(h),f=(new TextEncoder).encode(g),m=await async function(e,t){return window.crypto.subtle.sign(sl,e,t)}(a.privateKey,f),p=Gs(new Uint8Array(m)),y="".concat(g,".").concat(p);return i&&i.end({success:!0}),y}async hashString(e){return wl(e)}}function ac(e){return JSON.stringify(e,Object.keys(e).sort())}ic.POP_KEY_USAGES=["sign","verify"],ic.EXTRACTABLE=!0;const sc=0,lc=1,cc=2,uc=3;const dc=(e,t,n,r,o)=>function(){n.trace("Executing function ".concat(t));const i=null===r||void 0===r?void 0:r.startMeasurement(t,o);if(o){const e=t+"CallCount";null===r||void 0===r||r.incrementFields({[e]:1},o)}try{const r=e(...arguments);return null===i||void 0===i||i.end({success:!0}),n.trace("Returning result from ".concat(t)),r}catch(a){n.trace("Error occurred in ".concat(t));try{n.trace(JSON.stringify(a))}catch(a){n.trace("Unable to print error message.")}throw null===i||void 0===i||i.end({success:!1},a),a}},hc=(e,t,n,r,o)=>function(){n.trace("Executing function ".concat(t));const i=null===r||void 0===r?void 0:r.startMeasurement(t,o);if(o){const e=t+"CallCount";null===r||void 0===r||r.incrementFields({[e]:1},o)}return null===r||void 0===r||r.setPreQueueTime(t,o),e(...arguments).then(e=>(n.trace("Returning result from ".concat(t)),null===i||void 0===i||i.end({success:!0}),e)).catch(e=>{n.trace("Error occurred in ".concat(t));try{n.trace(JSON.stringify(e))}catch(e){n.trace("Unable to print error message.")}throw null===i||void 0===i||i.end({success:!1},e),e})};class gc{constructor(e,t,n,r){this.networkInterface=e,this.logger=t,this.performanceClient=n,this.correlationId=r}async detectRegion(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(bo,this.correlationId);let r=e;if(r)t.region_source=Ve;else{const e=gc.IMDS_OPTIONS;try{const n=await hc(this.getRegionFromIMDS.bind(this),wo,this.logger,this.performanceClient,this.correlationId)(H.IMDS_VERSION,e);if(n.status===B&&(r=n.body,t.region_source=Ge),n.status===W){const n=await hc(this.getCurrentVersion.bind(this),ko,this.logger,this.performanceClient,this.correlationId)(e);if(!n)return t.region_source=We,null;const o=await hc(this.getRegionFromIMDS.bind(this),wo,this.logger,this.performanceClient,this.correlationId)(n,e);o.status===B&&(r=o.body,t.region_source=Ge)}}catch(o){return t.region_source=We,null}}return r||(t.region_source=We),r||null}async getRegionFromIMDS(e,t){var n;return null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(wo,this.correlationId),this.networkInterface.sendGetRequestAsync("".concat(H.IMDS_ENDPOINT,"?api-version=").concat(e,"&format=text"),t,H.IMDS_TIMEOUT)}async getCurrentVersion(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(ko,this.correlationId);try{const t=await this.networkInterface.sendGetRequestAsync("".concat(H.IMDS_ENDPOINT,"?format=json"),e);return t.status===W&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?t.body["newest-versions"][0]:null}catch(n){return null}}}function fc(){return Math.round((new Date).getTime()/1e3)}function mc(e){return e.getTime()/1e3}function pc(e){return e?new Date(1e3*Number(e)):new Date}function yc(e,t){const n=Number(e)||0;return fc()+t>n}function vc(e,t){const n=Number(e)+24*t*60*60*1e3;return Date.now()>n}function bc(e,t,n,r,o){return{credentialType:Pe.ID_TOKEN,homeAccountId:e,environment:t,clientId:r,secret:n,realm:o,lastUpdatedAt:Date.now().toString()}}function wc(e,t,n,r,o,i,a,s,l,c,u,d,h,g,f){var m,p;const y={homeAccountId:e,credentialType:Pe.ACCESS_TOKEN,secret:n,cachedAt:fc().toString(),expiresOn:a.toString(),extendedExpiresOn:s.toString(),environment:t,clientId:r,realm:o,target:i,tokenType:u||De.BEARER,lastUpdatedAt:Date.now().toString()};if(d&&(y.userAssertionHash=d),c&&(y.refreshOn=c.toString()),g&&(y.requestedClaims=g,y.requestedClaimsHash=f),(null===(m=y.tokenType)||void 0===m?void 0:m.toLowerCase())!==De.BEARER.toLowerCase())switch(y.credentialType=Pe.ACCESS_TOKEN_WITH_AUTH_SCHEME,y.tokenType){case De.POP:const e=Kn(n,l);if(null===e||void 0===e||null===(p=e.cnf)||void 0===p||!p.kid)throw sn(Qt);y.keyId=e.cnf.kid;break;case De.SSH:y.keyId=h}return y}function kc(e,t,n,r,o,i,a){const s={credentialType:Pe.REFRESH_TOKEN,homeAccountId:e,environment:t,clientId:r,secret:n,lastUpdatedAt:Date.now().toString()};return i&&(s.userAssertionHash=i),o&&(s.familyId=o),a&&(s.expiresOn=a.toString()),s}function Cc(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")}function Sc(e){return!!e&&(Cc(e)&&e.hasOwnProperty("realm")&&e.hasOwnProperty("target")&&(e.credentialType===Pe.ACCESS_TOKEN||e.credentialType===Pe.ACCESS_TOKEN_WITH_AUTH_SCHEME))}function xc(e){return!!e&&(Cc(e)&&e.credentialType===Pe.REFRESH_TOKEN)}function Ac(){return fc()+Re}function Tc(e,t,n){e.authorization_endpoint=t.authorization_endpoint,e.token_endpoint=t.token_endpoint,e.end_session_endpoint=t.end_session_endpoint,e.issuer=t.issuer,e.endpointsFromNetwork=n,e.jwks_uri=t.jwks_uri}function Ic(e,t,n){e.aliases=t.aliases,e.preferred_cache=t.preferred_cache,e.preferred_network=t.preferred_network,e.aliasesFromNetwork=n}function Pc(e){return e.expiresAt<=fc()}gc.IMDS_OPTIONS={headers:{Metadata:"true"}};class Ec{constructor(e,t,n,r,o,i,a,s){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=n,this.authorityOptions=r,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=o,this.performanceClient=a,this.correlationId=i,this.managedIdentity=s||!1,this.regionDiscovery=new gc(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(H.CIAM_AUTH_URL))return uc;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case H.ADFS:return lc;case H.DSTS:return cc}return sc}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new $n(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw sn(vt)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw sn(vt)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw sn(vt)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw sn($t);return this.replacePath(this.metadata.end_session_endpoint)}throw sn(vt)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw sn(vt)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw sn(vt)}canReplaceTenant(e){return 1===e.PathSegments.length&&!Ec.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===sc&&this.protocolMode!==at}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const n=new $n(this.metadata.canonical_authority).getUrlComponents(),r=n.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((e,o)=>{let i=r[o];if(0===o&&this.canReplaceTenant(n)){const e=new $n(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];i!==e&&(this.logger.verbose("Replacing tenant domain name ".concat(i," with id ").concat(e)),i=e)}e!==i&&(t=t.replace("/".concat(i,"/"),"/".concat(e,"/")))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===lc||this.protocolMode===at&&!this.isAliasOfKnownMicrosoftAuthority(e)?"".concat(this.canonicalAuthority,".well-known/openid-configuration"):"".concat(this.canonicalAuthority,"v2.0/.well-known/openid-configuration")}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){var e,t;null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(go,this.correlationId);const n=this.getCurrentMetadataEntity(),r=await hc(this.updateCloudDiscoveryMetadata.bind(this),mo,this.logger,this.performanceClient,this.correlationId)(n);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,n.preferred_network);const o=await hc(this.updateEndpointMetadata.bind(this),yo,this.logger,this.performanceClient,this.correlationId)(n);this.updateCachedMetadata(n,r,{source:o}),null===(t=this.performanceClient)||void 0===t||t.addFields({cloudDiscoverySource:r,authorityEndpointSource:o},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:Ac(),jwks_uri:""}),e}updateCachedMetadata(e,t,n){t!==Oe&&(null===n||void 0===n?void 0:n.source)!==Oe&&(e.expiresAt=Ac(),e.canonical_authority=this.canonicalAuthority);const r=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(r,e),this.metadata=e}async updateEndpointMetadata(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(yo,this.correlationId);const n=this.updateEndpointMetadataFromLocalSources(e);if(n){var r;if(n.source===Le)if(null!==(r=this.authorityOptions.azureRegionConfiguration)&&void 0!==r&&r.azureRegion&&n.metadata){Tc(e,await hc(this.updateMetadataWithRegionalInformation.bind(this),vo,this.logger,this.performanceClient,this.correlationId)(n.metadata),!1),e.canonical_authority=this.canonicalAuthority}return n.source}let o=await hc(this.getEndpointMetadataFromNetwork.bind(this),po,this.logger,this.performanceClient,this.correlationId)();var i;if(o)return null!==(i=this.authorityOptions.azureRegionConfiguration)&&void 0!==i&&i.azureRegion&&(o=await hc(this.updateMetadataWithRegionalInformation.bind(this),vo,this.logger,this.performanceClient,this.correlationId)(o)),Tc(e,o,!0),je;throw sn(wt,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),Tc(e,t,!1),{source:Me};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const t=this.getEndpointMetadataFromHardcodedValues();if(t)return Tc(e,t,!1),{source:Le,metadata:t};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const n=Pc(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!n?(this.logger.verbose("Found endpoint metadata in the cache."),{source:Oe}):(n&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new $n(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw Ln(Sn)}return null}async getEndpointMetadataFromNetwork(){var e;null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(po,this.correlationId);const t={},n=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose("Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ".concat(n));try{const e=await this.networkInterface.sendGetRequestAsync(n,t),r=function(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}(e.body);return r?e.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(r){return this.logger.verbose("Authority.getEndpointMetadataFromNetwork: ".concat(r)),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in Xn?Xn[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){var t,n;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(vo,this.correlationId);const r=null===(n=this.authorityOptions.azureRegionConfiguration)||void 0===n?void 0:n.azureRegion;if(r){var o;if(r!==H.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=Qe,this.regionDiscoveryMetadata.region_used=r,Ec.replaceWithRegionalInformation(e,r);const t=await hc(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),bo,this.logger,this.performanceClient,this.correlationId)(null===(o=this.authorityOptions.azureRegionConfiguration)||void 0===o?void 0:o.environmentRegion,this.regionDiscoveryMetadata);if(t)return this.regionDiscoveryMetadata.region_outcome=Ye,this.regionDiscoveryMetadata.region_used=t,Ec.replaceWithRegionalInformation(e,t);this.regionDiscoveryMetadata.region_outcome=Je}return e}async updateCloudDiscoveryMetadata(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(mo,this.correlationId);const n=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(n)return n;const r=await hc(this.getCloudDiscoveryMetadataFromNetwork.bind(this),fo,this.logger,this.performanceClient,this.correlationId)();if(r)return Ic(e,r,!0),je;throw Ln(xn)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii("Known Authorities: ".concat(this.authorityOptions.knownAuthorities||H.NOT_APPLICABLE)),this.logger.verbosePii("Authority Metadata: ".concat(this.authorityOptions.authorityMetadata||H.NOT_APPLICABLE)),this.logger.verbosePii("Canonical Authority: ".concat(e.canonical_authority||H.NOT_APPLICABLE));const t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),Ic(e,t,!1),Me;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const t=(n=this.hostnameAndPort,nr(Zn.metadata,n));if(t)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),Ic(e,t,!1),Le;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}var n;const r=Pc(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!r?(this.logger.verbose("Found cloud discovery metadata in the cache."),Oe):(r&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===uc)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),Ec.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=nr(JSON.parse(this.authorityOptions.cloudDiscoveryMetadata).metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),e)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),e;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(e){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Ln(Cn)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),Ec.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){var e;null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(fo,this.correlationId);const t="".concat(H.AAD_INSTANCE_DISCOVERY_ENDPT).concat(this.canonicalAuthority,"oauth2/v2.0/authorize"),n={};let r=null;try{const e=await this.networkInterface.sendGetRequestAsync(t,n);let o,i;if(function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(e.body))o=e.body,i=o.metadata,this.logger.verbosePii("tenant_discovery_endpoint is: ".concat(o.tenant_discovery_endpoint));else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(e.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(this.logger.warning("A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ".concat(e.status)),o=e.body,o.error===H.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning("The CloudInstanceDiscoveryErrorResponse error is ".concat(o.error)),this.logger.warning("The CloudInstanceDiscoveryErrorResponse error description is ".concat(o.error_description)),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),i=[]}this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),r=nr(i,this.hostnameAndPort)}catch(o){if(o instanceof ht)this.logger.error("There was a network error while attempting to get the cloud discovery instance metadata.\nError: ".concat(o.errorCode,"\nError Description: ").concat(o.errorMessage));else{const e=o;this.logger.error("A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: ".concat(e.name,"\nError Description: ").concat(e.message))}return null}return r||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),r=Ec.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),r}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(e=>e&&$n.getDomainFromUrl(e).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let n;if(t&&t.azureCloudInstance!==lt){const e=t.tenant?t.tenant:H.DEFAULT_COMMON_TENANT;n="".concat(t.azureCloudInstance,"/").concat(e,"/")}return n||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return H.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw sn(vt)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return er.has(e)}static isPublicCloudAuthority(e){return H.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,n){const r=new $n(e);r.validateAsUri();const o=r.getUrlComponents();let i="".concat(t,".").concat(o.HostNameAndPort);this.isPublicCloudAuthority(o.HostNameAndPort)&&(i="".concat(t,".").concat(H.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX));const a=$n.constructAuthorityUriFromObject(c(c({},r.getUrlComponents()),{},{HostNameAndPort:i})).urlString;return n?"".concat(a,"?").concat(n):a}static replaceWithRegionalInformation(e,t){const n=c({},e);return n.authorization_endpoint=Ec.buildRegionalAuthorityString(n.authorization_endpoint,t),n.token_endpoint=Ec.buildRegionalAuthorityString(n.token_endpoint,t),n.end_session_endpoint&&(n.end_session_endpoint=Ec.buildRegionalAuthorityString(n.end_session_endpoint,t)),n}static transformCIAMAuthority(e){let t=e;const n=new $n(e).getUrlComponents();if(0===n.PathSegments.length&&n.HostNameAndPort.endsWith(H.CIAM_AUTH_URL)){const e=n.HostNameAndPort.split(".")[0];t="".concat(t).concat(e).concat(H.AAD_TENANT_DOMAIN_SUFFIX)}return t}}function _c(e){return e.endsWith(H.FORWARD_SLASH)?e:"".concat(e).concat(H.FORWARD_SLASH)}Ec.reservedTenantDomains=new Set(["{tenant}","{tenantid}",ae,le,se]);const Nc="no_tokens_found",Rc="native_account_unavailable",Mc="refresh_token_expired",Oc="ux_not_allowed",jc="bad_token",Lc=["interaction_required","consent_required","login_required",jc,Oc],qc=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],Dc={[Nc]:"No refresh token found in the cache. Please sign-in.",[Rc]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[Mc]:"Refresh token has expired.",[jc]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve.",[Oc]:"`canShowUI` flag in Edge was set to false. User interaction required on web page. Please invoke an interactive API to resolve."};class zc extends ht{constructor(e,t,n,r,o,i,a,s){super(e,t,n),Object.setPrototypeOf(this,zc.prototype),this.timestamp=r||H.EMPTY_STRING,this.traceId=o||H.EMPTY_STRING,this.correlationId=i||H.EMPTY_STRING,this.claims=a||H.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=s}}function Fc(e,t,n){const r=!!e&&Lc.indexOf(e)>-1,o=!!n&&qc.indexOf(n)>-1,i=!!t&&Lc.some(e=>t.indexOf(e)>-1);return r||i||o}function Uc(e){return new zc(e,Dc[e])}function Hc(e,t){if(!e)throw sn(mt);try{const n=t(e);return JSON.parse(n)}catch(n){throw sn(ft)}}function Bc(e){if(!e)throw sn(ft);const t=e.split(Ie,2);return{uid:t[0],utid:t.length<2?H.EMPTY_STRING:t[1]}}function Kc(e){if(e){return e.tid||e.tfp||e.acr||null}return null}class Wc{getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,loginHint:this.loginHint,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e])),dataBoundary:this.dataBoundary}}isSingleTenant(){return!this.tenantProfiles}static createAccount(e,t,n){var r,o,i,a,s,l,c,u,d;const h=new Wc;let g;t.authorityType===lc?h.authorityType=xe:t.protocolMode===at?h.authorityType=Ae:h.authorityType=Se,e.clientInfo&&n&&(g=Hc(e.clientInfo,n),g.xms_tdbr&&(h.dataBoundary="EU"===g.xms_tdbr?"EU":"None")),h.clientInfo=e.clientInfo,h.homeAccountId=e.homeAccountId,h.nativeAccountId=e.nativeAccountId;const f=e.environment||t&&t.getPreferredCache();if(!f)throw sn(Ft);h.environment=f,h.realm=(null===(r=g)||void 0===r?void 0:r.utid)||Kc(e.idTokenClaims)||"",h.localAccountId=(null===(o=g)||void 0===o?void 0:o.uid)||(null===(i=e.idTokenClaims)||void 0===i?void 0:i.oid)||(null===(a=e.idTokenClaims)||void 0===a?void 0:a.sub)||"";const m=(null===(s=e.idTokenClaims)||void 0===s?void 0:s.preferred_username)||(null===(l=e.idTokenClaims)||void 0===l?void 0:l.upn),p=null!==(c=e.idTokenClaims)&&void 0!==c&&c.emails?e.idTokenClaims.emails[0]:null;if(h.username=m||p||"",h.loginHint=null===(u=e.idTokenClaims)||void 0===u?void 0:u.login_hint,h.name=(null===(d=e.idTokenClaims)||void 0===d?void 0:d.name)||"",h.cloudGraphHostName=e.cloudGraphHostName,h.msGraphHost=e.msGraphHost,e.tenantProfiles)h.tenantProfiles=e.tenantProfiles;else{const t=Hn(e.homeAccountId,h.localAccountId,h.realm,e.idTokenClaims);h.tenantProfiles=[t]}return h}static createFromAccountInfo(e,t,n){var r;const o=new Wc;return o.authorityType=e.authorityType||Ae,o.homeAccountId=e.homeAccountId,o.localAccountId=e.localAccountId,o.nativeAccountId=e.nativeAccountId,o.realm=e.tenantId,o.environment=e.environment,o.username=e.username,o.name=e.name,o.loginHint=e.loginHint,o.cloudGraphHostName=t,o.msGraphHost=n,o.tenantProfiles=Array.from((null===(r=e.tenantProfiles)||void 0===r?void 0:r.values())||[]),o.dataBoundary=e.dataBoundary,o}static generateHomeAccountId(e,t,n,r,o){if(t!==lc&&t!==cc){if(e)try{const t=Hc(e,r.base64Decode);if(t.uid&&t.utid)return"".concat(t.uid,".").concat(t.utid)}catch(i){}n.warning("No client info in response")}return(null===o||void 0===o?void 0:o.sub)||""}static isAccountEntity(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"))}static accountInfoIsEqual(e,t,n){if(!e||!t)return!1;let r=!0;if(n){const n=e.idTokenClaims||{},o=t.idTokenClaims||{};r=n.iat===o.iat&&n.nonce===o.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.loginHint===t.loginHint&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&r}}function Vc(e,t,n){var r;return{clientId:e,authority:t.authority,scopes:t.scopes,homeAccountIdentifier:n,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid,embeddedClientId:t.embeddedClientId||(null===(r=t.tokenBodyParameters)||void 0===r?void 0:r.clientId)}}const Gc=864e5,Qc="Lax",Yc="None";class Jc{initialize(){return Promise.resolve()}getItem(e){const t="".concat(encodeURIComponent(e)),n=document.cookie.split(";");for(let r=0;r<n.length;r++){const e=n[r],[o,...i]=decodeURIComponent(e).trim().split("="),a=i.join("=");if(o===t)return a}return""}getUserData(){throw sn(nn)}setItem(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Qc,i="".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t),";path=/;SameSite=").concat(o,";");if(n){const e=function(e){const t=new Date,n=new Date(t.getTime()+e*Gc);return n.toUTCString()}(n);i+="expires=".concat(e,";")}(r||o===Yc)&&(i+="Secure;"),document.cookie=i}async setUserData(){return Promise.reject(sn(nn))}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),t=[];return e.forEach(e=>{const n=decodeURIComponent(e).trim().split("=");t.push(n[0])}),t}containsKey(e){return this.getKeys().includes(e)}decryptData(){return Promise.resolve(null)}}function $c(e,t){const n=e.getItem(Vl(t));return n?JSON.parse(n):[]}function Xc(e,t,n){const r=t.getItem(Gl(e,n));if(r){const e=JSON.parse(r);if(e&&e.hasOwnProperty("idToken")&&e.hasOwnProperty("accessToken")&&e.hasOwnProperty("refreshToken"))return e}return{idToken:[],accessToken:[],refreshToken:[]}}function Zc(e){return e.hasOwnProperty("id")&&e.hasOwnProperty("nonce")&&e.hasOwnProperty("data")}const eu="msal.cache.encryption";class tu{constructor(e,t,n){if(!window.localStorage)throw Tl(kl);this.memoryStorage=new rc,this.initialized=!1,this.clientId=e,this.logger=t,this.performanceClient=n,this.broadcast=new BroadcastChannel("msal.broadcast.cache")}async initialize(e){const t=new Jc,n=t.getItem(eu);let r={key:"",id:""};if(n)try{r=JSON.parse(n)}catch(o){}if(r.key&&r.id){const t=dc($s,zo,this.logger,this.performanceClient,e)(r.key);this.encryptionCookie={id:r.id,key:await hc(pl,qo,this.logger,this.performanceClient,e)(t)}}else{const n=dl(),r=await hc(ml,Do,this.logger,this.performanceClient,e)(),o=dc(Gs,Fo,this.logger,this.performanceClient,e)(new Uint8Array(r));this.encryptionCookie={id:n,key:await hc(pl,qo,this.logger,this.performanceClient,e)(r)};const i={id:n,key:o};t.setItem(eu,JSON.stringify(i),0,!0,Yc)}await hc(this.importExistingCache.bind(this),Eo,this.logger,this.performanceClient,e)(e),this.broadcast.addEventListener("message",this.updateCache.bind(this)),this.initialized=!0}getItem(e){return window.localStorage.getItem(e)}getUserData(e){if(!this.initialized)throw ns(Wa);return this.memoryStorage.getItem(e)}async decryptData(e,t,n){if(!this.initialized||!this.encryptionCookie)throw ns(Wa);if(t.id!==this.encryptionCookie.id)return this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},n),null;const r=await hc(bl,Ho,this.logger,this.performanceClient,n)(this.encryptionCookie.key,t.nonce,this.getContext(e),t.data);if(!r)return null;try{return JSON.parse(r)}catch(o){return this.performanceClient.incrementFields({encryptedCacheCorruptionCount:1},n),null}}setItem(e,t){window.localStorage.setItem(e,t)}async setUserData(e,t,n,r){if(!this.initialized||!this.encryptionCookie)throw ns(Wa);const{data:o,nonce:i}=await hc(vl,Uo,this.logger,this.performanceClient,n)(this.encryptionCookie.key,t,this.getContext(e)),a={id:this.encryptionCookie.id,nonce:i,data:o,lastUpdatedAt:r};this.memoryStorage.setItem(e,t),this.setItem(e,JSON.stringify(a)),this.broadcast.postMessage({key:e,value:t,context:this.getContext(e)})}removeItem(e){this.memoryStorage.containsKey(e)&&(this.memoryStorage.removeItem(e),this.broadcast.postMessage({key:e,value:null,context:this.getContext(e)})),window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}clear(){this.memoryStorage.clear();$c(this).forEach(e=>this.removeItem(e));const e=Xc(this.clientId,this);e.idToken.forEach(e=>this.removeItem(e)),e.accessToken.forEach(e=>this.removeItem(e)),e.refreshToken.forEach(e=>this.removeItem(e)),this.getKeys().forEach(e=>{(e.startsWith(Dl)||-1!==e.indexOf(this.clientId))&&this.removeItem(e)})}async importExistingCache(e){if(!this.encryptionCookie)return;let t=$c(this);t=await this.importArray(t,e),t.length?this.setItem(Vl(),JSON.stringify(t)):this.removeItem(Vl());const n=Xc(this.clientId,this);n.idToken=await this.importArray(n.idToken,e),n.accessToken=await this.importArray(n.accessToken,e),n.refreshToken=await this.importArray(n.refreshToken,e),n.idToken.length||n.accessToken.length||n.refreshToken.length?this.setItem(Gl(this.clientId),JSON.stringify(n)):this.removeItem(Gl(this.clientId))}async getItemFromEncryptedCache(e,t){if(!this.encryptionCookie)return null;const n=this.getItem(e);if(!n)return null;let r;try{r=JSON.parse(n)}catch(o){return null}return Zc(r)?r.id!==this.encryptionCookie.id?(this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},t),null):hc(bl,Ho,this.logger,this.performanceClient,t)(this.encryptionCookie.key,r.nonce,this.getContext(e),r.data):(this.performanceClient.incrementFields({unencryptedCacheCount:1},t),r)}async importArray(e,t){const n=[],r=[];return e.forEach(e=>{const o=this.getItemFromEncryptedCache(e,t).then(t=>{t?(this.memoryStorage.setItem(e,t),n.push(e)):this.removeItem(e)});r.push(o)}),await Promise.all(r),n}getContext(e){let t="";return e.includes(this.clientId)&&(t=this.clientId),t}updateCache(e){this.logger.trace("Updating internal cache from broadcast event");const t=this.performanceClient.startMeasurement(No);t.add({isBackground:!0});const{key:n,value:r,context:o}=e.data;return n?o&&o!==this.clientId?(this.logger.trace("Ignoring broadcast event from clientId: ".concat(o)),void t.end({success:!1,errorCode:"contextMismatch"})):(r?(this.memoryStorage.setItem(n,r),this.logger.verbose("Updated item in internal cache")):(this.memoryStorage.removeItem(n),this.logger.verbose("Removed item from internal cache")),void t.end({success:!0})):(this.logger.error("Broadcast event missing key"),void t.end({success:!1,errorCode:"noKey"}))}}class nu{constructor(){if(!window.sessionStorage)throw Tl(kl)}async initialize(){}getItem(e){return window.sessionStorage.getItem(e)}getUserData(e){return this.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}decryptData(){return Promise.resolve(null)}}const ru="msal:initializeStart",ou="msal:initializeEnd",iu="msal:accountAdded",au="msal:accountRemoved",su="msal:activeAccountChanged",lu="msal:loginStart",cu="msal:loginSuccess",uu="msal:loginFailure",du="msal:acquireTokenStart",hu="msal:acquireTokenSuccess",gu="msal:acquireTokenFailure",fu="msal:acquireTokenFromNetworkStart",mu="msal:ssoSilentStart",pu="msal:ssoSilentSuccess",yu="msal:ssoSilentFailure",vu="msal:acquireTokenByCodeStart",bu="msal:acquireTokenByCodeSuccess",wu="msal:acquireTokenByCodeFailure",ku="msal:handleRedirectStart",Cu="msal:handleRedirectEnd",Su="msal:popupOpened",xu="msal:logoutStart",Au="msal:logoutSuccess",Tu="msal:logoutFailure",Iu="msal:logoutEnd",Pu="msal:restoreFromBFCache";function Eu(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class _u extends lr{constructor(e,t,n,r,o,i,a){super(e,n,r,o,a),this.cacheConfig=t,this.logger=r,this.internalStorage=new rc,this.browserStorage=Nu(e,t.cacheLocation,r,o),this.temporaryCacheStorage=Nu(e,t.temporaryCacheLocation,r,o),this.cookieStorage=new Jc,this.eventHandler=i}async initialize(e){this.performanceClient.addFields({cacheLocation:this.cacheConfig.cacheLocation,cacheRetentionDays:this.cacheConfig.cacheRetentionDays},e),await this.browserStorage.initialize(e),await this.migrateExistingCache(e),this.trackVersionChanges(e)}async migrateExistingCache(e){const t=$c(this.browserStorage,0),n=Xc(this.clientId,this.browserStorage,0);this.performanceClient.addFields({oldAccountCount:t.length,oldAccessCount:n.accessToken.length,oldIdCount:n.idToken.length,oldRefreshCount:n.refreshToken.length},e);const r=$c(this.browserStorage,1),o=Xc(this.clientId,this.browserStorage,1);this.performanceClient.addFields({currAccountCount:r.length,currAccessCount:o.accessToken.length,currIdCount:o.idToken.length,currRefreshCount:o.refreshToken.length},e),await Promise.all([this.updateV0ToCurrent(1,t,r,e),this.updateV0ToCurrent(1,n.idToken,o.idToken,e),this.updateV0ToCurrent(1,n.accessToken,o.accessToken,e),this.updateV0ToCurrent(1,n.refreshToken,o.refreshToken,e)]),t.length>0?this.browserStorage.setItem(Vl(0),JSON.stringify(t)):this.browserStorage.removeItem(Vl(0)),r.length>0?this.browserStorage.setItem(Vl(1),JSON.stringify(r)):this.browserStorage.removeItem(Vl(1)),this.setTokenKeys(n,e,0),this.setTokenKeys(o,e,1)}async updateV0ToCurrent(e,t,n,r){const o=[];for(const i of[...t]){const a=this.browserStorage.getItem(i),s=this.validateAndParseJson(a||"");if(!s){Eu(t,i);continue}s.lastUpdatedAt||(s.lastUpdatedAt=Date.now().toString(),this.setItem(i,JSON.stringify(s),r));const l=Zc(s)?await this.browserStorage.decryptData(i,s,r):s;let c;if(l&&(Sc(l)||xc(l))&&(c=l.expiresOn),!l||vc(s.lastUpdatedAt,this.cacheConfig.cacheRetentionDays)||c&&yc(c,300))this.browserStorage.removeItem(i),Eu(t,i),this.performanceClient.incrementFields({expiredCacheRemovedCount:1},r);else if(this.cacheConfig.cacheLocation!==Ci||Zc(s)){const t="".concat(Dl,".").concat(e).concat("-").concat(i),a=this.browserStorage.getItem(t);if(!a){o.push(this.setUserData(t,JSON.stringify(l),r,s.lastUpdatedAt).then(()=>{n.push(t),this.performanceClient.incrementFields({upgradedCacheCount:1},r)}));continue}{const e=this.validateAndParseJson(a);if(Number(s.lastUpdatedAt)>Number(e.lastUpdatedAt)){o.push(this.setUserData(t,JSON.stringify(l),r,s.lastUpdatedAt).then(()=>{this.performanceClient.incrementFields({updatedCacheFromV0Count:1},r)}));continue}}}}return Promise.all(o)}trackVersionChanges(e){const t=this.browserStorage.getItem(Bl);t&&(this.logger.info("MSAL.js was last initialized by version: ".concat(t)),this.performanceClient.addFields({previousLibraryVersion:t},e)),t!==ql&&this.setItem(Bl,ql,e)}validateAndParseJson(e){if(!e)return null;try{const t=JSON.parse(e);return t&&"object"===typeof t?t:null}catch(t){return null}}setItem(e,t,n){let r=0,o=[];for(let a=0;a<=20;a++)try{this.browserStorage.setItem(e,t),a>0&&(a<=r?this.removeAccessTokenKeys(o.slice(0,a),n,0):(this.removeAccessTokenKeys(o.slice(0,r),n,0),this.removeAccessTokenKeys(o.slice(r,a),n)));break}catch(i){const s=sr(i);if(!(s.errorCode===rr&&a<20))throw s;if(!o.length){const n=e===Gl(this.clientId,0)?JSON.parse(t).accessToken:this.getTokenKeys(0).accessToken,i=e===Gl(this.clientId)?JSON.parse(t).accessToken:this.getTokenKeys().accessToken;o=[...n,...i],r=n.length}if(o.length<=a)throw s;this.removeAccessToken(o[a],n,!1)}}async setUserData(e,t,n,r){let o=0,i=[];for(let s=0;s<=20;s++)try{await hc(this.browserStorage.setUserData.bind(this.browserStorage),_o,this.logger,this.performanceClient)(e,t,n,r),s>0&&(s<=o?this.removeAccessTokenKeys(i.slice(0,s),n,0):(this.removeAccessTokenKeys(i.slice(0,o),n,0),this.removeAccessTokenKeys(i.slice(o,s),n)));break}catch(a){const e=sr(a);if(!(e.errorCode===rr&&s<20))throw e;if(!i.length){const e=this.getTokenKeys(0).accessToken,t=this.getTokenKeys().accessToken;i=[...e,...t],o=e.length}if(i.length<=s)throw e;this.removeAccessToken(i[s],n,!1)}}getAccount(e,t){this.logger.trace("BrowserCacheManager.getAccount called");const n=this.browserStorage.getUserData(e);if(!n)return this.removeAccountKeyFromMap(e,t),null;const r=this.validateAndParseJson(n);return r&&Wc.isAccountEntity(r)?lr.toObject(new Wc,r):null}async setAccount(e,t){this.logger.trace("BrowserCacheManager.setAccount called");const n=this.generateAccountKey(e.getAccountInfo()),r=Date.now().toString();e.lastUpdatedAt=r,await this.setUserData(n,JSON.stringify(e),t,r);const o=this.addAccountKeyToMap(n,t);this.cacheConfig.cacheLocation===Ci&&o&&this.eventHandler.emitEvent(iu,void 0,e.getAccountInfo())}getAccountKeys(){return $c(this.browserStorage)}addAccountKeyToMap(e,t){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii("BrowserCacheManager.addAccountKeyToMap called with key: ".concat(e));const n=this.getAccountKeys();return-1===n.indexOf(e)?(n.push(e),this.setItem(Vl(),JSON.stringify(n),t),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added"),!0):(this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map"),!1)}removeAccountKeyFromMap(e,t){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii("BrowserCacheManager.removeAccountKeyFromMap called with key: ".concat(e));const n=this.getAccountKeys(),r=n.indexOf(e);if(r>-1){if(n.splice(r,1),0===n.length)return void this.removeItem(Vl());this.setItem(Vl(),JSON.stringify(n),t),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")}else this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}removeAccount(e,t){const n=this.getActiveAccount(t);(null===n||void 0===n?void 0:n.homeAccountId)===e.homeAccountId&&(null===n||void 0===n?void 0:n.environment)===e.environment&&this.setActiveAccount(null,t),super.removeAccount(e,t),this.removeAccountKeyFromMap(this.generateAccountKey(e),t),this.browserStorage.getKeys().forEach(t=>{t.includes(e.homeAccountId)&&t.includes(e.environment)&&this.browserStorage.removeItem(t)}),this.cacheConfig.cacheLocation===Ci&&this.eventHandler.emitEvent(au,void 0,e)}removeIdToken(e,t){super.removeIdToken(e,t);const n=this.getTokenKeys(),r=n.idToken.indexOf(e);r>-1&&(this.logger.info("idToken removed from tokenKeys map"),n.idToken.splice(r,1),this.setTokenKeys(n,t))}removeAccessToken(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super.removeAccessToken(e,t),n&&this.removeAccessTokenKeys([e],t)}removeAccessTokenKeys(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.logger.trace("removeAccessTokenKey called");const r=this.getTokenKeys(n);let o=0;if(e.forEach(e=>{const t=r.accessToken.indexOf(e);t>-1&&(r.accessToken.splice(t,1),o++)}),o>0)return this.logger.info("removed ".concat(o," accessToken keys from tokenKeys map")),void this.setTokenKeys(r,t,n)}removeRefreshToken(e,t){super.removeRefreshToken(e,t);const n=this.getTokenKeys(),r=n.refreshToken.indexOf(e);r>-1&&(this.logger.info("refreshToken removed from tokenKeys map"),n.refreshToken.splice(r,1),this.setTokenKeys(n,t))}getTokenKeys(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return Xc(this.clientId,this.browserStorage,e)}setTokenKeys(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;0!==e.idToken.length||0!==e.accessToken.length||0!==e.refreshToken.length?this.setItem(Gl(this.clientId,n),JSON.stringify(e),t):this.removeItem(Gl(this.clientId,n))}getIdTokenCredential(e,t){const n=this.browserStorage.getUserData(e);if(!n)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeIdToken(e,t),null;const r=this.validateAndParseJson(n);return r&&(o=r)&&Cc(o)&&o.hasOwnProperty("realm")&&o.credentialType===Pe.ID_TOKEN?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null);var o}async setIdTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const n=this.generateCredentialKey(e),r=Date.now().toString();e.lastUpdatedAt=r,await this.setUserData(n,JSON.stringify(e),t,r);const o=this.getTokenKeys();-1===o.idToken.indexOf(n)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),o.idToken.push(n),this.setTokenKeys(o,t))}getAccessTokenCredential(e,t){const n=this.browserStorage.getUserData(e);if(!n)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeAccessTokenKeys([e],t),null;const r=this.validateAndParseJson(n);return r&&Sc(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null)}async setAccessTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const n=this.generateCredentialKey(e),r=Date.now().toString();e.lastUpdatedAt=r,await this.setUserData(n,JSON.stringify(e),t,r);const o=this.getTokenKeys(),i=o.accessToken.indexOf(n);-1!==i&&o.accessToken.splice(i,1),this.logger.trace("access token ".concat(-1===i?"added to":"updated in"," map")),o.accessToken.push(n),this.setTokenKeys(o,t)}getRefreshTokenCredential(e,t){const n=this.browserStorage.getUserData(e);if(!n)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeRefreshToken(e,t),null;const r=this.validateAndParseJson(n);return r&&xc(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null)}async setRefreshTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const n=this.generateCredentialKey(e),r=Date.now().toString();e.lastUpdatedAt=r,await this.setUserData(n,JSON.stringify(e),t,r);const o=this.getTokenKeys();-1===o.refreshToken.indexOf(n)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),o.refreshToken.push(n),this.setTokenKeys(o,t))}getAppMetadata(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&(r=e,(o=n)&&0===r.indexOf(Ee)&&o.hasOwnProperty("clientId")&&o.hasOwnProperty("environment"))?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),n):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null);var r,o}setAppMetadata(e,t){this.logger.trace("BrowserCacheManager.setAppMetadata called");const n=function(e){let{environment:t,clientId:n}=e;return[Ee,t,n].join(Te).toLowerCase()}(e);this.setItem(n,JSON.stringify(e),t)}getServerTelemetry(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&function(e,t){const n=0===e.indexOf(qe.CACHE_KEY);let r=!0;return t&&(r=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),n&&r}(e,n)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),n):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)}setServerTelemetry(e,t,n){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t),n)}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&function(e,t){return!!t&&0===e.indexOf(Ne)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri")}(e,n)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),n):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(e=>this.isAuthorityMetadata(e))}setWrapperMetadata(e,t){this.internalStorage.setItem(ji,e),this.internalStorage.setItem(Li,t)}getWrapperMetadata(){return[this.internalStorage.getItem(ji)||H.EMPTY_STRING,this.internalStorage.getItem(Li)||H.EMPTY_STRING]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(e){const t=this.generateCacheKey(ie),n=this.browserStorage.getItem(t);if(!n)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters found"),null;const r=this.validateAndParseJson(n);return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:r.homeAccountId,localAccountId:r.localAccountId,tenantId:r.tenantId},e)):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e,t){const n=this.generateCacheKey(ie);if(e){this.logger.verbose("setActiveAccount: Active account set");const r={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId,lastUpdatedAt:fc().toString()};this.setItem(n,JSON.stringify(r),t)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(n);this.eventHandler.emitEvent(su)}getThrottlingCache(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&function(e,t){let n=!1;e&&(n=0===e.indexOf(Ue));let r=!0;return t&&(r=t.hasOwnProperty("throttleTime")),n&&r}(e,n)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),n):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)}setThrottlingCache(e,t,n){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t),n)}getTemporaryCache(e,t){const n=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const e=this.cookieStorage.getItem(n);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),e}const r=this.temporaryCacheStorage.getItem(n);if(!r){if(this.cacheConfig.cacheLocation===Ci){const e=this.browserStorage.getItem(n);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),e}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),r}setTemporaryCache(e,t,n){const r=n?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(r,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(r,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}clear(e){this.removeAllAccounts(e),this.removeAppMetadata(e),this.temporaryCacheStorage.getKeys().forEach(e=>{-1===e.indexOf(Dl)&&-1===e.indexOf(this.clientId)||this.removeTemporaryItem(e)}),this.browserStorage.getKeys().forEach(e=>{-1===e.indexOf(Dl)&&-1===e.indexOf(this.clientId)||this.browserStorage.removeItem(e)}),this.internalStorage.clear()}clearTokensAndKeysWithClaims(e){this.performanceClient.addQueueMeasurement(Io,e);const t=this.getTokenKeys();let n=0;t.accessToken.forEach(t=>{const r=this.getAccessTokenCredential(t,e);null!==r&&void 0!==r&&r.requestedClaimsHash&&t.includes(r.requestedClaimsHash.toLowerCase())&&(this.removeAccessToken(t,e),n++)}),n>0&&this.logger.warning("".concat(n," access tokens with claims in the cache keys have been removed from the cache."))}generateCacheKey(e){return qn.startsWith(e,Dl)?e:"".concat(Dl,".").concat(this.clientId,".").concat(e)}generateCredentialKey(e){const t=e.credentialType===Pe.REFRESH_TOKEN&&e.familyId||e.clientId,n=e.tokenType&&e.tokenType.toLowerCase()!==De.BEARER.toLowerCase()?e.tokenType.toLowerCase():"";return["".concat(Dl,".").concat(1),e.homeAccountId,e.environment,e.credentialType,t,e.realm||"",e.target||"",e.requestedClaimsHash||"",n].join("-").toLowerCase()}generateAccountKey(e){const t=e.homeAccountId.split(".")[1];return["".concat(Dl,".").concat(1),e.homeAccountId,e.environment,t||e.tenantId||""].join("-").toLowerCase()}resetRequestCache(){this.logger.trace("BrowserCacheManager.resetRequestCache called"),this.removeTemporaryItem(this.generateCacheKey(Ni)),this.removeTemporaryItem(this.generateCacheKey(Ri)),this.removeTemporaryItem(this.generateCacheKey(Ei)),this.removeTemporaryItem(this.generateCacheKey(_i)),this.removeTemporaryItem(this.generateCacheKey(Oi)),this.setInteractionInProgress(!1)}cacheAuthorizeRequest(e,t){this.logger.trace("BrowserCacheManager.cacheAuthorizeRequest called");const n=Qs(JSON.stringify(e));if(this.setTemporaryCache(Ni,n,!0),t){const e=Qs(t);this.setTemporaryCache(Ri,e,!0)}}getCachedRequest(){this.logger.trace("BrowserCacheManager.getCachedRequest called");const e=this.getTemporaryCache(Ni,!0);if(!e)throw ns(Aa);const t=this.getTemporaryCache(Ri,!0);let n,r="";try{n=JSON.parse(Js(e)),t&&(r=Js(t))}catch(o){throw this.logger.errorPii("Attempted to parse: ".concat(e)),this.logger.error("Parsing cached token request threw with error: ".concat(o)),ns(Ta)}return[n,r]}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(Oi,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){var t;const n=null===(t=this.getInteractionInProgress())||void 0===t?void 0:t.clientId;return e?n===this.clientId:!!n}getInteractionInProgress(){const e="".concat(Dl,".").concat(Mi),t=this.getTemporaryCache(e,!1);try{return t?JSON.parse(t):null}catch(n){return this.logger.error("Cannot parse interaction status. Removing temporary cache items and clearing url hash. Retrying interaction should fix the error"),this.removeTemporaryItem(e),this.resetRequestCache(),Il(window),null}}setInteractionInProgress(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ii;const r="".concat(Dl,".").concat(Mi);if(e){if(this.getInteractionInProgress())throw ns(ha);this.setTemporaryCache(r,JSON.stringify({clientId:this.clientId,type:n}),!1)}else e||(null===(t=this.getInteractionInProgress())||void 0===t?void 0:t.clientId)!==this.clientId||this.removeTemporaryItem(r)}async hydrateCache(e,t){var n,r,o;const i=bc(null===(n=e.account)||void 0===n?void 0:n.homeAccountId,null===(r=e.account)||void 0===r?void 0:r.environment,e.idToken,this.clientId,e.tenantId);let a;t.claims&&(a=await this.cryptoImpl.hashString(t.claims));const s={idToken:i,accessToken:wc(null===(o=e.account)||void 0===o?void 0:o.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?mc(e.expiresOn):0,e.extExpiresOn?mc(e.extExpiresOn):0,Js,void 0,e.tokenType,void 0,t.sshKid,t.claims,a)};return this.saveCacheRecord(s,e.correlationId)}async saveCacheRecord(e,t,n){try{await super.saveCacheRecord(e,t,n)}catch(r){if(r instanceof ar&&this.performanceClient&&t)try{const e=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:e.refreshToken.length,cacheIdCount:e.idToken.length,cacheAtCount:e.accessToken.length},t)}catch(r){}throw r}}}function Nu(e,t,n,r){try{switch(t){case Ci:return new tu(e,n,r);case Si:return new nu}}catch(o){n.error(o)}return new rc}class Ru{constructor(e){this.eventCallbacks=new Map,this.logger=e||new ot({}),"undefined"!==typeof BroadcastChannel&&(this.broadcastChannel=new BroadcastChannel("msal.broadcast.event")),this.invokeCrossTabCallbacks=this.invokeCrossTabCallbacks.bind(this)}addEventCallback(e,t,n){if("undefined"!==typeof window){const r=n||dl();return this.eventCallbacks.has(r)?(this.logger.error("Event callback with id: ".concat(r," is already registered. Please provide a unique id or remove the existing callback and try again.")),null):(this.eventCallbacks.set(r,[e,t||[]]),this.logger.verbose("Event callback registered with id: ".concat(r)),r)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback ".concat(e," removed."))}emitEvent(e,t,n,r){var o;const i={eventType:e,interactionType:t||null,payload:n||null,error:r||null,timestamp:Date.now()};switch(e){case iu:case au:case su:null===(o=this.broadcastChannel)||void 0===o||o.postMessage(i);break;default:this.invokeCallbacks(i)}}invokeCallbacks(e){this.eventCallbacks.forEach((t,n)=>{let[r,o]=t;(0===o.length||o.includes(e.eventType))&&(this.logger.verbose("Emitting event to callback ".concat(n,": ").concat(e.eventType)),r.apply(null,[e]))})}invokeCrossTabCallbacks(e){const t=e.data;this.invokeCallbacks(t)}subscribeCrossTab(){var e;null===(e=this.broadcastChannel)||void 0===e||e.addEventListener("message",this.invokeCrossTabCallbacks)}unsubscribeCrossTab(){var e;null===(e=this.broadcastChannel)||void 0===e||e.removeEventListener("message",this.invokeCrossTabCallbacks)}}const Mu="home_account_id",Ou="UPN";async function ju(e,t,n,r,o,i,a){null===a||void 0===a||a.addQueueMeasurement(ho,i);const s=Ec.transformCIAMAuthority(_c(e)),l=new Ec(s,t,n,r,o,i,a);try{return await hc(l.resolveEndpointsAsync.bind(l),go,o,a,i)(),l}catch(c){throw sn(vt)}}class Lu extends ht{constructor(e,t,n,r,o){super(e,t,n),this.name="ServerError",this.errorNo=r,this.status=o,Object.setPrototypeOf(this,Lu.prototype)}}class qu{static generateThrottlingStorageKey(e){return"".concat(Ue,".").concat(JSON.stringify(e))}static preProcess(e,t,n){const r=qu.generateThrottlingStorageKey(t),o=e.getThrottlingCache(r);if(o){var i;if(o.throttleTime<Date.now())return void e.removeItem(r,n);throw new Lu((null===(i=o.errorCodes)||void 0===i?void 0:i.join(" "))||H.EMPTY_STRING,o.errorMessage,o.subError)}}static postProcess(e,t,n,r){if(qu.checkResponseStatus(n)||qu.checkResponseForRetryAfter(n)){const o={throttleTime:qu.calculateThrottleTime(parseInt(n.headers[te])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};e.setThrottlingCache(qu.generateThrottlingStorageKey(t),o,r)}}static checkResponseStatus(e){return 429===e.status||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return!!e.headers&&(e.headers.hasOwnProperty(te)&&(e.status<200||e.status>=300))}static calculateThrottleTime(e){const t=e<=0?0:e,n=Date.now()/1e3;return Math.floor(1e3*Math.min(n+(t||ze),n+Fe))}static removeThrottle(e,t,n,r){const o=Vc(t,n,r),i=this.generateThrottlingStorageKey(o);e.removeItem(i,n.correlationId)}}class Du{constructor(e,t){this.config=function(e){let{authOptions:t,systemOptions:n,loggerOptions:r,cacheOptions:o,storageInterface:i,networkInterface:a,cryptoInterface:s,clientCredentials:l,libraryInfo:u,telemetry:d,serverTelemetryManager:h,persistencePlugin:g,serializableCache:f}=e;const m=c(c({},Yo),r);return{authOptions:(p=t,c({clientCapabilities:[],azureCloudOptions:ei,skipAuthorityMetadataCache:!1,instanceAware:!1,encodeExtraQueryParams:!1},p)),systemOptions:c(c({},Qo),n),loggerOptions:m,cacheOptions:c(c({},Jo),o),storageInterface:i||new cr(t.clientId,ln,new ot(m),new Go),networkInterface:a||$o,cryptoInterface:s||ln,clientCredentials:l||Zo,libraryInfo:c(c({},Xo),u),telemetry:c(c({},ti),d),serverTelemetryManager:h||null,persistencePlugin:g||null,serializableCache:f||null};var p}(e),this.logger=new ot(this.config.loggerOptions,cn,un),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[Z]=H.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Mu:try{const n=Bc(e.credential);t[ne]="Oid:".concat(n.uid,"@").concat(n.utid)}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case Ou:t[ne]="UPN: ".concat(e.credential)}return t}async executePostToTokenEndpoint(e,t,n,r,o,i){var a;i&&(null===(a=this.performanceClient)||void 0===a||a.addQueueMeasurement(i,o));const s=await this.sendPostRequest(r,e,{body:t,headers:n},o);return this.config.serverTelemetryManager&&s.status<500&&429!==s.status&&this.config.serverTelemetryManager.clearTelemetryCache(),s}async sendPostRequest(e,t,n,r){let o;qu.preProcess(this.cacheManager,e,r);try{var i,a;o=await hc(this.networkClient.sendPostRequestAsync.bind(this.networkClient),Tr,this.logger,this.performanceClient,r)(t,n);const e=o.headers||{};null===(i=this.performanceClient)||void 0===i||i.addFields({refreshTokenSize:(null===(a=o.body.refresh_token)||void 0===a?void 0:a.length)||0,httpVerToken:e[oe]||"",requestId:e[re]||""},r)}catch(l){if(l instanceof os){const e=l.responseHeaders;var s;if(e)null===(s=this.performanceClient)||void 0===s||s.addFields({httpVerToken:e[oe]||"",requestId:e[re]||"",contentTypeHeader:e[Z]||void 0,contentLengthHeader:e[ee]||void 0,httpStatus:l.httpStatus},r);throw l.error}throw l instanceof ht?l:sn(bt)}return qu.postProcess(this.cacheManager,e,o,r),o}async updateAuthority(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(ro,t);const r="https://".concat(e,"/").concat(this.authority.tenant,"/"),o=await ju(r,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=o}createTokenQueryParameters(e){const t=new Map;return e.embeddedClientId&&Ws(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenQueryParameters&&zs(t,e.tokenQueryParameters),Ps(t,e.correlationId),vs(t,e.correlationId,this.performanceClient),Yn(t)}}class zu{static setRequestState(e,t,n){const r=zu.generateLibraryState(e,n);return t?"".concat(r).concat(H.RESOURCE_DELIM).concat(t):r}static generateLibraryState(e,t){if(!e)throw sn(Ht);const n={id:e.createNewGuid()};t&&(n.meta=t);const r=JSON.stringify(n);return e.base64Encode(r)}static parseRequestState(e,t){if(!e)throw sn(Ht);if(!t)throw sn(Ct);try{const n=t.split(H.RESOURCE_DELIM),r=n[0],o=n.length>1?n.slice(1).join(H.RESOURCE_DELIM):H.EMPTY_STRING,i=e.base64Decode(r),a=JSON.parse(i);return{userRequestState:o||H.EMPTY_STRING,libraryState:a}}catch(n){throw sn(Ct)}}}const Fu="sw";class Uu{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(so,e.correlationId);const r=await hc(this.generateKid.bind(this),so,t,this.performanceClient,e.correlationId)(e),o=this.cryptoUtils.base64UrlEncode(JSON.stringify(r));return{kid:r.kid,reqCnfString:o}}async generateKid(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(lo,e.correlationId);return{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:Fu}}async signPopToken(e,t,n){return this.signPayload(e,t,n)}async signPayload(e,t,n,r){const{resourceRequestMethod:o,resourceRequestUri:i,shrClaims:a,shrNonce:s,shrOptions:l}=n,u=i?new $n(i):void 0,d=null===u||void 0===u?void 0:u.getUrlComponents();return this.cryptoUtils.signJwt(c({at:e,ts:fc(),m:null===o||void 0===o?void 0:o.toUpperCase(),u:null===d||void 0===d?void 0:d.HostNameAndPort,nonce:s||this.cryptoUtils.createNewGuid(),p:null===d||void 0===d?void 0:d.AbsolutePath,q:null!==d&&void 0!==d&&d.QueryString?[[],d.QueryString]:void 0,client_claims:a||void 0},r),t,l,n.correlationId)}}class Hu{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}class Bu{constructor(e,t,n,r,o,i,a){this.clientId=e,this.cacheStorage=t,this.cryptoObj=n,this.logger=r,this.serializableCache=o,this.persistencePlugin=i,this.performanceClient=a}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){var n;const r="Error(s): ".concat(e.error_codes||H.NOT_AVAILABLE," - Timestamp: ").concat(e.timestamp||H.NOT_AVAILABLE," - Description: ").concat(e.error_description||H.NOT_AVAILABLE," - Correlation ID: ").concat(e.correlation_id||H.NOT_AVAILABLE," - Trace ID: ").concat(e.trace_id||H.NOT_AVAILABLE),o=null!==(n=e.error_codes)&&void 0!==n&&n.length?e.error_codes[0]:void 0,i=new Lu(e.error,r,e.suberror,o,e.status);if(t&&e.status&&e.status>=G&&e.status<=Q)return void this.logger.warning("executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.\n".concat(i));if(t&&e.status&&e.status>=K&&e.status<=V)return void this.logger.warning("executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.\n".concat(i));if(Fc(e.error,e.error_description,e.suberror))throw new zc(e.error,e.error_description,e.suberror,e.timestamp||H.EMPTY_STRING,e.trace_id||H.EMPTY_STRING,e.correlation_id||H.EMPTY_STRING,e.claims||H.EMPTY_STRING,o);throw i}}async handleServerTokenResponse(e,t,n,r,o,i,a,s,l){var c;let u,d;if(null===(c=this.performanceClient)||void 0===c||c.addQueueMeasurement(co,e.correlation_id),e.id_token){if(u=Kn(e.id_token||H.EMPTY_STRING,this.cryptoObj.base64Decode),o&&o.nonce&&u.nonce!==o.nonce)throw sn(At);if(r.maxAge||0===r.maxAge){const e=u.auth_time;if(!e)throw sn(Tt);Wn(e,r.maxAge)}}this.homeAccountIdentifier=Wc.generateHomeAccountId(e.client_info||H.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,u),o&&o.state&&(d=zu.parseRequestState(this.cryptoObj,o.state)),e.key_id=e.key_id||r.sshKid||void 0;const h=this.generateCacheRecord(e,t,n,r,u,i,o);let g;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),g=new Hu(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(g)),a&&!s&&h.account){const e=this.cacheStorage.generateAccountKey(h.account.getAccountInfo());if(!this.cacheStorage.getAccount(e,r.correlationId))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await Bu.generateAuthenticationResult(this.cryptoObj,t,h,!1,r,u,d,void 0,l)}await this.cacheStorage.saveCacheRecord(h,r.correlationId,r.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&g&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(g))}return Bu.generateAuthenticationResult(this.cryptoObj,t,h,!1,r,u,d,e,l)}generateCacheRecord(e,t,n,r,o,i,a){const s=t.getPreferredCache();if(!s)throw sn(Ft);const l=Kc(o);let c,u;e.id_token&&o&&(c=bc(this.homeAccountIdentifier,s,e.id_token,this.clientId,l||""),u=Ku(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,r.correlationId,o,e.client_info,s,l,a,void 0,this.logger));let d=null;if(e.access_token){const o=e.scope?Dn.fromString(e.scope):new Dn(r.scopes||[]),a=("string"===typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,c=("string"===typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,u=("string"===typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,h=n+a,g=h+c,f=u&&u>0?n+u:void 0;d=wc(this.homeAccountIdentifier,s,e.access_token,this.clientId,l||t.tenant||"",o.printScopes(),h,g,this.cryptoObj.base64Decode,f,e.token_type,i,e.key_id,r.claims,r.requestedClaimsHash)}let h=null;if(e.refresh_token){let t;if(e.refresh_token_expires_in){t=n+("string"===typeof e.refresh_token_expires_in?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in)}h=kc(this.homeAccountIdentifier,s,e.refresh_token,this.clientId,e.foci,i,t)}let g=null;return e.foci&&(g={clientId:this.clientId,environment:s,familyId:e.foci}),{account:u,idToken:c,accessToken:d,refreshToken:h,appMetadata:g}}static async generateAuthenticationResult(e,t,n,r,o,i,a,s,l){var c,u,d,h,g;let f,m,p=H.EMPTY_STRING,y=[],v=null,b=H.EMPTY_STRING;if(n.accessToken){if(n.accessToken.tokenType!==De.POP||o.popKid)p=n.accessToken.secret;else{const t=new Uu(e),{secret:r,keyId:i}=n.accessToken;if(!i)throw sn(Xt);p=await t.signPopToken(r,i,o)}y=Dn.fromString(n.accessToken.target).asArray(),v=pc(n.accessToken.expiresOn),f=pc(n.accessToken.extendedExpiresOn),n.accessToken.refreshOn&&(m=pc(n.accessToken.refreshOn))}n.appMetadata&&(b=n.appMetadata.familyId===_e?_e:"");const w=(null===i||void 0===i?void 0:i.oid)||(null===i||void 0===i?void 0:i.sub)||"",k=(null===i||void 0===i?void 0:i.tid)||"";null!==s&&void 0!==s&&s.spa_accountid&&n.account&&(n.account.nativeAccountId=null===s||void 0===s?void 0:s.spa_accountid);const C=n.account?Bn(n.account.getAccountInfo(),void 0,i,null===(c=n.idToken)||void 0===c?void 0:c.secret):null;return{authority:t.canonicalAuthority,uniqueId:w,tenantId:k,scopes:y,account:C,idToken:(null===n||void 0===n||null===(u=n.idToken)||void 0===u?void 0:u.secret)||"",idTokenClaims:i||{},accessToken:p,fromCache:r,expiresOn:v,extExpiresOn:f,refreshOn:m,correlationId:o.correlationId,requestId:l||H.EMPTY_STRING,familyId:b,tokenType:(null===(d=n.accessToken)||void 0===d?void 0:d.tokenType)||H.EMPTY_STRING,state:a?a.userRequestState:H.EMPTY_STRING,cloudGraphHostName:(null===(h=n.account)||void 0===h?void 0:h.cloudGraphHostName)||H.EMPTY_STRING,msGraphHost:(null===(g=n.account)||void 0===g?void 0:g.msGraphHost)||H.EMPTY_STRING,code:null===s||void 0===s?void 0:s.spa_code,fromNativeBroker:!1}}}function Ku(e,t,n,r,o,i,a,s,l,c,u,d){null===d||void 0===d||d.verbose("setCachedAccount called");const h=e.getAccountKeys().find(e=>e.startsWith(n));let g=null;h&&(g=e.getAccount(h,o));const f=g||Wc.createAccount({homeAccountId:n,idTokenClaims:i,clientInfo:a,environment:s,cloudGraphHostName:null===c||void 0===c?void 0:c.cloud_graph_host_name,msGraphHost:null===c||void 0===c?void 0:c.msgraph_host,nativeAccountId:u},t,r),m=f.tenantProfiles||[],p=l||f.realm;if(p&&!m.find(e=>e.tenantId===p)){const e=Hn(n,f.localAccountId,p,i);m.push(e)}return f.tenantProfiles=m,f}async function Wu(e,t,n){if("string"===typeof e)return e;return e({clientId:t,tokenEndpoint:n})}class Vu extends Du{constructor(e,t){var n;super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=null===(n=this.config.authOptions.authority.options.OIDCOptions)||void 0===n?void 0:n.defaultScopes}async acquireToken(e,t){var n,r;if(null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(oo,e.correlationId),!e.code)throw sn(Nt);const o=fc(),i=await hc(this.executeTokenRequest.bind(this),io,this.logger,this.performanceClient,e.correlationId)(this.authority,e),a=null===(r=i.headers)||void 0===r?void 0:r[re],s=new Bu(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return s.validateTokenResponse(i.body),hc(s.handleServerTokenResponse.bind(s),co,this.logger,this.performanceClient,e.correlationId)(i.body,this.authority,o,e,t,void 0,void 0,void 0,a)}getLogoutUri(e){if(!e)throw Ln(bn);const t=this.createLogoutUrlQueryString(e);return $n.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(io,t.correlationId);const r=this.createTokenQueryParameters(t),o=$n.appendQueryString(e.tokenEndpoint,r),i=await hc(this.createTokenRequestBody.bind(this),ao,this.logger,this.performanceClient,t.correlationId)(t);let a;if(t.clientInfo)try{const e=Hc(t.clientInfo,this.cryptoUtils.base64Decode);a={credential:"".concat(e.uid).concat(Ie).concat(e.utid),type:Mu}}catch(c){this.logger.verbose("Could not parse client info for CCS Header: "+c)}const s=this.createTokenRequestHeaders(a||t.ccsCredential),l=Vc(this.config.authOptions.clientId,t);return hc(this.executePostToTokenEndpoint.bind(this),Pr,this.logger,this.performanceClient,t.correlationId)(o,i,s,l,t.correlationId,Pr)}async createTokenRequestBody(e){var t,n;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(ao,e.correlationId);const r=new Map;if(ks(r,e.embeddedClientId||(null===(n=e.tokenBodyParameters)||void 0===n?void 0:n[cs])||this.config.authOptions.clientId),this.includeRedirectUri)Cs(r,e.redirectUri);else if(!e.redirectUri)throw Ln(dn);if(ws(r,e.scopes,!0,this.oidcDefaultScopes),function(e,t){e.set("code",t)}(r,e.code),Es(r,this.config.libraryInfo),_s(r,this.config.telemetry.application),Ks(r),this.serverTelemetryManager&&!ni(this.config)&&Bs(r,this.serverTelemetryManager),e.codeVerifier&&function(e,t){e.set("code_verifier",t)}(r,e.codeVerifier),this.config.clientCredentials.clientSecret&&Ms(r,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const t=this.config.clientCredentials.clientAssertion;Os(r,await Wu(t.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),js(r,t.assertionType)}if(Ls(r,ke),qs(r),e.authenticationScheme===De.POP){const t=new Uu(this.cryptoUtils,this.performanceClient);let n;if(e.popKid)n=this.cryptoUtils.encodeKid(e.popKid);else{n=(await hc(t.generateCnf.bind(t),so,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString}Us(r,n)}else if(e.authenticationScheme===De.SSH){if(!e.sshJwk)throw Ln(An);Hs(r,e.sshJwk)}let o;if((!qn.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&Is(r,e.claims,this.config.authOptions.clientCapabilities),e.clientInfo)try{const t=Hc(e.clientInfo,this.cryptoUtils.base64Decode);o={credential:"".concat(t.uid).concat(Ie).concat(t.utid),type:Mu}}catch(i){this.logger.verbose("Could not parse client info for CCS Header: "+i)}else o=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&o)switch(o.type){case Mu:try{As(r,Bc(o.credential))}catch(i){this.logger.verbose("Could not parse home account ID for CCS Header: "+i)}break;case Ou:xs(r,o.credential)}return e.embeddedClientId&&Ws(r,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&zs(r,e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[gs]||zs(r,{[gs]:"1"}),vs(r,e.correlationId,this.performanceClient),Yn(r)}createLogoutUrlQueryString(e){const t=new Map;return e.postLogoutRedirectUri&&function(e,t){e.set("post_logout_redirect_uri",t)}(t,e.postLogoutRedirectUri),e.correlationId&&Ps(t,e.correlationId),e.idTokenHint&&function(e,t){e.set("id_token_hint",t)}(t,e.idTokenHint),e.state&&Ns(t,e.state),e.logoutHint&&function(e,t){e.set("logout_hint",t)}(t,e.logoutHint),e.extraQueryParameters&&zs(t,e.extraQueryParameters),this.config.authOptions.instanceAware&&Ds(t),Yn(t,this.config.authOptions.encodeExtraQueryParams,e.extraQueryParameters)}}function Gu(e){const{skus:t,libraryName:n,libraryVersion:r,extensionName:o,extensionVersion:i}=e,a=new Map([[0,[n,r]],[2,[o,i]]]);let s=[];if(null!==t&&void 0!==t&&t.length){if(s=t.split(","),s.length<4)return t}else s=Array.from({length:4},()=>"|");return a.forEach((e,t)=>{var n,r;2===e.length&&null!==(n=e[0])&&void 0!==n&&n.length&&null!==(r=e[1])&&void 0!==r&&r.length&&function(e){const{skuArr:t,index:n,skuName:r,skuVersion:o}=e;if(n>=t.length)return;t[n]=[r,o].join("|")}({skuArr:s,index:t,skuName:e[0],skuVersion:e[1]})}),s.join(",")}class Qu{constructor(e,t){this.cacheOutcome=$e,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||H.EMPTY_STRING,this.wrapperVer=e.wrapperVer||H.EMPTY_STRING,this.telemetryCacheKey=qe.CACHE_KEY+Te+e.clientId}generateCurrentRequestHeaderValue(){const e="".concat(this.apiId).concat(qe.VALUE_SEPARATOR).concat(this.cacheOutcome),t=[this.wrapperSKU,this.wrapperVer],n=this.getNativeBrokerErrorCode();null!==n&&void 0!==n&&n.length&&t.push("broker_error=".concat(n));const r=t.join(qe.VALUE_SEPARATOR),o=[e,this.getRegionDiscoveryFields()].join(qe.VALUE_SEPARATOR);return[qe.SCHEMA_VERSION,o,r].join(qe.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=Qu.maxErrorsToSend(e),n=e.failedRequests.slice(0,2*t).join(qe.VALUE_SEPARATOR),r=e.errors.slice(0,t).join(qe.VALUE_SEPARATOR),o=e.errors.length,i=[o,t<o?qe.OVERFLOW_TRUE:qe.OVERFLOW_FALSE].join(qe.VALUE_SEPARATOR);return[qe.SCHEMA_VERSION,e.cacheHits,n,r,i].join(qe.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=qe.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof ht?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(qe.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId),e.cacheHits}getLastRequests(){return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||{failedRequests:[],errors:[],cacheHits:0}}clearTelemetryCache(){const e=this.getLastRequests(),t=Qu.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey,this.correlationId);else{const n={failedRequests:e.failedRequests.slice(2*t),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n,this.correlationId)}}static maxErrorsToSend(e){let t,n=0,r=0;const o=e.errors.length;for(t=0;t<o;t++){const o=e.failedRequests[2*t]||H.EMPTY_STRING,i=e.failedRequests[2*t+1]||H.EMPTY_STRING,a=e.errors[t]||H.EMPTY_STRING;if(r+=o.toString().length+i.toString().length+a.length+3,!(r<qe.MAX_LAST_HEADER_BYTES))break;n+=1}return n}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||H.EMPTY_STRING),e.push(this.regionSource||H.EMPTY_STRING),e.push(this.regionOutcome||H.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId)}static makeExtraSkuString(e){return Gu(e)}}class Yu{constructor(e,t,n,r,o,i,a,s,l){this.config=e,this.browserStorage=t,this.browserCrypto=n,this.networkClient=this.config.system.networkClient,this.eventHandler=o,this.navigationClient=i,this.platformAuthProvider=s,this.correlationId=l||dl(),this.logger=r.clone(ci,ql,this.correlationId),this.performanceClient=a}async clearCacheOnLogout(e,t){if(t)try{this.browserStorage.removeAccount(t,e),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch(n){this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),this.browserStorage.clear(e),await this.browserCrypto.clearKeystore()}catch(r){this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri;return $n.getAbsoluteUrl(t,El())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const n={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Qu(n,this.browserStorage)}async getDiscoveredAuthority(e){const{account:t}=e,n=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(xr,this.correlationId);const r={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},o=e.requestAuthority||this.config.auth.authority,i=null!==n&&void 0!==n&&n.length?"true"===n:this.config.auth.instanceAware,a=t&&i?this.config.auth.authority.replace($n.getDomainFromUrl(o),t.environment):o,s=Ec.generateAuthority(a,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),l=await hc(ju,ho,this.logger,this.performanceClient,this.correlationId)(s,this.config.system.networkClient,this.browserStorage,r,this.logger,this.correlationId,this.performanceClient);if(t&&!l.isAlias(t.environment))throw Ln(Nn);return l}}async function Ju(e,t,n,r){n.addQueueMeasurement(Dr,e.correlationId);const o=e.authority||t.auth.authority,i=[...e&&e.scopes||[]],a=c(c({},e),{},{correlationId:e.correlationId,authority:o,scopes:i});if(a.authenticationScheme){if(a.authenticationScheme===De.SSH){if(!e.sshJwk)throw Ln(An);if(!e.sshKid)throw Ln(Tn)}r.verbose('Authentication Scheme set to "'.concat(a.authenticationScheme,'" as configured in Auth request'))}else a.authenticationScheme=De.BEARER,r.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return t.cache.claimsBasedCachingEnabled&&e.claims&&!qn.isEmptyObj(e.claims)&&(a.requestedClaimsHash=await wl(e.claims)),a}async function $u(e,t,n,r,o){r.addQueueMeasurement(zr,e.correlationId);const i=await hc(Ju,Dr,o,r,e.correlationId)(e,n,r,o);return c(c(c({},e),i),{},{account:t,forceRefresh:e.forceRefresh||!1})}function Xu(e,t){let n;const r=e.httpMethod;if(t===st){if(n=r||J,n!==J)throw Ln(Rn)}else n=r||Y;if(e.authorizePostBodyParameters&&n!==J)throw Ln(Mn);return n}class Zu extends Yu{initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",null===e||void 0===e?void 0:e.correlationId);const t=c({correlationId:this.correlationId||dl()},e);if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const n=this.getLogoutHintFromIdTokenClaims(e.account);n&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=n)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=$n.getAbsoluteUrl(e.postLogoutRedirectUri,El())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=$n.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,El())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=$n.getAbsoluteUrl(El(),El())),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(Gr,this.correlationId);const t=await hc(this.getClientConfiguration.bind(this),Qr,this.logger,this.performanceClient,this.correlationId)(e);return new Vu(t,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:t,requestAuthority:n,requestAzureCloudOptions:r,requestExtraQueryParameters:o,account:i}=e;this.performanceClient.addQueueMeasurement(Qr,this.correlationId);const a=await hc(this.getDiscoveredAuthority.bind(this),xr,this.logger,this.performanceClient,this.correlationId)({requestAuthority:n,requestAzureCloudOptions:r,requestExtraQueryParameters:o,account:i}),s=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:a,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:s.loggerCallback,piiLoggingEnabled:s.piiLoggingEnabled,logLevel:s.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:ci,version:ql,cpu:H.EMPTY_STRING,os:H.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(Yr,this.correlationId);const n=this.getRedirectUri(e.redirectUri),r={interactionType:t},o=zu.setRequestState(this.browserCrypto,e&&e.state||H.EMPTY_STRING,r),i=await hc(Ju,Dr,this.logger,this.performanceClient,this.correlationId)(c(c({},e),{},{correlationId:this.correlationId}),this.config,this.performanceClient,this.logger),a=c(c({},i),{},{redirectUri:n,state:o,nonce:e.nonce||dl(),responseMode:this.config.auth.OIDCOptions.serverResponseType}),s=c(c({},a),{},{httpMethod:Xu(a,this.config.auth.protocolMode)});if(e.loginHint||e.sid)return s;const l=e.account||this.browserStorage.getActiveAccount(this.correlationId);return l&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: ".concat(l.homeAccountId),this.correlationId),s.account=l),s}}function ed(e,t,n){const r=Qn(e);if(!r)throw Gn(e)?(n.error("A ".concat(t," is present in the iframe but it does not contain known properties. It's likely that the ").concat(t," has been replaced by code running on the redirectUri page.")),n.errorPii("The ".concat(t," detected is: ").concat(e)),ns(ca)):(n.error("The request has returned to the redirectUri but a ".concat(t," is not present. It's likely that the ").concat(t," has been removed or the page has been redirected by code running on the redirectUri page.")),ns(sa));return r}function td(e,t,n){if(!e.state)throw ns(la);const r=function(e,t){if(!t)return null;try{return zu.parseRequestState(e,t).libraryState.meta}catch(n){throw sn(Ct)}}(t,e.state);if(!r)throw ns(ua);if(r.interactionType!==n)throw ns(da)}function nd(e,t,n,r){var o,i;const a=t.correlationId,s=new Map;ks(s,t.embeddedClientId||(null===(o=t.extraQueryParameters)||void 0===o?void 0:o[cs])||e.clientId);if(ws(s,[...t.scopes||[],...t.extraScopesToConsent||[]],!0,null===(i=e.authority.options.OIDCOptions)||void 0===i?void 0:i.defaultScopes),Cs(s,t.redirectUri),Ps(s,a),function(e,t){e.set("response_mode",t||we)}(s,t.responseMode),qs(s),t.prompt&&(!function(e,t){e.set("prompt",t)}(s,t.prompt),null===r||void 0===r||r.addFields({prompt:t.prompt},a)),t.domainHint&&(!function(e,t){e.set("domain_hint",t)}(s,t.domainHint),null===r||void 0===r||r.addFields({domainHintFromRequest:!0},a)),t.prompt!==he)if(t.sid&&t.prompt===fe)n.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),Ts(s,t.sid),null===r||void 0===r||r.addFields({sidFromRequest:!0},a);else if(t.account){const e=function(e){var t;return(null===(t=e.idTokenClaims)||void 0===t?void 0:t.sid)||null}(t.account);let o=function(e){var t;return e.loginHint||(null===(t=e.idTokenClaims)||void 0===t?void 0:t.login_hint)||null}(t.account);if(o&&t.domainHint&&(n.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),o=null),o){n.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),Ss(s,o),null===r||void 0===r||r.addFields({loginHintFromClaim:!0},a);try{As(s,Bc(t.account.homeAccountId))}catch(l){n.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e&&t.prompt===fe){n.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),Ts(s,e),null===r||void 0===r||r.addFields({sidFromClaim:!0},a);try{As(s,Bc(t.account.homeAccountId))}catch(l){n.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t.loginHint)n.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),Ss(s,t.loginHint),xs(s,t.loginHint),null===r||void 0===r||r.addFields({loginHintFromRequest:!0},a);else if(t.account.username){n.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),Ss(s,t.account.username),null===r||void 0===r||r.addFields({loginHintFromUpn:!0},a);try{As(s,Bc(t.account.homeAccountId))}catch(l){n.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else t.loginHint&&(n.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),Ss(s,t.loginHint),xs(s,t.loginHint),null===r||void 0===r||r.addFields({loginHintFromRequest:!0},a));else n.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return t.nonce&&function(e,t){e.set("nonce",t)}(s,t.nonce),t.state&&Ns(s,t.state),(t.claims||e.clientCapabilities&&e.clientCapabilities.length>0)&&Is(s,t.claims,e.clientCapabilities),t.embeddedClientId&&Ws(s,e.clientId,e.redirectUri),!e.instanceAware||t.extraQueryParameters&&Object.keys(t.extraQueryParameters).includes(ys)||Ds(s),s}function rd(e,t,n,r){const o=Yn(t,n,r);return $n.appendQueryString(e.authorizationEndpoint,o)}function od(e,t){if(!e.state||!t)throw e.state?sn(xt,"Cached State"):sn(xt,"Server State");let n,r;try{n=decodeURIComponent(e.state)}catch(o){throw sn(Ct,e.state)}try{r=decodeURIComponent(t)}catch(o){throw sn(Ct,e.state)}if(n!==r)throw sn(St);if(e.error||e.error_description||e.suberror){const t=function(e){var t,n;const r="code=",o=null===(t=e.error_uri)||void 0===t?void 0:t.lastIndexOf(r);return o&&o>=0?null===(n=e.error_uri)||void 0===n?void 0:n.substring(o+r.length):void 0}(e);if(Fc(e.error,e.error_description,e.suberror))throw new zc(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",t);throw new Lu(e.error||"",e.error_description,e.suberror,t)}}class id{constructor(e,t,n,r,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=n,this.logger=r,this.performanceClient=o}async handleCodeResponse(e,t){let n;this.performanceClient.addQueueMeasurement(Zr,t.correlationId);try{n=function(e,t){if(od(e,t),!e.code)throw sn(Yt);return e}(e,t.state)}catch(r){throw r instanceof Lu&&r.subError===ma?ns(ma):r}return hc(this.handleCodeResponseFromServer.bind(this),Xr,this.logger,this.performanceClient,t.correlationId)(n,t)}async handleCodeResponseFromServer(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.performanceClient.addQueueMeasurement(Xr,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await hc(this.authModule.updateAuthority.bind(this.authModule),ro,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),n&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const e=this.createCcsCredentials(t);e&&(this.authCodeRequest.ccsCredential=e)}return await hc(this.authModule.acquireToken.bind(this.authModule),oo,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:Mu}:e.loginHint?{credential:e.loginHint,type:Ou}:null}}const ad="user_switch",sd={[ad]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class ld extends ht{constructor(e,t,n){super(e,t),Object.setPrototypeOf(this,ld.prototype),this.name="NativeAuthError",this.ext=n}}function cd(e){if(e.ext&&e.ext.status&&"DISABLED"===e.ext.status)return!0;if(e.ext&&e.ext.error&&-2147186943===e.ext.error)return!0;switch(e.errorCode){case"ContentError":case"PageException":return!0;default:return!1}}function ud(e,t,n){if(n&&n.status)switch(n.status){case"ACCOUNT_UNAVAILABLE":return Uc(Rc);case"USER_INTERACTION_REQUIRED":return new zc(e,t);case"USER_CANCEL":return ns(ma);case"NO_NETWORK":return ns(Na);case"UX_NOT_ALLOWED":return Uc(Oc)}return new ld(e,sd[e]||t,n)}class dd extends Du{constructor(e,t){super(e,t)}async acquireCachedToken(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(jr,e.correlationId);let n=$e;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!qn.isEmptyObj(e.claims))throw this.setCacheOutcome(Xe,e.correlationId),sn(Vt);if(!e.account)throw sn(Dt);const r=e.account.tenantId||function(e){var t;const n=null===(t=new $n(e).getUrlComponents().PathSegments.slice(-1)[0])||void 0===t?void 0:t.toLowerCase();switch(n){case ae:case se:case le:return;default:return n}}(e.authority),o=this.cacheManager.getTokenKeys(),i=this.cacheManager.getAccessToken(e.account,e,o,r);if(!i)throw this.setCacheOutcome(Ze,e.correlationId),sn(Vt);if(a=i.cachedAt,Number(a)>fc()||yc(i.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(et,e.correlationId),sn(Vt);var a;i.refreshOn&&yc(i.refreshOn,0)&&(n=tt);const s=e.authority||this.authority.getPreferredCache(),l={account:this.cacheManager.getAccount(this.cacheManager.generateAccountKey(e.account),e.correlationId),accessToken:i,idToken:this.cacheManager.getIdToken(e.account,e.correlationId,o,r,this.performanceClient),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(s)};return this.setCacheOutcome(n,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await hc(this.generateResultFromCacheRecord.bind(this),Lr,this.logger,this.performanceClient,e.correlationId)(l,e),n]}setCacheOutcome(e,t){var n,r;null===(n=this.serverTelemetryManager)||void 0===n||n.setCacheOutcome(e),null===(r=this.performanceClient)||void 0===r||r.addFields({cacheOutcome:e},t),e!==$e&&this.logger.info("Token refresh is required due to cache outcome: ".concat(e))}async generateResultFromCacheRecord(e,t){var n;let r;if(null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(Lr,t.correlationId),e.idToken&&(r=Kn(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||0===t.maxAge){var o;const e=null===(o=r)||void 0===o?void 0:o.auth_time;if(!e)throw sn(Tt);Wn(e,t.maxAge)}return Bu.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)}}class hd extends Zu{async acquireToken(e){this.performanceClient.addQueueMeasurement(br,e.correlationId);const t=this.initializeServerTelemetryManager(Hi),n=await hc(this.getClientConfiguration.bind(this),Qr,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),r=new dd(n,this.performanceClient);this.logger.verbose("Silent auth client created");try{const t=(await hc(r.acquireCachedToken.bind(r),jr,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),t}catch(o){throw o instanceof ts&&o.errorCode===La&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),o}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t.correlationId,null===t||void 0===t?void 0:t.account)}}const gd=["prompt"],fd=["scopes"];class md extends Yu{constructor(e,t,n,r,o,i,a,s,l,c,u,d){super(e,t,n,r,o,i,s,l,d),this.apiId=a,this.accountId=c,this.platformAuthProvider=l,this.nativeStorageManager=u,this.silentCacheClient=new hd(e,this.nativeStorageManager,n,r,o,i,s,l,d);const h=this.platformAuthProvider.getExtensionName();this.skus=Qu.makeExtraSkuString({libraryName:ci,libraryVersion:ql,extensionName:h,extensionVersion:this.platformAuthProvider.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters=c(c({},e.extraParameters),{},{[fs]:this.skus})}async acquireToken(e,t){this.performanceClient.addQueueMeasurement(Ar,this.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const n=this.performanceClient.startMeasurement(Ar,this.correlationId),r=fc(),o=this.initializeServerTelemetryManager(this.apiId);try{const a=await this.initializeNativeRequest(e);try{const e=await this.acquireTokensFromCache(this.accountId,a);return n.end({success:!0,isNativeBroker:!1,fromCache:!0}),e}catch(i){if(t===Ji)throw this.logger.info("MSAL internal Cache does not contain tokens, return error as per cache policy"),n.end({success:!1,brokerErrorCode:"cache_request_failed"}),i;this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const s=await this.platformAuthProvider.sendMessage(a);return await this.handleNativeResponse(s,a,r).then(e=>(n.end({success:!0,isNativeBroker:!0,requestId:e.requestId}),o.clearNativeBrokerErrorCode(),e)).catch(e=>{throw n.end({success:!1,errorCode:e.errorCode,subErrorCode:e.subError}),e})}catch(i){throw i instanceof ld&&o.setNativeBrokerErrorCode(i.errorCode),n.end({success:!1}),i}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:Dn.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),sn(Ut);const n=this.browserStorage.getBaseAccountInfo({nativeAccountId:e},this.correlationId);if(!n)throw sn(Ut);try{const e=this.createSilentCacheRequest(t,n),r=await this.silentCacheClient.acquireToken(e),o=c(c({},n),{},{idTokenClaims:null===r||void 0===r?void 0:r.idTokenClaims,idToken:null===r||void 0===r?void 0:r.idToken});return c(c({},r),{},{account:o})}catch(r){throw r}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const n=Object.assign({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(e),e));delete n.onRedirectNavigate;const r=await this.initializeNativeRequest(n);try{await this.platformAuthProvider.sendMessage(r)}catch(a){if(a instanceof ld){if(this.initializeServerTelemetryManager(this.apiId).setNativeBrokerErrorCode(a.errorCode),cd(a))throw a}}this.browserStorage.setTemporaryCache(Oi,JSON.stringify(r),!0);const o={apiId:qi,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},i=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(i,o)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const n=this.browserStorage.getCachedNativeRequest();if(!n)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&(null===e||void 0===e||e.addFields({errorCode:"no_cached_request"},t)),null;const{prompt:r}=n,o=u(n,gd);r&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Oi));const i=fc();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const t=await this.platformAuthProvider.sendMessage(o),n=await this.handleNativeResponse(t,o,i);return this.initializeServerTelemetryManager(this.apiId).clearNativeBrokerErrorCode(),e&&this.correlationId&&this.performanceClient.addFields({isNativeBroker:!0},this.correlationId),n}catch(a){throw a}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,t,n){var r,o;this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const i=Kn(e.id_token,Js),a=this.createHomeAccountIdentifier(e,i),s=null===(r=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId},this.correlationId))||void 0===r?void 0:r.homeAccountId;if(null!==(o=t.extraParameters)&&void 0!==o&&o.child_client_id&&e.account.id!==t.accountId)this.logger.info("handleNativeServerResponse: Double broker flow detected, ignoring accountId mismatch");else if(a!==s&&e.account.id!==t.accountId)throw ud(ad);const l=await this.getDiscoveredAuthority({requestAuthority:t.authority}),c=Ku(this.browserStorage,l,a,Js,this.correlationId,i,e.client_info,void 0,i.tid,void 0,e.account.id,this.logger);e.expires_in=Number(e.expires_in);const u=await this.generateAuthenticationResult(e,t,i,c,l.canonicalAuthority,n);return await this.cacheAccount(c,this.correlationId),await this.cacheNativeTokens(e,t,a,i,e.access_token,u.tenantId,n),u}createHomeAccountIdentifier(e,t){return Wc.generateHomeAccountId(e.client_info||H.EMPTY_STRING,sc,this.logger,this.browserCrypto,t)}generateScopes(e,t){return t?Dn.fromString(t):Dn.fromString(e)}async generatePopAccessToken(e,t){if(t.tokenType===De.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const n=new Uu(this.browserCrypto),r={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw sn(Xt);return n.signPopToken(e.access_token,t.keyId,r)}return e.access_token}async generateAuthenticationResult(e,t,n,r,o,i){const a=this.addTelemetryFromNativeResponse(e.properties.MATS),s=this.generateScopes(t.scope,e.scope),l=e.account.properties||{},c=l.UID||n.oid||n.sub||H.EMPTY_STRING,u=l.TenantId||n.tid||H.EMPTY_STRING,d=Bn(r.getAccountInfo(),void 0,n,e.id_token);d.nativeAccountId!==e.account.id&&(d.nativeAccountId=e.account.id);const h=await this.generatePopAccessToken(e,t),g=t.tokenType===De.POP?De.POP:De.BEARER;return{authority:o,uniqueId:c,tenantId:u,scopes:s.asArray(),account:d,idToken:e.id_token,idTokenClaims:n,accessToken:h,fromCache:!!a&&this.isResponseFromCache(a),expiresOn:pc(i+e.expires_in),tokenType:g,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}async cacheAccount(e,t){await this.browserStorage.setAccount(e,this.correlationId),this.browserStorage.removeAccountContext(e.getAccountInfo(),t)}cacheNativeTokens(e,t,n,r,o,i,a){const s=bc(n,t.authority,e.id_token||"",t.clientId,r.tid||""),l=a+(t.tokenType===De.POP?H.SHR_NONCE_VALIDITY:("string"===typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),c=this.generateScopes(e.scope,t.scope),u={idToken:s,accessToken:wc(n,t.authority,o,t.clientId,r.tid||i,c.printScopes(),l,0,Js,void 0,t.tokenType,void 0,t.keyId)};return this.nativeStorageManager.saveCacheRecord(u,this.correlationId,t.storeInCache)}getExpiresInValue(e,t){return e===De.POP?H.SHR_NONCE_VALIDITY:("string"===typeof t?parseInt(t,10):t)||0}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.platformAuthProvider.getExtensionId(),extensionVersion:this.platformAuthProvider.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}getMATSFromResponse(e){if(e)try{return JSON.parse(e)}catch(t){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return"undefined"===typeof e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=await this.getCanonicalAuthority(e),{scopes:n}=e,r=u(e,fd),o=new Dn(n||[]);o.appendScopes($);const i=c(c({},r),{},{accountId:this.accountId,clientId:this.config.auth.clientId,authority:t.urlString,scope:o.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:this.getPrompt(e.prompt),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:c(c({},e.extraQueryParameters),e.tokenQueryParameters),extendedExpiryToken:!1,keyId:e.popKid});if(i.signPopToken&&e.popKid)throw ns(Qa);if(this.handleExtraBrokerParams(i),i.extraParameters=i.extraParameters||{},i.extraParameters.telemetry=hi,e.authenticationScheme===De.POP){const t={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},n=new Uu(this.browserCrypto);let r;if(i.keyId)r=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:i.keyId})),i.signPopToken=!1;else{const e=await hc(n.generateCnf.bind(n),so,this.logger,this.performanceClient,this.correlationId)(t,this.logger);r=e.reqCnfString,i.keyId=e.kid,i.signPopToken=!0}i.reqCnf=r}return this.addRequestSKUs(i),i}async getCanonicalAuthority(e){const t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const n=new $n(t);return n.validateAsUri(),n}getPrompt(e){switch(this.apiId){case zi:case Hi:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),fe}if(e)switch(e){case fe:case ge:case de:case he:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e;default:throw this.logger.trace("initializeNativeRequest: prompt = ".concat(e," is not compatible with native flow")),ns(Va)}else this.logger.trace("initializeNativeRequest: prompt was not provided")}handleExtraBrokerParams(e){var t;const n=e.extraParameters&&e.extraParameters.hasOwnProperty(ms)&&e.extraParameters.hasOwnProperty(ps)&&e.extraParameters.hasOwnProperty(cs);if(!e.embeddedClientId&&!n)return;let r="";const o=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,r=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[ps],r=e.extraParameters[cs]),e.extraParameters={child_client_id:r,child_redirect_uri:o},null===(t=this.performanceClient)||void 0===t||t.addFields({embeddedClientId:r,embeddedRedirectUri:o},this.correlationId)}}async function pd(e,t,n,r,o){const i=nd(c(c({},e.auth),{},{authority:t}),n,r,o);if(Es(i,{sku:ci,version:ql,os:"",cpu:""}),e.auth.protocolMode!==at&&_s(i,e.telemetry.application),n.platformBroker&&(function(e){e.set("nativebroker","1")}(i),o.addFields({isPlatformAuthorizeRequest:!0},n.correlationId),n.authenticationScheme===De.POP)){const e=new ic(r,o),t=new Uu(e);let a;if(n.popKid)a=e.encodeKid(n.popKid);else{a=(await hc(t.generateCnf.bind(t),so,r,o,n.correlationId)(n,r)).reqCnfString}Us(i,a)}return vs(i,n.correlationId,o),i}async function yd(e,t,n,r,o){if(!n.codeChallenge)throw Ln(kn);const i=await hc(pd,$r,r,o,n.correlationId)(e,t,n,r,o);return bs(i,pe),Rs(i,n.codeChallenge,H.S256_CODE_CHALLENGE_METHOD),zs(i,n.extraQueryParameters||{}),rd(t,i,e.auth.encodeExtraQueryParams,n.extraQueryParameters)}async function vd(e,t,n,r,o,i){if(!r.earJwk)throw ns(ra);const a=await pd(t,n,r,o,i);bs(a,ye),function(e,t){e.set("ear_jwk",encodeURIComponent(t)),e.set("ear_jwe_crypto","eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0")}(a,r.earJwk);const s=new Map;zs(s,r.extraQueryParameters||{});return wd(e,rd(n,s,t.auth.encodeExtraQueryParams,r.extraQueryParameters),a)}async function bd(e,t,n,r,o,i){const a=await pd(t,n,r,o,i);bs(a,pe),Rs(a,r.codeChallenge,r.codeChallengeMethod||H.S256_CODE_CHALLENGE_METHOD),function(e,t){Object.entries(t).forEach(t=>{let[n,r]=t;r&&e.set(n,r)})}(a,r.authorizePostBodyParameters||{});const s=new Map;zs(s,r.extraQueryParameters||{});return wd(e,rd(n,s,t.auth.encodeExtraQueryParams,r.extraQueryParameters),a)}function wd(e,t,n){const r=e.createElement("form");return r.method="post",r.action=t,n.forEach((t,n)=>{const o=e.createElement("input");o.hidden=!0,o.name=n,o.value=t,r.appendChild(o)}),e.body.appendChild(r),r}async function kd(e,t,n,r,o,i,a,s,l,u){if(s.verbose("Account id found, calling WAM for token"),!u)throw ns(Ka);const d=new ic(s,l),h=new md(r,o,d,s,a,r.system.navigationClient,n,l,u,t,i,e.correlationId),{userRequestState:g}=zu.parseRequestState(d,e.state);return hc(h.acquireToken.bind(h),Ar,s,l,e.correlationId)(c(c({},e),{},{state:g,prompt:void 0}))}async function Cd(e,t,n,r,o,i,a,s,l,u,d,h){if(qu.removeThrottle(a,o.auth.clientId,e),t.accountId)return hc(kd,to,u,d,e.correlationId)(e,t.accountId,r,o,a,s,l,u,d,h);const g=c(c({},e),{},{code:t.code||"",codeVerifier:n}),f=new id(i,a,g,u,d);return await hc(f.handleCodeResponse.bind(f),Zr,u,d,e.correlationId)(t,e)}async function Sd(e,t,n,r,o,i,a,s,l,c,u){if(qu.removeThrottle(i,r.auth.clientId,e),od(t,e.state),!t.ear_jwe)throw ns(oa);if(!e.earJwk)throw ns(ra);const d=JSON.parse(await hc(fl,Ko,l,c,e.correlationId)(e.earJwk,t.ear_jwe));if(d.accountId)return hc(kd,to,l,c,e.correlationId)(e,d.accountId,n,r,i,a,s,l,c,u);const h=new Bu(r.auth.clientId,i,new ic(l,c),l,null,null,c);h.validateTokenResponse(d);const g={code:"",state:e.state,nonce:e.nonce,client_info:d.client_info,cloud_graph_host_name:d.cloud_graph_host_name,cloud_instance_host_name:d.cloud_instance_host_name,cloud_instance_name:d.cloud_instance_name,msgraph_host:d.msgraph_host};return await hc(h.handleServerTokenResponse.bind(h),co,l,c,e.correlationId)(d,o,fc(),e,g,void 0,void 0,void 0,void 0)}async function xd(e,t,n){e.addQueueMeasurement(Ro,n);const r=dc(Ad,Mo,t,e,n)(e,t,n);return{verifier:r,challenge:await hc(Td,Oo,t,e,n)(r,e,t,n)}}function Ad(e,t,n){try{const r=new Uint8Array(32);dc(cl,Lo,t,e,n)(r);return Gs(r)}catch(r){throw ns(na)}}async function Td(e,t,n,r){t.addQueueMeasurement(Oo,r);try{const o=await hc(ll,jo,n,t,r)(e,t,r);return Gs(new Uint8Array(o))}catch(o){throw ns(na)}}class Id{constructor(e,t,n,r){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=r,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=n,this.handshakeEvent=n.startMeasurement(Ao),this.platformAuthType=yi}async sendMessage(e){this.logger.trace(this.platformAuthType+" - sendMessage called.");const t={method:wi,request:e},n={channel:ui,extensionId:this.extensionId,responseId:dl(),body:t};this.logger.trace(this.platformAuthType+" - Sending request to browser extension"),this.logger.tracePii(this.platformAuthType+" - Sending request to browser extension: ".concat(JSON.stringify(n))),this.messageChannel.port1.postMessage(n);const r=await new Promise((e,t)=>{this.resolvers.set(n.responseId,{resolve:e,reject:t})});return this.validatePlatformBrokerResponse(r)}static async createProvider(e,t,n){e.trace("PlatformAuthExtensionHandler - createProvider called.");try{const r=new Id(e,t,n,di);return await r.sendHandshakeRequest(),r}catch(r){const o=new Id(e,t,n);return await o.sendHandshakeRequest(),o}}async sendHandshakeRequest(){this.logger.trace(this.platformAuthType+" - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:ui,extensionId:this.extensionId,responseId:dl(),body:{method:vi}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=e=>{this.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((t,n)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:n}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),n(ns(Ha)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(e){if(this.logger.trace(this.platformAuthType+" - onWindowMessage called"),e.source!==window)return;const t=e.data;if(t.channel&&t.channel===ui&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===vi){const e=this.handshakeResolvers.get(t.responseId);if(!e)return void this.logger.trace(this.platformAuthType+".onWindowMessage - resolver can't be found for request ".concat(t.responseId));this.logger.verbose(t.extensionId?"Extension with id: ".concat(t.extensionId," not installed"):"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),e.reject(ns(Ba))}}onChannelMessage(e){this.logger.trace(this.platformAuthType+" - onChannelMessage called.");const t=e.data,n=this.resolvers.get(t.responseId),r=this.handshakeResolvers.get(t.responseId);try{const e=t.body.method;if(e===ki){if(!n)return;const e=t.body.response;if(this.logger.trace(this.platformAuthType+" - Received response from browser extension"),this.logger.tracePii(this.platformAuthType+" - Received response from browser extension: ".concat(JSON.stringify(e))),"Success"!==e.status)n.reject(ud(e.code,e.description,e.ext));else{if(!e.result)throw gt(ct,"Event does not contain result.");e.result.code&&e.result.description?n.reject(ud(e.result.code,e.result.description,e.result.ext)):n.resolve(e.result)}this.resolvers.delete(t.responseId)}else if(e===bi){if(!r)return void this.logger.trace(this.platformAuthType+".onChannelMessage - resolver can't be found for request ".concat(t.responseId));clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(this.platformAuthType+" - Received HandshakeResponse from extension: ".concat(this.extensionId)),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),r.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(o){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: ".concat(o)),this.logger.errorPii("Unable to parse ".concat(e)),n?n.reject(o):r&&r.reject(o)}}validatePlatformBrokerResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw gt(ct,"Response missing expected properties.")}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}getExtensionName(){var e;return this.getExtensionId()===di?"chrome":null!==(e=this.getExtensionId())&&void 0!==e&&e.length?"unknown":void 0}}const Pd=["accountId","clientId","authority","scope","redirectUri","correlationId","state","storeInCache","embeddedClientId","extraParameters"];class Ed{constructor(e,t,n){this.logger=e,this.performanceClient=t,this.correlationId=n,this.platformAuthType=pi}static async createProvider(e,t,n){var r;if(e.trace("PlatformAuthDOMHandler: createProvider called"),null!==(r=window.navigator)&&void 0!==r&&r.platformAuthentication){const r=await window.navigator.platformAuthentication.getSupportedContracts(gi);if(null!==r&&void 0!==r&&r.includes(mi))return e.trace("Platform auth api available in DOM"),new Ed(e,t,n)}}getExtensionId(){return gi}getExtensionVersion(){return""}getExtensionName(){return fi}async sendMessage(e){this.logger.trace(this.platformAuthType+" - Sending request to browser DOM API");try{const t=this.initializePlatformDOMRequest(e),n=await window.navigator.platformAuthentication.executeGetToken(t);return this.validatePlatformBrokerResponse(n)}catch(t){throw this.logger.error(this.platformAuthType+" - executeGetToken DOM API error"),t}}initializePlatformDOMRequest(e){this.logger.trace(this.platformAuthType+" - initializeNativeDOMRequest called");const{accountId:t,clientId:n,authority:r,scope:o,redirectUri:i,correlationId:a,state:s,storeInCache:l,embeddedClientId:d,extraParameters:h}=e,g=u(e,Pd),f=this.getDOMExtraParams(g);return{accountId:t,brokerId:this.getExtensionId(),authority:r,clientId:n,correlationId:a||this.correlationId,extraParameters:c(c({},h),f),isSecurityTokenService:!1,redirectUri:i,scope:o,state:s,storeInCache:l,embeddedClientId:d}}validatePlatformBrokerResponse(e){if(e.hasOwnProperty("isSuccess")){if(e.hasOwnProperty("accessToken")&&e.hasOwnProperty("idToken")&&e.hasOwnProperty("clientInfo")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scopes")&&e.hasOwnProperty("expiresIn"))return this.logger.trace(this.platformAuthType+" - platform broker returned successful and valid response"),this.convertToPlatformBrokerResponse(e);if(e.hasOwnProperty("error")){const t=e;if(!1===t.isSuccess&&t.error&&t.error.code)throw this.logger.trace(this.platformAuthType+" - platform broker returned error response"),ud(t.error.code,t.error.description,{error:parseInt(t.error.errorCode),protocol_error:t.error.protocolError,status:t.error.status,properties:t.error.properties})}}throw gt(ct,"Response missing expected properties.")}convertToPlatformBrokerResponse(e){var t;this.logger.trace(this.platformAuthType+" - convertToNativeResponse called");return{access_token:e.accessToken,id_token:e.idToken,client_info:e.clientInfo,account:e.account,expires_in:e.expiresIn,scope:e.scopes,state:e.state||"",properties:e.properties||{},extendedLifetimeToken:null!==(t=e.extendedLifetimeToken)&&void 0!==t&&t,shr:e.proofOfPossessionPayload}}getDOMExtraParams(e){return c({},Object.entries(e).reduce((e,t)=>{let[n,r]=t;return e[n]=String(r),e},{}))}}async function _d(e,t,n,r){e.trace("getPlatformAuthProvider called",n);const o=function(){let e;try{var t;return e=window[Si],"true"===(null===(t=e)||void 0===t?void 0:t.getItem(Hl))}catch(n){return!1}}();let i;e.trace("Has client allowed platform auth via DOM API: "+o);try{o&&(i=await Ed.createProvider(e,t,n)),i||(e.trace("Platform auth via DOM API not available, checking for extension"),i=await Id.createProvider(e,r||2e3,t))}catch(a){e.trace("Platform auth not available",a)}return i}function Nd(e,t,n,r){if(t.trace("isPlatformAuthAllowed called"),!e.system.allowPlatformBroker)return t.trace("isPlatformAuthAllowed: allowPlatformBroker is not enabled, returning false"),!1;if(!n)return t.trace("isPlatformAuthAllowed: Platform auth provider is not initialized, returning false"),!1;if(r)switch(r){case De.BEARER:case De.POP:return t.trace("isPlatformAuthAllowed: authenticationScheme is supported, returning true"),!0;default:return t.trace("isPlatformAuthAllowed: authenticationScheme is not supported, returning false"),!1}return!0}class Rd extends Zu{constructor(e,t,n,r,o,i,a,s,l,c){super(e,t,n,r,o,i,a,l,c),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=s,this.eventHandler=o}acquireToken(e,t){let n;try{var r;if(n={popupName:this.generatePopupName(e.scopes||$,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:null!==(r=e.popupWindowParent)&&void 0!==r?r:window},this.performanceClient.addFields({isAsyncPopup:this.config.system.asyncPopups},this.correlationId),this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,n,t);{const r=c(c({},e),{},{httpMethod:Xu(e,this.config.auth.protocolMode)});return this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),n.popup=this.openSizedPopup("about:blank",n),this.acquireTokenPopupAsync(r,n,t)}}catch(o){return Promise.reject(o)}}logout(e){try{var t;this.logger.verbose("logoutPopup called");const n=this.initializeLogoutRequest(e),r={popupName:this.generateLogoutPopupName(n),popupWindowAttributes:(null===e||void 0===e?void 0:e.popupWindowAttributes)||{},popupWindowParent:null!==(t=null===e||void 0===e?void 0:e.popupWindowParent)&&void 0!==t?t:window},o=e&&e.authority,i=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(n,r,o,i)):(this.logger.verbose("asyncPopup set to false, opening popup"),r.popup=this.openSizedPopup("about:blank",r),this.logoutPopupAsync(n,r,o,i))}catch(n){return Promise.reject(n)}}async acquireTokenPopupAsync(e,t,n){this.logger.verbose("acquireTokenPopupAsync called");const r=await hc(this.initializeAuthorizationRequest.bind(this),Yr,this.logger,this.performanceClient,this.correlationId)(e,Wi.Popup);t.popup&&jl(r.authority);const o=Nd(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme);return r.platformBroker=o,this.config.auth.protocolMode===st?this.executeEarFlow(r,t):this.executeCodeFlow(r,t,n)}async executeCodeFlow(e,t,n){const r=e.correlationId,o=this.initializeServerTelemetryManager(Di),i=n||await hc(xd,Ro,this.logger,this.performanceClient,r)(this.performanceClient,this.logger,r),a=c(c({},e),{},{codeChallenge:i.challenge});try{const n=await hc(this.createAuthCodeClient.bind(this),Gr,this.logger,this.performanceClient,r)({serverTelemetryManager:o,requestAuthority:a.authority,requestAzureCloudOptions:a.azureCloudOptions,requestExtraQueryParameters:a.extraQueryParameters,account:a.account});if(a.httpMethod===J)return await this.executeCodeFlowWithPost(a,t,n,i.verifier);{const o=await hc(yd,Jr,this.logger,this.performanceClient,r)(this.config,n.authority,a,this.logger,this.performanceClient),s=this.initiateAuthRequest(o,t);this.eventHandler.emitEvent(Su,Wi.Popup,{popupWindow:s},null);const l=await this.monitorPopupForHash(s,t.popupWindowParent),c=dc(ed,uo,this.logger,this.performanceClient,this.correlationId)(l,this.config.auth.OIDCOptions.serverResponseType,this.logger);return await hc(Cd,no,this.logger,this.performanceClient,r)(e,c,i.verifier,Di,this.config,n,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}}catch(l){var s;throw null===(s=t.popup)||void 0===s||s.close(),l instanceof ht&&(l.setCorrelationId(this.correlationId),o.cacheFailedRequest(l)),l}}async executeEarFlow(e,t){const n=e.correlationId,r=await hc(this.getDiscoveredAuthority.bind(this),xr,this.logger,this.performanceClient,n)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),o=await hc(gl,Bo,this.logger,this.performanceClient,n)(),i=c(c({},e),{},{earJwk:o}),a=t.popup||this.openPopup("about:blank",t);(await vd(a.document,this.config,r,i,this.logger,this.performanceClient)).submit();const s=await hc(this.monitorPopupForHash.bind(this),Kr,this.logger,this.performanceClient,n)(a,t.popupWindowParent),l=dc(ed,uo,this.logger,this.performanceClient,this.correlationId)(s,this.config.auth.OIDCOptions.serverResponseType,this.logger);return hc(Sd,eo,this.logger,this.performanceClient,n)(i,l,Di,this.config,r,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async executeCodeFlowWithPost(e,t,n,r){const o=e.correlationId,i=await hc(this.getDiscoveredAuthority.bind(this),xr,this.logger,this.performanceClient,o)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),a=t.popup||this.openPopup("about:blank",t);(await bd(a.document,this.config,i,e,this.logger,this.performanceClient)).submit();const s=await hc(this.monitorPopupForHash.bind(this),Kr,this.logger,this.performanceClient,o)(a,t.popupWindowParent),l=dc(ed,uo,this.logger,this.performanceClient,this.correlationId)(s,this.config.auth.OIDCOptions.serverResponseType,this.logger);return hc(Cd,no,this.logger,this.performanceClient,o)(e,l,r,Di,this.config,n,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async logoutPopupAsync(e,t,n,r){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(xu,Wi.Popup,e);const o=this.initializeServerTelemetryManager(Ki);try{await this.clearCacheOnLogout(this.correlationId,e.account);const s=await hc(this.createAuthCodeClient.bind(this),Gr,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:o,requestAuthority:n,account:e.account||void 0});try{s.authority.endSessionEndpoint}catch(l){var i;if(null!==(i=e.account)&&void 0!==i&&i.homeAccountId&&e.postLogoutRedirectUri&&s.authority.protocolMode===at){var a;if(this.eventHandler.emitEvent(Au,Wi.Popup,e),r){const e={apiId:Ki,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=$n.getAbsoluteUrl(r,El());await this.navigationClient.navigateInternal(t,e)}return void(null===(a=t.popup)||void 0===a||a.close())}}const c=s.getLogoutUri(e);this.eventHandler.emitEvent(Au,Wi.Popup,e);const u=this.openPopup(c,t);if(this.eventHandler.emitEvent(Su,Wi.Popup,{popupWindow:u},null),await this.monitorPopupForHash(u,t.popupWindowParent).catch(()=>{}),r){const e={apiId:Ki,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=$n.getAbsoluteUrl(r,El());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: ".concat(t)),await this.navigationClient.navigateInternal(t,e)}else this.logger.verbose("No main window navigation requested")}catch(c){var s;throw null===(s=t.popup)||void 0===s||s.close(),c instanceof ht&&(c.setCorrelationId(this.correlationId),o.cacheFailedRequest(c)),this.eventHandler.emitEvent(Tu,Wi.Popup,null,c),this.eventHandler.emitEvent(Iu,Wi.Popup),c}this.eventHandler.emitEvent(Iu,Wi.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii("Navigate to: ".concat(e)),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),ns(aa)}monitorPopupForHash(e,t){return new Promise((t,n)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const r=setInterval(()=>{if(e.closed)return this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(r),void n(ns(ma));let o="";try{o=e.location.href}catch(s){}if(!o||"about:blank"===o)return;clearInterval(r);let i="";const a=this.config.auth.OIDCOptions.serverResponseType;e&&(i=a===ve?e.location.search:e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),t(i)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,t)})}openPopup(e,t){try{let n;if(t.popup?(n=t.popup,this.logger.verbosePii("Navigating popup window to: ".concat(e)),n.location.assign(e)):"undefined"===typeof t.popup&&(this.logger.verbosePii("Opening popup window to: ".concat(e)),n=this.openSizedPopup(e,t)),!n)throw ns(fa);return n.focus&&n.focus(),this.currentWindow=n,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),n}catch(n){throw this.logger.error("error opening popup "+n.message),ns(ga)}}openSizedPopup(e,t){var n,r,o,i;let{popupName:a,popupWindowAttributes:s,popupWindowParent:l}=t;const c=l.screenLeft?l.screenLeft:l.screenX,u=l.screenTop?l.screenTop:l.screenY,d=l.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,h=l.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let g=null===(n=s.popupSize)||void 0===n?void 0:n.width,f=null===(r=s.popupSize)||void 0===r?void 0:r.height,m=null===(o=s.popupPosition)||void 0===o?void 0:o.top,p=null===(i=s.popupPosition)||void 0===i?void 0:i.left;return(!g||g<0||g>d)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),g=ii),(!f||f<0||f>h)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),f=ai),(!m||m<0||m>h)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),m=Math.max(0,h/2-ai/2+u)),(!p||p<0||p>d)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),p=Math.max(0,d/2-ii/2+c)),l.open(e,a,"width=".concat(g,", height=").concat(f,", top=").concat(m,", left=").concat(p,", scrollbars=yes"))}unloadWindow(e){this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow)}generatePopupName(e,t){return"".concat(si,".").concat(this.config.auth.clientId,".").concat(e.join("-"),".").concat(t,".").concat(this.correlationId)}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return"".concat(si,".").concat(this.config.auth.clientId,".").concat(t,".").concat(this.correlationId)}}class Md extends Zu{constructor(e,t,n,r,o,i,a,s,l,c){super(e,t,n,r,o,i,a,l,c),this.nativeStorage=s}async acquireToken(e){const t=await hc(this.initializeAuthorizationRequest.bind(this),Yr,this.logger,this.performanceClient,this.correlationId)(e,Wi.Redirect);t.platformBroker=Nd(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme);const n=e=>{e.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.resetRequestCache(),this.eventHandler.emitEvent(Pu,Wi.Redirect))},r=this.getRedirectStartPage(e.redirectStartPage);this.logger.verbosePii("Redirect start page: ".concat(r)),this.browserStorage.setTemporaryCache(Ei,r,!0),window.addEventListener("pageshow",n);try{this.config.auth.protocolMode===st?await this.executeEarFlow(t):await this.executeCodeFlow(t,e.onRedirectNavigate)}catch(o){throw o instanceof ht&&o.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",n),o}}async executeCodeFlow(e,t){const n=e.correlationId,r=this.initializeServerTelemetryManager(qi),o=await hc(xd,Ro,this.logger,this.performanceClient,n)(this.performanceClient,this.logger,n),i=c(c({},e),{},{codeChallenge:o.challenge});this.browserStorage.cacheAuthorizeRequest(i,o.verifier);try{if(i.httpMethod===J)return await this.executeCodeFlowWithPost(i);{const n=await hc(this.createAuthCodeClient.bind(this),Gr,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:i.authority,requestAzureCloudOptions:i.azureCloudOptions,requestExtraQueryParameters:i.extraQueryParameters,account:i.account}),o=await hc(yd,Jr,this.logger,this.performanceClient,e.correlationId)(this.config,n.authority,i,this.logger,this.performanceClient);return await this.initiateAuthRequest(o,t)}}catch(a){throw a instanceof ht&&(a.setCorrelationId(this.correlationId),r.cacheFailedRequest(a)),a}}async executeEarFlow(e){const t=e.correlationId,n=await hc(this.getDiscoveredAuthority.bind(this),xr,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),r=await hc(gl,Bo,this.logger,this.performanceClient,t)(),o=c(c({},e),{},{earJwk:r});this.browserStorage.cacheAuthorizeRequest(o);return(await vd(document,this.config,n,o,this.logger,this.performanceClient)).submit(),new Promise((e,t)=>{setTimeout(()=>{t(ns(Xa,"failed_to_redirect"))},this.config.system.redirectNavigationTimeout)})}async executeCodeFlowWithPost(e){const t=e.correlationId,n=await hc(this.getDiscoveredAuthority.bind(this),xr,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});this.browserStorage.cacheAuthorizeRequest(e);return(await bd(document,this.config,n,e,this.logger,this.performanceClient)).submit(),new Promise((e,t)=>{setTimeout(()=>{t(ns(Xa,"failed_to_redirect"))},this.config.system.redirectNavigationTimeout)})}async handleRedirectPromise(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;const o=this.initializeServerTelemetryManager(Fi);try{const[i,a]=this.getRedirectResponse(e||"");if(!i)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.resetRequestCache(),"back_forward"!==function(){if("undefined"===typeof window||"undefined"===typeof window.performance||"function"!==typeof window.performance.getEntriesByType)return;const e=window.performance.getEntriesByType("navigation"),t=e.length?e[0]:void 0;return null===t||void 0===t?void 0:t.type}()?r.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const s=this.browserStorage.getTemporaryCache(Ei,!0)||H.EMPTY_STRING,l=Jn(s);if(l===Jn(window.location.href)&&this.config.auth.navigateToLoginRequestUrl){this.logger.verbose("Current page is loginRequestUrl, handling response"),s.indexOf("#")>-1&&function(e){const t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""}(s);return await this.handleResponse(i,t,n,o)}if(!this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(i,t,n,o);if(!Pl()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(_i,a,!0);const e={apiId:Fi,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let r=!0;if(s&&"null"!==s)this.logger.verbose("Navigating to loginRequestUrl: ".concat(s)),r=await this.navigationClient.navigateInternal(s,e);else{const t=function(){const e=new $n(window.location.href).getUrlComponents();return"".concat(e.Protocol,"//").concat(e.HostNameAndPort,"/")}();this.browserStorage.setTemporaryCache(Ei,t,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),r=await this.navigationClient.navigateInternal(t,e)}if(!r)return await this.handleResponse(i,t,n,o)}return null}catch(i){throw i instanceof ht&&(i.setCorrelationId(this.correlationId),o.cacheFailedRequest(i)),i}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(t=this.config.auth.OIDCOptions.serverResponseType===ve?window.location.search:window.location.hash);let n=Qn(t);if(n){try{td(n,this.browserCrypto,Wi.Redirect)}catch(o){return o instanceof ht&&this.logger.error("Interaction type validation failed due to ".concat(o.errorCode,": ").concat(o.errorMessage)),[null,""]}return Il(window),this.logger.verbose("Hash contains known properties, returning response hash"),[n,t]}const r=this.browserStorage.getTemporaryCache(_i,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(_i)),r&&(n=Qn(r),n)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[n,r]):[null,""]}async handleResponse(e,t,n,r){if(!e.state)throw ns(la);if(e.ear_jwe){const n=await hc(this.getDiscoveredAuthority.bind(this),xr,this.logger,this.performanceClient,t.correlationId)({requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account});return hc(Sd,eo,this.logger,this.performanceClient,t.correlationId)(t,e,qi,this.config,n,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}const o=await hc(this.createAuthCodeClient.bind(this),Gr,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:t.authority});return hc(Cd,no,this.logger,this.performanceClient,t.correlationId)(t,e,n,qi,this.config,o,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: ".concat(e));const n={apiId:qi,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},r=t||this.config.auth.onRedirectNavigate;if("function"===typeof r){this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback");return!1!==r(e)?(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),void await this.navigationClient.navigateExternal(e,n)):void this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation")}return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),void await this.navigationClient.navigateExternal(e,n)}throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),ns(aa)}async logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e),n=this.initializeServerTelemetryManager(Bi);try{this.eventHandler.emitEvent(xu,Wi.Redirect,e),await this.clearCacheOnLogout(this.correlationId,t.account);const i={apiId:Bi,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=await hc(this.createAuthCodeClient.bind(this),Gr,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:e&&e.authority,requestExtraQueryParameters:null===e||void 0===e?void 0:e.extraQueryParameters,account:e&&e.account||void 0});if(a.authority.protocolMode===at)try{a.authority.endSessionEndpoint}catch(o){var r;if(null!==(r=t.account)&&void 0!==r&&r.homeAccountId)return void this.eventHandler.emitEvent(Au,Wi.Redirect,t)}const s=a.getLogoutUri(t);if(this.eventHandler.emitEvent(Au,Wi.Redirect,t),!e||"function"!==typeof e.onRedirectNavigate)return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,Pi),void await this.navigationClient.navigateExternal(s,i);if(!1!==e.onRedirectNavigate(s))return this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,Pi),void await this.navigationClient.navigateExternal(s,i);this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation")}catch(i){throw i instanceof ht&&(i.setCorrelationId(this.correlationId),n.cacheFailedRequest(i)),this.eventHandler.emitEvent(Tu,Wi.Redirect,null,i),this.eventHandler.emitEvent(Iu,Wi.Redirect),i}this.eventHandler.emitEvent(Iu,Wi.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return $n.getAbsoluteUrl(t,El())}}async function Od(e,t,n,r,o){if(t.addQueueMeasurement(Br,r),!e)throw n.info("Navigate url is empty"),ns(aa);return o?hc(Dd,Wr,n,t,r)(e,o,t,r):dc(zd,Vr,n,t,r)(e)}async function jd(e,t,n,r,o){const i=Fd();if(!i.contentDocument)throw"No document associated with iframe!";return(await bd(i.contentDocument,e,t,n,r,o)).submit(),i}async function Ld(e,t,n,r,o){const i=Fd();if(!i.contentDocument)throw"No document associated with iframe!";return(await vd(i.contentDocument,e,t,n,r,o)).submit(),i}async function qd(e,t,n,r,o,i,a){return r.addQueueMeasurement(Kr,i),new Promise((r,i)=>{t<Ll&&o.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower (".concat(t,"ms) than the default (").concat(Ll,"ms). This may result in timeouts."));const s=window.setTimeout(()=>{window.clearInterval(l),i(ns(ya))},t),l=window.setInterval(()=>{let t="";const n=e.contentWindow;try{t=n?n.location.href:""}catch(i){}if(!t||"about:blank"===t)return;let o="";n&&(o=a===ve?n.location.search:n.location.hash),window.clearTimeout(s),window.clearInterval(l),r(o)},n)}).finally(()=>{dc(Ud,To,o,r,i)(e)})}function Dd(e,t,n,r){return n.addQueueMeasurement(Wr,r),new Promise((n,r)=>{const o=Fd();window.setTimeout(()=>{o?(o.src=e,n(o)):r("Unable to load iframe")},t)})}function zd(e){const t=Fd();return t.src=e,t}function Fd(){const e=document.createElement("iframe");return e.className="msalSilentIframe",e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(e),e}function Ud(e){document.body===e.parentNode&&document.body.removeChild(e)}class Hd extends Zu{constructor(e,t,n,r,o,i,a,s,l,c,u){super(e,t,n,r,o,i,s,c,u),this.apiId=a,this.nativeStorage=l}async acquireToken(e){this.performanceClient.addQueueMeasurement(wr,e.correlationId),e.loginHint||e.sid||e.account&&e.account.username||this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const t=c({},e);t.prompt?t.prompt!==fe&&t.prompt!==me&&(this.logger.warning("SilentIframeClient. Replacing invalid prompt ".concat(t.prompt," with ").concat(fe)),t.prompt=fe):t.prompt=fe;const n=await hc(this.initializeAuthorizationRequest.bind(this),Yr,this.logger,this.performanceClient,e.correlationId)(t,Wi.Silent);return n.platformBroker=Nd(this.config,this.logger,this.platformAuthProvider,n.authenticationScheme),jl(n.authority),this.config.auth.protocolMode===st?this.executeEarFlow(n):this.executeCodeFlow(n)}async executeCodeFlow(e){let t;const n=this.initializeServerTelemetryManager(this.apiId);try{return t=await hc(this.createAuthCodeClient.bind(this),Gr,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:n,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),await hc(this.silentTokenHelper.bind(this),Hr,this.logger,this.performanceClient,e.correlationId)(t,e)}catch(r){if(r instanceof ht&&(r.setCorrelationId(this.correlationId),n.cacheFailedRequest(r)),!t||!(r instanceof ht)||r.errorCode!==oi)throw r;return this.performanceClient.addFields({retryError:r.errorCode},this.correlationId),await hc(this.silentTokenHelper.bind(this),Hr,this.logger,this.performanceClient,this.correlationId)(t,e)}}async executeEarFlow(e){const t=e.correlationId,n=await hc(this.getDiscoveredAuthority.bind(this),xr,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),r=await hc(gl,Bo,this.logger,this.performanceClient,t)(),o=c(c({},e),{},{earJwk:r}),i=await hc(Ld,Br,this.logger,this.performanceClient,t)(this.config,n,o,this.logger,this.performanceClient),a=this.config.auth.OIDCOptions.serverResponseType,s=await hc(qd,Kr,this.logger,this.performanceClient,t)(i,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,t,a),l=dc(ed,uo,this.logger,this.performanceClient,t)(s,a,this.logger);return hc(Sd,eo,this.logger,this.performanceClient,t)(o,l,this.apiId,this.config,n,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}logout(){return Promise.reject(ns(Ca))}async silentTokenHelper(e,t){const n=t.correlationId;this.performanceClient.addQueueMeasurement(Hr,n);const r=await hc(xd,Ro,this.logger,this.performanceClient,n)(this.performanceClient,this.logger,n),o=c(c({},t),{},{codeChallenge:r.challenge});let i;if(t.httpMethod===J)i=await hc(jd,Br,this.logger,this.performanceClient,n)(this.config,e.authority,o,this.logger,this.performanceClient);else{const t=await hc(yd,Jr,this.logger,this.performanceClient,n)(this.config,e.authority,o,this.logger,this.performanceClient);i=await hc(Od,Br,this.logger,this.performanceClient,n)(t,this.performanceClient,this.logger,n,this.config.system.navigateFrameWait)}const a=this.config.auth.OIDCOptions.serverResponseType,s=await hc(qd,Kr,this.logger,this.performanceClient,n)(i,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,n,a),l=dc(ed,uo,this.logger,this.performanceClient,n)(s,a,this.logger);return hc(Cd,no,this.logger,this.performanceClient,n)(t,l,r.verifier,this.apiId,this.config,e,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}}class Bd extends Du{constructor(e,t){super(e,t)}async acquireToken(e){var t,n;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(_r,e.correlationId);const r=fc(),o=await hc(this.executeTokenRequest.bind(this),Er,this.logger,this.performanceClient,e.correlationId)(e,this.authority),i=null===(n=o.headers)||void 0===n?void 0:n[re],a=new Bu(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return a.validateTokenResponse(o.body),hc(a.handleServerTokenResponse.bind(a),co,this.logger,this.performanceClient,e.correlationId)(o.body,this.authority,r,e,void 0,void 0,!0,e.forceCache,i)}async acquireTokenByRefreshToken(e){var t;if(!e)throw Ln(vn);if(null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Rr,e.correlationId),!e.account)throw sn(Dt);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await hc(this.acquireTokenWithCachedRefreshToken.bind(this),Nr,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(n){const t=n instanceof zc&&n.errorCode===Nc,r=n instanceof Lu&&n.errorCode===Be&&n.subError===Ke;if(t||r)return hc(this.acquireTokenWithCachedRefreshToken.bind(this),Nr,this.logger,this.performanceClient,e.correlationId)(e,!1);throw n}return hc(this.acquireTokenWithCachedRefreshToken.bind(this),Nr,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(Nr,e.correlationId);const r=dc(this.cacheManager.getRefreshToken.bind(this.cacheManager),Po,this.logger,this.performanceClient,e.correlationId)(e.account,t,e.correlationId,void 0,this.performanceClient);if(!r)throw Uc(Nc);var o;if(r.expiresOn&&yc(r.expiresOn,e.refreshTokenExpirationOffsetSeconds||300))throw null===(o=this.performanceClient)||void 0===o||o.addFields({rtExpiresOnMs:Number(r.expiresOn)},e.correlationId),Uc(Mc);const i=c(c({},e),{},{refreshToken:r.secret,authenticationScheme:e.authenticationScheme||De.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:Mu}});try{return await hc(this.acquireToken.bind(this),_r,this.logger,this.performanceClient,e.correlationId)(i)}catch(s){var a;if(s instanceof zc)if(null===(a=this.performanceClient)||void 0===a||a.addFields({rtExpiresOnMs:Number(r.expiresOn)},e.correlationId),s.subError===jc){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const t=this.cacheManager.generateCredentialKey(r);this.cacheManager.removeRefreshToken(t,e.correlationId)}throw s}}async executeTokenRequest(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(Er,e.correlationId);const r=this.createTokenQueryParameters(e),o=$n.appendQueryString(t.tokenEndpoint,r),i=await hc(this.createTokenRequestBody.bind(this),Mr,this.logger,this.performanceClient,e.correlationId)(e),a=this.createTokenRequestHeaders(e.ccsCredential),s=Vc(this.config.authOptions.clientId,e);return hc(this.executePostToTokenEndpoint.bind(this),Ir,this.logger,this.performanceClient,e.correlationId)(o,i,a,s,e.correlationId,Ir)}async createTokenRequestBody(e){var t,n,r;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Mr,e.correlationId);const o=new Map;if(ks(o,e.embeddedClientId||(null===(n=e.tokenBodyParameters)||void 0===n?void 0:n[cs])||this.config.authOptions.clientId),e.redirectUri&&Cs(o,e.redirectUri),ws(o,e.scopes,!0,null===(r=this.config.authOptions.authority.options.OIDCOptions)||void 0===r?void 0:r.defaultScopes),Ls(o,Ce),qs(o),Es(o,this.config.libraryInfo),_s(o,this.config.telemetry.application),Ks(o),this.serverTelemetryManager&&!ni(this.config)&&Bs(o,this.serverTelemetryManager),function(e,t){e.set("refresh_token",t)}(o,e.refreshToken),this.config.clientCredentials.clientSecret&&Ms(o,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const t=this.config.clientCredentials.clientAssertion;Os(o,await Wu(t.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),js(o,t.assertionType)}if(e.authenticationScheme===De.POP){const t=new Uu(this.cryptoUtils,this.performanceClient);let n;if(e.popKid)n=this.cryptoUtils.encodeKid(e.popKid);else{n=(await hc(t.generateCnf.bind(t),so,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString}Us(o,n)}else if(e.authenticationScheme===De.SSH){if(!e.sshJwk)throw Ln(An);Hs(o,e.sshJwk)}if((!qn.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&Is(o,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case Mu:try{As(o,Bc(e.ccsCredential.credential))}catch(i){this.logger.verbose("Could not parse home account ID for CCS Header: "+i)}break;case Ou:xs(o,e.ccsCredential.credential)}return e.embeddedClientId&&Ws(o,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&zs(o,e.tokenBodyParameters),vs(o,e.correlationId,this.performanceClient),Yn(o)}}class Kd extends Zu{async acquireToken(e){this.performanceClient.addQueueMeasurement(Cr,e.correlationId);const t=await hc(Ju,Dr,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),n=c(c({},e),t);e.redirectUri&&(n.redirectUri=this.getRedirectUri(e.redirectUri));const r=this.initializeServerTelemetryManager(Hi),o=await this.createRefreshTokenClient({serverTelemetryManager:r,authorityUrl:n.authority,azureCloudOptions:n.azureCloudOptions,account:n.account});return hc(o.acquireTokenByRefreshToken.bind(o),Rr,this.logger,this.performanceClient,e.correlationId)(n).catch(e=>{throw e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e),e})}logout(){return Promise.reject(ns(Ca))}async createRefreshTokenClient(e){const t=await hc(this.getClientConfiguration.bind(this),Qr,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new Bd(t,this.performanceClient)}}class Wd{constructor(e,t,n,r){this.isBrowserEnvironment="undefined"!==typeof window,this.config=e,this.storage=t,this.logger=n,this.cryptoObj=r}async loadExternalTokens(e,t,n){if(!this.isBrowserEnvironment)throw ns(Ea);const r=e.correlationId||dl(),o=t.id_token?Kn(t.id_token,Js):void 0,i={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},a=e.authority?new Ec(Ec.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,i,this.logger,e.correlationId||dl()):void 0,s=await this.loadAccount(e,n.clientInfo||t.client_info||"",r,o,a),l=await this.loadIdToken(t,s.homeAccountId,s.environment,s.realm,r),c=await this.loadAccessToken(e,t,s.homeAccountId,s.environment,s.realm,n,r),u=await this.loadRefreshToken(t,s.homeAccountId,s.environment,r);return this.generateAuthenticationResult(e,{account:s,idToken:l,accessToken:c,refreshToken:u},o,a)}async loadAccount(e,t,n,r,o){if(this.logger.verbose("TokenCache - loading account"),e.account){const t=Wc.createFromAccountInfo(e.account);return await this.storage.setAccount(t,n),t}if(!o||!t&&!r)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),ns(ja);const i=Wc.generateHomeAccountId(t,o.authorityType,this.logger,this.cryptoObj,r),a=null===r||void 0===r?void 0:r.tid,s=Ku(this.storage,o,i,Js,n,r,t,o.hostnameAndPort,a,void 0,void 0,this.logger);return await this.storage.setAccount(s,n),s}async loadIdToken(e,t,n,r,o){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const i=bc(t,n,e.id_token,this.config.auth.clientId,r);return await this.storage.setIdTokenCredential(i,o),i}async loadAccessToken(e,t,n,r,o,i,a){if(!t.access_token)return this.logger.verbose("TokenCache - no access token found in response"),null;if(!t.expires_in)return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;if(!t.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null;this.logger.verbose("TokenCache - loading access token");const s=t.scope?Dn.fromString(t.scope):new Dn(e.scopes),l=i.expiresOn||t.expires_in+fc(),c=i.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+fc(),u=wc(n,r,t.access_token,this.config.auth.clientId,o,s.printScopes(),l,c,Js);return await this.storage.setAccessTokenCredential(u,a),u}async loadRefreshToken(e,t,n,r){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const o=kc(t,n,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return await this.storage.setRefreshTokenCredential(o,r),o}generateAuthenticationResult(e,t,n,r){var o,i,a;let s,l="",c=[],u=null;null!==t&&void 0!==t&&t.accessToken&&(l=t.accessToken.secret,c=Dn.fromString(t.accessToken.target).asArray(),u=pc(t.accessToken.expiresOn),s=pc(t.accessToken.extendedExpiresOn));const d=t.account;return{authority:r?r.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:c,account:d.getAccountInfo(),idToken:(null===(o=t.idToken)||void 0===o?void 0:o.secret)||"",idTokenClaims:n||{},accessToken:l,fromCache:!0,expiresOn:u,correlationId:e.correlationId||"",requestId:"",extExpiresOn:s,familyId:(null===(i=t.refreshToken)||void 0===i?void 0:i.familyId)||"",tokenType:(null===t||void 0===t||null===(a=t.accessToken)||void 0===a?void 0:a.tokenType)||"",state:e.state||"",cloudGraphHostName:d.cloudGraphHostName||"",msGraphHost:d.msGraphHost||"",fromNativeBroker:!1}}}class Vd extends Vu{constructor(e){super(e),this.includeRedirectUri=!1}}class Gd extends Zu{constructor(e,t,n,r,o,i,a,s,l,c){super(e,t,n,r,o,i,s,l,c),this.apiId=a}async acquireToken(e){if(!e.code)throw ns(qa);const t=await hc(this.initializeAuthorizationRequest.bind(this),Yr,this.logger,this.performanceClient,e.correlationId)(e,Wi.Silent),n=this.initializeServerTelemetryManager(this.apiId);try{const r=c(c({},t),{},{code:e.code}),o=await hc(this.getClientConfiguration.bind(this),Qr,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:n,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),i=new Vd(o);this.logger.verbose("Auth code client created");const a=new id(i,this.browserStorage,r,this.logger,this.performanceClient);return await hc(a.handleCodeResponseFromServer.bind(a),Xr,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(r){throw r instanceof ht&&(r.setCorrelationId(this.correlationId),n.cacheFailedRequest(r)),r}}logout(){return Promise.reject(ns(Ca))}}function Qd(e,t,n){try{Ml(e)}catch(r){throw t.end({success:!1},r,n),r}}class Yd{constructor(e){var t,n,r,o;this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new ic(this.logger,this.performanceClient):ln,this.eventHandler=new Ru(this.logger),this.browserStorage=this.isBrowserEnvironment?new _u(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,function(e){const t=e.cloudDiscoveryMetadata;let n;if(t)try{n=JSON.parse(t)}catch(r){throw Ln(Cn)}return{canonicalAuthority:e.authority?_c(e.authority):void 0,knownAuthorities:e.knownAuthorities,cloudDiscoveryMetadata:n}}(this.config.auth)):(t=this.config.auth.clientId,n=this.logger,r=this.performanceClient,o=this.eventHandler,new _u(t,{cacheLocation:xi,cacheRetentionDays:5,temporaryCacheLocation:xi,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1},ln,n,r,o));const i={cacheLocation:xi,cacheRetentionDays:5,temporaryCacheLocation:xi,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new _u(this.config.auth.clientId,i,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler),this.tokenCache=new Wd(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static async createController(e,t){const n=new Yd(e);return await n.initialize(t),n}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e,t){if(this.logger.trace("initialize called"),this.initialized)return void this.logger.info("initialize has already been called, exiting early.");if(!this.isBrowserEnvironment)return this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,void this.eventHandler.emitEvent(ou);const n=(null===e||void 0===e?void 0:e.correlationId)||this.getRequestCorrelationId(),r=this.config.system.allowPlatformBroker,o=this.performanceClient.startMeasurement(Fr,n);if(this.eventHandler.emitEvent(ru),!t)try{this.logMultipleInstances(o)}catch(i){}if(await hc(this.browserStorage.initialize.bind(this.browserStorage),Ur,this.logger,this.performanceClient,n)(n),r)try{this.platformAuthProvider=await _d(this.logger,this.performanceClient,n,this.config.system.nativeBrokerHandshakeTimeout)}catch(a){this.logger.verbose(a)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),dc(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),Io,this.logger,this.performanceClient,n)(n)),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(n),this.initialized=!0,this.eventHandler.emitEvent(ou),o.end({allowPlatformBroker:r,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),Rl(this.initialized),this.isBrowserEnvironment){const t=e||"";let n=this.redirectResponse.get(t);return"undefined"===typeof n?(n=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,n),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),n}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){var t;if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;if((null===(t=this.browserStorage.getInteractionInProgress())||void 0===t?void 0:t.type)===Pi)return this.logger.verbose("handleRedirectPromise removing interaction_in_progress flag and returning null after sign-out"),this.browserStorage.setInteractionInProgress(!1),Promise.resolve(null);const n=this.getAllAccounts(),r=this.browserStorage.getCachedNativeRequest(),o=r&&this.platformAuthProvider&&!e;let i,a;this.eventHandler.emitEvent(ku,Wi.Redirect);try{if(o&&this.platformAuthProvider){i=this.performanceClient.startMeasurement(pr,(null===r||void 0===r?void 0:r.correlationId)||""),this.logger.trace("handleRedirectPromise - acquiring token from native platform"),i.add({isPlatformBrokerRequest:!0});const e=new md(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Fi,this.performanceClient,this.platformAuthProvider,r.accountId,this.nativeInternalStorage,r.correlationId);a=hc(e.handleRedirectPromise.bind(e),xo,this.logger,this.performanceClient,i.event.correlationId)(this.performanceClient,i.event.correlationId)}else{const[t,n]=this.browserStorage.getCachedRequest(),r=t.correlationId;i=this.performanceClient.startMeasurement(pr,r),this.logger.trace("handleRedirectPromise - acquiring token from web flow");const o=this.createRedirectClient(r);a=hc(o.handleRedirectPromise.bind(o),So,this.logger,this.performanceClient,i.event.correlationId)(e,t,n,i)}}catch(s){throw this.browserStorage.resetRequestCache(),s}return a.then(e=>{if(e){this.browserStorage.resetRequestCache();n.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(cu,Wi.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(hu,Wi.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),i.end({success:!0},void 0,e.account)}else i.event.errorCode?i.end({success:!1},void 0):i.discard();return this.eventHandler.emitEvent(Cu,Wi.Redirect),e}).catch(e=>{this.browserStorage.resetRequestCache();const t=e;throw n.length>0?this.eventHandler.emitEvent(gu,Wi.Redirect,null,t):this.eventHandler.emitEvent(uu,Wi.Redirect,null,t),this.eventHandler.emitEvent(Cu,Wi.Redirect),i.end({success:!1},t),e})}async acquireTokenRedirect(e){const t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);const n=this.performanceClient.startMeasurement(mr,t);n.add({scenarioId:e.scenarioId});const r=e.onRedirectNavigate;if(r)e.onRedirectNavigate=t=>{const o="function"===typeof r?r(t):void 0;return n.add({navigateCallbackResult:!1!==o}),n.event=n.end({success:!0},void 0,e.account)||n.event,o};else{const t=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=r=>{const o="function"===typeof t?t(r):void 0;return n.add({navigateCallbackResult:!1!==o}),n.event=n.end({success:!0},void 0,e.account)||n.event,o}}const o=this.getAllAccounts().length>0;try{let r;if(Ol(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,Ii),o?this.eventHandler.emitEvent(du,Wi.Redirect,e):this.eventHandler.emitEvent(lu,Wi.Redirect,e),this.platformAuthProvider&&this.canUsePlatformBroker(e)){r=new md(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,qi,this.performanceClient,this.platformAuthProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,n).catch(r=>{if(n.add({brokerErrorName:r.name,brokerErrorCode:r.errorCode}),r instanceof ld&&cd(r)){this.platformAuthProvider=void 0;return this.createRedirectClient(t).acquireToken(e)}if(r instanceof zc){this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow");return this.createRedirectClient(t).acquireToken(e)}throw r})}else{r=this.createRedirectClient(t).acquireToken(e)}return await r}catch(i){throw this.browserStorage.resetRequestCache(),2===n.event.status?this.performanceClient.startMeasurement(pr,t).end({success:!1},i,e.account):n.end({success:!1},i,e.account),o?this.eventHandler.emitEvent(gu,Wi.Redirect,null,i):this.eventHandler.emitEvent(uu,Wi.Redirect,null,i),i}}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(fr,t);n.add({scenarioId:e.scenarioId});try{this.logger.verbose("acquireTokenPopup called",t),Qd(this.initialized,n,e.account),this.browserStorage.setInteractionInProgress(!0,Ii)}catch(a){return Promise.reject(a)}const r=this.getAllAccounts();let o;r.length>0?this.eventHandler.emitEvent(du,Wi.Popup,e):this.eventHandler.emitEvent(lu,Wi.Popup,e);const i=this.getPreGeneratedPkceCodes(t);if(this.canUsePlatformBroker(e))n.add({isPlatformBrokerRequest:!0}),o=this.acquireTokenNative(c(c({},e),{},{correlationId:t}),Di).then(e=>(n.end({success:!0},void 0,e.account),e)).catch(r=>{if(n.add({brokerErrorName:r.name,brokerErrorCode:r.errorCode}),r instanceof ld&&cd(r)){this.platformAuthProvider=void 0;return this.createPopupClient(t).acquireToken(e,i)}if(r instanceof zc){this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow");return this.createPopupClient(t).acquireToken(e,i)}throw r});else{o=this.createPopupClient(t).acquireToken(e,i)}return o.then(e=>(r.length<this.getAllAccounts().length?this.eventHandler.emitEvent(cu,Wi.Popup,e):this.eventHandler.emitEvent(hu,Wi.Popup,e),n.end({success:!0,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length},void 0,e.account),e)).catch(t=>(r.length>0?this.eventHandler.emitEvent(gu,Wi.Popup,null,t):this.eventHandler.emitEvent(uu,Wi.Popup,null,t),n.end({success:!1},t,e.account),Promise.reject(t))).finally(async()=>{this.browserStorage.setInteractionInProgress(!1),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(t)})}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){var t,n;const r=this.getRequestCorrelationId(e),o=c(c({},e),{},{prompt:e.prompt,correlationId:r});let i;if(this.ssoSilentMeasurement=this.performanceClient.startMeasurement(Sr,r),null===(t=this.ssoSilentMeasurement)||void 0===t||t.add({scenarioId:e.scenarioId}),Qd(this.initialized,this.ssoSilentMeasurement,e.account),null===(n=this.ssoSilentMeasurement)||void 0===n||n.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",r),this.eventHandler.emitEvent(mu,Wi.Silent,o),this.canUsePlatformBroker(o)){var a;null===(a=this.ssoSilentMeasurement)||void 0===a||a.add({isPlatformBrokerRequest:!0}),i=this.acquireTokenNative(o,zi).catch(e=>{var t;if(null===(t=this.ssoSilentMeasurement)||void 0===t||t.add({brokerErrorName:e.name,brokerErrorCode:e.errorCode}),e instanceof ld&&cd(e)){this.platformAuthProvider=void 0;return this.createSilentIframeClient(o.correlationId).acquireToken(o)}throw e})}else{i=this.createSilentIframeClient(o.correlationId).acquireToken(o)}return i.then(e=>{var t;return this.eventHandler.emitEvent(pu,Wi.Silent,e),null===(t=this.ssoSilentMeasurement)||void 0===t||t.end({success:!0,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length},void 0,e.account),e}).catch(t=>{var n;throw this.eventHandler.emitEvent(yu,Wi.Silent,null,t),null===(n=this.ssoSilentMeasurement)||void 0===n||n.end({success:!1},t,e.account),t}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(e){const t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);const n=this.performanceClient.startMeasurement(ur,t);Qd(this.initialized,n),this.eventHandler.emitEvent(vu,Wi.Silent,e),n.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw ns(za);if(e.code){const r=e.code;let o=this.hybridAuthCodeResponses.get(r);return o?(this.logger.verbose("Existing acquireTokenByCode request found",t),n.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),o=this.acquireTokenByCodeAsync(c(c({},e),{},{correlationId:t})).then(e=>(this.eventHandler.emitEvent(bu,Wi.Silent,e),this.hybridAuthCodeResponses.delete(r),n.end({success:!0,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length},void 0,e.account),e)).catch(e=>{throw this.hybridAuthCodeResponses.delete(r),this.eventHandler.emitEvent(wu,Wi.Silent,null,e),n.end({success:!1},e),e}),this.hybridAuthCodeResponses.set(r,o)),await o}if(e.nativeAccountId){if(this.canUsePlatformBroker(e,e.nativeAccountId)){n.add({isPlatformBrokerRequest:!0});const r=await this.acquireTokenNative(c(c({},e),{},{correlationId:t}),Ui,e.nativeAccountId).catch(e=>{throw e instanceof ld&&cd(e)&&(this.platformAuthProvider=void 0),n.add({brokerErrorName:e.name,brokerErrorCode:e.errorCode}),e});return n.end({success:!0},void 0,r.account),r}throw ns(Ua)}throw ns(Da)}catch(r){throw this.eventHandler.emitEvent(wu,Wi.Silent,null,r),n.end({success:!1},r),r}}async acquireTokenByCodeAsync(e){var t;this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(Co,e.correlationId),null===(t=this.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement);const n=this.createSilentAuthCodeClient(e.correlationId);return await n.acquireToken(e).then(e=>{var t;return null===(t=this.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.end({success:!0,fromCache:e.fromCache}),e}).catch(e=>{var t;throw null===(t=this.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.end({success:!1},e),e}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(Or,e.correlationId),t){case Yi:case Ji:case $i:const t=this.createSilentCacheClient(e.correlationId);return hc(t.acquireToken.bind(t),br,this.logger,this.performanceClient,e.correlationId)(e);default:throw sn(Vt)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(dr,e.correlationId),t){case Yi:case $i:case Xi:case Zi:const t=this.createSilentRefreshClient(e.correlationId);return hc(t.acquireToken.bind(t),Cr,this.logger,this.performanceClient,e.correlationId)(e);default:throw sn(Vt)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(qr,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return hc(t.acquireToken.bind(t),wr,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect(c({correlationId:t},e))}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);Ol(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,Pi);return this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);Ml(this.initialized),this.browserStorage.setInteractionInProgress(!0,Pi);return this.createPopupClient(t).logout(e).finally(()=>{this.browserStorage.setInteractionInProgress(!1)})}catch(t){return Promise.reject(t)}}async clearCache(e){if(!this.isBrowserEnvironment)return void this.logger.info("in non-browser environment, returning early.");const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){const t=this.getRequestCorrelationId();return function(e,t,n,r,o){return e.verbose("getAllAccounts called"),n?t.getAllAccounts(o||{},r):[]}(this.logger,this.browserStorage,this.isBrowserEnvironment,t,e)}getAccount(e){const t=this.getRequestCorrelationId();return function(e,t,n,r){const o=n.getAccountInfoFilteredBy(e,r);return o?(t.verbose("getAccount: Account matching provided filter found, returning"),o):(t.verbose("getAccount: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}getAccountByUsername(e){const t=this.getRequestCorrelationId();return function(e,t,n,r){if(t.trace("getAccountByUsername called"),!e)return t.warning("getAccountByUsername: No username provided"),null;const o=n.getAccountInfoFilteredBy({username:e},r);return o?(t.verbose("getAccountByUsername: Account matching username found, returning"),t.verbosePii("getAccountByUsername: Returning signed-in accounts matching username: ".concat(e)),o):(t.verbose("getAccountByUsername: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}getAccountByHomeId(e){const t=this.getRequestCorrelationId();return function(e,t,n,r){if(t.trace("getAccountByHomeId called"),!e)return t.warning("getAccountByHomeId: No homeAccountId provided"),null;const o=n.getAccountInfoFilteredBy({homeAccountId:e},r);return o?(t.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),t.verbosePii("getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ".concat(e)),o):(t.verbose("getAccountByHomeId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}getAccountByLocalId(e){const t=this.getRequestCorrelationId();return function(e,t,n,r){if(t.trace("getAccountByLocalId called"),!e)return t.warning("getAccountByLocalId: No localAccountId provided"),null;const o=n.getAccountInfoFilteredBy({localAccountId:e},r);return o?(t.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),t.verbosePii("getAccountByLocalId: Returning signed-in accounts matching localAccountId: ".concat(e)),o):(t.verbose("getAccountByLocalId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}setActiveAccount(e){const t=this.getRequestCorrelationId();!function(e,t,n){t.setActiveAccount(e,n)}(e,this.browserStorage,t)}getActiveAccount(){const e=this.getRequestCorrelationId();return function(e,t){return e.getActiveAccount(t)}(this.browserStorage,e)}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const n=Wc.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return await this.browserStorage.setAccount(n,e.correlationId),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,n,r){if(this.logger.trace("acquireTokenNative called"),!this.platformAuthProvider)throw ns(Ka);return new md(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.platformAuthProvider,n||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e,r)}canUsePlatformBroker(e,t){if(this.logger.trace("canUsePlatformBroker called"),!this.platformAuthProvider)return this.logger.trace("canUsePlatformBroker: platform broker unavilable, returning false"),!1;if(!Nd(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme))return this.logger.trace("canUsePlatformBroker: isBrokerAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case fe:case ge:case de:case he:this.logger.trace("canUsePlatformBroker: prompt is compatible with platform broker flow");break;default:return this.logger.trace("canUsePlatformBroker: prompt = ".concat(e.prompt," is not compatible with platform broker flow, returning false")),!1}return!(!t&&!this.getNativeAccountId(e))||(this.logger.trace("canUsePlatformBroker: nativeAccountId is not available, returning false"),!1)}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new Rd(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createRedirectClient(e){return new Md(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createSilentIframeClient(e){return new Hd(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,zi,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createSilentCacheClient(e){return new hd(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.platformAuthProvider,e)}createSilentRefreshClient(e){return new Kd(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.platformAuthProvider,e)}createSilentAuthCodeClient(e){return new Gd(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ui,this.performanceClient,this.platformAuthProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return Nl(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){this.config.cache.cacheLocation===Ci?this.eventHandler.subscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}disableAccountStorageEvents(){this.config.cache.cacheLocation===Ci?this.eventHandler.unsubscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return null!==e&&void 0!==e&&e.correlationId?e.correlationId:this.isBrowserEnvironment?dl():H.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect(c({correlationId:t},e||Vi))}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup(c({correlationId:t},e||Vi))}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(hr,t);n.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),Qd(this.initialized,n,e.account),this.logger.verbose("acquireTokenSilent called",t);const r=e.account||this.getActiveAccount();if(!r)throw ns(Sa);return this.acquireTokenSilentDeduped(e,r,t).then(r=>(n.end({success:!0,fromCache:r.fromCache,accessTokenSize:r.accessToken.length,idTokenSize:r.idToken.length},void 0,r.account),c(c({},r),{},{state:e.state,correlationId:t}))).catch(e=>{throw e instanceof ht&&e.setCorrelationId(t),n.end({success:!1},e,r),e})}async acquireTokenSilentDeduped(e,t,n){const r=Vc(this.config.auth.clientId,c(c({},e),{},{authority:e.authority||this.config.auth.authority,correlationId:n}),t.homeAccountId),o=JSON.stringify(r),i=this.activeSilentTokenRequests.get(o);if("undefined"===typeof i){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",n),this.performanceClient.addFields({deduped:!1},n);const r=hc(this.acquireTokenSilentAsync.bind(this),gr,this.logger,this.performanceClient,n)(c(c({},e),{},{correlationId:n}),t);return this.activeSilentTokenRequests.set(o,r),r.finally(()=>{this.activeSilentTokenRequests.delete(o)})}return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",n),this.performanceClient.addFields({deduped:!0},n),i}async acquireTokenSilentAsync(e,t){const n=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(gr,e.correlationId),this.eventHandler.emitEvent(du,Wi.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",n);const r=await hc($u,zr,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),o=e.cacheLookupPolicy||Yi;return this.acquireTokenSilentNoIframe(r,o).catch(async e=>{const t=function(e,t){const n=!(e instanceof zc&&e.subError!==jc),r=e.errorCode===oi||e.errorCode===Vt,o=n&&r||e.errorCode===Nc||e.errorCode===Mc,i=ta.includes(t);return o&&i}(e,o);if(t){if(this.activeIframeRequest){if(o!==ea){const[t,n]=this.activeIframeRequest;this.logger.verbose("Iframe request is already in progress, awaiting resolution for request with correlationId: ".concat(n),r.correlationId);const i=this.performanceClient.startMeasurement(kr,r.correlationId);i.add({awaitIframeCorrelationId:n});const a=await t;if(i.end({success:a}),a)return this.logger.verbose("Parallel iframe request with correlationId: ".concat(n," succeeded. Retrying cache and/or RT redemption"),r.correlationId),this.acquireTokenSilentNoIframe(r,o);throw this.logger.info("Iframe request with correlationId: ".concat(n," failed. Interaction is required.")),e}return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",r.correlationId),hc(this.acquireTokenBySilentIframe.bind(this),qr,this.logger,this.performanceClient,r.correlationId)(r)}{let e;return this.activeIframeRequest=[new Promise(t=>{e=t}),r.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",r.correlationId),hc(this.acquireTokenBySilentIframe.bind(this),qr,this.logger,this.performanceClient,r.correlationId)(r).then(t=>(e(!0),t)).catch(t=>{throw e(!1),t}).finally(()=>{this.activeIframeRequest=void 0})}}throw e}).then(t=>(this.eventHandler.emitEvent(hu,Wi.Silent,t),this.performanceClient.addFields({fromCache:t.fromCache},e.correlationId),t)).catch(e=>{throw this.eventHandler.emitEvent(gu,Wi.Silent,null,e),e}).finally(()=>{document.removeEventListener("visibilitychange",n)})}async acquireTokenSilentNoIframe(e,t){return Nd(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.performanceClient.addFields({isPlatformBrokerRequest:!0},e.correlationId),this.acquireTokenNative(e,Hi,e.account.nativeAccountId,t).catch(async t=>{if(this.performanceClient.addFields({brokerErrorName:t.name,brokerErrorCode:t.errorCode},e.correlationId),t instanceof ld&&cd(t))throw this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.platformAuthProvider=void 0,sn(Vt);throw t})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),t===Ji&&this.logger.verbose("acquireTokenSilent - cache lookup policy set to AccessToken, attempting to acquire token from local cache"),hc(this.acquireTokenFromCache.bind(this),Or,this.logger,this.performanceClient,e.correlationId)(e,t).catch(n=>{if(t===Ji)throw n;return this.eventHandler.emitEvent(fu,Wi.Silent,e),hc(this.acquireTokenByRefreshToken.bind(this),dr,this.logger,this.performanceClient,e.correlationId)(e,t)}))}async preGeneratePkceCodes(e){return this.logger.verbose("Generating new PKCE codes"),this.pkceCode=await hc(xd,Ro,this.logger,this.performanceClient,e)(this.performanceClient,this.logger,e),Promise.resolve()}getPreGeneratedPkceCodes(e){this.logger.verbose("Attempting to pick up pre-generated PKCE codes");const t=this.pkceCode?c({},this.pkceCode):void 0;return this.pkceCode=void 0,this.logger.verbose("".concat(t?"Found":"Did not find"," pre-generated PKCE codes")),this.performanceClient.addFields({usePreGeneratedPkce:!!t},e),t}logMultipleInstances(e){const t=this.config.auth.clientId;if(!window)return;window.msal=window.msal||{},window.msal.clientIds=window.msal.clientIds||[];window.msal.clientIds.length>0&&this.logger.verbose("There is already an instance of MSAL.js in the window."),window.msal.clientIds.push(t),function(e,t,n){var r;const o=(null===(r=window.msal)||void 0===r?void 0:r.clientIds)||[],i=o.length,a=o.filter(t=>t===e).length;a>1&&n.warning("There is already an instance of MSAL.js in the window with the same client id."),t.add({msalInstanceCount:i,sameClientIdInstanceCount:a})}(t,e,this.logger)}}class Jd{static async createPublicClientApplication(e){const t=await async function(e,t){const n=new Yl(e);return await n.initialize(),Yd.createController(n,t)}(e);return new Jd(e,t)}constructor(e,t){this.isBroker=!1,this.controller=t||new Yd(new Yl(e))}async initialize(e){return this.controller.initialize(e,this.isBroker)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}class $d{constructor(e){this.config={siteUrl:e.siteUrl||"https://evokebehavioralhealthcom.sharepoint.com/sites/Clinistrators",staffListName:e.staffListName||"Staff",studentsListName:e.studentsListName||"Clients",scheduleListName:e.scheduleListName||"ABASchedules",clientId:e.clientId,tenantId:e.tenantId,redirectUri:e.redirectUri},this.msalConfig={auth:{clientId:this.config.clientId,authority:"https://login.microsoftonline.com/".concat(this.config.tenantId),redirectUri:this.config.redirectUri},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1}},this.msalInstance=new Jd(this.msalConfig),this.isInitialized=!1,this.accessToken=null,this.tokenExpiry=null,this.requestDigest=null,this.digestExpiry=null,this.loginRequest={scopes:["https://evokebehavioralhealthcom.sharepoint.com/.default"],prompt:"select_account"},console.log("\ud83d\udd27 SharePointService initialized:",{siteUrl:this.config.siteUrl,clientId:this.config.clientId,redirectUri:this.config.redirectUri,scopes:this.loginRequest.scopes})}async initializeMSAL(){if(!this.isInitialized)try{console.log("\ud83d\udd04 Initializing MSAL..."),await this.msalInstance.initialize(),this.isInitialized=!0,console.log("\u2705 MSAL initialized successfully")}catch(e){throw console.error("\u274c MSAL initialization failed:",e),e}}async login(){try{console.log("\ud83d\udd10 Starting MSAL login..."),await this.initializeMSAL();const t=this.msalInstance.getAllAccounts();if(t.length>0)try{const e=await this.msalInstance.acquireTokenSilent(c(c({},this.loginRequest),{},{account:t[0]}));return this.accessToken=e.accessToken,this.tokenExpiry=e.expiresOn.getTime(),console.log("\u2705 Silent login successful"),!0}catch(e){console.log("\u26a0\ufe0f Silent login failed, will redirect...")}return console.log("\ud83d\udd17 Redirecting to Microsoft login..."),console.log("\ud83d\udccb Login request:",this.loginRequest),await this.msalInstance.loginRedirect(this.loginRequest),!1}catch(t){throw console.error("\u274c MSAL login failed:",t),t}}async checkAuthentication(){try{await this.initializeMSAL();const t=await this.msalInstance.handleRedirectPromise();if(t)return console.log("\u2705 Login redirect handled successfully"),console.log("\ud83d\udccb Token response:",{scopes:t.scopes,tokenType:t.tokenType,expiresOn:t.expiresOn}),this.accessToken=t.accessToken,this.tokenExpiry=t.expiresOn.getTime(),!0;const n=this.msalInstance.getAllAccounts();if(n.length>0){console.log("\u2705 Found existing account:",n[0].username);try{const e=await this.msalInstance.acquireTokenSilent(c(c({},this.loginRequest),{},{account:n[0]}));return this.accessToken=e.accessToken,this.tokenExpiry=e.expiresOn.getTime(),console.log("\u2705 Token acquired silently"),!0}catch(e){return console.log("\u26a0\ufe0f Silent token acquisition failed:",e.message),!1}}return console.log("\u26a0\ufe0f No authenticated accounts found"),!1}catch(e){return console.error("\u274c Authentication check failed:",e),!1}}async getCachedToken(){try{await this.initializeMSAL();const e=this.msalInstance.getAllAccounts();if(0===e.length)return null;const t=await this.msalInstance.acquireTokenSilent(c(c({},this.loginRequest),{},{account:e[0]}));return console.log("\u2705 Retrieved token silently from MSAL"),this.tokenExpiry=t.expiresOn.getTime(),t.accessToken}catch(e){return console.log("\u26a0\ufe0f Could not get token silently:",e.message),null}}forceLogout(){console.log("\ud83d\udeaa Logging out with MSAL..."),this.accessToken=null,this.tokenExpiry=null;const e=this.msalInstance.getAllAccounts();e.length>0&&this.msalInstance.logoutRedirect({account:e[0]})}async getRequestDigest(){if(this.requestDigest&&this.digestExpiry&&Date.now()<this.digestExpiry)return this.requestDigest;try{const e=await fetch("".concat(this.config.siteUrl,"/_api/contextinfo"),{method:"POST",headers:{Accept:"application/json;odata=verbose",Authorization:"Bearer ".concat(this.accessToken)}});if(e.ok){const t=await e.json();return this.requestDigest=t.d.GetContextWebInformation.FormDigestValue,this.digestExpiry=Date.now()+1e3*t.d.GetContextWebInformation.FormDigestTimeoutSeconds-6e4,this.requestDigest}throw new Error("Failed to get request digest: ".concat(e.status))}catch(e){throw console.error("Error getting request digest:",e),e}}async getHeaders(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t={Accept:"application/json;odata=verbose",Authorization:"Bearer ".concat(this.accessToken)};if(e){const e=await this.getRequestDigest();t["X-RequestDigest"]=e,t["Content-Type"]="application/json;odata=verbose"}return t}async makeRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.accessToken)throw new Error("No access token available. Please login first.");try{const n=await fetch(e,t);if(401===n.status)throw new Error("Authentication failed. Access token may have expired.");return n}catch(n){throw console.error("SharePoint request failed:",n),n}}async loadStaff(){try{console.log("\ud83d\udd0d Loading staff from SharePoint REST API...");const e=await this.getHeaders(),t="".concat(this.config.siteUrl,"/_api/web/lists/getbytitle('").concat(this.config.staffListName,"')/items?")+"$select=Id,StaffPerson/Id,StaffPerson/Title,StaffPerson/EMail,Role,PrimaryProgram,SecondaryProgram,IsActive&$expand=StaffPerson&$top=5000";console.log("\ud83d\udccb Fetching staff from:",t);const n=await this.makeRequest(t,{headers:e});if(!n.ok){const e=await n.text();throw console.error("SharePoint Staff API Error:",n.status,e),new Error("Failed to load staff: ".concat(n.status," - ").concat(e))}const r=await n.json();console.log("\ud83d\udd0d Raw SharePoint staff response:",r);const o=r.d.results||[];return console.log("\u2705 Found ".concat(o.length," staff members")),o.length>0&&console.log("\ud83d\udccb First staff item:",o[0]),o.map(e=>{const t=e.StaffPerson,n=t?t.Title:"Unknown Staff",r=t?t.EMail:"",o=new L({id:t?t.Id:e.Id,name:n,role:e.Role||"RBT",email:r,primaryProgram:!0===e.PrimaryProgram,secondaryProgram:!0===e.SecondaryProgram,isActive:!1!==e.IsActive});return console.log("\u2705 Loaded staff: ".concat(o.name," (").concat(o.role,") - Primary: ").concat(o.primaryProgram,", Secondary: ").concat(o.secondaryProgram)),o})}catch(e){throw console.error("Error loading staff:",e),e}}async loadStudents(){try{console.log("\ud83d\udd0d Loading students from SharePoint REST API...");const e=await this.getHeaders(),t="".concat(this.config.siteUrl,"/_api/web/lists/getbytitle('").concat(this.config.studentsListName,"')/items?")+"$select=Id,Title,Program,RatioAM,RatioPM,IsActive,PairedWith,Team/Id,Team/Title,Team/EMail&$expand=Team&$top=5000";console.log("\ud83d\udccb Fetching students from:",t);const n=await this.makeRequest(t,{headers:e});if(!n.ok){const e=await n.text();throw console.error("\u274c SharePoint Students API Error:",n.status,e),new Error("Failed to load students: ".concat(n.status," - ").concat(e))}const r=await n.json();console.log("\ud83d\udd0d Raw SharePoint students response:",r);const o=r.d.results||[];return console.log("\u2705 Found ".concat(o.length," students")),o.length>0&&(console.log("\ud83d\udccb First student item:",o[0]),console.log("\ud83d\udccb First student team data:",o[0].Team)),this.parseStudents(o)}catch(e){throw console.error("\u274c Error loading students:",e),e}}parseStudents(e){console.log("\ud83d\udd0d Parsing ".concat(e.length," students"));const t=e.map(e=>{console.log("\ud83d\udd0d Processing student: ".concat(e.Title));let t=[],n=[];e.Team&&(e.Team.results&&Array.isArray(e.Team.results)?(console.log("  \ud83d\udccb Team data for ".concat(e.Title,":"),e.Team.results),t=e.Team.results.map(e=>({id:e.Id,title:e.Title,name:e.Title,email:e.EMail||""})),n=t.map(e=>e.id)):e.Team.Id&&(console.log("  \ud83d\udccb Single team member for ".concat(e.Title,":"),e.Team),t=[{id:e.Team.Id,title:e.Team.Title,name:e.Team.Title,email:e.Team.EMail||""}],n=[e.Team.Id]));const r=new q({id:e.Id,name:e.Title,program:e.Program||M.PRIMARY,ratioAM:e.RatioAM||"1:1",ratioPM:e.RatioPM||"1:1",isActive:!1!==e.IsActive,team:t,teamIds:n,pairedWith:e.PairedWith||null});return t.length>0?console.log("\u2705 ".concat(e.Title," has ").concat(t.length," team members:"),t.map(e=>e.title)):console.log("\u26a0\ufe0f ".concat(e.Title," has no team members")),r});return console.log("\ud83d\udcca STUDENT LOAD SUMMARY:"),console.log("  Total students: ".concat(t.length)),console.log("  Students with teams: ".concat(t.filter(e=>e.team&&e.team.length>0).length)),t}async loadSchedule(e){try{return console.log("\ud83d\udcc5 Schedule loading temporarily disabled - returning empty schedule"),new z({date:e,assignments:[],lockedAssignments:new Set,isFinalized:!1})}catch(t){return console.error("Error in loadSchedule:",t),new z({date:e})}}async saveStaff(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{const n=await this.getHeaders(!0);t&&(n["X-HTTP-Method"]="MERGE",n["If-Match"]="*");const r=t?"".concat(this.config.siteUrl,"/_api/web/lists/getbytitle('").concat(this.config.staffListName,"')/items(").concat(e.id,")"):"".concat(this.config.siteUrl,"/_api/web/lists/getbytitle('").concat(this.config.staffListName,"')/items"),o={__metadata:{type:"SP.Data.StaffListItem"},Title:e.name,Role:e.role,Email:e.email,PrimaryProgram:e.primaryProgram,SecondaryProgram:e.secondaryProgram,IsActive:e.isActive},i=await this.makeRequest(r,{method:"POST",headers:n,body:JSON.stringify(o)});if(!i.ok)throw new Error("Failed to save staff: ".concat(i.status));return i}catch(n){throw console.error("Error saving staff:",n),n}}async saveStudent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{const n=await this.getHeaders(!0);t&&(n["X-HTTP-Method"]="MERGE",n["If-Match"]="*");const r=t?"".concat(this.config.siteUrl,"/_api/web/lists/getbytitle('").concat(this.config.studentsListName,"')/items(").concat(e.id,")"):"".concat(this.config.siteUrl,"/_api/web/lists/getbytitle('").concat(this.config.studentsListName,"')/items"),o={__metadata:{type:"SP.Data.ClientsListItem"},Title:e.name,Program:e.program,RatioAM:e.ratioAM,RatioPM:e.ratioPM,IsActive:e.isActive},i=await this.makeRequest(r,{method:"POST",headers:n,body:JSON.stringify(o)});if(!i.ok)throw new Error("Failed to save student: ".concat(i.status));return i}catch(n){throw console.error("Error saving student:",n),n}}async saveSchedule(e){try{return console.log("\ud83d\udcbe Schedule saving temporarily disabled"),!0}catch(t){return console.error("Error saving schedule:",t),!1}}async saveAssignment(e){try{return console.log("\ud83d\udcbe Assignment saving temporarily disabled"),{success:!0,id:e.id}}catch(t){return console.error("Error saving assignment:",t),{success:!1}}}}class Xd{constructor(e){this.config=e,this.accessToken=null}setAccessToken(e){this.accessToken=e}getHeaders(){const e={Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"};return this.accessToken&&(e.Authorization="Bearer ".concat(this.accessToken)),e}async searchUsers(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{const n=await fetch("".concat(this.config.siteUrl,"/_api/web/siteusers?$filter=substringof('").concat(e,"',Title) or substringof('").concat(e,"',Email)&$top=").concat(t),{headers:this.getHeaders()});if(!n.ok)throw new Error("Failed to search users: ".concat(n.status));return(await n.json()).d.results.map(e=>({id:e.Id,title:e.Title,email:e.Email,loginName:e.LoginName,principalType:e.PrincipalType}))}catch(n){throw console.error("Error searching users:",n),n}}async getUserById(e){try{const t=await fetch("".concat(this.config.siteUrl,"/_api/web/siteusers/getbyid(").concat(e,")"),{headers:this.getHeaders()});if(!t.ok)throw new Error("Failed to get user: ".concat(t.status));const n=await t.json();return{id:n.d.Id,title:n.d.Title,email:n.d.Email,loginName:n.d.LoginName,principalType:n.d.PrincipalType}}catch(t){throw console.error("Error getting user by ID:",t),t}}async resolveUserByEmail(e){try{const t=await fetch("".concat(this.config.siteUrl,"/_api/web/ensureuser"),{method:"POST",headers:c(c({},this.getHeaders()),{},{"X-RequestDigest":await this.getRequestDigest()}),body:JSON.stringify({logonName:e})});if(!t.ok)throw new Error("Failed to resolve user: ".concat(t.status));const n=await t.json();return{id:n.d.Id,title:n.d.Title,email:n.d.Email,loginName:n.d.LoginName,principalType:n.d.PrincipalType}}catch(t){throw console.error("Error resolving user by email:",t),t}}async getRequestDigest(){try{const e=await fetch("".concat(this.config.siteUrl,"/_api/contextinfo"),{method:"POST",headers:this.getHeaders()});if(!e.ok)throw new Error("Failed to get request digest: ".concat(e.status));return(await e.json()).d.GetContextWebInformation.FormDigestValue}catch(e){throw console.error("Error getting request digest:",e),e}}formatForPeoplePicker(e){return e&&0!==e.length?{results:e}:null}extractUserIds(e){return e&&e.results?e.results.map(e=>e.Id||e.id):[]}async getAllSiteUsers(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];try{let t="".concat(this.config.siteUrl,"/_api/web/siteusers?$top=1000");e&&(t+="&$filter=PrincipalType eq 1");const n=await fetch(t,{headers:this.getHeaders()});if(!n.ok)throw new Error("Failed to get site users: ".concat(n.status));return(await n.json()).d.results.filter(e=>e.Title&&e.Email).map(e=>({id:e.Id,title:e.Title,email:e.Email,loginName:e.LoginName,principalType:e.PrincipalType})).sort((e,t)=>e.title.localeCompare(t.title))}catch(t){throw console.error("Error getting all site users:",t),t}}async validateUserIds(e){const t=[],n=[];for(const o of e)try{const e=await this.getUserById(o);t.push(e)}catch(r){n.push(o)}return{validUsers:t,invalidIds:n}}}class Zd{constructor(){this.debugMode=!1}async autoAssignSchedule(e,t,n){const r=[],o=[];this.log("Starting auto-assignment process...");const i=t.filter(e=>e.isActive),a=n.filter(e=>e.isActive);this.log("Active staff: ".concat(i.length,", Active students: ").concat(a.length)),console.log("\ud83d\udd0d STAFF DEBUGGING - Active Staff Details:"),i.forEach((e,t)=>{console.log("  Staff ".concat(t+1,": ").concat(e.name," (ID: ").concat(e.id,")")),console.log("    Role: ".concat(e.role)),console.log("    Primary Program: ".concat(e.primaryProgram)),console.log("    Secondary Program: ".concat(e.secondaryProgram)),console.log("    Can work Primary: ".concat(e.canWorkProgram(M.PRIMARY))),console.log("    Can work Secondary: ".concat(e.canWorkProgram(M.SECONDARY))),console.log("    Can do 1:1 sessions: ".concat(e.canDo1To1Sessions())),console.log("---")});const s=["AM","PM"],l=[M.PRIMARY,M.SECONDARY];for(const u of l)for(const t of s){this.log("\nProcessing ".concat(u," ").concat(t," session..."));const n=a.filter(n=>n.program===u&&!this.isStudentAssigned(n.id,t,u,e));this.log("Students needing assignment: ".concat(n.length)),console.log("\ud83d\udd0d STUDENTS DEBUGGING - ".concat(u," ").concat(t," Students:")),n.forEach((e,n)=>{const r="AM"===t?e.ratioAM:e.ratioPM;console.log("  Student ".concat(n+1,": ").concat(e.name," (ID: ").concat(e.id,")")),console.log("    Program: ".concat(e.program)),console.log("    ".concat(t," Ratio: ").concat(r)),console.log("---")});const s=this.prioritizeStudents(n);for(const l of s)try{if(l.isPaired()){this.log("\ud83d\udd17 ".concat(l.name," is paired with student ID: ").concat(l.pairedWith));const c=l.getPairedStudent(a);if(c&&n.includes(c)){this.log("\ud83d\udd17 Found paired student: ".concat(c.name));const n=await this.assignPairedStudents(l,c,t,u,i,e);if(n.length>0){r.push(...n),n.forEach(t=>e.addAssignment(t)),this.log("\u2713 Assigned paired students ".concat(l.name," and ").concat(c.name));const t=s.indexOf(c);t>-1&&s.splice(t,1)}else o.push("Could not assign paired students ".concat(l.name," and ").concat(c.name," in ").concat(u," ").concat(t)),this.log("\u2717 Could not assign paired students ".concat(l.name," and ").concat(c.name));continue}this.log("\ud83d\udd17 Paired student for ".concat(l.name," not found or not in same program"))}const c=await this.assignStudent(l,t,u,i,e);if(c.length>0)r.push(...c),c.forEach(t=>e.addAssignment(t)),this.log("\u2713 Assigned ".concat(c.length," staff to ").concat(l.name));else{o.push("Could not assign ".concat(l.name," in ").concat(u," ").concat(t)),this.log("\u2717 Could not assign ".concat(l.name," - checking available staff...")),console.log("\ud83d\udd0d DEBUGGING FAILED ASSIGNMENT for ".concat(l.name," in ").concat(u," ").concat(t,":"));const n="AM"===t?l.ratioAM:l.ratioPM;console.log("  Required ratio: ".concat(n)),i.forEach((r,o)=>{const i=r.isActive,a=r.canWorkProgram(u),s=e.isStaffAvailable(r.id,t,u),c=e.hasStaffWorkedWithStudentToday(r.id,l.id),d="1:1"!==n||r.canDo1To1Sessions();console.log("    Staff ".concat(o+1,": ").concat(r.name)),console.log("      Active: ".concat(i)),console.log("      Can work ".concat(u,": ").concat(a)),console.log("      Available for ".concat(t,": ").concat(s)),console.log("      Already worked with student today: ".concat(c)),console.log("      Can do 1:1 (if needed): ".concat(d)),console.log("      Overall eligible: ".concat(i&&a&&s&&!c&&d)),console.log("      ---")})}}catch(c){o.push("Error assigning ".concat(l.name,": ").concat(c.message)),this.log("\u2717 Error assigning ".concat(l.name,": ").concat(c.message))}}return this.log("\nAuto-assignment complete. Created ".concat(r.length," assignments.")),o.length>0&&(this.log("Errors: ".concat(o.length)),o.forEach(e=>this.log("  - ".concat(e)))),{assignments:r,errors:o}}async assignStudent(e,t,n,r,o){const i=[],a=this.getRequiredStaffCount(e);if(this.log("".concat(e.name," needs ").concat(a," staff (").concat(e.ratio,")")),e.isSmallGroup())return this.assignSmallGroupStudent(e,t,n,r,o);{const s=U.getAvailableStaffForStudent(e,t,n,r,o),l=s.filter(t=>e.teamIds.includes(t.id));if(this.log("  Available staff: ".concat(s.length,", Team staff: ").concat(l.length)),console.log("\ud83d\udd0d DETAILED TEAM DEBUG for ".concat(e.name,":")),console.log("  Student team array:",e.team),console.log("  Student teamIds array:",e.teamIds),console.log("  Available staff IDs:",s.map(e=>"".concat(e.name," (ID: ").concat(e.id,")"))),console.log("  Team staff after filtering:",l.map(e=>"".concat(e.name," (ID: ").concat(e.id,")"))),l.length<a)return this.log("Insufficient team staff available. Need ".concat(a,", have ").concat(l.length," team members")),this.log("  Team IDs for ".concat(e.name,":"),e.teamIds),this.log("  Available team staff:",l.map(e=>"".concat(e.name," (ID: ").concat(e.id,")"))),console.log("\ud83d\udd0d TEAM MATCHING DEBUG:"),s.forEach(t=>{const n=e.teamIds.includes(t.id);console.log("  Staff ".concat(t.name," (ID: ").concat(t.id,") - In team: ").concat(n))}),[];const c=this.sortStaffForStudent(e,l);for(let u=0;u<a&&u<c.length;u++){const a=new D({id:U.generateAssignmentId(),staffId:c[u].id,studentId:e.id,session:t,program:n,date:o.date,isLocked:!1,assignedBy:"auto"}),s=F.validateAssignment(a,o,r,[e]);0===s.length?(i.push(a),this.log("  Assigned ".concat(c[u].name," to ").concat(e.name))):this.log("  Cannot assign ".concat(c[u].name,": ").concat(s.join(", ")))}}return i}assignSmallGroupStudent(e,t,n,r,o){if("function"!==typeof o.getAssignmentsForSession)return console.error("Schedule object missing getAssignmentsForSession method",o),[];const i=o.getAssignmentsForSession(t,n);for(const s of i){const a=this.findStudentById(s.studentId);if(a&&a.isSmallGroup()){if(1===i.filter(e=>e.staffId===s.staffId).length){const i=r.find(e=>e.id===s.staffId);if(i&&this.canStaffWorkWithStudent(i,e,o)){const r=new D({id:U.generateAssignmentId(),staffId:s.staffId,studentId:e.id,session:t,program:n,date:o.date,isLocked:!1,assignedBy:"auto"});return this.log("  Added ".concat(e.name," to existing small group with ").concat(i.name)),[r]}}}}const a=U.getAvailableStaffForStudent(e,t,n,r,o).filter(t=>e.teamIds.includes(t.id));if(a.length>0){const r=this.sortStaffForStudent(e,a),i=new D({id:U.generateAssignmentId(),staffId:r[0].id,studentId:e.id,session:t,program:n,date:o.date,isLocked:!1,assignedBy:"auto"});return this.log("  Started new small group with ".concat(r[0].name," for ").concat(e.name)),[i]}return[]}sortStaffForStudent(e,t){return[...t].sort((t,n)=>{const r=e.teamIds.includes(t.id),o=e.teamIds.includes(n.id);if(r&&!o)return-1;if(!r&&o)return 1;const i=t.getRoleLevel(),a=n.getRoleLevel();return i!==a?i-a:t.name.localeCompare(n.name)})}prioritizeStudents(e){return[...e].sort((e,t)=>{if(e.requiresMultipleStaff()&&!t.requiresMultipleStaff())return-1;if(!e.requiresMultipleStaff()&&t.requiresMultipleStaff())return 1;const n=e.teamIds.length,r=t.teamIds.length;return n!==r?n-r:e.name.localeCompare(t.name)})}getRequiredStaffCount(e){switch(e.ratio){case j.TWO_TO_ONE:return 2;case j.ONE_TO_ONE:case j.ONE_TO_TWO:default:return 1}}isStudentAssigned(e,t,n,r){if("function"!==typeof r.getAssignmentsForSession)return console.error("Schedule object missing getAssignmentsForSession method",r),!1;return r.getAssignmentsForSession(t,n).some(t=>t.studentId===e)}canStaffWorkWithStudent(e,t,n){return!n.hasStaffWorkedWithStudentToday(e.id,t.id)}findStudentById(e){return null}optimizeAssignments(e,t,n){return this.log("Assignment optimization not yet implemented"),e.assignments}setDebugMode(e){this.debugMode=e}log(e){this.debugMode&&console.log("[AutoAssignment] ".concat(e))}generateStats(e,t,n){const r={totalAssignments:e.assignments.length,staffUtilization:{},unassignedStudents:[],assignmentsBySession:{},ratioDistribution:{}};t.filter(e=>e.isActive).forEach(t=>{const n=e.getStaffAssignments(t.id);r.staffUtilization[t.name]={assignmentCount:n.length,utilizationRate:n.length/2}});const o=n.filter(e=>e.isActive);return o.forEach(t=>{const n=e.getStudentAssignments(t.id);n.length<2&&r.unassignedStudents.push({name:t.name,assignmentCount:n.length,requiredCount:2})}),["AM","PM"].forEach(t=>{[M.PRIMARY,M.SECONDARY].forEach(n=>{const o="".concat(n,"_").concat(t);"function"===typeof e.getAssignmentsForSession?r.assignmentsBySession[o]=e.getAssignmentsForSession(t,n).length:(r.assignmentsBySession[o]=0,console.error("Schedule object missing getAssignmentsForSession method in stats collection"))})}),Object.values(j).forEach(e=>{const t=o.filter(t=>t.ratio===e).length;r.ratioDistribution[e]=t}),r}async assignPairedStudents(e,t,n,r,o,i){const a=[];if(this.log("Assigning paired students: ".concat(e.name," and ").concat(t.name)),this.isStudentAssigned(e.id,n,r,i)||this.isStudentAssigned(t.id,n,r,i))return this.log("One of the paired students is already assigned"),[];const s=this.getRequiredStaffCount(e),l=this.getRequiredStaffCount(t),c=s+l;this.log("Paired students need ".concat(s," + ").concat(l," = ").concat(c," staff total"));const u=U.getAvailableStaffForStudent(e,n,r,o,i).filter(e=>this.canStaffWorkWithStudent(e,t,i));if(u.length<c)return this.log("Insufficient staff for paired students. Need ".concat(c,", have ").concat(u.length)),[];const d=this.sortStaffForStudent(e,u);if(e.isSmallGroup()&&t.isSmallGroup()){if(this.log("Both students are 1:2 ratio - assigning same staff to both"),0===d.length)return this.log("No available staff for paired 1:2 students"),[];const s=d[0],l=new D({id:U.generateAssignmentId(),staffId:s.id,studentId:e.id,session:n,program:r,date:i.date,isLocked:!1,assignedBy:"auto-paired"}),c=new D({id:U.generateAssignmentId(),staffId:s.id,studentId:t.id,session:n,program:r,date:i.date,isLocked:!1,assignedBy:"auto-paired"}),u=F.validateAssignment(l,i,o,[e,t]),h=F.validateAssignment(c,i,o,[e,t]);if(0!==u.length||0!==h.length)return this.log("  Cannot assign ".concat(s.name," to paired students: ").concat([...u,...h].join(", "))),[];a.push(l,c),this.log("  Assigned ".concat(s.name," to both ").concat(e.name," and ").concat(t.name," (shared 1:2)"))}else{this.log("Assigning staff for ratios: ".concat(e.getSessionRatio(n)," and ").concat(t.getSessionRatio(n)));const c=Math.max(s,l);for(let u=0;u<c&&u<d.length;u++){const c=d[u];if(u<s){const s=new D({id:U.generateAssignmentId(),staffId:c.id,studentId:e.id,session:n,program:r,date:i.date,isLocked:!1,assignedBy:"auto-paired"}),l=F.validateAssignment(s,i,o,[e,t]);if(0!==l.length)return this.log("  Cannot assign ".concat(c.name," to ").concat(e.name,": ").concat(l.join(", "))),[];a.push(s),this.log("  Assigned ".concat(c.name," to ").concat(e.name," (paired)"))}if(u<l){const s=new D({id:U.generateAssignmentId(),staffId:c.id,studentId:t.id,session:n,program:r,date:i.date,isLocked:!1,assignedBy:"auto-paired"}),l=F.validateAssignment(s,i,o,[e,t]);if(0!==l.length)return this.log("  Cannot assign ".concat(c.name," to ").concat(t.name,": ").concat(l.join(", "))),[];a.push(s),this.log("  Assigned ".concat(c.name," to ").concat(t.name," (paired)"))}}}const h=a.filter(t=>t.studentId===e.id),g=a.filter(e=>e.studentId===t.id);return h.length===s&&g.length===l?(this.log("Successfully assigned ".concat(a.length," staff to paired students")),a):(this.log("Failed to assign sufficient staff to paired students"),[])}}const eh=y("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),th=y("lock-open",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),nh=y("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),rh=y("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var oh=n(414);const ih=e=>{let{schedule:t,staff:n,students:o,onAssignmentLock:i,onAssignmentUnlock:a,onAssignmentRemove:s,onManualAssignment:l,selectedDate:u}=e;console.log("\ud83d\udd0d ScheduleTableView rendering with:",{studentsCount:o.length,staffCount:n.length,assignmentsCount:t.assignments.length});const[d,h]=(0,r.useState)({}),[g,f]=(0,r.useState)(new Set),m=[...new Set(o.filter(e=>e.isActive).map(e=>e.program))],p=e=>{let t=[];return e.team&&e.team.length>0&&(t=e.team.map(e=>{const t=e.title||e.DisplayName||e.LookupValue;if(!t)return null;let r="RBT",o=e.email;if(e.email){const t=n.find(t=>t.email&&t.email.toLowerCase()===e.email.toLowerCase());t&&(r=t.role)}if("RBT"===r&&e.id){const t=n.find(t=>t.id===e.id);t&&(r=t.role)}return{id:e.id,name:t,role:r,email:o}}).filter(Boolean)),t},y=(e,n)=>{const r=t.assignments.find(t=>t.studentId===e.id&&t.session===n&&t.program===e.program);return t.assignments.length>0&&(console.log("\ud83d\udd0d ASSIGNMENT LOOKUP for ".concat(e.name," ").concat(n,":")),console.log("  Looking for: studentId=".concat(e.id,", session=").concat(n,", program=").concat(e.program)),console.log("  Found assignment:",r),console.log("  All assignments:",t.assignments)),r},v=(e,t)=>"".concat(e,"_").concat(t),b=e=>{let t=e.name;if(e.isPaired()){const n=e.getPairedStudent(o);n&&(t+=" (paired: ".concat(n.name,")"))}return t},w=e=>{const t={[j.ONE_TO_ONE]:"bg-blue-100 text-blue-800",[j.TWO_TO_ONE]:"bg-red-100 text-red-800",[j.ONE_TO_TWO]:"bg-green-100 text-green-800"};return(0,oh.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(t[e.ratio]||"bg-gray-100 text-gray-800"),children:e.ratio})},k=(e,t)=>{const n=p(e),r=y(e,t),i=v(e.id,t),a=((e,t)=>{const n=v(e,t);return g.has(n)})(e.id,t),u=d[i]||(null===r||void 0===r?void 0:r.staffId)||"";if(console.log("\ud83d\udd0d DROPDOWN DEBUG for ".concat(e.name," ").concat(t,":")),console.log("  Team members available:",n.map(e=>"".concat(e.name," (ID: ").concat(e.id,")"))),console.log("  Current assignment:",r),console.log("  Selected staff ID:",u),console.log("  Pre-assignments:",d[i]),r){console.log("  Assignment staff ID: ".concat(r.staffId," (type: ").concat(typeof r.staffId,")"));const e=n.find(e=>e.id===r.staffId||e.id==r.staffId);console.log("  Staff in team?: ".concat(!!e)),e?console.log("  Matching team member:",e):(console.log("  \u274c PROBLEM: Assigned staff ".concat(r.staffId," not found in team!")),console.log("  Team IDs:",n.map(e=>"".concat(e.id," (").concat(typeof e.id,")"))))}return 0===n.length?(0,oh.jsx)("span",{className:"text-gray-400 text-sm",children:"No team"}):(0,oh.jsxs)("div",{className:"flex items-center gap-2",children:[(0,oh.jsxs)("select",{value:u,onChange:n=>((e,t,n)=>{const r=v(e,t);h(e=>c(c({},e),{},{[r]:n?parseInt(n):null}))})(e.id,t,n.target.value),disabled:a,className:"text-sm border rounded px-2 py-1 ".concat(a?"bg-gray-100 text-gray-600":"bg-white"),children:[(0,oh.jsx)("option",{value:"",children:"Select staff..."}),n.map(e=>(0,oh.jsxs)("option",{value:e.id,children:[e.name," (",e.role,")"]},e.id))]}),u&&!a&&(0,oh.jsx)("button",{onClick:()=>((e,t)=>{const n=v(e,t),r=d[n];if(r){const i=o.find(t=>t.id===e);i&&l&&l({staffId:r,studentId:e,session:t,program:i.program}),f(e=>new Set([...e,n]))}})(e.id,t),className:"p-1 text-green-600 hover:text-green-800",title:"Lock this assignment",children:(0,oh.jsx)(eh,{className:"w-4 h-4"})}),a&&(0,oh.jsx)("button",{onClick:()=>((e,t)=>{const n=v(e,t);f(e=>{const t=new Set(e);return t.delete(n),t});const r=y(o.find(t=>t.id===e),t);r&&s&&s(r.id),h(e=>c(c({},e),{},{[n]:null}))})(e.id,t),className:"p-1 text-yellow-600 hover:text-yellow-800",title:"Unlock this assignment",children:(0,oh.jsx)(th,{className:"w-4 h-4"})})]})};return(0,oh.jsx)("div",{className:"space-y-6",children:m.map(e=>{const t=o.filter(t=>t.program===e&&t.isActive);return(0,oh.jsxs)("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[(0,oh.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-4",children:[(0,oh.jsx)("h3",{className:"text-lg font-bold",children:e.toUpperCase()}),(0,oh.jsxs)("p",{className:"text-blue-100 text-sm",children:[t.length," students"]})]}),(0,oh.jsx)("div",{className:"overflow-x-auto",children:(0,oh.jsxs)("table",{className:"w-full",children:[(0,oh.jsx)("thead",{className:"bg-gray-50",children:(0,oh.jsxs)("tr",{children:[(0,oh.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r",children:"Client"}),(0,oh.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r",children:"AM Staff Assignment"}),(0,oh.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r",children:"PM Staff Assignment"}),(0,oh.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Full Team"})]})}),(0,oh.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map((e,t)=>{const n=p(e),r=t%2===0;return(0,oh.jsxs)("tr",{className:r?"bg-white":"bg-gray-50",children:[(0,oh.jsx)("td",{className:"px-6 py-4 whitespace-nowrap border-r",children:(0,oh.jsx)("div",{className:"flex items-center",children:(0,oh.jsxs)("div",{children:[(0,oh.jsx)("div",{className:"text-sm font-medium text-gray-900",children:b(e)}),(0,oh.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[w(e),e.isPaired()&&(0,oh.jsx)("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 rounded text-xs font-medium",children:"Paired"})]})]})})}),(0,oh.jsx)("td",{className:"px-6 py-4 whitespace-nowrap border-r",children:k(e,"AM")}),(0,oh.jsx)("td",{className:"px-6 py-4 whitespace-nowrap border-r",children:k(e,"PM")}),(0,oh.jsx)("td",{className:"px-6 py-4",children:(0,oh.jsx)("div",{className:"flex flex-wrap gap-1",children:n.length>0?n.map((e,t)=>{return(0,oh.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat((n=e.role,{RBT:"bg-purple-100 text-purple-800",BS:"bg-indigo-100 text-indigo-800",BCBA:"bg-blue-100 text-blue-800",EA:"bg-green-100 text-green-800",MHA:"bg-yellow-100 text-yellow-800",CC:"bg-orange-100 text-orange-800",Teacher:"bg-pink-100 text-pink-800",Director:"bg-gray-100 text-gray-800"}[n]||"bg-gray-100 text-gray-800")),children:e.name},t);var n}):(0,oh.jsx)("span",{className:"text-gray-400 text-sm",children:"No team assigned"})})})]},e.id)})})]})})]},e)})})},ah=e=>{let{schedule:t,staff:n,students:r,session:o,program:i}=e;const a=t.getAssignmentsForSession(o,i),s=r.filter(e=>e.program===i&&e.isActive),l=new Set(a.map(e=>e.studentId)),c=s.length-l.size,u={},d=new Set(a.map(e=>e.staffId));a.forEach(e=>{const t=n.find(t=>t.id===e.staffId);if(t){const e=t.role;u[e]||(u[e]=new Set),u[e].add(t.id)}});const h={};Object.keys(u).forEach(e=>{h[e]=u[e].size});const g=s.filter(e=>!l.has(e.id)),f=n.filter(e=>{if(!e.isActive)return!1;return("Primary"===i?e.primaryProgram:e.secondaryProgram)&&!d.has(e.id)}),m={};f.forEach(e=>{const t=e.role;m[t]||(m[t]=[]),m[t].push(e)});const p=e=>({RBT:"bg-purple-100 text-purple-800",BS:"bg-indigo-100 text-indigo-800",BCBA:"bg-blue-100 text-blue-800",EA:"bg-green-100 text-green-800",MHA:"bg-yellow-100 text-yellow-800",CC:"bg-orange-100 text-orange-800",Teacher:"bg-pink-100 text-pink-800",Trainer:"bg-gray-100 text-gray-800",Director:"bg-red-100 text-red-800"}[e]||"bg-gray-100 text-gray-800");return(0,oh.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,oh.jsxs)("h3",{className:"font-semibold text-gray-900 mb-3",children:[i," ",o," Summary"]}),(0,oh.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,oh.jsxs)("div",{className:"flex justify-between",children:[(0,oh.jsx)("span",{children:"Total Students:"}),(0,oh.jsx)("span",{className:"font-medium",children:s.length})]}),(0,oh.jsxs)("div",{className:"flex justify-between",children:[(0,oh.jsx)("span",{children:"Assigned:"}),(0,oh.jsx)("span",{className:"font-medium",children:l.size})]}),(0,oh.jsxs)("div",{className:"flex justify-between",children:[(0,oh.jsx)("span",{children:"Unassigned:"}),(0,oh.jsx)("span",{className:"font-medium ".concat(0===c?"text-green-600":c<=2?"text-yellow-600":"text-red-600"),children:c})]}),(0,oh.jsxs)("div",{className:"flex justify-between",children:[(0,oh.jsx)("span",{children:"Staff Used:"}),(0,oh.jsx)("span",{className:"font-medium",children:d.size})]})]}),Object.keys(h).length>0&&(0,oh.jsxs)("div",{className:"mt-3 border-t pt-3",children:[(0,oh.jsx)("div",{className:"text-xs font-medium text-gray-600 mb-2",children:"Staff by Role:"}),(0,oh.jsx)("div",{className:"space-y-1",children:Object.entries(h).sort((e,t)=>{let[n]=e,[r]=t;return n.localeCompare(r)}).map(e=>{let[t,n]=e;return(0,oh.jsxs)("div",{className:"flex justify-between items-center",children:[(0,oh.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-medium ".concat(p(t)),children:t}),(0,oh.jsx)("span",{className:"text-xs font-semibold",children:n})]},t)})})]}),g.length>0&&(0,oh.jsxs)("div",{className:"mt-3 border-t pt-3",children:[(0,oh.jsx)("div",{className:"text-xs font-medium text-gray-600 mb-2",children:"Unassigned Students:"}),(0,oh.jsx)("div",{className:"space-y-1 max-h-20 overflow-y-auto",children:g.map(e=>(0,oh.jsxs)("div",{className:"text-xs text-gray-700 flex justify-between",children:[(0,oh.jsx)("span",{children:e.name}),(0,oh.jsx)("span",{className:"text-gray-500",children:"AM"===o?e.ratioAM:e.ratioPM})]},e.id))})]}),Object.keys(m).length>0&&(0,oh.jsxs)("div",{className:"mt-3 border-t pt-3",children:[(0,oh.jsx)("div",{className:"text-xs font-medium text-gray-600 mb-2",children:"Available Staff:"}),(0,oh.jsx)("div",{className:"space-y-1 max-h-20 overflow-y-auto",children:Object.entries(m).sort((e,t)=>{let[n]=e,[r]=t;return n.localeCompare(r)}).map(e=>{let[t,n]=e;return(0,oh.jsxs)("div",{className:"space-y-0.5",children:[(0,oh.jsxs)("div",{className:"px-2 py-0.5 rounded text-xs font-medium inline-block ".concat(p(t)),children:[t," (",n.length,")"]}),(0,oh.jsx)("div",{className:"ml-2 space-y-0.5",children:n.map(e=>(0,oh.jsx)("div",{className:"text-xs text-gray-600",children:e.name},e.id))})]},t)})})]}),0===c?(0,oh.jsxs)("div",{className:"mt-3 flex items-center gap-2 text-green-600",children:[(0,oh.jsx)(nh,{className:"w-4 h-4"}),(0,oh.jsx)("span",{className:"text-sm font-medium",children:"Complete"})]}):(0,oh.jsxs)("div",{className:"mt-3 flex items-center gap-2 text-amber-600",children:[(0,oh.jsx)(rh,{className:"w-4 h-4"}),(0,oh.jsx)("span",{className:"text-sm font-medium",children:"Incomplete"})]})]})},sh=y("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),lh=y("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),ch=e=>{let{schedule:t,staff:n,students:o,onValidationChange:i}=e;const[a,s]=(0,r.useState)({errors:[],warnings:[],isValid:!0,lastValidated:null}),[l,c]=(0,r.useState)(!1),[u,d]=(0,r.useState)(!1);(0,r.useEffect)(()=>{h()},[t,n,o]);const h=async()=>{c(!0);try{const e=[],r=[],a=F.validateSchedule(t,n,o);e.push(...a);const l=g();e.push(...l.errors),r.push(...l.warnings);const c={errors:e,warnings:r,isValid:0===e.length,lastValidated:new Date};s(c),i&&i(c)}catch(e){console.error("Validation error:",e),s({errors:["Validation failed: ".concat(e.message)],warnings:[],isValid:!1,lastValidated:new Date})}finally{c(!1)}},g=()=>{const e=[],t=[],r=(o.filter(e=>e.isActive),n.filter(e=>e.isActive),f());e.push(...r);const i=m();e.push(...i);const a=p();t.push(...a);const s=y();e.push(...s);const l=v();t.push(...l);const c=w();return t.push(...c),{errors:e,warnings:t}},f=()=>{const e=[],n=o.filter(e=>e.isActive);for(const r of n){const n=t.getStudentAssignments(r.id);for(const t of["AM","PM"]){const o=n.filter(e=>e.session===t),i=r.ratio===j.TWO_TO_ONE?2:1;o.length>0&&o.length<i&&e.push("".concat(r.name," requires ").concat(i," staff but has only ").concat(o.length," assigned in ").concat(t," session"))}}return e},m=()=>{const e=[],r=o.filter(e=>e.isActive);for(const o of r){const r=t.getStudentAssignments(o.id).map(e=>e.staffId),i=[...new Set(r)];if(r.length!==i.length){const t=r.filter((e,t)=>r.indexOf(e)!==t).map(e=>{const t=n.find(t=>t.id===e);return t?t.name:"Staff ID ".concat(e)});e.push("".concat(o.name," has the same staff member(s) assigned multiple times: ").concat([...new Set(t)].join(", ")))}}return e},p=()=>{const e=[],r=n.filter(e=>e.isActive);for(const n of r){const r=t.getStaffAssignments(n.id),o={AM:0,PM:0};r.forEach(e=>{o[e.session]++}),Object.entries(o).forEach(t=>{let[r,o]=t;o>n.maxStudents&&e.push("".concat(n.name," is assigned to ").concat(o," students in ").concat(r," session (max: ").concat(n.maxStudents,")"))}),0===r.length&&e.push("".concat(n.name," has no assignments"))}return e},y=()=>{const e=[];for(const r of t.assignments){const t=n.find(e=>e.id===r.staffId),i=o.find(e=>e.id===r.studentId);t&&i&&(t.canWorkProgram(r.program)||e.push("".concat(t.name," is assigned to ").concat(i.name," in ").concat(r.program," program, but is not qualified for this program")),i.program!==r.program&&e.push("".concat(i.name," is assigned to ").concat(r.program," program but belongs to ").concat(i.program," program")))}return e},v=()=>{const e=[],n=o.filter(e=>e.isActive);for(const r of n){const n=t.getStudentAssignments(r.id),o=["AM","PM"];for(const t of o){0===n.filter(e=>e.session===t).length&&e.push("".concat(r.name," has no assignment for ").concat(t," session"))}}return e},w=()=>{const e=[],r=n.filter(e=>e.isActive).map(e=>({name:e.name,count:t.getStaffAssignments(e.id).length}));if(r.length>0){const t=Math.max(...r.map(e=>e.count)),n=Math.min(...r.map(e=>e.count));t-n>2&&e.push("Uneven workload distribution: some staff have ".concat(t," assignments while others have ").concat(n))}return e};return(0,oh.jsxs)("div",{className:"bg-white rounded-lg shadow-lg",children:[(0,oh.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,oh.jsxs)("div",{className:"flex items-center justify-between",children:[(0,oh.jsxs)("div",{className:"flex items-center gap-3",children:[l?(0,oh.jsx)(b,{className:"w-5 h-5 animate-spin"}):a.isValid&&0===a.warnings.length?(0,oh.jsx)(nh,{className:"w-5 h-5 text-green-600"}):a.errors.length>0?(0,oh.jsx)(sh,{className:"w-5 h-5 text-red-600"}):(0,oh.jsx)(rh,{className:"w-5 h-5 text-yellow-600"}),(0,oh.jsxs)("div",{children:[(0,oh.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Schedule Validation"}),(0,oh.jsx)("p",{className:"text-sm text-gray-600",children:l?"Validating...":a.isValid&&0===a.warnings.length?"All constraints satisfied":a.errors.length>0?"".concat(a.errors.length," error(s) found"):"".concat(a.warnings.length," warning(s)")})]})]}),(0,oh.jsxs)("div",{className:"flex items-center gap-2",children:[(0,oh.jsxs)("button",{onClick:h,disabled:l,className:"px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 flex items-center gap-1",children:[(0,oh.jsx)(b,{className:"w-4 h-4 ".concat(l?"animate-spin":"")}),"Revalidate"]}),(0,oh.jsx)("button",{onClick:()=>d(!u),className:"px-3 py-1 text-sm border border-gray-300 rounded hover:bg-gray-50",children:u?"Hide Details":"Show Details"})]})]})}),u&&(0,oh.jsxs)("div",{className:"p-4 space-y-4",children:[(0,oh.jsx)(uh,{schedule:t,staff:n,students:o}),a.errors.length>0&&(0,oh.jsxs)("div",{className:"space-y-2",children:[(0,oh.jsxs)("h4",{className:"font-medium text-red-900 flex items-center gap-2",children:[(0,oh.jsx)(sh,{className:"w-4 h-4"}),"Errors (",a.errors.length,")"]}),(0,oh.jsx)("div",{className:"space-y-1",children:a.errors.map((e,t)=>(0,oh.jsx)("div",{className:"text-sm text-red-700 bg-red-50 p-2 rounded",children:e},t))})]}),a.warnings.length>0&&(0,oh.jsxs)("div",{className:"space-y-2",children:[(0,oh.jsxs)("h4",{className:"font-medium text-yellow-900 flex items-center gap-2",children:[(0,oh.jsx)(rh,{className:"w-4 h-4"}),"Warnings (",a.warnings.length,")"]}),(0,oh.jsx)("div",{className:"space-y-1",children:a.warnings.map((e,t)=>(0,oh.jsx)("div",{className:"text-sm text-yellow-700 bg-yellow-50 p-2 rounded",children:e},t))})]}),a.isValid&&0===a.warnings.length&&(0,oh.jsxs)("div",{className:"text-sm text-green-700 bg-green-50 p-3 rounded flex items-center gap-2",children:[(0,oh.jsx)(nh,{className:"w-4 h-4"}),"Schedule passes all validation checks"]}),a.lastValidated&&(0,oh.jsxs)("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[(0,oh.jsx)(lh,{className:"w-3 h-3"}),"Last validated: ",a.lastValidated.toLocaleTimeString()]})]})]})},uh=e=>{let{schedule:t,staff:n,students:r}=e;const o=r.filter(e=>e.isActive),i=n.filter(e=>e.isActive),a=t.assignments.length,s=new Set(t.assignments.map(e=>e.studentId)).size,l=new Set(t.assignments.map(e=>e.staffId)).size,c=t.assignments.filter(e=>t.isAssignmentLocked(e.id)).length,u=o.length>0?s/o.length*100:0,d=i.length>0?l/i.length*100:0,h=[{label:"Total Assignments",value:a,color:"text-blue-600"},{label:"Students Assigned",value:"".concat(s,"/").concat(o.length),percentage:u,color:100===u?"text-green-600":"text-yellow-600"},{label:"Staff Utilized",value:"".concat(l,"/").concat(i.length),percentage:d,color:"text-blue-600"},{label:"Locked Assignments",value:c,color:"text-yellow-600"}];return(0,oh.jsxs)("div",{className:"space-y-3",children:[(0,oh.jsx)("h4",{className:"font-medium text-gray-900",children:"Summary"}),(0,oh.jsx)("div",{className:"grid grid-cols-2 gap-4",children:h.map((e,t)=>(0,oh.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded",children:[(0,oh.jsxs)("div",{className:"text-lg font-semibold ".concat(e.color),children:[e.value,void 0!==e.percentage&&(0,oh.jsxs)("span",{className:"text-sm ml-1",children:["(",e.percentage.toFixed(0),"%)"]})]}),(0,oh.jsx)("div",{className:"text-xs text-gray-600",children:e.label})]},t))})]})},dh=()=>(0,oh.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,oh.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,oh.jsx)(lh,{className:"w-5 h-5"}),"Scheduling Rules & Constraints"]}),(0,oh.jsx)("div",{className:"space-y-6",children:[{title:"Staff-Student Ratios",description:"Each student must have the correct number of staff assigned based on their ratio requirement",examples:["1:1 ratio = 1 staff member","2:1 ratio = 2 staff members","1:2 ratio = 1 staff for up to 2 students"]},{title:"Same-Day Restriction",description:"No staff member can be assigned to the same student for both AM and PM sessions",examples:["If John works with Student A in AM, he cannot work with Student A in PM"]},{title:"Program Qualifications",description:"Staff can only be assigned to programs they are qualified for",examples:["Primary program staff cannot be assigned to Secondary program students"]},{title:"Role Hierarchy",description:"Staff assignments follow the established hierarchy for optimal matches",examples:["RBT \u2192 BS \u2192 BCBA \u2192 EA \u2192 MHA \u2192 CC \u2192 Teacher \u2192 Director"]},{title:"Session Times",description:"Assignments must respect program-specific session times",examples:["Primary AM: 8:45-11:30, PM: 12:00-15:00","Secondary AM: 8:45-12:00, PM: 12:30-15:00"]}].map((e,t)=>(0,oh.jsxs)("div",{className:"border-l-4 border-blue-500 pl-4",children:[(0,oh.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:e.title}),(0,oh.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.description}),(0,oh.jsx)("ul",{className:"text-xs text-gray-500 space-y-1",children:e.examples.map((e,t)=>(0,oh.jsxs)("li",{className:"flex items-start gap-1",children:[(0,oh.jsx)("span",{className:"text-blue-500 mt-1",children:"\u2022"}),(0,oh.jsx)("span",{children:e})]},t))})]},t))})]}),hh=y("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),gh=y("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),fh=y("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]),mh=y("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ph=y("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),yh=y("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),vh=e=>{let{selectedUsers:t=[],onSelectionChange:n,placeholder:o="Search for people...",maxSelections:i=null,disabled:a=!1,peoplePickerService:s}=e;const[l,c]=(0,r.useState)(!1),[u,d]=(0,r.useState)(""),[h,g]=(0,r.useState)([]),[f,m]=(0,r.useState)(!1),[p,y]=(0,r.useState)([]),b=(0,r.useRef)(null);(0,r.useEffect)(()=>{s&&w()},[s]),(0,r.useEffect)(()=>{const e=e=>{b.current&&!b.current.contains(e.target)&&c(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const w=async()=>{try{const e=await s.getAllSiteUsers(!0);y(e)}catch(e){console.error("Error loading users:",e)}},k=(u.trim()?h:p.slice(0,10)).filter(e=>!t.some(t=>t.id===e.id));return(0,oh.jsxs)("div",{className:"relative",ref:b,children:[t.length>0&&(0,oh.jsx)("div",{className:"mb-2 flex flex-wrap gap-2",children:t.map(e=>(0,oh.jsxs)("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:[(0,oh.jsx)(v,{className:"w-3 h-3"}),(0,oh.jsx)("span",{children:e.title}),!a&&(0,oh.jsx)("button",{onClick:()=>(e=>{if(a)return;const r=t.filter(t=>t.id!==e);n(r)})(e.id),className:"hover:bg-blue-200 rounded-full p-0.5",children:(0,oh.jsx)(mh,{className:"w-3 h-3"})})]},e.id))}),(0,oh.jsxs)("div",{className:"relative",children:[(0,oh.jsxs)("div",{className:"flex items-center border border-gray-300 rounded-md",children:[(0,oh.jsxs)("div",{className:"flex-1 flex items-center",children:[(0,oh.jsx)(ph,{className:"w-4 h-4 text-gray-400 ml-3"}),(0,oh.jsx)("input",{type:"text",value:u,onChange:e=>(async e=>{if(d(e),e.trim()){m(!0);try{const t=p.filter(t=>t.title.toLowerCase().includes(e.toLowerCase())||t.email.toLowerCase().includes(e.toLowerCase())).slice(0,10);g(t)}catch(t){console.error("Error searching users:",t),g([])}finally{m(!1)}}else g([])})(e.target.value),onFocus:()=>c(!0),placeholder:o,disabled:a,className:"w-full pl-2 pr-3 py-2 border-0 focus:outline-none focus:ring-0"})]}),(0,oh.jsx)("button",{onClick:()=>c(!l),disabled:a,className:"px-3 py-2 border-l border-gray-300 hover:bg-gray-50 disabled:opacity-50",children:(0,oh.jsx)(yh,{className:"w-4 h-4 transition-transform ".concat(l?"rotate-180":"")})})]}),l&&!a&&(0,oh.jsxs)("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:[f&&(0,oh.jsx)("div",{className:"px-4 py-3 text-gray-500 text-sm",children:"Searching..."}),!f&&0===k.length&&(0,oh.jsx)("div",{className:"px-4 py-3 text-gray-500 text-sm",children:u.trim()?"No users found":"No users available"}),!f&&k.map(e=>(0,oh.jsx)("button",{onClick:()=>(e=>{if(a)return;if(t.some(t=>t.id===e.id))return;if(i&&t.length>=i)return;const r=[...t,e];n(r),d(""),g([]),c(!1)})(e),className:"w-full px-4 py-3 text-left hover:bg-gray-50 focus:bg-gray-50 focus:outline-none border-b border-gray-100 last:border-b-0",children:(0,oh.jsxs)("div",{className:"flex items-center gap-3",children:[(0,oh.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-medium",children:e.title.charAt(0).toUpperCase()}),(0,oh.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,oh.jsx)("div",{className:"font-medium text-gray-900 truncate",children:e.title}),(0,oh.jsx)("div",{className:"text-sm text-gray-500 truncate",children:e.email})]})]})},e.id)),i&&t.length>=i&&(0,oh.jsxs)("div",{className:"px-4 py-3 text-amber-600 text-sm bg-amber-50 border-t",children:["Maximum ",i," selection",1!==i?"s":""," reached"]})]})]}),i&&(0,oh.jsxs)("div",{className:"mt-1 text-xs text-gray-500",children:[t.length," of ",i," selected"]})]})},bh=e=>{let{selectedUser:t=null,onSelectionChange:n,placeholder:r="Search for a person...",disabled:o=!1,peoplePickerService:i}=e;return(0,oh.jsx)(vh,{selectedUsers:t?[t]:[],onSelectionChange:e=>n(e[0]||null),placeholder:r,maxSelections:1,disabled:o,peoplePickerService:i})},wh=e=>{let{selectedStaff:t=[],onSelectionChange:n,allStaff:o=[],disabled:i=!1,peoplePickerService:a}=e;const[s,l]=(0,r.useState)([]);(0,r.useEffect)(()=>{a&&o.length>0&&c()},[a,o]);const c=async()=>{try{const e=(await a.getAllSiteUsers(!0)).filter(e=>o.some(t=>t.email&&e.email&&t.email.toLowerCase()===e.email.toLowerCase()));l(e)}catch(e){console.error("Error loading staff users:",e)}};return(0,oh.jsxs)("div",{children:[(0,oh.jsx)(vh,{selectedUsers:t,onSelectionChange:n,placeholder:"Search for staff members...",disabled:i,peoplePickerService:a}),o.length>0&&0===s.length&&(0,oh.jsx)("div",{className:"mt-2 text-sm text-amber-600",children:"Note: Only users in the Staff list can be selected"})]})},kh=e=>{var t;let{staff:n=null,onSave:o,onCancel:i,peoplePickerService:a}=e;const[s,l]=(0,r.useState)({name:(null===n||void 0===n?void 0:n.name)||"",role:(null===n||void 0===n?void 0:n.role)||R.RBT,email:(null===n||void 0===n?void 0:n.email)||"",phone:(null===n||void 0===n?void 0:n.phone)||"",isActive:null===(t=null===n||void 0===n?void 0:n.isActive)||void 0===t||t,primaryProgram:(null===n||void 0===n?void 0:n.primaryProgram)||!1,secondaryProgram:(null===n||void 0===n?void 0:n.secondaryProgram)||!1,certificationExpiry:(null===n||void 0===n?void 0:n.certificationExpiry)||"",userId:(null===n||void 0===n?void 0:n.userId)||"",staffPerson:(null===n||void 0===n?void 0:n.staffPerson)||null}),[u,d]=(0,r.useState)(null!==n&&void 0!==n&&n.staffPerson?{id:n.userId,title:n.name,email:n.email}:null),[h,g]=(0,r.useState)({}),f=(e,t)=>{l(n=>c(c({},n),{},{[e]:t})),h[e]&&g(t=>c(c({},t),{},{[e]:null}))};return(0,oh.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,oh.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,oh.jsx)("div",{className:"bg-blue-600 text-white p-4 rounded-t-lg",children:(0,oh.jsxs)("h2",{className:"text-xl font-bold flex items-center gap-2",children:[(0,oh.jsx)(hh,{className:"w-5 h-5"}),n?"Edit Staff Member":"Add Staff Member"]})}),(0,oh.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!(()=>{const e={};return s.name.trim()||(e.name="Name is required"),s.email.trim()?/\S+@\S+\.\S+/.test(s.email)||(e.email="Email is invalid"):e.email="Email is required",s.role||(e.role="Role is required"),s.primaryProgram||s.secondaryProgram||(e.programs="At least one program must be selected"),g(e),0===Object.keys(e).length})())return;const t=c({id:(null===n||void 0===n?void 0:n.id)||Date.now()},s);o(new L(t))},className:"p-6 space-y-6",children:[(0,oh.jsxs)("div",{children:[(0,oh.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Staff Member *"}),(0,oh.jsx)(bh,{selectedUser:u,onSelectionChange:e=>{d(e),l(e?t=>c(c({},t),{},{name:e.title,email:e.email,userId:e.id.toString(),staffPerson:e}):e=>c(c({},e),{},{name:"",email:"",userId:"",staffPerson:null}))},placeholder:"Search for staff member...",peoplePickerService:a}),h.name&&(0,oh.jsx)("p",{className:"mt-1 text-sm text-red-600",children:h.name})]}),(0,oh.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,oh.jsxs)("div",{children:[(0,oh.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name *"}),(0,oh.jsx)("input",{type:"text",value:s.name,onChange:e=>f("name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:u}),h.name&&(0,oh.jsx)("p",{className:"mt-1 text-sm text-red-600",children:h.name})]}),(0,oh.jsxs)("div",{children:[(0,oh.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role *"}),(0,oh.jsx)("select",{value:s.role,onChange:e=>f("role",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:Object.values(R).map(e=>(0,oh.jsx)("option",{value:e,children:e},e))}),h.role&&(0,oh.jsx)("p",{className:"mt-1 text-sm text-red-600",children:h.role})]})]}),(0,oh.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,oh.jsxs)("div",{children:[(0,oh.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,oh.jsx)(gh,{className:"w-4 h-4 inline mr-1"}),"Email *"]}),(0,oh.jsx)("input",{type:"email",value:s.email,onChange:e=>f("email",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:u}),h.email&&(0,oh.jsx)("p",{className:"mt-1 text-sm text-red-600",children:h.email})]}),(0,oh.jsxs)("div",{children:[(0,oh.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,oh.jsx)(fh,{className:"w-4 h-4 inline mr-1"}),"Phone"]}),(0,oh.jsx)("input",{type:"tel",value:s.phone,onChange:e=>f("phone",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,oh.jsxs)("div",{children:[(0,oh.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,oh.jsx)(k,{className:"w-4 h-4 inline mr-1"}),"Certification Expiry"]}),(0,oh.jsx)("input",{type:"date",value:s.certificationExpiry,onChange:e=>f("certificationExpiry",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,oh.jsxs)("div",{children:[(0,oh.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Programs *"}),(0,oh.jsxs)("div",{className:"space-y-2",children:[(0,oh.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,oh.jsx)("input",{type:"checkbox",checked:s.primaryProgram,onChange:e=>f("primaryProgram",e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,oh.jsx)("span",{className:"text-sm",children:"Primary Program"})]}),(0,oh.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,oh.jsx)("input",{type:"checkbox",checked:s.secondaryProgram,onChange:e=>f("secondaryProgram",e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,oh.jsx)("span",{className:"text-sm",children:"Secondary Program"})]})]}),h.programs&&(0,oh.jsx)("p",{className:"mt-1 text-sm text-red-600",children:h.programs})]}),(0,oh.jsx)("div",{children:(0,oh.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,oh.jsx)("input",{type:"checkbox",checked:s.isActive,onChange:e=>f("isActive",e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,oh.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Active"})]})}),(0,oh.jsxs)("div",{className:"flex gap-3 pt-4 border-t",children:[(0,oh.jsxs)("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 flex items-center justify-center gap-2",children:[(0,oh.jsx)(S,{className:"w-4 h-4"}),n?"Update Staff":"Add Staff"]}),(0,oh.jsxs)("button",{type:"button",onClick:i,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 flex items-center justify-center gap-2",children:[(0,oh.jsx)(mh,{className:"w-4 h-4"}),"Cancel"]})]})]})]})})},Ch=e=>{var t;let{student:n=null,onSave:o,onCancel:i,allStaff:a=[],peoplePickerService:s}=e;const[l,u]=(0,r.useState)({name:(null===n||void 0===n?void 0:n.name)||"",program:(null===n||void 0===n?void 0:n.program)||M.PRIMARY,ratioAM:(null===n||void 0===n?void 0:n.ratioAM)||j.ONE_TO_ONE,ratioPM:(null===n||void 0===n?void 0:n.ratioPM)||j.ONE_TO_ONE,team:(null===n||void 0===n?void 0:n.team)||[],isActive:null===(t=null===n||void 0===n?void 0:n.isActive)||void 0===t||t,notes:(null===n||void 0===n?void 0:n.notes)||"",dateStarted:(null===n||void 0===n?void 0:n.dateStarted)||""}),[d,h]=(0,r.useState)({}),g=(e,t)=>{u(n=>c(c({},n),{},{[e]:t})),d[e]&&h(t=>c(c({},t),{},{[e]:null}))};return(0,oh.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,oh.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,oh.jsx)("div",{className:"bg-green-600 text-white p-4 rounded-t-lg",children:(0,oh.jsxs)("h2",{className:"text-xl font-bold flex items-center gap-2",children:[(0,oh.jsx)(v,{className:"w-5 h-5"}),n?"Edit Student":"Add Student"]})}),(0,oh.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!(()=>{const e={};return l.name.trim()||(e.name="Name is required"),l.program||(e.program="Program is required"),l.ratioAM||(e.ratioAM="AM ratio is required"),l.ratioPM||(e.ratioPM="PM ratio is required"),h(e),0===Object.keys(e).length})())return;const t=c({id:(null===n||void 0===n?void 0:n.id)||Date.now()},l);o(new q(t))},className:"p-6 space-y-6",children:[(0,oh.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,oh.jsxs)("div",{children:[(0,oh.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name *"}),(0,oh.jsx)("input",{type:"text",value:l.name,onChange:e=>g("name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"}),d.name&&(0,oh.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.name})]}),(0,oh.jsxs)("div",{children:[(0,oh.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Program *"}),(0,oh.jsx)("select",{value:l.program,onChange:e=>g("program",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",children:Object.values(M).map(e=>(0,oh.jsx)("option",{value:e,children:e},e))}),d.program&&(0,oh.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.program})]})]}),(0,oh.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,oh.jsxs)("div",{children:[(0,oh.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"AM Ratio *"}),(0,oh.jsx)("select",{value:l.ratioAM,onChange:e=>g("ratioAM",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",children:Object.values(j).map(e=>(0,oh.jsx)("option",{value:e,children:e},e))}),d.ratioAM&&(0,oh.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.ratioAM})]}),(0,oh.jsxs)("div",{children:[(0,oh.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"PM Ratio *"}),(0,oh.jsx)("select",{value:l.ratioPM,onChange:e=>g("ratioPM",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",children:Object.values(j).map(e=>(0,oh.jsx)("option",{value:e,children:e},e))}),d.ratioPM&&(0,oh.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.ratioPM})]})]}),(0,oh.jsxs)("div",{children:[(0,oh.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,oh.jsx)(k,{className:"w-4 h-4 inline mr-1"}),"Date Started"]}),(0,oh.jsx)("input",{type:"date",value:l.dateStarted,onChange:e=>g("dateStarted",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"})]}),(0,oh.jsxs)("div",{children:[(0,oh.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Team Members"}),(0,oh.jsx)(wh,{selectedStaff:l.team,onSelectionChange:e=>{u(t=>c(c({},t),{},{team:e}))},allStaff:a,peoplePickerService:s}),(0,oh.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Select staff members who work with this client"})]}),(0,oh.jsxs)("div",{children:[(0,oh.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),(0,oh.jsx)("textarea",{value:l.notes,onChange:e=>g("notes",e.target.value),rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Additional notes about the student..."})]}),(0,oh.jsx)("div",{children:(0,oh.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,oh.jsx)("input",{type:"checkbox",checked:l.isActive,onChange:e=>g("isActive",e.target.checked),className:"rounded border-gray-300 text-green-600 focus:ring-green-500"}),(0,oh.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Active"})]})}),(0,oh.jsxs)("div",{className:"flex gap-3 pt-4 border-t",children:[(0,oh.jsxs)("button",{type:"submit",className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 flex items-center justify-center gap-2",children:[(0,oh.jsx)(S,{className:"w-4 h-4"}),n?"Update Student":"Add Student"]}),(0,oh.jsxs)("button",{type:"button",onClick:i,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 flex items-center justify-center gap-2",children:[(0,oh.jsx)(mh,{className:"w-4 h-4"}),"Cancel"]})]})]})]})})},Sh=y("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]),xh=y("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),Ah=e=>{let{staff:t,students:n,onEditStudent:o,onEditStaff:i}=e;const[a,s]=(0,r.useState)("clients-by-staff"),[l,c]=(0,r.useState)(""),[u,d]=(0,r.useState)(""),h=(0,r.useMemo)(()=>{var e;console.log("\ud83d\udd0d TeamManagement: Building clientsByStaff mapping"),console.log("\ud83d\udd0d TeamManagement: Staff data:",t),console.log("\ud83d\udd0d TeamManagement: Students data:",n),console.log("\ud83d\udd0d TeamManagement: Sample student team data:",null===n||void 0===n||null===(e=n[0])||void 0===e?void 0:e.team);const r={};return t.filter(e=>e.isActive).forEach(e=>{console.log("\ud83d\udd0d Processing staff: ".concat(e.name," (ID: ").concat(e.id,")"));const t=n.filter(t=>{if(!t.isActive)return!1;if(console.log("  \ud83d\udd0d Checking student: ".concat(t.name)),console.log("    Team data:",t.team),!t.team||0===t.team.length)return console.log("    \u26a0\ufe0f No team data for ".concat(t.name)),!1;const n=t.team.some(n=>{var r,o,i,a,s;console.log("    \ud83d\udd0d Checking team member:",n);const l=null===(r=e.email)||void 0===r?void 0:r.toLowerCase().trim(),c=null===(o=n.email)||void 0===o?void 0:o.toLowerCase().trim();if(l&&c&&l===c)return console.log("    \u2705 EMAIL MATCH: ".concat(e.name," found in ").concat(t.name,"'s team")),!0;if(e.id&&n.id&&e.id===n.id)return console.log("    \u2705 ID MATCH: ".concat(e.name," found in ").concat(t.name,"'s team")),!0;const u=null===(i=e.name)||void 0===i?void 0:i.toLowerCase().trim(),d=(null===(a=n.title)||void 0===a?void 0:a.toLowerCase().trim())||(null===(s=n.name)||void 0===s?void 0:s.toLowerCase().trim());return!(!u||!d||u!==d)&&(console.log("    \u2705 NAME MATCH: ".concat(e.name," found in ").concat(t.name,"'s team")),!0)});return n&&console.log("  \u2705 ".concat(t.name," assigned to ").concat(e.name)),n});r[e.id]={staff:e,clients:t},console.log("\u2705 ".concat(e.name," has ").concat(t.length," clients:"),t.map(e=>e.name))}),console.log("\ud83d\udcca Final clientsByStaff mapping:",r),r},[t,n]),g=(0,r.useMemo)(()=>{console.log("\ud83d\udd0d TeamManagement: Building staffByClient mapping");const e={};return n.filter(e=>e.isActive).forEach(n=>{console.log("\ud83d\udd0d Processing student: ".concat(n.name)),console.log("  Team data:",n.team);const r=n.team.map(e=>{console.log("  \ud83d\udd0d Processing team member:",e);const n=t.find(t=>{var n,r,o,i,a;const s=null===(n=t.email)||void 0===n?void 0:n.toLowerCase().trim(),l=null===(r=e.email)||void 0===r?void 0:r.toLowerCase().trim();if(s&&l&&s===l)return console.log("    \u2705 EMAIL MATCH: Found staff ".concat(t.name," for team member")),!0;if(t.id&&e.id&&t.id===e.id)return console.log("    \u2705 ID MATCH: Found staff ".concat(t.name," for team member")),!0;const c=null===(o=t.name)||void 0===o?void 0:o.toLowerCase().trim(),u=(null===(i=e.title)||void 0===i?void 0:i.toLowerCase().trim())||(null===(a=e.name)||void 0===a?void 0:a.toLowerCase().trim());return!(!c||!u||c!==u)&&(console.log("    \u2705 NAME MATCH: Found staff ".concat(t.name," for team member")),!0)});return n?{id:n.id,name:e.title||e.DisplayName||e.LookupValue||n.name,role:n.role,email:n.email}:(console.log("    \u26a0\ufe0f No staff match found for team member:",e),{id:e.id,name:e.title||e.DisplayName||e.LookupValue,role:"Unknown",email:e.email})}).filter(Boolean);e[n.id]={student:n,teamMembers:r},console.log("\u2705 ".concat(n.name," has ").concat(r.length," team members:"),r.map(e=>e.name))}),console.log("\ud83d\udcca Final staffByClient mapping:",e),e},[t,n]),f=(0,r.useMemo)(()=>"clients-by-staff"===a?Object.values(h).filter(e=>{const t=e.staff.name.toLowerCase().includes(l.toLowerCase()),n=!u||"Primary"===u&&e.staff.primaryProgram||"Secondary"===u&&e.staff.secondaryProgram;return t&&n}):Object.values(g).filter(e=>{const t=e.student.name.toLowerCase().includes(l.toLowerCase()),n=!u||e.student.program===u;return t&&n}),[a,h,g,l,u]),m=(e,t,n)=>e.filter(e=>e.getSessionRatio(n)===t).length,p=e=>({RBT:"bg-blue-100 text-blue-800","Senior RBT":"bg-green-100 text-green-800",Lead:"bg-purple-100 text-purple-800",Supervisor:"bg-orange-100 text-orange-800",Director:"bg-red-100 text-red-800"}[e]||"bg-gray-100 text-gray-800");return(0,oh.jsxs)("div",{className:"bg-white rounded-lg shadow-lg",children:[(0,oh.jsx)("div",{className:"bg-indigo-600 text-white p-4 rounded-t-lg",children:(0,oh.jsxs)("h2",{className:"text-xl font-bold flex items-center gap-2",children:[(0,oh.jsx)(v,{className:"w-5 h-5"}),"Team Management"]})}),(0,oh.jsxs)("div",{className:"p-6",children:[(0,oh.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:[(0,oh.jsxs)("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[(0,oh.jsxs)("button",{onClick:()=>s("clients-by-staff"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("clients-by-staff"===a?"bg-white text-indigo-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:[(0,oh.jsx)(v,{className:"w-4 h-4 inline mr-2"}),"Clients by Staff"]}),(0,oh.jsxs)("button",{onClick:()=>s("staff-by-client"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("staff-by-client"===a?"bg-white text-indigo-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:[(0,oh.jsx)(hh,{className:"w-4 h-4 inline mr-2"}),"Staff by Client"]})]}),(0,oh.jsxs)("div",{className:"flex gap-3 flex-1",children:[(0,oh.jsxs)("div",{className:"relative flex-1",children:[(0,oh.jsx)(ph,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,oh.jsx)("input",{type:"text",value:l,onChange:e=>c(e.target.value),placeholder:"Search ".concat("clients-by-staff"===a?"staff":"clients","..."),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),(0,oh.jsxs)("div",{className:"relative",children:[(0,oh.jsx)(Sh,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,oh.jsxs)("select",{value:u,onChange:e=>d(e.target.value),className:"pl-10 pr-8 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 appearance-none bg-white",children:[(0,oh.jsx)("option",{value:"",children:"All Programs"}),(0,oh.jsx)("option",{value:"Primary",children:"Primary"}),(0,oh.jsx)("option",{value:"Secondary",children:"Secondary"})]})]})]})]}),(0,oh.jsx)("div",{className:"space-y-4",children:0===f.length?(0,oh.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,oh.jsx)(v,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),(0,oh.jsxs)("p",{children:["No ","clients-by-staff"===a?"staff":"clients"," found"]})]}):f.map((e,t)=>(0,oh.jsx)("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50",children:"clients-by-staff"===a?(0,oh.jsxs)("div",{children:[(0,oh.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,oh.jsxs)("div",{className:"flex items-center gap-3",children:[(0,oh.jsx)("div",{className:"w-10 h-10 bg-indigo-500 rounded-full flex items-center justify-center text-white font-medium",children:e.staff.name.charAt(0)}),(0,oh.jsxs)("div",{children:[(0,oh.jsx)("h3",{className:"font-semibold text-gray-900",children:e.staff.name}),(0,oh.jsxs)("div",{className:"flex items-center gap-2",children:[(0,oh.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(p(e.staff.role)),children:e.staff.role}),(0,oh.jsxs)("div",{className:"flex gap-1",children:[e.staff.primaryProgram&&(0,oh.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs",children:"Primary"}),e.staff.secondaryProgram&&(0,oh.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded text-xs",children:"Secondary"})]})]})]})]}),(0,oh.jsx)("button",{onClick:()=>i&&i(e.staff),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded",children:(0,oh.jsx)(xh,{className:"w-4 h-4"})})]}),(0,oh.jsxs)("div",{className:"ml-13",children:[(0,oh.jsxs)("div",{className:"flex items-center gap-4 mb-2",children:[(0,oh.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:["Clients: ",e.clients.length]}),e.clients.length>0&&(0,oh.jsxs)(oh.Fragment,{children:[(0,oh.jsxs)("span",{className:"text-xs text-gray-500",children:["AM: ",m(e.clients,"1:1","AM")," (1:1),",m(e.clients,"2:1","AM")," (2:1),",m(e.clients,"1:2","AM")," (1:2)"]}),(0,oh.jsxs)("span",{className:"text-xs text-gray-500",children:["PM: ",m(e.clients,"1:1","PM")," (1:1),",m(e.clients,"2:1","PM")," (2:1),",m(e.clients,"1:2","PM")," (1:2)"]})]})]}),e.clients.length>0&&(0,oh.jsx)("div",{className:"flex flex-wrap gap-2",children:e.clients.map(e=>(0,oh.jsxs)("div",{className:"flex items-center gap-2 bg-gray-100 rounded-full px-3 py-1",children:[(0,oh.jsx)("span",{className:"text-sm",children:e.name}),(0,oh.jsxs)("div",{className:"flex gap-1",children:[(0,oh.jsxs)("span",{className:"text-xs bg-blue-200 text-blue-700 px-1 rounded",children:["AM: ",e.ratioAM]}),(0,oh.jsxs)("span",{className:"text-xs bg-green-200 text-green-700 px-1 rounded",children:["PM: ",e.ratioPM]})]})]},e.id))})]})]}):(0,oh.jsxs)("div",{children:[(0,oh.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,oh.jsxs)("div",{className:"flex items-center gap-3",children:[(0,oh.jsx)("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center text-white font-medium",children:e.student.name.charAt(0)}),(0,oh.jsxs)("div",{children:[(0,oh.jsx)("h3",{className:"font-semibold text-gray-900",children:e.student.name}),(0,oh.jsxs)("div",{className:"flex items-center gap-2",children:[(0,oh.jsx)("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs",children:e.student.program}),(0,oh.jsxs)("span",{className:"text-xs bg-blue-200 text-blue-700 px-2 py-1 rounded",children:["AM: ",e.student.ratioAM]}),(0,oh.jsxs)("span",{className:"text-xs bg-green-200 text-green-700 px-2 py-1 rounded",children:["PM: ",e.student.ratioPM]})]})]})]}),(0,oh.jsx)("button",{onClick:()=>o&&o(e.student),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded",children:(0,oh.jsx)(xh,{className:"w-4 h-4"})})]}),(0,oh.jsxs)("div",{className:"ml-13",children:[(0,oh.jsx)("div",{className:"flex items-center gap-4 mb-2",children:(0,oh.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:["Team Members: ",e.teamMembers.length]})}),e.teamMembers.length>0?(0,oh.jsx)("div",{className:"flex flex-wrap gap-2",children:e.teamMembers.map(e=>(0,oh.jsxs)("div",{className:"flex items-center gap-2 bg-indigo-100 rounded-full px-3 py-1",children:[(0,oh.jsx)("span",{className:"text-sm",children:e.name}),(0,oh.jsx)("span",{className:"text-xs px-2 py-0.5 rounded ".concat(p(e.role)),children:e.role})]},e.id))}):(0,oh.jsx)("p",{className:"text-sm text-gray-500 italic",children:"No team members assigned"})]})]})},t))}),(0,oh.jsxs)("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4 bg-gray-50 rounded-lg p-4",children:[(0,oh.jsxs)("div",{className:"text-center",children:[(0,oh.jsx)("div",{className:"text-2xl font-bold text-indigo-600",children:t.filter(e=>e.isActive).length}),(0,oh.jsx)("div",{className:"text-sm text-gray-600",children:"Active Staff"})]}),(0,oh.jsxs)("div",{className:"text-center",children:[(0,oh.jsx)("div",{className:"text-2xl font-bold text-green-600",children:n.filter(e=>e.isActive).length}),(0,oh.jsx)("div",{className:"text-sm text-gray-600",children:"Active Clients"})]}),(0,oh.jsxs)("div",{className:"text-center",children:[(0,oh.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:Object.values(g).reduce((e,t)=>e+t.teamMembers.length,0)}),(0,oh.jsx)("div",{className:"text-sm text-gray-600",children:"Total Team Assignments"})]})]})]})]})},Th=[new L({id:1,name:"Sarah Johnson",role:"RBT",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new L({id:2,name:"Mike Chen",role:"RBT",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new L({id:3,name:"Emily Rodriguez",role:"RBT",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new L({id:4,name:"David Kim",role:"RBT",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new L({id:5,name:"Jessica Williams",role:"RBT",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new L({id:6,name:"Alex Thompson",role:"RBT",primaryProgram:!0,secondaryProgram:!0,isActive:!0}),new L({id:7,name:"Maria Garcia",role:"RBT",primaryProgram:!0,secondaryProgram:!0,isActive:!0}),new L({id:8,name:"Chris Lee",role:"RBT",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new L({id:9,name:"Amanda Davis",role:"RBT",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new L({id:10,name:"Ryan Martinez",role:"RBT",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new L({id:11,name:"Nicole Brown",role:"RBT",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new L({id:12,name:"Kevin Wilson",role:"RBT",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new L({id:13,name:"Stephanie Taylor",role:"RBT",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new L({id:14,name:"Brandon White",role:"RBT",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new L({id:15,name:"Melissa Adams",role:"RBT",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new L({id:16,name:"Jordan Smith",role:"RBT",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new L({id:17,name:"Taylor Jones",role:"RBT",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new L({id:18,name:"Morgan Clark",role:"RBT",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new L({id:19,name:"Casey Green",role:"RBT",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new L({id:20,name:"Riley Miller",role:"RBT",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new L({id:41,name:"Dr. Jennifer Parker",role:"BS",primaryProgram:!0,secondaryProgram:!0,isActive:!0}),new L({id:42,name:"Lisa Anderson",role:"BS",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new L({id:43,name:"Mark Roberts",role:"BS",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new L({id:44,name:"Amy Foster",role:"BS",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new L({id:45,name:"Daniel Cooper",role:"BS",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new L({id:61,name:"Dr. Michael Stevens",role:"BCBA",primaryProgram:!0,secondaryProgram:!0,isActive:!0}),new L({id:62,name:"Dr. Sarah Mitchell",role:"BCBA",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new L({id:63,name:"Dr. Robert Turner",role:"BCBA",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new L({id:64,name:"Dr. Linda Campbell",role:"BCBA",primaryProgram:!0,secondaryProgram:!0,isActive:!0}),new L({id:71,name:"Carol Henderson",role:"EA",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new L({id:72,name:"Janet Phillips",role:"EA",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new L({id:73,name:"Robert Evans",role:"EA",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new L({id:76,name:"Patricia Young",role:"MHA",primaryProgram:!0,secondaryProgram:!0,isActive:!0}),new L({id:77,name:"Thomas Hall",role:"MHA",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new L({id:78,name:"Michelle Lewis",role:"CC",primaryProgram:!0,secondaryProgram:!0,isActive:!0}),new L({id:79,name:"Elizabeth Murphy",role:"Teacher",primaryProgram:!0,secondaryProgram:!0,isActive:!0}),new L({id:80,name:"James Wilson",role:"Director",primaryProgram:M.PRIMARY,secondaryProgram:M.SECONDARY,isActive:!0})],Ih=[new q({id:101,name:"Alex Martinez",program:M.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:102,name:"Emma Thompson",program:M.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:103,name:"Liam Johnson",program:M.PRIMARY,ratio:j.TWO_TO_ONE,isActive:!0}),new q({id:104,name:"Sophie Chen",program:M.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:105,name:"Noah Davis",program:M.PRIMARY,ratio:j.ONE_TO_TWO,isActive:!0}),new q({id:106,name:"Isabella Garcia",program:M.PRIMARY,ratio:j.ONE_TO_TWO,isActive:!0}),new q({id:107,name:"Mason Williams",program:M.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:108,name:"Olivia Brown",program:M.PRIMARY,ratio:j.TWO_TO_ONE,isActive:!0}),new q({id:109,name:"Lucas Wilson",program:M.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0,pairedWith:110}),new q({id:110,name:"Ava Rodriguez",program:M.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0,pairedWith:109}),new q({id:111,name:"Ethan Taylor",program:M.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:112,name:"Mia Anderson",program:M.PRIMARY,ratio:j.ONE_TO_TWO,isActive:!0}),new q({id:113,name:"Jacob Miller",program:M.PRIMARY,ratio:j.ONE_TO_TWO,isActive:!0}),new q({id:114,name:"Charlotte Lee",program:M.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0,pairedWith:115}),new q({id:115,name:"Michael White",program:M.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0,pairedWith:114}),new q({id:116,name:"Amelia Harris",program:M.PRIMARY,ratio:j.TWO_TO_ONE,isActive:!0}),new q({id:117,name:"Benjamin Clark",program:M.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:118,name:"Harper Lewis",program:M.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:119,name:"Daniel Walker",program:M.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:120,name:"Ella Young",program:M.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:121,name:"Matthew King",program:M.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:122,name:"Avery Scott",program:M.PRIMARY,ratio:j.ONE_TO_TWO,isActive:!0}),new q({id:123,name:"Logan Green",program:M.PRIMARY,ratio:j.ONE_TO_TWO,isActive:!0}),new q({id:124,name:"Luna Adams",program:M.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:125,name:"Owen Baker",program:M.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:126,name:"Layla Hall",program:M.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:127,name:"Carter Rivera",program:M.PRIMARY,ratio:j.TWO_TO_ONE,isActive:!0}),new q({id:128,name:"Zoe Campbell",program:M.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:129,name:"Grayson Nelson",program:M.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:130,name:"Lily Mitchell",program:M.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:201,name:"Adrian Torres",program:M.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0,pairedWith:202}),new q({id:202,name:"Cesar Flores",program:M.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0,pairedWith:201}),new q({id:203,name:"Maya Patel",program:M.SECONDARY,ratio:j.TWO_TO_ONE,isActive:!0}),new q({id:204,name:"Diego Santos",program:M.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:205,name:"Zara Ahmed",program:M.SECONDARY,ratio:j.ONE_TO_TWO,isActive:!0}),new q({id:206,name:"Kai Thompson",program:M.SECONDARY,ratio:j.ONE_TO_TWO,isActive:!0}),new q({id:207,name:"Nora Kim",program:M.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:208,name:"Mateo Gonzalez",program:M.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:209,name:"Aria Parker",program:M.SECONDARY,ratio:j.TWO_TO_ONE,isActive:!0}),new q({id:210,name:"Felix Rodriguez",program:M.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:211,name:"Ivy Chen",program:M.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:212,name:"Jaxon Davis",program:M.SECONDARY,ratio:j.ONE_TO_TWO,isActive:!0}),new q({id:213,name:"Vera Martinez",program:M.SECONDARY,ratio:j.ONE_TO_TWO,isActive:!0}),new q({id:214,name:"Ezra Wilson",program:M.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:215,name:"Sage Anderson",program:M.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:216,name:"Phoenix Taylor",program:M.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:217,name:"River Johnson",program:M.SECONDARY,ratio:j.TWO_TO_ONE,isActive:!0}),new q({id:218,name:"Luna Garcia",program:M.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:219,name:"Atlas Brown",program:M.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0}),new q({id:220,name:"Nova Lee",program:M.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0})],Ph=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;const t=new z({date:e});return[{staffId:1,studentId:101,session:"AM",program:M.PRIMARY},{staffId:2,studentId:102,session:"AM",program:M.PRIMARY},{staffId:4,studentId:107,session:"AM",program:M.PRIMARY},{staffId:9,studentId:101,session:"PM",program:M.PRIMARY},{staffId:11,studentId:102,session:"PM",program:M.PRIMARY},{staffId:3,studentId:201,session:"AM",program:M.SECONDARY},{staffId:5,studentId:202,session:"AM",program:M.SECONDARY}].forEach((n,r)=>{const o=new D({id:"test_".concat(r+1),staffId:n.staffId,studentId:n.studentId,session:n.session,program:n.program,date:e,isLocked:!1,assignedBy:"manual"});t.addAssignment(o)}),t.lockAssignment("test_1"),t.lockAssignment("test_6"),t},Eh=()=>({validScenario:{description:"All constraints satisfied",schedule:Ph(),expectedErrors:0,expectedWarnings:0},sameDayViolation:{description:"Staff assigned to same student twice in one day",schedule:(()=>{const e=Ph(),t=new D({id:"violation_1",staffId:1,studentId:101,session:"PM",program:M.PRIMARY,date:new Date,isLocked:!1,assignedBy:"manual"});return e.addAssignment(t),e})(),expectedErrors:1,expectedWarnings:0},ratioViolation:{description:"2:1 student with only one staff assigned",schedule:(()=>{const e=new z({date:new Date}),t=new D({id:"ratio_violation",staffId:1,studentId:103,session:"AM",program:M.PRIMARY,date:new Date,isLocked:!1,assignedBy:"manual"});return e.addAssignment(t),e})(),expectedErrors:1,expectedWarnings:0}});class _h{constructor(){this.testResults=[],this.autoAssignEngine=new Zd,this.autoAssignEngine.setDebugMode(!0)}async runAllTests(){return console.log("\ud83e\uddea Starting ABA Scheduler Test Suite...\n"),this.testResults=[],await this.testDataModels(),await this.testValidationRules(),await this.testAutoAssignment(),await this.testPerformance(),await this.testIntegration(),this.printSummary(),this.testResults}async testDataModels(){console.log("\ud83d\udccb Testing Data Models..."),this.test("Staff role hierarchy",()=>{const e=Th.find(e=>"RBT"===e.role),t=Th.find(e=>"BCBA"===e.role),n=Th.find(e=>"Director"===e.role);return e.getRoleLevel()<t.getRoleLevel()&&t.getRoleLevel()<n.getRoleLevel()}),this.test("Staff program qualification",()=>{const e=Th[0],t=e.canWorkProgram("Primary"),n=e.canWorkProgram("Secondary");return(!e.primaryProgram||t)&&(!e.secondaryProgram||n)}),this.test("Student ratio requirements",()=>{const e=Ih.find(e=>"1:1"===e.ratio),t=Ih.find(e=>"2:1"===e.ratio),n=Ih.find(e=>"1:2"===e.ratio);return!e.requiresMultipleStaff()&&t.requiresMultipleStaff()&&n.isSmallGroup()}),this.test("Schedule assignment management",()=>{const e=Ph(),t=e.assignments.length,n={id:"test_new",staffId:99,studentId:199,session:"AM",program:"Primary",date:new Date};return e.addAssignment(n),e.removeAssignment("test_new"),e.assignments.length===t}),this.test("Assignment ID generation",()=>{const e=U.generateAssignmentId();return e!==U.generateAssignmentId()&&e.includes("assignment_")}),this.test("Staff hierarchy sorting",()=>{const e=U.sortStaffByHierarchy(Th.slice(0,5));for(let t=1;t<e.length;t++)if(e[t].getRoleLevel()<e[t-1].getRoleLevel())return!1;return!0}),console.log("\u2705 Data Models tests completed\n")}async testValidationRules(){console.log("\ud83d\udd0d Testing Validation Rules...");const e=Eh();this.test("Valid schedule passes validation",()=>{const t=e.validScenario;return F.validateSchedule(t.schedule,Th,Ih).length===t.expectedErrors}),this.test("Same-day violation detected",()=>{const t=e.sameDayViolation;return F.validateSchedule(t.schedule,Th,Ih).length>=t.expectedErrors}),this.test("Ratio violation detected",()=>{const t=e.ratioViolation;return F.validateSchedule(t.schedule,Th,Ih).length>=t.expectedErrors}),this.test("Individual assignment validation",()=>{const e=Ph(),t=e.assignments[0],n=new z({date:e.date,assignments:e.assignments.filter(e=>e.id!==t.id),lockedAssignments:e.lockedAssignments,isFinalized:e.isFinalized});return 0===F.validateAssignment(t,n,Th,Ih).length}),console.log("\u2705 Validation Rules tests completed\n")}async testAutoAssignment(){console.log("\ud83e\udd16 Testing Auto-Assignment..."),this.test("Auto-assignment creates assignments",async()=>{const e=Ph(),t=(e.assignments.length,await this.autoAssignEngine.autoAssignSchedule(e,Th,Ih));return t&&t.assignments&&t.assignments.length>=0}),this.test("Auto-assignment respects staff hierarchy",async()=>{const e=Ph(),t=Ih.find(t=>"1:1"===t.ratio&&!e.assignments.some(e=>e.studentId===t.id));if(!t)return!0;const n=await this.autoAssignEngine.autoAssignSchedule(e,Th,Ih);if(!n||!n.assignments)return!1;const r=n.assignments.find(e=>e.studentId===t.id);if(r){const e=Th.find(e=>e.id===r.staffId);return e&&e.canWorkProgram(r.program)}return!0}),this.test("Auto-assignment respects constraints",async()=>{const e=Ph(),t=await this.autoAssignEngine.autoAssignSchedule(e,Th,Ih);if(!t||!t.assignments)return!1;const n=[...e.assignments,...t.assignments];return 0===F.validateSchedule(c(c({},e),{},{assignments:n}),Th,Ih).length}),this.test("Auto-assignment preserves locked assignments",async()=>{const e=Ph(),t=[...e.lockedAssignments],n=await this.autoAssignEngine.autoAssignSchedule(e,Th,Ih);return!(!n||!n.assignments)&&t.every(t=>e.assignments.some(e=>e.id===t))}),console.log("\u2705 Auto-Assignment tests completed\n")}async testPerformance(){console.log("\u26a1 Testing Performance..."),this.test("Handles large datasets efficiently",async()=>{const e=Date.now(),t=Th.slice(0,20),n=Ih.slice(0,15),r=Ph(),o=await this.autoAssignEngine.autoAssignSchedule(r,t,n),i=Date.now()-e;return console.log("  Auto-assignment completed in ".concat(i,"ms")),o&&o.assignments&&i<5e3}),this.test("Validation performs efficiently",()=>{const e=Ph(),t=Date.now();for(let r=0;r<10;r++)F.validateSchedule(e,Th,Ih);const n=Date.now()-t;return console.log("  10 validation runs completed in ".concat(n,"ms")),n<1e3}),console.log("\u2705 Performance tests completed\n")}async testIntegration(){console.log("\ud83d\udd17 Testing Integration Scenarios..."),this.test("Complete scheduling workflow",async()=>{const e=Ph();e.assignments.length;e.assignments.length>0&&e.lockAssignment(e.assignments[0].id);const t=await this.autoAssignEngine.autoAssignSchedule(e,Th,Ih);if(!t||!t.assignments)return!1;const n=F.validateSchedule(e,Th,Ih);return t.assignments.length>=0&&0===n.length}),this.test("Handles mixed ratio requirements",async()=>{const e=Ph(),t=Ih.filter(e=>"1:1"===e.ratio),n=Ih.filter(e=>"2:1"===e.ratio),r=Ih.filter(e=>"1:2"===e.ratio);console.log("  Testing with ".concat(t.length," 1:1, ").concat(n.length," 2:1, ").concat(r.length," 1:2 students"));const o=await this.autoAssignEngine.autoAssignSchedule(e,Th,Ih);return o&&o.errors&&0===o.errors.length}),this.test("Maintains program separation",async()=>{const e=Ph(),t=await this.autoAssignEngine.autoAssignSchedule(e,Th,Ih);if(!t||!t.assignments)return!1;const n=[...e.assignments,...t.assignments].filter(e=>"Primary"===e.program).every(e=>{const t=Th.find(t=>t.id===e.staffId);return t&&t.canWorkProgram("Primary")}),r=[...e.assignments,...t.assignments].filter(e=>"Secondary"===e.program).every(e=>{const t=Th.find(t=>t.id===e.staffId);return t&&t.canWorkProgram("Secondary")});return n&&r}),console.log("\u2705 Integration tests completed\n")}test(e,t){try{const n=Date.now(),r=t(),o=Date.now()-n;return r instanceof Promise?r.then(t=>{const r=Date.now()-n;return this.recordTest(e,t,null,r),t}).catch(t=>{const r=Date.now()-n;return this.recordTest(e,!1,t,r),!1}):(this.recordTest(e,r,null,o),r)}catch(n){return this.recordTest(e,!1,n,0),!1}}recordTest(e,t,n,r){const o={name:e,passed:t,error:n?n.message:null,duration:r};this.testResults.push(o);const i=t?"\u2705":"\u274c",a=r>0?" (".concat(r,"ms)"):"";console.log("  ".concat(i," ").concat(e).concat(a)),n&&console.log("    Error: ".concat(n.message))}printSummary(){const e=this.testResults.filter(e=>e.passed).length,t=this.testResults.length-e,n=this.testResults.reduce((e,t)=>e+t.duration,0);console.log("\n\ud83d\udcca Test Summary:"),console.log("   Total Tests: ".concat(this.testResults.length)),console.log("   Passed: ".concat(e)),console.log("   Failed: ".concat(t)),console.log("   Total Duration: ".concat(n,"ms")),console.log("   Success Rate: ".concat((e/this.testResults.length*100).toFixed(1),"%")),t>0&&(console.log("\n\u274c Failed Tests:"),this.testResults.filter(e=>!e.passed).forEach(e=>{console.log("   - ".concat(e.name,": ").concat(e.error||"Unknown error"))})),console.log(0===t?"\n\ud83c\udf89 All tests passed!":"\n\u26a0\ufe0f  Some tests failed.")}generateReport(){return{summary:{total:this.testResults.length,passed:this.testResults.filter(e=>e.passed).length,failed:this.testResults.filter(e=>!e.passed).length,duration:this.testResults.reduce((e,t)=>e+t.duration,0)},results:this.testResults,timestamp:(new Date).toISOString()}}}const Nh=()=>{const[e]=(0,r.useState)({siteUrl:"https://evokebehavioralhealthcom.sharepoint.com/sites/Clinistrators",staffListName:"Staff",studentsListName:"Clients",scheduleListName:"ABASchedules",clientId:"c9f70b7e-8ffb-403d-af93-80b95b38a0bb",tenantId:"a4adcc38-7b4e-485c-80f9-7d9ca4e83d64",redirectUri:"localhost"===window.location.hostname?"http://localhost:3000":"https://mlr3037.github.io/EvokeSchedule2.0"}),[t]=(0,r.useState)(()=>new $d(e)),[n]=(0,r.useState)(()=>new Xd(e)),[o]=(0,r.useState)(()=>new Zd),[i,a]=(0,r.useState)(!1),[s,l]=(0,r.useState)(null),[u,d]=(0,r.useState)([]),[h,g]=(0,r.useState)([]),[f,m]=(0,r.useState)(new Date),[p,y]=(0,r.useState)(new z({date:new Date})),[N,R]=(0,r.useState)("schedule"),[M,O]=(0,r.useState)(!1),[j,F]=(0,r.useState)(!1),[H,B]=(0,r.useState)(!1),[K,W]=(0,r.useState)(null),[V,G]=(0,r.useState)(!1),[Q,Y]=(0,r.useState)(!1),[J,$]=(0,r.useState)(null),[X,Z]=(0,r.useState)(null),[ee,te]=(0,r.useState)(!1),[ne,re]=(0,r.useState)(null),[oe,ie]=(0,r.useState)(!1);(0,r.useEffect)(()=>{ae()},[]);const ae=async()=>{try{console.log("\ud83d\ude80 Initializing application..."),await t.initializeMSAL(),console.log("\u2705 MSAL initialized successfully");const e=await t.checkAuthentication();a(e),l(t.accessToken),t.accessToken&&n.setAccessToken(t.accessToken),e?(console.log("\u2705 User authenticated, loading data..."),await se()):console.log("\u26a0\ufe0f User not authenticated")}catch(e){console.error("\u274c Error initializing app:",e),(e.message.includes("session has expired")||e.message.includes("Authentication"))&&(a(!1),l(null),console.log("\ud83d\udd04 Authentication issue detected - user will be prompted to log in"))}},se=async()=>{O(!0);try{console.log("\ud83d\udd04 Starting data load..."),console.log("SharePoint config:",e);const[n,r,o]=await Promise.all([t.loadStaff().catch(e=>(console.error("\u274c Failed to load staff:",e),[])),t.loadStudents().catch(e=>(console.error("\u274c Failed to load students:",e),[])),t.loadSchedule(f).catch(e=>(console.error("\u274c Failed to load schedule:",e),{assignments:[],date:f}))]);d(n),g(r),y(o),console.log("\u2705 Loaded ".concat(n.length," staff, ").concat(r.length," students")),0===n.length&&0===r.length&&console.warn("\u26a0\ufe0f No data loaded. Check authentication and SharePoint list names.")}catch(n){console.error("\ud83d\udca5 Error loading data:",n),d([]),g([]),y({assignments:[],date:f})}finally{O(!1)}},le=async()=>{try{O(!0);await t.login()&&(a(!0),l(t.accessToken),t.accessToken&&n.setAccessToken(t.accessToken),await se())}catch(e){console.error("Login error:",e),alert("Login failed: ".concat(e.message))}finally{O(!1)}};return i?(0,oh.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,oh.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,oh.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,oh.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,oh.jsxs)("div",{className:"flex items-center gap-3",children:[(0,oh.jsx)(v,{className:"w-8 h-8 text-blue-600"}),(0,oh.jsxs)("div",{children:[(0,oh.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"ABA Scheduler"}),(0,oh.jsx)("p",{className:"text-sm text-gray-500",children:"Staff & Student Scheduling"})]})]}),(0,oh.jsxs)("div",{className:"flex items-center gap-4",children:[(0,oh.jsxs)("div",{className:"flex items-center gap-2",children:[(0,oh.jsx)(k,{className:"w-5 h-5 text-gray-500"}),(0,oh.jsx)("input",{type:"date",value:f.toISOString().split("T")[0],onChange:e=>(async e=>{if(m(e),i)try{const n=await t.loadSchedule(e);y(n)}catch(n){console.error("Error loading schedule for new date:",n)}})(new Date(e.target.value)),className:"border border-gray-300 rounded px-3 py-1 text-sm"})]}),(0,oh.jsxs)("div",{className:"flex items-center gap-2",children:[(0,oh.jsxs)("button",{onClick:async()=>{if(null!==K&&void 0!==K&&K.isValid||window.confirm("There are validation errors. Do you want to proceed with auto-assignment anyway?")){B(!0),o.setDebugMode(!0);try{const e=await o.autoAssignSchedule(p,u,h);if(e.assignments.length>0){console.log("Auto-assignment created ".concat(e.assignments.length," new assignments"));const t=[...p.assignments,...e.assignments],n=new z({date:p.date,assignments:t,lockedAssignments:p.lockedAssignments,isFinalized:p.isFinalized});y(n),console.log("\u2705 Updated schedule with ".concat(t.length," total assignments (").concat(e.assignments.length," new)")),console.log("\ud83d\udd0d NEW ASSIGNMENTS DETAILS:"),e.assignments.forEach((e,t)=>{console.log("  Assignment ".concat(t+1,":")),console.log("    ID: ".concat(e.id)),console.log("    Staff ID: ".concat(e.staffId)),console.log("    Student ID: ".concat(e.studentId)),console.log("    Session: ".concat(e.session)),console.log("    Program: ".concat(e.program)),console.log("    ---")}),console.log("\ud83d\udd0d UPDATED SCHEDULE ASSIGNMENTS:"),console.log("Total assignments in new schedule: ".concat(n.assignments.length))}e.errors.length>0&&console.warn("Auto-assignment errors:",e.errors)}catch(e){console.error("Auto-assignment failed:",e)}finally{B(!1)}}},disabled:H||M,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 disabled:opacity-50 flex items-center gap-2",children:[H?(0,oh.jsx)(b,{className:"w-4 h-4 animate-spin"}):(0,oh.jsx)(C,{className:"w-4 h-4"}),"Auto Assign"]}),(0,oh.jsxs)("button",{onClick:async()=>{F(!0);try{await t.saveSchedule(p),console.log("Schedule saved successfully")}catch(e){console.error("Error saving schedule:",e)}finally{F(!1)}},disabled:j||M,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2",children:[j?(0,oh.jsx)(b,{className:"w-4 h-4 animate-spin"}):(0,oh.jsx)(S,{className:"w-4 h-4"}),"Save"]}),(0,oh.jsxs)("button",{onClick:se,disabled:M,className:"bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 disabled:opacity-50 flex items-center gap-2",children:[(0,oh.jsx)(b,{className:"w-4 h-4 ".concat(M?"animate-spin":"")}),"Refresh"]}),(0,oh.jsx)("button",{onClick:async()=>{console.log("\ud83d\udd0d Debug Check Starting..."),console.log("Current authentication status:",i),console.log("Access token exists:",!!s),console.log("SharePoint config:",e),console.log("Current staff count:",u.length),console.log("Current students count:",h.length);try{console.log("\ud83d\udd04 Testing authentication...");const e=await t.checkAuthentication();console.log("Auth check result:",e),e?(console.log("\ud83d\udd04 Authentication successful, listing all SharePoint lists..."),await t.debugListAllLists(),console.log("\ud83d\udd04 Attempting to load data..."),await se()):console.log("\u274c Not authenticated. Please sign in first.")}catch(n){console.error("\ud83d\udca5 Debug check failed:",n)}},className:"bg-yellow-600 text-white px-4 py-2 rounded hover:bg-yellow-700 flex items-center gap-2",children:"\ud83d\udd0d Debug"}),(0,oh.jsx)("button",{onClick:()=>{console.log("\ud83d\udd04 Clearing authentication cache..."),localStorage.removeItem("sp_access_token"),localStorage.removeItem("sp_token_expiry"),t.accessToken=null,t.tokenExpiry=null,a(!1),l(null),alert("Authentication cache cleared. Please refresh the page and log in again.")},className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 flex items-center gap-2",title:"Clear authentication cache to fix 401 errors",children:"\ud83d\udd04 Clear Auth"})]}),(0,oh.jsx)("div",{className:"relative",children:(0,oh.jsxs)("button",{onClick:()=>{t.forceLogout(),a(!1),l(null),d([]),g([]),y(new z({date:f}))},className:"flex items-center gap-2 text-gray-700 hover:text-gray-900",children:[(0,oh.jsx)(x,{className:"w-5 h-5"}),"Sign Out"]})})]})]})})}),(0,oh.jsx)("nav",{className:"bg-white border-b border-gray-200",children:(0,oh.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,oh.jsx)("div",{className:"flex space-x-8",children:[{id:"schedule",label:"Schedule",icon:A},{id:"staff",label:"Staff",icon:v},{id:"students",label:"Students",icon:v},{id:"teams",label:"Teams",icon:v},{id:"validation",label:"Validation",icon:T},{id:"rules",label:"Rules",icon:I},{id:"tests",label:"Tests",icon:C}].map(e=>{const t=e.icon;return(0,oh.jsxs)("button",{onClick:()=>R(e.id),className:"py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 ".concat(N===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,oh.jsx)(t,{className:"w-4 h-4"}),e.label]},e.id)})})})}),(0,oh.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[M&&(0,oh.jsxs)("div",{className:"flex justify-center items-center py-12",children:[(0,oh.jsx)(b,{className:"w-8 h-8 animate-spin text-blue-600"}),(0,oh.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading..."})]}),!M&&(0,oh.jsxs)(oh.Fragment,{children:["schedule"===N&&(0,oh.jsxs)("div",{className:"space-y-6",children:[(0,oh.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 mb-6",children:[(0,oh.jsx)(ah,{schedule:p,staff:u,students:h,session:"AM",program:"Primary"}),(0,oh.jsx)(ah,{schedule:p,staff:u,students:h,session:"PM",program:"Primary"}),(0,oh.jsx)(ah,{schedule:p,staff:u,students:h,session:"AM",program:"Secondary"}),(0,oh.jsx)(ah,{schedule:p,staff:u,students:h,session:"PM",program:"Secondary"})]}),(0,oh.jsx)(ih,{schedule:p,staff:u,students:h,onAssignmentLock:e=>{p.lockAssignment(e),y(c({},p))},onAssignmentUnlock:e=>{p.unlockAssignment(e),y(c({},p))},onAssignmentRemove:e=>{p.removeAssignment(e),p.unlockAssignment(e),y(c({},p))},onManualAssignment:e=>{let{staffId:t,studentId:n,session:r,program:o}=e;const i=new D({id:U.generateAssignmentId(),staffId:t,studentId:n,session:r,program:o,date:f,isLocked:!1,assignedBy:"manual"});p.addAssignment(i),y(c({},p))},selectedDate:f})]}),"staff"===N&&(0,oh.jsxs)("div",{className:"space-y-6",children:[(0,oh.jsxs)("div",{className:"flex justify-between items-center",children:[(0,oh.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Staff Management"}),(0,oh.jsxs)("button",{onClick:()=>G(!0),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 flex items-center gap-2",children:[(0,oh.jsx)(P,{className:"w-4 h-4"}),"Add Staff"]})]}),(0,oh.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:[(0,oh.jsx)("h3",{className:"text-lg font-semibold text-yellow-800 mb-2",children:"Debug Information"}),(0,oh.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,oh.jsxs)("div",{children:[(0,oh.jsx)("strong",{children:"Authentication Status:"})," ",i?"\u2705 Authenticated":"\u274c Not Authenticated"]}),(0,oh.jsxs)("div",{children:[(0,oh.jsx)("strong",{children:"Access Token:"})," ",s?"\u2705 Present":"\u274c Missing"]}),(0,oh.jsxs)("div",{children:[(0,oh.jsx)("strong",{children:"Staff Count:"})," ",u.length]}),(0,oh.jsxs)("div",{children:[(0,oh.jsx)("strong",{children:"Students Count:"})," ",h.length]}),(0,oh.jsxs)("div",{className:"col-span-2",children:[(0,oh.jsx)("strong",{children:"SharePoint Site:"})," ",e.siteUrl]}),(0,oh.jsxs)("div",{children:[(0,oh.jsx)("strong",{children:"Staff List:"})," ",e.staffListName]}),(0,oh.jsxs)("div",{children:[(0,oh.jsx)("strong",{children:"Students List:"})," ",e.studentsListName]})]})]}),(0,oh.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,oh.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,oh.jsx)("thead",{className:"bg-gray-50",children:(0,oh.jsxs)("tr",{children:[(0,oh.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,oh.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),(0,oh.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Primary Program"}),(0,oh.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Secondary Program"}),(0,oh.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,oh.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,oh.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:u.map(e=>(0,oh.jsxs)("tr",{children:[(0,oh.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.name}),(0,oh.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.role}),(0,oh.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.primaryProgram||"-"}),(0,oh.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.secondaryProgram||"-"}),(0,oh.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,oh.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(e.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.isActive?"Active":"Inactive"})}),(0,oh.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[(0,oh.jsx)("button",{onClick:()=>$(e),className:"text-blue-600 hover:text-blue-900 mr-3",children:(0,oh.jsx)(E,{className:"w-4 h-4"})}),(0,oh.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this staff member?"))try{await t.deleteStaff(e),await se()}catch(n){console.error("Error deleting staff:",n)}})(e.id),className:"text-red-600 hover:text-red-900",children:(0,oh.jsx)(_,{className:"w-4 h-4"})})]})]},e.id))})]})})]}),"students"===N&&(0,oh.jsxs)("div",{className:"space-y-6",children:[(0,oh.jsxs)("div",{className:"flex justify-between items-center",children:[(0,oh.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Student Management"}),(0,oh.jsxs)("button",{onClick:()=>Y(!0),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 flex items-center gap-2",children:[(0,oh.jsx)(P,{className:"w-4 h-4"}),"Add Student"]})]}),(0,oh.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,oh.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,oh.jsx)("thead",{className:"bg-gray-50",children:(0,oh.jsxs)("tr",{children:[(0,oh.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,oh.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Program"}),(0,oh.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ratio AM"}),(0,oh.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ratio PM"}),(0,oh.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,oh.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,oh.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:h.map(e=>(0,oh.jsxs)("tr",{children:[(0,oh.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.name}),(0,oh.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.program}),(0,oh.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,oh.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs font-medium",children:e.ratioAM})}),(0,oh.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,oh.jsx)("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 rounded text-xs font-medium",children:e.ratioPM})}),(0,oh.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,oh.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(e.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.isActive?"Active":"Inactive"})}),(0,oh.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[(0,oh.jsx)("button",{onClick:()=>Z(e),className:"text-blue-600 hover:text-blue-900 mr-3",children:(0,oh.jsx)(E,{className:"w-4 h-4"})}),(0,oh.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this student?"))try{await t.deleteStudent(e),await se()}catch(n){console.error("Error deleting student:",n)}})(e.id),className:"text-red-600 hover:text-red-900",children:(0,oh.jsx)(_,{className:"w-4 h-4"})})]})]},e.id))})]})})]}),"teams"===N&&(0,oh.jsx)(Ah,{staff:u,students:h,onEditStaff:e=>{$(e),G(!0)},onEditStudent:e=>{Z(e),Y(!0)}}),"validation"===N&&(0,oh.jsx)(ch,{schedule:p,staff:u,students:h,onValidationChange:e=>{W(e)}}),"rules"===N&&(0,oh.jsx)(dh,{}),"tests"===N&&(0,oh.jsxs)("div",{className:"space-y-6",children:[(0,oh.jsxs)("div",{className:"flex justify-between items-center",children:[(0,oh.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Test Suite"}),(0,oh.jsxs)("button",{onClick:async()=>{ie(!0),re(null);try{console.log("\ud83e\uddea Starting test suite...");const e=await(async()=>{const e=new _h;return await e.runAllTests(),e.generateReport()})();re(e),console.log("\u2705 Test suite completed")}catch(e){console.error("\u274c Test suite failed:",e),re({summary:{total:0,passed:0,failed:1,duration:0},results:[],error:e.message})}finally{ie(!1)}},disabled:oe,className:"bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700 disabled:opacity-50 flex items-center gap-2",children:[oe?(0,oh.jsx)(b,{className:"w-5 h-5 animate-spin"}):(0,oh.jsx)(C,{className:"w-5 h-5"}),oe?"Running Tests...":"Run All Tests"]})]}),ne&&(0,oh.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,oh.jsxs)("div",{className:"mb-6",children:[(0,oh.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Test Results Summary"}),(0,oh.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,oh.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg text-center",children:[(0,oh.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:ne.summary.total}),(0,oh.jsx)("div",{className:"text-sm text-blue-800",children:"Total Tests"})]}),(0,oh.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg text-center",children:[(0,oh.jsx)("div",{className:"text-2xl font-bold text-green-600",children:ne.summary.passed}),(0,oh.jsx)("div",{className:"text-sm text-green-800",children:"Passed"})]}),(0,oh.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg text-center",children:[(0,oh.jsx)("div",{className:"text-2xl font-bold text-red-600",children:ne.summary.failed}),(0,oh.jsx)("div",{className:"text-sm text-red-800",children:"Failed"})]}),(0,oh.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg text-center",children:[(0,oh.jsxs)("div",{className:"text-2xl font-bold text-gray-600",children:[ne.summary.duration,"ms"]}),(0,oh.jsx)("div",{className:"text-sm text-gray-800",children:"Duration"})]})]}),(0,oh.jsxs)("div",{className:"mt-4",children:[(0,oh.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-1",children:[(0,oh.jsx)("span",{children:"Success Rate"}),(0,oh.jsxs)("span",{children:[ne.summary.total>0?(ne.summary.passed/ne.summary.total*100).toFixed(1):0,"%"]})]}),(0,oh.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,oh.jsx)("div",{className:"h-2 rounded-full ".concat(0===ne.summary.failed?"bg-green-500":"bg-yellow-500"),style:{width:"".concat(ne.summary.total>0?ne.summary.passed/ne.summary.total*100:0,"%")}})})]})]}),ne.results&&ne.results.length>0&&(0,oh.jsxs)("div",{children:[(0,oh.jsx)("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Test Details"}),(0,oh.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:ne.results.map((e,t)=>(0,oh.jsxs)("div",{className:"p-3 rounded border-l-4 ".concat(e.passed?"bg-green-50 border-green-400":"bg-red-50 border-red-400"),children:[(0,oh.jsxs)("div",{className:"flex items-center justify-between",children:[(0,oh.jsx)("div",{className:"flex items-center gap-2",children:(0,oh.jsxs)("span",{className:"text-sm font-medium ".concat(e.passed?"text-green-800":"text-red-800"),children:[e.passed?"\u2705":"\u274c"," ",e.name]})}),(0,oh.jsxs)("span",{className:"text-xs text-gray-500",children:[e.duration,"ms"]})]}),e.error&&(0,oh.jsx)("div",{className:"mt-2 text-sm text-red-700 font-mono bg-red-100 p-2 rounded",children:e.error})]},t))})]}),ne.error&&(0,oh.jsxs)("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded",children:[(0,oh.jsx)("h4",{className:"text-red-800 font-medium",children:"Test Suite Error"}),(0,oh.jsx)("p",{className:"text-red-700 text-sm mt-1",children:ne.error})]})]}),(0,oh.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[(0,oh.jsx)("h3",{className:"text-lg font-semibold text-blue-900 mb-3",children:"About the Test Suite"}),(0,oh.jsxs)("div",{className:"text-blue-800 space-y-2",children:[(0,oh.jsx)("p",{children:"This comprehensive test suite validates all core functionality of the ABA Scheduling System:"}),(0,oh.jsxs)("ul",{className:"list-disc list-inside space-y-1 ml-4",children:[(0,oh.jsxs)("li",{children:[(0,oh.jsx)("strong",{children:"Data Models:"})," Staff and Student object validation, role hierarchies"]}),(0,oh.jsxs)("li",{children:[(0,oh.jsx)("strong",{children:"Validation Rules:"})," Schedule constraints, ratio requirements, program separation"]}),(0,oh.jsxs)("li",{children:[(0,oh.jsx)("strong",{children:"Auto-Assignment:"})," Automated scheduling algorithms and optimization"]}),(0,oh.jsxs)("li",{children:[(0,oh.jsx)("strong",{children:"Performance:"})," Large dataset handling and response times"]}),(0,oh.jsxs)("li",{children:[(0,oh.jsx)("strong",{children:"Integration:"})," End-to-end workflow testing"]})]}),(0,oh.jsxs)("p",{className:"mt-3 text-sm",children:[(0,oh.jsx)("strong",{children:"Note:"})," Tests run using sample data and do not affect your actual schedule or database."]})]})]})]})]})]}),V&&(0,oh.jsx)(kh,{staff:J,onSave:J?async e=>{try{const n=new L(c(c({},e),{},{id:J.id}));await t.saveStaff(n,!0),await se(),$(null)}catch(n){console.error("Error updating staff:",n)}}:async e=>{try{const n=new L(e);await t.saveStaff(n),await se(),G(!1)}catch(n){console.error("Error adding staff:",n)}},onCancel:()=>{G(!1),$(null)},peoplePickerService:n}),Q&&(0,oh.jsx)(Ch,{student:X,onSave:X?async e=>{try{const n=new q(c(c({},e),{},{id:X.id}));await t.saveStudent(n,!0),await se(),Z(null)}catch(n){console.error("Error updating student:",n)}}:async e=>{try{const n=new q(e);await t.saveStudent(n),await se(),Y(!1)}catch(n){console.error("Error adding student:",n)}},onCancel:()=>{Y(!1),Z(null)},allStaff:u,peoplePickerService:n})]}):(0,oh.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,oh.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-lg max-w-md w-full mx-4",children:[(0,oh.jsxs)("div",{className:"text-center mb-6",children:[(0,oh.jsx)(v,{className:"w-12 h-12 text-blue-600 mx-auto mb-4"}),(0,oh.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"ABA Scheduler"}),(0,oh.jsx)("p",{className:"text-gray-600",children:"Staff & Student Scheduling System"})]}),(0,oh.jsx)("button",{onClick:le,disabled:M,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:M?(0,oh.jsxs)(oh.Fragment,{children:[(0,oh.jsx)(b,{className:"w-5 h-5 animate-spin"}),"Signing in..."]}):(0,oh.jsxs)(oh.Fragment,{children:[(0,oh.jsx)(w,{className:"w-5 h-5"}),"Sign in with Microsoft"]})}),(0,oh.jsx)("div",{className:"mt-6 text-sm text-gray-500 text-center",children:(0,oh.jsx)("p",{children:"Sign in to access the ABA scheduling system"})})]})})},Rh=e=>{e&&e instanceof Function&&n.e(206).then(n.bind(n,206)).then(t=>{let{getCLS:n,getFID:r,getFCP:o,getLCP:i,getTTFB:a}=t;n(e),r(e),o(e),i(e),a(e)})};o.createRoot(document.getElementById("root")).render((0,oh.jsx)(r.StrictMode,{children:(0,oh.jsx)(Nh,{})})),Rh()})();