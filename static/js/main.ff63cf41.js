/*! For license information please see main.ff63cf41.js.LICENSE.txt */
(()=>{"use strict";var e={85:(e,t,n)=>{var r=n(340),a=n(950),i=n(119);function s(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function d(e){if(l(e)!==e)throw Error(s(188))}function h(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=h(e)))return t;e=e.sibling}return null}var f=Object.assign,m=Symbol.for("react.element"),g=Symbol.for("react.transitional.element"),p=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),w=Symbol.for("react.consumer"),S=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),C=Symbol.for("react.lazy");Symbol.for("react.scope");var E=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var I=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var N=Symbol.iterator;function P(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=N&&e[N]||e["@@iterator"])?e:null}var _=Symbol.for("react.client.reference");function O(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===_?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case v:return"Fragment";case b:return"Profiler";case y:return"StrictMode";case A:return"Suspense";case x:return"SuspenseList";case E:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case p:return"Portal";case S:return e.displayName||"Context";case w:return(e._context.displayName||"Context")+".Consumer";case T:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case k:return null!==(t=e.displayName||null)?t:O(e.type)||"Memo";case C:t=e._payload,e=e._init;try{return O(e(t))}catch(n){}}return null}var R=Array.isArray,M=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,D=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L={pending:!1,data:null,method:null,action:null},F=[],j=-1;function U(e){return{current:e}}function B(e){0>j||(e.current=F[j],F[j]=null,j--)}function H(e,t){j++,F[j]=e.current,e.current=t}var z,q,W=U(null),V=U(null),K=U(null),G=U(null);function Y(e,t){switch(H(K,t),H(V,e),H(W,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?vd(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=yd(t=vd(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}B(W),H(W,e)}function $(){B(W),B(V),B(K)}function Q(e){null!==e.memoizedState&&H(G,e);var t=W.current,n=yd(t,e.type);t!==n&&(H(V,e),H(W,n))}function J(e){V.current===e&&(B(W),B(V)),G.current===e&&(B(G),uh._currentValue=L)}function X(e){if(void 0===z)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);z=t&&t[1]||"",q=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+z+e+q}var Z=!1;function ee(e,t){if(!e||Z)return"";Z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(a){var r=a}Reflect.construct(e,[],n)}else{try{n.call()}catch(i){r=i}e.call(n.prototype)}}else{try{throw Error()}catch(s){r=s}(n=e())&&"function"===typeof n.catch&&n.catch(function(){})}}catch(o){if(o&&r&&"string"===typeof o.stack)return[o.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var a=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");a&&a.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var i=r.DetermineComponentFrameRoot(),s=i[0],o=i[1];if(s&&o){var l=s.split("\n"),c=o.split("\n");for(a=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;a<c.length&&!c[a].includes("DetermineComponentFrameRoot");)a++;if(r===l.length||a===c.length)for(r=l.length-1,a=c.length-1;1<=r&&0<=a&&l[r]!==c[a];)a--;for(;1<=r&&0<=a;r--,a--)if(l[r]!==c[a]){if(1!==r||1!==a)do{if(r--,0>--a||l[r]!==c[a]){var u="\n"+l[r].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=r&&0<=a);break}}}finally{Z=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?X(n):""}function te(e,t){switch(e.tag){case 26:case 27:case 5:return X(e.type);case 16:return X("Lazy");case 13:return e.child!==t&&null!==t?X("Suspense Fallback"):X("Suspense");case 19:return X("SuspenseList");case 0:case 15:return ee(e.type,!1);case 11:return ee(e.type.render,!1);case 1:return ee(e.type,!0);case 31:return X("Activity");default:return""}}function ne(e){try{var t="",n=null;do{t+=te(e,n),n=e,e=e.return}while(e);return t}catch(r){return"\nError generating stack: "+r.message+"\n"+r.stack}}var re=Object.prototype.hasOwnProperty,ae=r.unstable_scheduleCallback,ie=r.unstable_cancelCallback,se=r.unstable_shouldYield,oe=r.unstable_requestPaint,le=r.unstable_now,ce=r.unstable_getCurrentPriorityLevel,ue=r.unstable_ImmediatePriority,de=r.unstable_UserBlockingPriority,he=r.unstable_NormalPriority,fe=r.unstable_LowPriority,me=r.unstable_IdlePriority,ge=r.log,pe=r.unstable_setDisableYieldValue,ve=null,ye=null;function be(e){if("function"===typeof ge&&pe(e),ye&&"function"===typeof ye.setStrictMode)try{ye.setStrictMode(ve,e)}catch(t){}}var we=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(Se(e)/Te|0)|0},Se=Math.log,Te=Math.LN2;var Ae=256,xe=262144,ke=4194304;function Ce(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ee(e,t,n){var r=e.pendingLanes;if(0===r)return 0;var a=0,i=e.suspendedLanes,s=e.pingedLanes;e=e.warmLanes;var o=134217727&r;return 0!==o?0!==(r=o&~i)?a=Ce(r):0!==(s&=o)?a=Ce(s):n||0!==(n=o&~e)&&(a=Ce(n)):0!==(o=r&~i)?a=Ce(o):0!==s?a=Ce(s):n||0!==(n=r&~e)&&(a=Ce(n)),0===a?0:0!==t&&t!==a&&0===(t&i)&&((i=a&-a)>=(n=t&-t)||32===i&&0!==(4194048&n))?t:a}function Ie(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Ne(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Pe(){var e=ke;return 0===(62914560&(ke<<=1))&&(ke=4194304),e}function _e(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Oe(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Re(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-we(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|261930&n}function Me(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-we(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}function De(e,t){var n=t&-t;return 0!==((n=0!==(42&n)?1:Le(n))&(e.suspendedLanes|t))?0:n}function Le(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Fe(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function je(){var e=D.p;return 0!==e?e:void 0===(e=window.event)?32:Ch(e.type)}function Ue(e,t){var n=D.p;try{return D.p=e,t()}finally{D.p=n}}var Be=Math.random().toString(36).slice(2),He="__reactFiber$"+Be,ze="__reactProps$"+Be,qe="__reactContainer$"+Be,We="__reactEvents$"+Be,Ve="__reactListeners$"+Be,Ke="__reactHandles$"+Be,Ge="__reactResources$"+Be,Ye="__reactMarker$"+Be;function $e(e){delete e[He],delete e[ze],delete e[We],delete e[Ve],delete e[Ke]}function Qe(e){var t=e[He];if(t)return t;for(var n=e.parentNode;n;){if(t=n[qe]||n[He]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Ld(e);null!==e;){if(n=e[He])return n;e=Ld(e)}return t}n=(e=n).parentNode}return null}function Je(e){if(e=e[He]||e[qe]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function Xe(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(s(33))}function Ze(e){var t=e[Ge];return t||(t=e[Ge]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function et(e){e[Ye]=!0}var tt=new Set,nt={};function rt(e,t){at(e,t),at(e+"Capture",t)}function at(e,t){for(nt[e]=t,e=0;e<t.length;e++)tt.add(t[e])}var it=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),st={},ot={};function lt(e,t,n){if(a=t,re.call(ot,a)||!re.call(st,a)&&(it.test(a)?ot[a]=!0:(st[a]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var a}function ct(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function ut(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function dt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ht(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ft(e){if(!e._valueTracker){var t=ht(e)?"checked":"value";e._valueTracker=function(e,t,n){var r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){n=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e,t,""+e[t])}}function mt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ht(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function gt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var pt=/[\n"\\]/g;function vt(e){return e.replace(pt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function yt(e,t,n,r,a,i,s,o){e.name="",null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s?e.type=s:e.removeAttribute("type"),null!=t?"number"===s?(0===t&&""===e.value||e.value!=t)&&(e.value=""+dt(t)):e.value!==""+dt(t)&&(e.value=""+dt(t)):"submit"!==s&&"reset"!==s||e.removeAttribute("value"),null!=t?wt(e,s,dt(t)):null!=n?wt(e,s,dt(n)):null!=r&&e.removeAttribute("value"),null==a&&null!=i&&(e.defaultChecked=!!i),null!=a&&(e.checked=a&&"function"!==typeof a&&"symbol"!==typeof a),null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.name=""+dt(o):e.removeAttribute("name")}function bt(e,t,n,r,a,i,s,o){if(null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i&&(e.type=i),null!=t||null!=n){if(!("submit"!==i&&"reset"!==i||void 0!==t&&null!==t))return void ft(e);n=null!=n?""+dt(n):"",t=null!=t?""+dt(t):n,o||t===e.value||(e.value=t),e.defaultValue=t}r="function"!==typeof(r=null!=r?r:a)&&"symbol"!==typeof r&&!!r,e.checked=o?e.checked:!!r,e.defaultChecked=!!r,null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.name=s),ft(e)}function wt(e,t,n){"number"===t&&gt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function St(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+dt(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function Tt(e,t,n){null==t||((t=""+dt(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+dt(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function At(e,t,n,r){if(null==t){if(null!=r){if(null!=n)throw Error(s(92));if(R(r)){if(1<r.length)throw Error(s(93));r=r[0]}n=r}null==n&&(n=""),t=n}n=dt(t),e.defaultValue=n,(r=e.textContent)===n&&""!==r&&null!==r&&(e.value=r),ft(e)}function xt(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var kt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ct(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!==typeof n||0===n||kt.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Et(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(s(62));if(e=e.style,null!=n){for(var r in n)!n.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var a in t)r=t[a],t.hasOwnProperty(a)&&n[a]!==r&&Ct(e,a,r)}else for(var i in t)t.hasOwnProperty(i)&&Ct(e,i,t[i])}function It(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Nt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Pt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function _t(e){return Pt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Ot(){}var Rt=null;function Mt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Dt=null,Lt=null;function Ft(e){var t=Je(e);if(t&&(e=t.stateNode)){var n=e[ze]||null;e:switch(e=t.stateNode,t.type){case"input":if(yt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+vt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=r[ze]||null;if(!a)throw Error(s(90));yt(r,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name)}}for(t=0;t<n.length;t++)(r=n[t]).form===e.form&&mt(r)}break e;case"textarea":Tt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&St(e,!!n.multiple,t,!1)}}}var jt=!1;function Ut(e,t,n){if(jt)return e(t,n);jt=!0;try{return e(t)}finally{if(jt=!1,(null!==Dt||null!==Lt)&&(Zc(),Dt&&(t=Dt,e=Lt,Lt=Dt=null,Ft(t),e)))for(t=0;t<e.length;t++)Ft(e[t])}}function Bt(e,t){var n=e.stateNode;if(null===n)return null;var r=n[ze]||null;if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Ht=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),zt=!1;if(Ht)try{var qt={};Object.defineProperty(qt,"passive",{get:function(){zt=!0}}),window.addEventListener("test",qt,qt),window.removeEventListener("test",qt,qt)}catch(Jh){zt=!1}var Wt=null,Vt=null,Kt=null;function Gt(){if(Kt)return Kt;var e,t,n=Vt,r=n.length,a="value"in Wt?Wt.value:Wt.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===a[i-t];t++);return Kt=a.slice(e,1<t?1-t:void 0)}function Yt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function $t(){return!0}function Qt(){return!1}function Jt(e){function t(t,n,r,a,i){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(a):a[s]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?$t:Qt,this.isPropagationStopped=Qt,this}return f(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=$t)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=$t)},persist:function(){},isPersistent:$t}),t}var Xt,Zt,en,tn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nn=Jt(tn),rn=f({},tn,{view:0,detail:0}),an=Jt(rn),sn=f({},rn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==en&&(en&&"mousemove"===e.type?(Xt=e.screenX-en.screenX,Zt=e.screenY-en.screenY):Zt=Xt=0,en=e),Xt)},movementY:function(e){return"movementY"in e?e.movementY:Zt}}),on=Jt(sn),ln=Jt(f({},sn,{dataTransfer:0})),cn=Jt(f({},rn,{relatedTarget:0})),un=Jt(f({},tn,{animationName:0,elapsedTime:0,pseudoElement:0})),dn=Jt(f({},tn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),hn=Jt(f({},tn,{data:0})),fn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=gn[e])&&!!t[e]}function vn(){return pn}var yn=Jt(f({},rn,{key:function(e){if(e.key){var t=fn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Yt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?mn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vn,charCode:function(e){return"keypress"===e.type?Yt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Yt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),bn=Jt(f({},sn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),wn=Jt(f({},rn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vn})),Sn=Jt(f({},tn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Tn=Jt(f({},sn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),An=Jt(f({},tn,{newState:0,oldState:0})),xn=[9,13,27,32],kn=Ht&&"CompositionEvent"in window,Cn=null;Ht&&"documentMode"in document&&(Cn=document.documentMode);var En=Ht&&"TextEvent"in window&&!Cn,In=Ht&&(!kn||Cn&&8<Cn&&11>=Cn),Nn=String.fromCharCode(32),Pn=!1;function _n(e,t){switch(e){case"keyup":return-1!==xn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function On(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Rn=!1;var Mn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Dn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Mn[e.type]:"textarea"===t}function Ln(e,t,n,r){Dt?Lt?Lt.push(r):Lt=[r]:Dt=r,0<(t=rd(t,"onChange")).length&&(n=new nn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Fn=null,jn=null;function Un(e){$u(e,0)}function Bn(e){if(mt(Xe(e)))return e}function Hn(e,t){if("change"===e)return t}var zn=!1;if(Ht){var qn;if(Ht){var Wn="oninput"in document;if(!Wn){var Vn=document.createElement("div");Vn.setAttribute("oninput","return;"),Wn="function"===typeof Vn.oninput}qn=Wn}else qn=!1;zn=qn&&(!document.documentMode||9<document.documentMode)}function Kn(){Fn&&(Fn.detachEvent("onpropertychange",Gn),jn=Fn=null)}function Gn(e){if("value"===e.propertyName&&Bn(jn)){var t=[];Ln(t,jn,e,Mt(e)),Ut(Un,t)}}function Yn(e,t,n){"focusin"===e?(Kn(),jn=n,(Fn=t).attachEvent("onpropertychange",Gn)):"focusout"===e&&Kn()}function $n(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Bn(jn)}function Qn(e,t){if("click"===e)return Bn(t)}function Jn(e,t){if("input"===e||"change"===e)return Bn(t)}var Xn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Zn(e,t){if(Xn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!re.call(t,a)||!Xn(e[a],t[a]))return!1}return!0}function er(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function tr(e,t){var n,r=er(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=er(r)}}function nr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?nr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function rr(e){for(var t=gt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=gt((e=t.contentWindow).document)}return t}function ar(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var ir=Ht&&"documentMode"in document&&11>=document.documentMode,sr=null,or=null,lr=null,cr=!1;function ur(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;cr||null==sr||sr!==gt(r)||("selectionStart"in(r=sr)&&ar(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},lr&&Zn(lr,r)||(lr=r,0<(r=rd(or,"onSelect")).length&&(t=new nn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=sr)))}function dr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var hr={animationend:dr("Animation","AnimationEnd"),animationiteration:dr("Animation","AnimationIteration"),animationstart:dr("Animation","AnimationStart"),transitionrun:dr("Transition","TransitionRun"),transitionstart:dr("Transition","TransitionStart"),transitioncancel:dr("Transition","TransitionCancel"),transitionend:dr("Transition","TransitionEnd")},fr={},mr={};function gr(e){if(fr[e])return fr[e];if(!hr[e])return e;var t,n=hr[e];for(t in n)if(n.hasOwnProperty(t)&&t in mr)return fr[e]=n[t];return e}Ht&&(mr=document.createElement("div").style,"AnimationEvent"in window||(delete hr.animationend.animation,delete hr.animationiteration.animation,delete hr.animationstart.animation),"TransitionEvent"in window||delete hr.transitionend.transition);var pr=gr("animationend"),vr=gr("animationiteration"),yr=gr("animationstart"),br=gr("transitionrun"),wr=gr("transitionstart"),Sr=gr("transitioncancel"),Tr=gr("transitionend"),Ar=new Map,xr="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function kr(e,t){Ar.set(e,t),rt(t,[e])}xr.push("scrollEnd");var Cr="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},Er=[],Ir=0,Nr=0;function Pr(){for(var e=Ir,t=Nr=Ir=0;t<e;){var n=Er[t];Er[t++]=null;var r=Er[t];Er[t++]=null;var a=Er[t];Er[t++]=null;var i=Er[t];if(Er[t++]=null,null!==r&&null!==a){var s=r.pending;null===s?a.next=a:(a.next=s.next,s.next=a),r.pending=a}0!==i&&Mr(n,a,i)}}function _r(e,t,n,r){Er[Ir++]=e,Er[Ir++]=t,Er[Ir++]=n,Er[Ir++]=r,Nr|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Or(e,t,n,r){return _r(e,t,n,r),Dr(e)}function Rr(e,t){return _r(e,null,null,t),Dr(e)}function Mr(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var a=!1,i=e.return;null!==i;)i.childLanes|=n,null!==(r=i.alternate)&&(r.childLanes|=n),22===i.tag&&(null===(e=i.stateNode)||1&e._visibility||(a=!0)),e=i,i=i.return;return 3===e.tag?(i=e.stateNode,a&&null!==t&&(a=31-we(n),null===(r=(e=i.hiddenUpdates)[a])?e[a]=[t]:r.push(t),t.lane=536870912|n),i):null}function Dr(e){if(50<Wc)throw Wc=0,Vc=null,Error(s(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Lr={};function Fr(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jr(e,t,n,r){return new Fr(e,t,n,r)}function Ur(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Br(e,t){var n=e.alternate;return null===n?((n=jr(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Hr(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function zr(e,t,n,r,a,i){var o=0;if(r=e,"function"===typeof e)Ur(e)&&(o=1);else if("string"===typeof e)o=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,W.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case E:return(e=jr(31,n,t,a)).elementType=E,e.lanes=i,e;case v:return qr(n.children,a,i,t);case y:o=8,a|=24;break;case b:return(e=jr(12,n,t,2|a)).elementType=b,e.lanes=i,e;case A:return(e=jr(13,n,t,a)).elementType=A,e.lanes=i,e;case x:return(e=jr(19,n,t,a)).elementType=x,e.lanes=i,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case S:o=10;break e;case w:o=9;break e;case T:o=11;break e;case k:o=14;break e;case C:o=16,r=null;break e}o=29,n=Error(s(130,null===e?"null":typeof e,"")),r=null}return(t=jr(o,n,t,a)).elementType=e,t.type=r,t.lanes=i,t}function qr(e,t,n,r){return(e=jr(7,e,r,t)).lanes=n,e}function Wr(e,t,n){return(e=jr(6,e,null,t)).lanes=n,e}function Vr(e){var t=jr(18,null,null,0);return t.stateNode=e,t}function Kr(e,t,n){return(t=jr(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Gr=new WeakMap;function Yr(e,t){if("object"===typeof e&&null!==e){var n=Gr.get(e);return void 0!==n?n:(t={value:e,source:t,stack:ne(t)},Gr.set(e,t),t)}return{value:e,source:t,stack:ne(t)}}var $r=[],Qr=0,Jr=null,Xr=0,Zr=[],ea=0,ta=null,na=1,ra="";function aa(e,t){$r[Qr++]=Xr,$r[Qr++]=Jr,Jr=e,Xr=t}function ia(e,t,n){Zr[ea++]=na,Zr[ea++]=ra,Zr[ea++]=ta,ta=e;var r=na;e=ra;var a=32-we(r)-1;r&=~(1<<a),n+=1;var i=32-we(t)+a;if(30<i){var s=a-a%5;i=(r&(1<<s)-1).toString(32),r>>=s,a-=s,na=1<<32-we(t)+a|n<<a|r,ra=i+e}else na=1<<i|n<<a|r,ra=e}function sa(e){null!==e.return&&(aa(e,1),ia(e,1,0))}function oa(e){for(;e===Jr;)Jr=$r[--Qr],$r[Qr]=null,Xr=$r[--Qr],$r[Qr]=null;for(;e===ta;)ta=Zr[--ea],Zr[ea]=null,ra=Zr[--ea],Zr[ea]=null,na=Zr[--ea],Zr[ea]=null}function la(e,t){Zr[ea++]=na,Zr[ea++]=ra,Zr[ea++]=ta,na=t.id,ra=t.overflow,ta=e}var ca=null,ua=null,da=!1,ha=null,fa=!1,ma=Error(s(519));function ga(e){throw Sa(Yr(Error(s(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),ma}function pa(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[He]=e,t[ze]=r,n){case"dialog":Qu("cancel",t),Qu("close",t);break;case"iframe":case"object":case"embed":Qu("load",t);break;case"video":case"audio":for(n=0;n<Gu.length;n++)Qu(Gu[n],t);break;case"source":Qu("error",t);break;case"img":case"image":case"link":Qu("error",t),Qu("load",t);break;case"details":Qu("toggle",t);break;case"input":Qu("invalid",t),bt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0);break;case"select":Qu("invalid",t);break;case"textarea":Qu("invalid",t),At(t,r.value,r.defaultValue,r.children)}"string"!==typeof(n=r.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||cd(t.textContent,n)?(null!=r.popover&&(Qu("beforetoggle",t),Qu("toggle",t)),null!=r.onScroll&&Qu("scroll",t),null!=r.onScrollEnd&&Qu("scrollend",t),null!=r.onClick&&(t.onclick=Ot),t=!0):t=!1,t||ga(e,!0)}function va(e){for(ca=e.return;ca;)switch(ca.tag){case 5:case 31:case 13:return void(fa=!1);case 27:case 3:return void(fa=!0);default:ca=ca.return}}function ya(e){if(e!==ca)return!1;if(!da)return va(e),da=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||bd(e.type,e.memoizedProps)),t=!t),t&&ua&&ga(e),va(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));ua=Dd(e)}else if(31===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));ua=Dd(e)}else 27===n?(n=ua,Cd(e.type)?(e=Md,Md=null,ua=e):ua=n):ua=ca?Rd(e.stateNode.nextSibling):null;return!0}function ba(){ua=ca=null,da=!1}function wa(){var e=ha;return null!==e&&(null===Pc?Pc=e:Pc.push.apply(Pc,e),ha=null),e}function Sa(e){null===ha?ha=[e]:ha.push(e)}var Ta=U(null),Aa=null,xa=null;function ka(e,t,n){H(Ta,t._currentValue),t._currentValue=n}function Ca(e){e._currentValue=Ta.current,B(Ta)}function Ea(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ia(e,t,n,r){var a=e.child;for(null!==a&&(a.return=e);null!==a;){var i=a.dependencies;if(null!==i){var o=a.child;i=i.firstContext;e:for(;null!==i;){var l=i;i=a;for(var c=0;c<t.length;c++)if(l.context===t[c]){i.lanes|=n,null!==(l=i.alternate)&&(l.lanes|=n),Ea(i.return,n,e),r||(o=null);break e}i=l.next}}else if(18===a.tag){if(null===(o=a.return))throw Error(s(341));o.lanes|=n,null!==(i=o.alternate)&&(i.lanes|=n),Ea(o,n,e),o=null}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===e){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}}function Na(e,t,n,r){e=null;for(var a=t,i=!1;null!==a;){if(!i)if(0!==(524288&a.flags))i=!0;else if(0!==(262144&a.flags))break;if(10===a.tag){var o=a.alternate;if(null===o)throw Error(s(387));if(null!==(o=o.memoizedProps)){var l=a.type;Xn(a.pendingProps.value,o.value)||(null!==e?e.push(l):e=[l])}}else if(a===G.current){if(null===(o=a.alternate))throw Error(s(387));o.memoizedState.memoizedState!==a.memoizedState.memoizedState&&(null!==e?e.push(uh):e=[uh])}a=a.return}null!==e&&Ia(t,e,n,r),t.flags|=262144}function Pa(e){for(e=e.firstContext;null!==e;){if(!Xn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function _a(e){Aa=e,xa=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Oa(e){return Ma(Aa,e)}function Ra(e,t){return null===Aa&&_a(e),Ma(e,t)}function Ma(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===xa){if(null===e)throw Error(s(308));xa=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else xa=xa.next=t;return n}var Da="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},La=r.unstable_scheduleCallback,Fa=r.unstable_NormalPriority,ja={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ua(){return{controller:new Da,data:new Map,refCount:0}}function Ba(e){e.refCount--,0===e.refCount&&La(Fa,function(){e.controller.abort()})}var Ha=null,za=0,qa=0,Wa=null;function Va(){if(0===--za&&null!==Ha){null!==Wa&&(Wa.status="fulfilled");var e=Ha;Ha=null,qa=0,Wa=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Ka=M.S;M.S=function(e,t){Rc=le(),"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Ha){var n=Ha=[];za=0,qa=zu(),Wa={status:"pending",value:void 0,then:function(e){n.push(e)}}}za++,t.then(Va,Va)}(0,t),null!==Ka&&Ka(e,t)};var Ga=U(null);function Ya(){var e=Ga.current;return null!==e?e:mc.pooledCache}function $a(e,t){H(Ga,null===t?Ga.current:t.pool)}function Qa(){var e=Ya();return null===e?null:{parent:ja._currentValue,pool:e}}var Ja=Error(s(460)),Xa=Error(s(474)),Za=Error(s(542)),ei={then:function(){}};function ti(e){return"fulfilled"===(e=e.status)||"rejected"===e}function ni(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Ot,Ot),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw si(e=t.reason),e;default:if("string"===typeof t.status)t.then(Ot,Ot);else{if(null!==(e=mc)&&100<e.shellSuspendCounter)throw Error(s(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw si(e=t.reason),e}throw ai=t,Ja}}function ri(e){try{return(0,e._init)(e._payload)}catch(t){if(null!==t&&"object"===typeof t&&"function"===typeof t.then)throw ai=t,Ja;throw t}}var ai=null;function ii(){if(null===ai)throw Error(s(459));var e=ai;return ai=null,e}function si(e){if(e===Ja||e===Za)throw Error(s(483))}var oi=null,li=0;function ci(e){var t=li;return li+=1,null===oi&&(oi=[]),ni(oi,e,t)}function ui(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function di(e,t){if(t.$$typeof===m)throw Error(s(525));throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function hi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function a(e,t){return(e=Br(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=67108866,n):r:(t.flags|=67108866,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Wr(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===v?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===C&&ri(i)===t.type)?(ui(t=a(t,n.props),n),t.return=e,t):(ui(t=zr(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Kr(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function d(e,t,n,r,i){return null===t||7!==t.tag?((t=qr(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Wr(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case g:return ui(n=zr(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case p:return(t=Kr(t,e.mode,n)).return=e,t;case C:return h(e,t=ri(t),n)}if(R(t)||P(t))return(t=qr(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return h(e,ci(t),n);if(t.$$typeof===S)return h(e,Ra(e,t),n);di(e,t)}return null}function f(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==a?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case g:return n.key===a?c(e,t,n,r):null;case p:return n.key===a?u(e,t,n,r):null;case C:return f(e,t,n=ri(n),r)}if(R(n)||P(n))return null!==a?null:d(e,t,n,r,null);if("function"===typeof n.then)return f(e,t,ci(n),r);if(n.$$typeof===S)return f(e,t,Ra(e,n),r);di(e,n)}return null}function m(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return l(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case g:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case p:return u(t,e=e.get(null===r.key?n:r.key)||null,r,a);case C:return m(e,t,n,r=ri(r),a)}if(R(r)||P(r))return d(t,e=e.get(n)||null,r,a,null);if("function"===typeof r.then)return m(e,t,n,ci(r),a);if(r.$$typeof===S)return m(e,t,n,Ra(t,r),a);di(t,r)}return null}function y(l,c,u,d){if("object"===typeof u&&null!==u&&u.type===v&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case g:e:{for(var b=u.key;null!==c;){if(c.key===b){if((b=u.type)===v){if(7===c.tag){n(l,c.sibling),(d=a(c,u.props.children)).return=l,l=d;break e}}else if(c.elementType===b||"object"===typeof b&&null!==b&&b.$$typeof===C&&ri(b)===c.type){n(l,c.sibling),ui(d=a(c,u.props),u),d.return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}u.type===v?((d=qr(u.props.children,l.mode,d,u.key)).return=l,l=d):(ui(d=zr(u.type,u.key,u.props,null,l.mode,d),u),d.return=l,l=d)}return o(l);case p:e:{for(b=u.key;null!==c;){if(c.key===b){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){n(l,c.sibling),(d=a(c,u.children||[])).return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}(d=Kr(u,l.mode,d)).return=l,l=d}return o(l);case C:return y(l,c,u=ri(u),d)}if(R(u))return function(a,s,o,l){for(var c=null,u=null,d=s,g=s=0,p=null;null!==d&&g<o.length;g++){d.index>g?(p=d,d=null):p=d.sibling;var v=f(a,d,o[g],l);if(null===v){null===d&&(d=p);break}e&&d&&null===v.alternate&&t(a,d),s=i(v,s,g),null===u?c=v:u.sibling=v,u=v,d=p}if(g===o.length)return n(a,d),da&&aa(a,g),c;if(null===d){for(;g<o.length;g++)null!==(d=h(a,o[g],l))&&(s=i(d,s,g),null===u?c=d:u.sibling=d,u=d);return da&&aa(a,g),c}for(d=r(d);g<o.length;g++)null!==(p=m(d,a,g,o[g],l))&&(e&&null!==p.alternate&&d.delete(null===p.key?g:p.key),s=i(p,s,g),null===u?c=p:u.sibling=p,u=p);return e&&d.forEach(function(e){return t(a,e)}),da&&aa(a,g),c}(l,c,u,d);if(P(u)){if("function"!==typeof(b=P(u)))throw Error(s(150));return function(a,o,l,c){if(null==l)throw Error(s(151));for(var u=null,d=null,g=o,p=o=0,v=null,y=l.next();null!==g&&!y.done;p++,y=l.next()){g.index>p?(v=g,g=null):v=g.sibling;var b=f(a,g,y.value,c);if(null===b){null===g&&(g=v);break}e&&g&&null===b.alternate&&t(a,g),o=i(b,o,p),null===d?u=b:d.sibling=b,d=b,g=v}if(y.done)return n(a,g),da&&aa(a,p),u;if(null===g){for(;!y.done;p++,y=l.next())null!==(y=h(a,y.value,c))&&(o=i(y,o,p),null===d?u=y:d.sibling=y,d=y);return da&&aa(a,p),u}for(g=r(g);!y.done;p++,y=l.next())null!==(y=m(g,a,p,y.value,c))&&(e&&null!==y.alternate&&g.delete(null===y.key?p:y.key),o=i(y,o,p),null===d?u=y:d.sibling=y,d=y);return e&&g.forEach(function(e){return t(a,e)}),da&&aa(a,p),u}(l,c,u=b.call(u),d)}if("function"===typeof u.then)return y(l,c,ci(u),d);if(u.$$typeof===S)return y(l,c,Ra(l,u),d);di(l,u)}return"string"===typeof u&&""!==u||"number"===typeof u||"bigint"===typeof u?(u=""+u,null!==c&&6===c.tag?(n(l,c.sibling),(d=a(c,u)).return=l,l=d):(n(l,c),(d=Wr(u,l.mode,d)).return=l,l=d),o(l)):n(l,c)}return function(e,t,n,r){try{li=0;var a=y(e,t,n,r);return oi=null,a}catch(s){if(s===Ja||s===Za)throw s;var i=jr(29,s,null,e.mode);return i.lanes=r,i.return=e,i}}}var fi=hi(!0),mi=hi(!1),gi=!1;function pi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function vi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function yi(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function bi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&fc)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,t=Dr(e),Mr(e,null,n),t}return _r(e,r,t,n),Dr(e)}function wi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Me(e,n)}}function Si(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var s={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===i?a=i=s:i=i.next=s,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Ti=!1;function Ai(){if(Ti){if(null!==Wa)throw Wa}}function xi(e,t,n,r){Ti=!1;var a=e.updateQueue;gi=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(null!==o){a.shared.pending=null;var l=o,c=l.next;l.next=null,null===s?i=c:s.next=c,s=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==i){var d=a.baseState;for(s=0,u=c=l=null,o=i;;){var h=-536870913&o.lane,m=h!==o.lane;if(m?(pc&h)===h:(r&h)===h){0!==h&&h===qa&&(Ti=!0),null!==u&&(u=u.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var g=e,p=o;h=t;var v=n;switch(p.tag){case 1:if("function"===typeof(g=p.payload)){d=g.call(v,d,h);break e}d=g;break e;case 3:g.flags=-65537&g.flags|128;case 0:if(null===(h="function"===typeof(g=p.payload)?g.call(v,d,h):g)||void 0===h)break e;d=f({},d,h);break e;case 2:gi=!0}}null!==(h=o.callback)&&(e.flags|=64,m&&(e.flags|=8192),null===(m=a.callbacks)?a.callbacks=[h]:m.push(h))}else m={lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=m,l=d):u=u.next=m,s|=h;if(null===(o=o.next)){if(null===(o=a.shared.pending))break;o=(m=o).next,m.next=null,a.lastBaseUpdate=m,a.shared.pending=null}}null===u&&(l=d),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,null===i&&(a.shared.lanes=0),xc|=s,e.lanes=s,e.memoizedState=d}}function ki(e,t){if("function"!==typeof e)throw Error(s(191,e));e.call(t)}function Ci(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)ki(n[e],t)}var Ei=U(null),Ii=U(0);function Ni(e,t){H(Ii,e=Tc),H(Ei,t),Tc=e|t.baseLanes}function Pi(){H(Ii,Tc),H(Ei,Ei.current)}function _i(){Tc=Ii.current,B(Ei),B(Ii)}var Oi=U(null),Ri=null;function Mi(e){var t=e.alternate;H(Ui,1&Ui.current),H(Oi,e),null===Ri&&(null===t||null!==Ei.current||null!==t.memoizedState)&&(Ri=e)}function Di(e){H(Ui,Ui.current),H(Oi,e),null===Ri&&(Ri=e)}function Li(e){22===e.tag?(H(Ui,Ui.current),H(Oi,e),null===Ri&&(Ri=e)):Fi()}function Fi(){H(Ui,Ui.current),H(Oi,Oi.current)}function ji(e){B(Oi),Ri===e&&(Ri=null),B(Ui)}var Ui=U(0);function Bi(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||_d(n)||Od(n)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(0!==(128&t.flags))return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Hi=0,zi=null,qi=null,Wi=null,Vi=!1,Ki=!1,Gi=!1,Yi=0,$i=0,Qi=null,Ji=0;function Xi(){throw Error(s(321))}function Zi(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Xn(e[n],t[n]))return!1;return!0}function es(e,t,n,r,a,i){return Hi=i,zi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,M.H=null===e||null===e.memoizedState?po:vo,Gi=!1,i=n(r,a),Gi=!1,Ki&&(i=ns(t,n,r,a)),ts(e),i}function ts(e){M.H=go;var t=null!==qi&&null!==qi.next;if(Hi=0,Wi=qi=zi=null,Vi=!1,$i=0,Qi=null,t)throw Error(s(300));null===e||Ro||null!==(e=e.dependencies)&&Pa(e)&&(Ro=!0)}function ns(e,t,n,r){zi=e;var a=0;do{if(Ki&&(Qi=null),$i=0,Ki=!1,25<=a)throw Error(s(301));if(a+=1,Wi=qi=null,null!=e.updateQueue){var i=e.updateQueue;i.lastEffect=null,i.events=null,i.stores=null,null!=i.memoCache&&(i.memoCache.index=0)}M.H=yo,i=t(n,r)}while(Ki);return i}function rs(){var e=M.H,t=e.useState()[0];return t="function"===typeof t.then?cs(t):t,e=e.useState()[0],(null!==qi?qi.memoizedState:null)!==e&&(zi.flags|=1024),t}function as(){var e=0!==Yi;return Yi=0,e}function is(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function ss(e){if(Vi){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Vi=!1}Hi=0,Wi=qi=zi=null,Ki=!1,$i=Yi=0,Qi=null}function os(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Wi?zi.memoizedState=Wi=e:Wi=Wi.next=e,Wi}function ls(){if(null===qi){var e=zi.alternate;e=null!==e?e.memoizedState:null}else e=qi.next;var t=null===Wi?zi.memoizedState:Wi.next;if(null!==t)Wi=t,qi=e;else{if(null===e){if(null===zi.alternate)throw Error(s(467));throw Error(s(310))}e={memoizedState:(qi=e).memoizedState,baseState:qi.baseState,baseQueue:qi.baseQueue,queue:qi.queue,next:null},null===Wi?zi.memoizedState=Wi=e:Wi=Wi.next=e}return Wi}function cs(e){var t=$i;return $i+=1,null===Qi&&(Qi=[]),e=ni(Qi,e,t),t=zi,null===(null===Wi?t.memoizedState:Wi.next)&&(t=t.alternate,M.H=null===t||null===t.memoizedState?po:vo),e}function us(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return cs(e);if(e.$$typeof===S)return Oa(e)}throw Error(s(438,String(e)))}function ds(e){var t=null,n=zi.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=zi.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},zi.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=I;return t.index++,n}function hs(e,t){return"function"===typeof t?t(e):t}function fs(e){return ms(ls(),qi,e)}function ms(e,t,n){var r=e.queue;if(null===r)throw Error(s(311));r.lastRenderedReducer=n;var a=e.baseQueue,i=r.pending;if(null!==i){if(null!==a){var o=a.next;a.next=i.next,i.next=o}t.baseQueue=a=i,r.pending=null}if(i=e.baseState,null===a)e.memoizedState=i;else{var l=o=null,c=null,u=t=a.next,d=!1;do{var h=-536870913&u.lane;if(h!==u.lane?(pc&h)===h:(Hi&h)===h){var f=u.revertLane;if(0===f)null!==c&&(c=c.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),h===qa&&(d=!0);else{if((Hi&f)===f){u=u.next,f===qa&&(d=!0);continue}h={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=h,o=i):c=c.next=h,zi.lanes|=f,xc|=f}h=u.action,Gi&&n(i,h),i=u.hasEagerState?u.eagerState:n(i,h)}else f={lane:h,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=f,o=i):c=c.next=f,zi.lanes|=h,xc|=h;u=u.next}while(null!==u&&u!==t);if(null===c?o=i:c.next=l,!Xn(i,e.memoizedState)&&(Ro=!0,d&&null!==(n=Wa)))throw n;e.memoizedState=i,e.baseState=o,e.baseQueue=c,r.lastRenderedState=i}return null===a&&(r.lanes=0),[e.memoizedState,r.dispatch]}function gs(e){var t=ls(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,i=t.memoizedState;if(null!==a){n.pending=null;var o=a=a.next;do{i=e(i,o.action),o=o.next}while(o!==a);Xn(i,t.memoizedState)||(Ro=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function ps(e,t,n){var r=zi,a=ls(),i=da;if(i){if(void 0===n)throw Error(s(407));n=n()}else n=t();var o=!Xn((qi||a).memoizedState,n);if(o&&(a.memoizedState=n,Ro=!0),a=a.queue,Hs(bs.bind(null,r,a,e),[e]),a.getSnapshot!==t||o||null!==Wi&&1&Wi.memoizedState.tag){if(r.flags|=2048,Ls(9,{destroy:void 0},ys.bind(null,r,a,n,t),null),null===mc)throw Error(s(349));i||0!==(127&Hi)||vs(r,t,n)}return n}function vs(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=zi.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},zi.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function ys(e,t,n,r){t.value=n,t.getSnapshot=r,ws(t)&&Ss(e)}function bs(e,t,n){return n(function(){ws(t)&&Ss(e)})}function ws(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Xn(e,n)}catch(r){return!0}}function Ss(e){var t=Rr(e,2);null!==t&&Yc(t,e,2)}function Ts(e){var t=os();if("function"===typeof e){var n=e;if(e=n(),Gi){be(!0);try{n()}finally{be(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hs,lastRenderedState:e},t}function As(e,t,n,r){return e.baseState=n,ms(e,qi,"function"===typeof r?r:hs)}function xs(e,t,n,r,a){if(ho(e))throw Error(s(485));if(null!==(e=t.action)){var i={payload:a,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){i.listeners.push(e)}};null!==M.T?n(!0):i.isTransition=!1,r(i),null===(n=t.pending)?(i.next=t.pending=i,ks(t,i)):(i.next=n.next,t.pending=n.next=i)}}function ks(e,t){var n=t.action,r=t.payload,a=e.state;if(t.isTransition){var i=M.T,s={};M.T=s;try{var o=n(a,r),l=M.S;null!==l&&l(s,o),Cs(e,t,o)}catch(c){Is(e,t,c)}finally{null!==i&&null!==s.types&&(i.types=s.types),M.T=i}}else try{Cs(e,t,i=n(a,r))}catch(u){Is(e,t,u)}}function Cs(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then(function(n){Es(e,t,n)},function(n){return Is(e,t,n)}):Es(e,t,n)}function Es(e,t,n){t.status="fulfilled",t.value=n,Ns(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,ks(e,n)))}function Is(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,Ns(t),t=t.next}while(t!==r)}e.action=null}function Ns(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Ps(e,t){return t}function _s(e,t){if(da){var n=mc.formState;if(null!==n){e:{var r=zi;if(da){if(ua){t:{for(var a=ua,i=fa;8!==a.nodeType;){if(!i){a=null;break t}if(null===(a=Rd(a.nextSibling))){a=null;break t}}a="F!"===(i=a.data)||"F"===i?a:null}if(a){ua=Rd(a.nextSibling),r="F!"===a.data;break e}}ga(r)}r=!1}r&&(t=n[0])}}return(n=os()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ps,lastRenderedState:t},n.queue=r,n=lo.bind(null,zi,r),r.dispatch=n,r=Ts(!1),i=uo.bind(null,zi,!1,r.queue),a={state:t,dispatch:null,action:e,pending:null},(r=os()).queue=a,n=xs.bind(null,zi,a,i,n),a.dispatch=n,r.memoizedState=e,[t,n,!1]}function Os(e){return Rs(ls(),qi,e)}function Rs(e,t,n){if(t=ms(e,t,Ps)[0],e=fs(hs)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var r=cs(t)}catch(s){if(s===Ja)throw Za;throw s}else r=t;var a=(t=ls()).queue,i=a.dispatch;return n!==t.memoizedState&&(zi.flags|=2048,Ls(9,{destroy:void 0},Ms.bind(null,a,n),null)),[r,i,e]}function Ms(e,t){e.action=t}function Ds(e){var t=ls(),n=qi;if(null!==n)return Rs(t,n,e);ls(),t=t.memoizedState;var r=(n=ls()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function Ls(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},null===(t=zi.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},zi.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Fs(){return ls().memoizedState}function js(e,t,n,r){var a=os();zi.flags|=e,a.memoizedState=Ls(1|t,{destroy:void 0},n,void 0===r?null:r)}function Us(e,t,n,r){var a=ls();r=void 0===r?null:r;var i=a.memoizedState.inst;null!==qi&&null!==r&&Zi(r,qi.memoizedState.deps)?a.memoizedState=Ls(t,i,n,r):(zi.flags|=e,a.memoizedState=Ls(1|t,i,n,r))}function Bs(e,t){js(8390656,8,e,t)}function Hs(e,t){Us(2048,8,e,t)}function zs(e){var t=ls().memoizedState;return function(e){zi.flags|=4;var t=zi.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},zi.updateQueue=t,t.events=[e];else{var n=t.events;null===n?t.events=[e]:n.push(e)}}({ref:t,nextImpl:e}),function(){if(0!==(2&fc))throw Error(s(440));return t.impl.apply(void 0,arguments)}}function qs(e,t){return Us(4,2,e,t)}function Ws(e,t){return Us(4,4,e,t)}function Vs(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function Ks(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,Us(4,4,Vs.bind(null,t,e),n)}function Gs(){}function Ys(e,t){var n=ls();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&Zi(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function $s(e,t){var n=ls();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&Zi(t,r[1]))return r[0];if(r=e(),Gi){be(!0);try{e()}finally{be(!1)}}return n.memoizedState=[r,t],r}function Qs(e,t,n){return void 0===n||0!==(1073741824&Hi)&&0===(261930&pc)?e.memoizedState=t:(e.memoizedState=n,e=Gc(),zi.lanes|=e,xc|=e,n)}function Js(e,t,n,r){return Xn(n,t)?n:null!==Ei.current?(e=Qs(e,n,r),Xn(e,t)||(Ro=!0),e):0===(42&Hi)||0!==(1073741824&Hi)&&0===(261930&pc)?(Ro=!0,e.memoizedState=n):(e=Gc(),zi.lanes|=e,xc|=e,t)}function Xs(e,t,n,r,a){var i=D.p;D.p=0!==i&&8>i?i:8;var s=M.T,o={};M.T=o,uo(e,!1,t,n);try{var l=a(),c=M.S;if(null!==c&&c(o,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)co(e,t,function(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){r.status="fulfilled",r.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(r.status="rejected",r.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),r}(l,r),Kc());else co(e,t,r,Kc())}catch(u){co(e,t,{then:function(){},status:"rejected",reason:u},Kc())}finally{D.p=i,null!==s&&null!==o.types&&(s.types=o.types),M.T=s}}function Zs(){}function eo(e,t,n,r){if(5!==e.tag)throw Error(s(476));var a=to(e).queue;Xs(e,a,t,L,null===n?Zs:function(){return no(e),n(r)})}function to(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:L,baseState:L,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hs,lastRenderedState:L},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hs,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function no(e){var t=to(e);null===t.next&&(t=e.alternate.memoizedState),co(e,t.next.queue,{},Kc())}function ro(){return Oa(uh)}function ao(){return ls().memoizedState}function io(){return ls().memoizedState}function so(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Kc(),r=bi(t,e=yi(n),n);return null!==r&&(Yc(r,t,n),wi(r,t,n)),t={cache:Ua()},void(e.payload=t)}t=t.return}}function oo(e,t,n){var r=Kc();n={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},ho(e)?fo(t,n):null!==(n=Or(e,t,n,r))&&(Yc(n,e,r),mo(n,t,r))}function lo(e,t,n){co(e,t,n,Kc())}function co(e,t,n,r){var a={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(ho(e))fo(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=i(s,n);if(a.hasEagerState=!0,a.eagerState=o,Xn(o,s))return _r(e,t,a,0),null===mc&&Pr(),!1}catch(l){}if(null!==(n=Or(e,t,a,r)))return Yc(n,e,r),mo(n,t,r),!0}return!1}function uo(e,t,n,r){if(r={lane:2,revertLane:zu(),gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},ho(e)){if(t)throw Error(s(479))}else null!==(t=Or(e,n,r,2))&&Yc(t,e,2)}function ho(e){var t=e.alternate;return e===zi||null!==t&&t===zi}function fo(e,t){Ki=Vi=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function mo(e,t,n){if(0!==(4194048&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Me(e,n)}}var go={readContext:Oa,use:us,useCallback:Xi,useContext:Xi,useEffect:Xi,useImperativeHandle:Xi,useLayoutEffect:Xi,useInsertionEffect:Xi,useMemo:Xi,useReducer:Xi,useRef:Xi,useState:Xi,useDebugValue:Xi,useDeferredValue:Xi,useTransition:Xi,useSyncExternalStore:Xi,useId:Xi,useHostTransitionStatus:Xi,useFormState:Xi,useActionState:Xi,useOptimistic:Xi,useMemoCache:Xi,useCacheRefresh:Xi};go.useEffectEvent=Xi;var po={readContext:Oa,use:us,useCallback:function(e,t){return os().memoizedState=[e,void 0===t?null:t],e},useContext:Oa,useEffect:Bs,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,js(4194308,4,Vs.bind(null,t,e),n)},useLayoutEffect:function(e,t){return js(4194308,4,e,t)},useInsertionEffect:function(e,t){js(4,2,e,t)},useMemo:function(e,t){var n=os();t=void 0===t?null:t;var r=e();if(Gi){be(!0);try{e()}finally{be(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=os();if(void 0!==n){var a=n(t);if(Gi){be(!0);try{n(t)}finally{be(!1)}}}else a=t;return r.memoizedState=r.baseState=a,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:a},r.queue=e,e=e.dispatch=oo.bind(null,zi,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},os().memoizedState=e},useState:function(e){var t=(e=Ts(e)).queue,n=lo.bind(null,zi,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Gs,useDeferredValue:function(e,t){return Qs(os(),e,t)},useTransition:function(){var e=Ts(!1);return e=Xs.bind(null,zi,e.queue,!0,!1),os().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=zi,a=os();if(da){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===mc)throw Error(s(349));0!==(127&pc)||vs(r,t,n)}a.memoizedState=n;var i={value:n,getSnapshot:t};return a.queue=i,Bs(bs.bind(null,r,i,e),[e]),r.flags|=2048,Ls(9,{destroy:void 0},ys.bind(null,r,i,n,t),null),n},useId:function(){var e=os(),t=mc.identifierPrefix;if(da){var n=ra;t="_"+t+"R_"+(n=(na&~(1<<32-we(na)-1)).toString(32)+n),0<(n=Yi++)&&(t+="H"+n.toString(32)),t+="_"}else t="_"+t+"r_"+(n=Ji++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:ro,useFormState:_s,useActionState:_s,useOptimistic:function(e){var t=os();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=uo.bind(null,zi,!0,n),n.dispatch=t,[e,t]},useMemoCache:ds,useCacheRefresh:function(){return os().memoizedState=so.bind(null,zi)},useEffectEvent:function(e){var t=os(),n={impl:e};return t.memoizedState=n,function(){if(0!==(2&fc))throw Error(s(440));return n.impl.apply(void 0,arguments)}}},vo={readContext:Oa,use:us,useCallback:Ys,useContext:Oa,useEffect:Hs,useImperativeHandle:Ks,useInsertionEffect:qs,useLayoutEffect:Ws,useMemo:$s,useReducer:fs,useRef:Fs,useState:function(){return fs(hs)},useDebugValue:Gs,useDeferredValue:function(e,t){return Js(ls(),qi.memoizedState,e,t)},useTransition:function(){var e=fs(hs)[0],t=ls().memoizedState;return["boolean"===typeof e?e:cs(e),t]},useSyncExternalStore:ps,useId:ao,useHostTransitionStatus:ro,useFormState:Os,useActionState:Os,useOptimistic:function(e,t){return As(ls(),0,e,t)},useMemoCache:ds,useCacheRefresh:io};vo.useEffectEvent=zs;var yo={readContext:Oa,use:us,useCallback:Ys,useContext:Oa,useEffect:Hs,useImperativeHandle:Ks,useInsertionEffect:qs,useLayoutEffect:Ws,useMemo:$s,useReducer:gs,useRef:Fs,useState:function(){return gs(hs)},useDebugValue:Gs,useDeferredValue:function(e,t){var n=ls();return null===qi?Qs(n,e,t):Js(n,qi.memoizedState,e,t)},useTransition:function(){var e=gs(hs)[0],t=ls().memoizedState;return["boolean"===typeof e?e:cs(e),t]},useSyncExternalStore:ps,useId:ao,useHostTransitionStatus:ro,useFormState:Ds,useActionState:Ds,useOptimistic:function(e,t){var n=ls();return null!==qi?As(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:ds,useCacheRefresh:io};function bo(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:f({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}yo.useEffectEvent=zs;var wo={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Kc(),a=yi(r);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=bi(e,a,r))&&(Yc(t,e,r),wi(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Kc(),a=yi(r);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=bi(e,a,r))&&(Yc(t,e,r),wi(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Kc(),r=yi(n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=bi(e,r,n))&&(Yc(t,e,n),wi(t,e,n))}};function So(e,t,n,r,a,i,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,s):!t.prototype||!t.prototype.isPureReactComponent||(!Zn(n,r)||!Zn(a,i))}function To(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&wo.enqueueReplaceState(t,t.state,null)}function Ao(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var a in n===t&&(n=f({},n)),e)void 0===n[a]&&(n[a]=e[a]);return n}function xo(e){Cr(e)}function ko(e){console.error(e)}function Co(e){Cr(e)}function Eo(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Io(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function No(e,t,n){return(n=yi(n)).tag=3,n.payload={element:null},n.callback=function(){Eo(e,t)},n}function Po(e){return(e=yi(e)).tag=3,e}function _o(e,t,n,r){var a=n.type.getDerivedStateFromError;if("function"===typeof a){var i=r.value;e.payload=function(){return a(i)},e.callback=function(){Io(t,n,r)}}var s=n.stateNode;null!==s&&"function"===typeof s.componentDidCatch&&(e.callback=function(){Io(t,n,r),"function"!==typeof a&&(null===Lc?Lc=new Set([this]):Lc.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var Oo=Error(s(461)),Ro=!1;function Mo(e,t,n,r){t.child=null===e?mi(t,null,n,r):fi(t,e.child,n,r)}function Do(e,t,n,r,a){n=n.render;var i=t.ref;if("ref"in r){var s={};for(var o in r)"ref"!==o&&(s[o]=r[o])}else s=r;return _a(t),r=es(e,t,n,s,i,a),o=as(),null===e||Ro?(da&&o&&sa(t),t.flags|=1,Mo(e,t,r,a),t.child):(is(e,t,a),al(e,t,a))}function Lo(e,t,n,r,a){if(null===e){var i=n.type;return"function"!==typeof i||Ur(i)||void 0!==i.defaultProps||null!==n.compare?((e=zr(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Fo(e,t,i,r,a))}if(i=e.child,!il(e,a)){var s=i.memoizedProps;if((n=null!==(n=n.compare)?n:Zn)(s,r)&&e.ref===t.ref)return al(e,t,a)}return t.flags|=1,(e=Br(i,r)).ref=t.ref,e.return=t,t.child=e}function Fo(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(Zn(i,r)&&e.ref===t.ref){if(Ro=!1,t.pendingProps=r=i,!il(e,a))return t.lanes=e.lanes,al(e,t,a);0!==(131072&e.flags)&&(Ro=!0)}}return Wo(e,t,n,r,a)}function jo(e,t,n,r){var a=r.children,i=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===r.mode){if(0!==(128&t.flags)){if(i=null!==i?i.baseLanes|n:n,null!==e){for(r=t.child=e.child,a=0;null!==r;)a=a|r.lanes|r.childLanes,r=r.sibling;r=a&~i}else r=0,t.child=null;return Bo(e,t,i,n,r)}if(0===(536870912&n))return r=t.lanes=536870912,Bo(e,t,null!==i?i.baseLanes|n:n,n,r);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&$a(0,null!==i?i.cachePool:null),null!==i?Ni(t,i):Pi(),Li(t)}else null!==i?($a(0,i.cachePool),Ni(t,i),Fi(),t.memoizedState=null):(null!==e&&$a(0,null),Pi(),Fi());return Mo(e,t,a,n),t.child}function Uo(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Bo(e,t,n,r,a){var i=Ya();return i=null===i?null:{parent:ja._currentValue,pool:i},t.memoizedState={baseLanes:n,cachePool:i},null!==e&&$a(0,null),Pi(),Li(t),null!==e&&Na(e,t,r,!0),t.childLanes=a,null}function Ho(e,t){return(t=Zo({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function zo(e,t,n){return fi(t,e.child,null,n),(e=Ho(t,t.pendingProps)).flags|=2,ji(t),t.memoizedState=null,e}function qo(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(s(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Wo(e,t,n,r,a){return _a(t),n=es(e,t,n,r,void 0,a),r=as(),null===e||Ro?(da&&r&&sa(t),t.flags|=1,Mo(e,t,n,a),t.child):(is(e,t,a),al(e,t,a))}function Vo(e,t,n,r,a,i){return _a(t),t.updateQueue=null,n=ns(t,r,n,a),ts(e),r=as(),null===e||Ro?(da&&r&&sa(t),t.flags|=1,Mo(e,t,n,i),t.child):(is(e,t,i),al(e,t,i))}function Ko(e,t,n,r,a){if(_a(t),null===t.stateNode){var i=Lr,s=n.contextType;"object"===typeof s&&null!==s&&(i=Oa(s)),i=new n(r,i),t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,i.updater=wo,t.stateNode=i,i._reactInternals=t,(i=t.stateNode).props=r,i.state=t.memoizedState,i.refs={},pi(t),s=n.contextType,i.context="object"===typeof s&&null!==s?Oa(s):Lr,i.state=t.memoizedState,"function"===typeof(s=n.getDerivedStateFromProps)&&(bo(t,n,s,r),i.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(s=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),s!==i.state&&wo.enqueueReplaceState(i,i.state,null),xi(t,r,i,a),Ai(),i.state=t.memoizedState),"function"===typeof i.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){i=t.stateNode;var o=t.memoizedProps,l=Ao(n,o);i.props=l;var c=i.context,u=n.contextType;s=Lr,"object"===typeof u&&null!==u&&(s=Oa(u));var d=n.getDerivedStateFromProps;u="function"===typeof d||"function"===typeof i.getSnapshotBeforeUpdate,o=t.pendingProps!==o,u||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o||c!==s)&&To(t,i,r,s),gi=!1;var h=t.memoizedState;i.state=h,xi(t,r,i,a),Ai(),c=t.memoizedState,o||h!==c||gi?("function"===typeof d&&(bo(t,n,d,r),c=t.memoizedState),(l=gi||So(t,n,l,r,h,c,s))?(u||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),i.props=r,i.state=c,i.context=s,r=l):("function"===typeof i.componentDidMount&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,vi(e,t),u=Ao(n,s=t.memoizedProps),i.props=u,d=t.pendingProps,h=i.context,c=n.contextType,l=Lr,"object"===typeof c&&null!==c&&(l=Oa(c)),(c="function"===typeof(o=n.getDerivedStateFromProps)||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(s!==d||h!==l)&&To(t,i,r,l),gi=!1,h=t.memoizedState,i.state=h,xi(t,r,i,a),Ai();var f=t.memoizedState;s!==d||h!==f||gi||null!==e&&null!==e.dependencies&&Pa(e.dependencies)?("function"===typeof o&&(bo(t,n,o,r),f=t.memoizedState),(u=gi||So(t,n,u,r,h,f,l)||null!==e&&null!==e.dependencies&&Pa(e.dependencies))?(c||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(r,f,l),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),i.props=r,i.state=f,i.context=l,r=u):("function"!==typeof i.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return i=r,qo(e,t),r=0!==(128&t.flags),i||r?(i=t.stateNode,n=r&&"function"!==typeof n.getDerivedStateFromError?null:i.render(),t.flags|=1,null!==e&&r?(t.child=fi(t,e.child,null,a),t.child=fi(t,null,n,a)):Mo(e,t,n,a),t.memoizedState=i.state,e=t.child):e=al(e,t,a),e}function Go(e,t,n,r){return ba(),t.flags|=256,Mo(e,t,n,r),t.child}var Yo={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function $o(e){return{baseLanes:e,cachePool:Qa()}}function Qo(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=Ec),e}function Jo(e,t,n){var r,a=t.pendingProps,i=!1,o=0!==(128&t.flags);if((r=o)||(r=(null===e||null!==e.memoizedState)&&0!==(2&Ui.current)),r&&(i=!0,t.flags&=-129),r=0!==(32&t.flags),t.flags&=-33,null===e){if(da){if(i?Mi(t):Fi(),(e=ua)?null!==(e=null!==(e=Pd(e,fa))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ta?{id:na,overflow:ra}:null,retryLane:536870912,hydrationErrors:null},(n=Vr(e)).return=t,t.child=n,ca=t,ua=null):e=null,null===e)throw ga(t);return Od(e)?t.lanes=32:t.lanes=536870912,null}var l=a.children;return a=a.fallback,i?(Fi(),l=Zo({mode:"hidden",children:l},i=t.mode),a=qr(a,i,n,null),l.return=t,a.return=t,l.sibling=a,t.child=l,(a=t.child).memoizedState=$o(n),a.childLanes=Qo(e,r,n),t.memoizedState=Yo,Uo(null,a)):(Mi(t),Xo(t,l))}var c=e.memoizedState;if(null!==c&&null!==(l=c.dehydrated)){if(o)256&t.flags?(Mi(t),t.flags&=-257,t=el(e,t,n)):null!==t.memoizedState?(Fi(),t.child=e.child,t.flags|=128,t=null):(Fi(),l=a.fallback,i=t.mode,a=Zo({mode:"visible",children:a.children},i),(l=qr(l,i,n,null)).flags|=2,a.return=t,l.return=t,a.sibling=l,t.child=a,fi(t,e.child,null,n),(a=t.child).memoizedState=$o(n),a.childLanes=Qo(e,r,n),t.memoizedState=Yo,t=Uo(null,a));else if(Mi(t),Od(l)){if(r=l.nextSibling&&l.nextSibling.dataset)var u=r.dgst;r=u,(a=Error(s(419))).stack="",a.digest=r,Sa({value:a,source:null,stack:null}),t=el(e,t,n)}else if(Ro||Na(e,t,n,!1),r=0!==(n&e.childLanes),Ro||r){if(null!==(r=mc)&&(0!==(a=De(r,n))&&a!==c.retryLane))throw c.retryLane=a,Rr(e,a),Yc(r,e,a),Oo;_d(l)||su(),t=el(e,t,n)}else _d(l)?(t.flags|=192,t.child=e.child,t=null):(e=c.treeContext,ua=Rd(l.nextSibling),ca=t,da=!0,ha=null,fa=!1,null!==e&&la(t,e),(t=Xo(t,a.children)).flags|=4096);return t}return i?(Fi(),l=a.fallback,i=t.mode,u=(c=e.child).sibling,(a=Br(c,{mode:"hidden",children:a.children})).subtreeFlags=65011712&c.subtreeFlags,null!==u?l=Br(u,l):(l=qr(l,i,n,null)).flags|=2,l.return=t,a.return=t,a.sibling=l,t.child=a,Uo(null,a),a=t.child,null===(l=e.child.memoizedState)?l=$o(n):(null!==(i=l.cachePool)?(c=ja._currentValue,i=i.parent!==c?{parent:c,pool:c}:i):i=Qa(),l={baseLanes:l.baseLanes|n,cachePool:i}),a.memoizedState=l,a.childLanes=Qo(e,r,n),t.memoizedState=Yo,Uo(e.child,a)):(Mi(t),e=(n=e.child).sibling,(n=Br(n,{mode:"visible",children:a.children})).return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n)}function Xo(e,t){return(t=Zo({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Zo(e,t){return(e=jr(22,e,null,t)).lanes=0,e}function el(e,t,n){return fi(t,e.child,null,n),(e=Xo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function tl(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ea(e.return,t,n)}function nl(e,t,n,r,a,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a,treeForkCount:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=a,s.treeForkCount=i)}function rl(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;r=r.children;var s=Ui.current,o=0!==(2&s);if(o?(s=1&s|2,t.flags|=128):s&=1,H(Ui,s),Mo(e,t,r,n),r=da?Xr:0,!o&&null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&tl(e,n,t);else if(19===e.tag)tl(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===Bi(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),nl(t,!1,a,n,i,r);break;case"backwards":case"unstable_legacy-backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===Bi(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}nl(t,!0,n,null,i,r);break;case"together":nl(t,!1,null,null,void 0,r);break;default:t.memoizedState=null}return t.child}function al(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),xc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(Na(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Br(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Br(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function il(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Pa(e))}function sl(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Ro=!0;else{if(!il(e,n)&&0===(128&t.flags))return Ro=!1,function(e,t,n){switch(t.tag){case 3:Y(t,t.stateNode.containerInfo),ka(0,ja,e.memoizedState.cache),ba();break;case 27:case 5:Q(t);break;case 4:Y(t,t.stateNode.containerInfo);break;case 10:ka(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,Di(t),null;break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(Mi(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Jo(e,t,n):(Mi(t),null!==(e=al(e,t,n))?e.sibling:null);Mi(t);break;case 19:var a=0!==(128&e.flags);if((r=0!==(n&t.childLanes))||(Na(e,t,n,!1),r=0!==(n&t.childLanes)),a){if(r)return rl(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),H(Ui,Ui.current),r)break;return null;case 22:return t.lanes=0,jo(e,t,n,t.pendingProps);case 24:ka(0,ja,e.memoizedState.cache)}return al(e,t,n)}(e,t,n);Ro=0!==(131072&e.flags)}else Ro=!1,da&&0!==(1048576&t.flags)&&ia(t,Xr,t.index);switch(t.lanes=0,t.tag){case 16:e:{var r=t.pendingProps;if(e=ri(t.elementType),t.type=e,"function"!==typeof e){if(void 0!==e&&null!==e){var a=e.$$typeof;if(a===T){t.tag=11,t=Do(null,t,e,r,n);break e}if(a===k){t.tag=14,t=Lo(null,t,e,r,n);break e}}throw t=O(e)||e,Error(s(306,t,""))}Ur(e)?(r=Ao(e,r),t.tag=1,t=Ko(null,t,e,r,n)):(t.tag=0,t=Wo(null,t,e,r,n))}return t;case 0:return Wo(e,t,t.type,t.pendingProps,n);case 1:return Ko(e,t,r=t.type,a=Ao(r,t.pendingProps),n);case 3:e:{if(Y(t,t.stateNode.containerInfo),null===e)throw Error(s(387));r=t.pendingProps;var i=t.memoizedState;a=i.element,vi(e,t),xi(t,r,null,n);var o=t.memoizedState;if(r=o.cache,ka(0,ja,r),r!==i.cache&&Ia(t,[ja],n,!0),Ai(),r=o.element,i.isDehydrated){if(i={element:r,isDehydrated:!1,cache:o.cache},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Go(e,t,r,n);break e}if(r!==a){Sa(a=Yr(Error(s(424)),t)),t=Go(e,t,r,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(ua=Rd(e.firstChild),ca=t,da=!0,ha=null,fa=!0,n=mi(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ba(),r===a){t=al(e,t,n);break e}Mo(e,t,r,n)}t=t.child}return t;case 26:return qo(e,t),null===e?(n=Vd(t.type,null,t.pendingProps,null))?t.memoizedState=n:da||(n=t.type,e=t.pendingProps,(r=pd(K.current).createElement(n))[He]=t,r[ze]=e,hd(r,n,e),et(r),t.stateNode=r):t.memoizedState=Vd(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Q(t),null===e&&da&&(r=t.stateNode=Fd(t.type,t.pendingProps,K.current),ca=t,fa=!0,a=ua,Cd(t.type)?(Md=a,ua=Rd(r.firstChild)):ua=a),Mo(e,t,t.pendingProps.children,n),qo(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&da&&((a=r=ua)&&(null!==(r=function(e,t,n,r){for(;1===e.nodeType;){var a=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[Ye])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(i=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(i!==a.rel||e.getAttribute("href")!==(null==a.href||""===a.href?null:a.href)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin)||e.getAttribute("title")!==(null==a.title?null:a.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((i=e.getAttribute("src"))!==(null==a.src?null:a.src)||e.getAttribute("type")!==(null==a.type?null:a.type)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin))&&i&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var i=null==a.name?null:""+a.name;if("hidden"===a.type&&e.getAttribute("name")===i)return e}if(null===(e=Rd(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,fa))?(t.stateNode=r,ca=t,ua=Rd(r.firstChild),fa=!1,a=!0):a=!1),a||ga(t)),Q(t),a=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,r=i.children,bd(a,i)?r=null:null!==o&&bd(a,o)&&(t.flags|=32),null!==t.memoizedState&&(a=es(e,t,rs,null,null,n),uh._currentValue=a),qo(e,t),Mo(e,t,r,n),t.child;case 6:return null===e&&da&&((e=n=ua)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=Rd(e.nextSibling)))return null}return e}(n,t.pendingProps,fa))?(t.stateNode=n,ca=t,ua=null,e=!0):e=!1),e||ga(t)),null;case 13:return Jo(e,t,n);case 4:return Y(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=fi(t,null,r,n):Mo(e,t,r,n),t.child;case 11:return Do(e,t,t.type,t.pendingProps,n);case 7:return Mo(e,t,t.pendingProps,n),t.child;case 8:case 12:return Mo(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,ka(0,t.type,r.value),Mo(e,t,r.children,n),t.child;case 9:return a=t.type._context,r=t.pendingProps.children,_a(t),r=r(a=Oa(a)),t.flags|=1,Mo(e,t,r,n),t.child;case 14:return Lo(e,t,t.type,t.pendingProps,n);case 15:return Fo(e,t,t.type,t.pendingProps,n);case 19:return rl(e,t,n);case 31:return function(e,t,n){var r=t.pendingProps,a=0!==(128&t.flags);if(t.flags&=-129,null===e){if(da){if("hidden"===r.mode)return e=Ho(t,r),t.lanes=536870912,Uo(null,e);if(Di(t),(e=ua)?null!==(e=null!==(e=Pd(e,fa))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ta?{id:na,overflow:ra}:null,retryLane:536870912,hydrationErrors:null},(n=Vr(e)).return=t,t.child=n,ca=t,ua=null):e=null,null===e)throw ga(t);return t.lanes=536870912,null}return Ho(t,r)}var i=e.memoizedState;if(null!==i){var o=i.dehydrated;if(Di(t),a)if(256&t.flags)t.flags&=-257,t=zo(e,t,n);else{if(null===t.memoizedState)throw Error(s(558));t.child=e.child,t.flags|=128,t=null}else if(Ro||Na(e,t,n,!1),a=0!==(n&e.childLanes),Ro||a){if(null!==(r=mc)&&0!==(o=De(r,n))&&o!==i.retryLane)throw i.retryLane=o,Rr(e,o),Yc(r,e,o),Oo;su(),t=zo(e,t,n)}else e=i.treeContext,ua=Rd(o.nextSibling),ca=t,da=!0,ha=null,fa=!1,null!==e&&la(t,e),(t=Ho(t,r)).flags|=4096;return t}return(e=Br(e.child,{mode:r.mode,children:r.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,n);case 22:return jo(e,t,n,t.pendingProps);case 24:return _a(t),r=Oa(ja),null===e?(null===(a=Ya())&&(a=mc,i=Ua(),a.pooledCache=i,i.refCount++,null!==i&&(a.pooledCacheLanes|=n),a=i),t.memoizedState={parent:r,cache:a},pi(t),ka(0,ja,a)):(0!==(e.lanes&n)&&(vi(e,t),xi(t,null,null,n),Ai()),a=e.memoizedState,i=t.memoizedState,a.parent!==r?(a={parent:r,cache:r},t.memoizedState=a,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=a),ka(0,ja,r)):(r=i.cache,ka(0,ja,r),r!==a.cache&&Ia(t,[ja],n,!0))),Mo(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(s(156,t.tag))}function ol(e){e.flags|=4}function ll(e,t,n,r,a){if((t=0!==(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&a)===a)if(e.stateNode.complete)e.flags|=8192;else{if(!ru())throw ai=ei,Xa;e.flags|=8192}}else e.flags&=-16777217}function cl(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!ah(t)){if(!ru())throw ai=ei,Xa;e.flags|=8192}}function ul(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Pe():536870912,e.lanes|=t,Ic|=t)}function dl(e,t){if(!da)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function hl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=65011712&a.subtreeFlags,r|=65011712&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function fl(e,t,n){var r=t.pendingProps;switch(oa(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return hl(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Ca(ja),$(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(ya(t)?ol(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,wa())),hl(t),null;case 26:var a=t.type,i=t.memoizedState;return null===e?(ol(t),null!==i?(hl(t),cl(t,i)):(hl(t),ll(t,a,0,0,n))):i?i!==e.memoizedState?(ol(t),hl(t),cl(t,i)):(hl(t),t.flags&=-16777217):((e=e.memoizedProps)!==r&&ol(t),hl(t),ll(t,a,0,0,n)),null;case 27:if(J(t),n=K.current,a=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&ol(t);else{if(!r){if(null===t.stateNode)throw Error(s(166));return hl(t),null}e=W.current,ya(t)?pa(t):(e=Fd(a,r,n),t.stateNode=e,ol(t))}return hl(t),null;case 5:if(J(t),a=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&ol(t);else{if(!r){if(null===t.stateNode)throw Error(s(166));return hl(t),null}if(i=W.current,ya(t))pa(t);else{var o=pd(K.current);switch(i){case 1:i=o.createElementNS("http://www.w3.org/2000/svg",a);break;case 2:i=o.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;default:switch(a){case"svg":i=o.createElementNS("http://www.w3.org/2000/svg",a);break;case"math":i=o.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;case"script":(i=o.createElement("div")).innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i="string"===typeof r.is?o.createElement("select",{is:r.is}):o.createElement("select"),r.multiple?i.multiple=!0:r.size&&(i.size=r.size);break;default:i="string"===typeof r.is?o.createElement(a,{is:r.is}):o.createElement(a)}}i[He]=t,i[ze]=r;e:for(o=t.child;null!==o;){if(5===o.tag||6===o.tag)i.appendChild(o.stateNode);else if(4!==o.tag&&27!==o.tag&&null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break e;for(;null===o.sibling;){if(null===o.return||o.return===t)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}t.stateNode=i;e:switch(hd(i,a,r),a){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&ol(t)}}return hl(t),ll(t,t.type,null===e||e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&ol(t);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(e=K.current,ya(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(a=ca))switch(a.tag){case 27:case 5:r=a.memoizedProps}e[He]=t,(e=!!(e.nodeValue===n||null!==r&&!0===r.suppressHydrationWarning||cd(e.nodeValue,n)))||ga(t,!0)}else(e=pd(e).createTextNode(r))[He]=t,t.stateNode=e}return hl(t),null;case 31:if(n=t.memoizedState,null===e||null!==e.memoizedState){if(r=ya(t),null!==n){if(null===e){if(!r)throw Error(s(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(s(557));e[He]=t}else ba(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;hl(t),e=!1}else n=wa(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return 256&t.flags?(ji(t),t):(ji(t),null);if(0!==(128&t.flags))throw Error(s(558))}return hl(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(a=ya(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(s(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(s(317));a[He]=t}else ba(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;hl(t),a=!1}else a=wa(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=a),a=!0;if(!a)return 256&t.flags?(ji(t),t):(ji(t),null)}return ji(t),0!==(128&t.flags)?(t.lanes=n,t):(n=null!==r,e=null!==e&&null!==e.memoizedState,n&&(a=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(a=r.alternate.memoizedState.cachePool.pool),i=null,null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(i=r.memoizedState.cachePool.pool),i!==a&&(r.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),ul(t,t.updateQueue),hl(t),null);case 4:return $(),null===e&&Zu(t.stateNode.containerInfo),hl(t),null;case 10:return Ca(t.type),hl(t),null;case 19:if(B(Ui),null===(r=t.memoizedState))return hl(t),null;if(a=0!==(128&t.flags),null===(i=r.rendering))if(a)dl(r,!1);else{if(0!==Ac||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(i=Bi(e))){for(t.flags|=128,dl(r,!1),e=i.updateQueue,t.updateQueue=e,ul(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Hr(n,e),n=n.sibling;return H(Ui,1&Ui.current|2),da&&aa(t,r.treeForkCount),t.child}e=e.sibling}null!==r.tail&&le()>Mc&&(t.flags|=128,a=!0,dl(r,!1),t.lanes=4194304)}else{if(!a)if(null!==(e=Bi(i))){if(t.flags|=128,a=!0,e=e.updateQueue,t.updateQueue=e,ul(t,e),dl(r,!0),null===r.tail&&"hidden"===r.tailMode&&!i.alternate&&!da)return hl(t),null}else 2*le()-r.renderingStartTime>Mc&&536870912!==n&&(t.flags|=128,a=!0,dl(r,!1),t.lanes=4194304);r.isBackwards?(i.sibling=t.child,t.child=i):(null!==(e=r.last)?e.sibling=i:t.child=i,r.last=i)}return null!==r.tail?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=le(),e.sibling=null,n=Ui.current,H(Ui,a?1&n|2:1&n),da&&aa(t,r.treeForkCount),e):(hl(t),null);case 22:case 23:return ji(t),_i(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?0!==(536870912&n)&&0===(128&t.flags)&&(hl(t),6&t.subtreeFlags&&(t.flags|=8192)):hl(t),null!==(n=t.updateQueue)&&ul(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&B(Ga),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Ca(ja),hl(t),null;case 25:case 30:return null}throw Error(s(156,t.tag))}function ml(e,t){switch(oa(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ca(ja),$(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return J(t),null;case 31:if(null!==t.memoizedState){if(ji(t),null===t.alternate)throw Error(s(340));ba()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(ji(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));ba()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return B(Ui),null;case 4:return $(),null;case 10:return Ca(t.type),null;case 22:case 23:return ji(t),_i(),null!==e&&B(Ga),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Ca(ja),null;default:return null}}function gl(e,t){switch(oa(t),t.tag){case 3:Ca(ja),$();break;case 26:case 27:case 5:J(t);break;case 4:$();break;case 31:null!==t.memoizedState&&ji(t);break;case 13:ji(t);break;case 19:B(Ui);break;case 10:Ca(t.type);break;case 22:case 23:ji(t),_i(),null!==e&&B(Ga);break;case 24:Ca(ja)}}function pl(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var a=r.next;n=a;do{if((n.tag&e)===e){r=void 0;var i=n.create,s=n.inst;r=i(),s.destroy=r}n=n.next}while(n!==a)}}catch(o){Au(t,t.return,o)}}function vl(e,t,n){try{var r=t.updateQueue,a=null!==r?r.lastEffect:null;if(null!==a){var i=a.next;r=i;do{if((r.tag&e)===e){var s=r.inst,o=s.destroy;if(void 0!==o){s.destroy=void 0,a=t;var l=n,c=o;try{c()}catch(u){Au(a,l,u)}}}r=r.next}while(r!==i)}}catch(u){Au(t,t.return,u)}}function yl(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{Ci(t,n)}catch(r){Au(e,e.return,r)}}}function bl(e,t,n){n.props=Ao(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){Au(e,t,r)}}function wl(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode}"function"===typeof n?e.refCleanup=n(r):n.current=r}}catch(a){Au(e,t,a)}}function Sl(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"===typeof r)try{r()}catch(a){Au(e,t,a)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(i){Au(e,t,i)}else n.current=null}function Tl(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(a){Au(e,e.return,a)}}function Al(e,t,n){try{var r=e.stateNode;!function(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var a=null,i=null,o=null,l=null,c=null,u=null,d=null;for(m in n){var h=n[m];if(n.hasOwnProperty(m)&&null!=h)switch(m){case"checked":case"value":break;case"defaultValue":c=h;default:r.hasOwnProperty(m)||ud(e,t,m,null,r,h)}}for(var f in r){var m=r[f];if(h=n[f],r.hasOwnProperty(f)&&(null!=m||null!=h))switch(f){case"type":i=m;break;case"name":a=m;break;case"checked":u=m;break;case"defaultChecked":d=m;break;case"value":o=m;break;case"defaultValue":l=m;break;case"children":case"dangerouslySetInnerHTML":if(null!=m)throw Error(s(137,t));break;default:m!==h&&ud(e,t,f,m,r,h)}}return void yt(e,o,l,c,u,d,i,a);case"select":for(i in m=o=l=f=null,n)if(c=n[i],n.hasOwnProperty(i)&&null!=c)switch(i){case"value":break;case"multiple":m=c;default:r.hasOwnProperty(i)||ud(e,t,i,null,r,c)}for(a in r)if(i=r[a],c=n[a],r.hasOwnProperty(a)&&(null!=i||null!=c))switch(a){case"value":f=i;break;case"defaultValue":l=i;break;case"multiple":o=i;default:i!==c&&ud(e,t,a,i,r,c)}return t=l,n=o,r=m,void(null!=f?St(e,!!n,f,!1):!!r!==!!n&&(null!=t?St(e,!!n,t,!0):St(e,!!n,n?[]:"",!1)));case"textarea":for(l in m=f=null,n)if(a=n[l],n.hasOwnProperty(l)&&null!=a&&!r.hasOwnProperty(l))switch(l){case"value":case"children":break;default:ud(e,t,l,null,r,a)}for(o in r)if(a=r[o],i=n[o],r.hasOwnProperty(o)&&(null!=a||null!=i))switch(o){case"value":f=a;break;case"defaultValue":m=a;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=a)throw Error(s(91));break;default:a!==i&&ud(e,t,o,a,r,i)}return void Tt(e,f,m);case"option":for(var g in n)if(f=n[g],n.hasOwnProperty(g)&&null!=f&&!r.hasOwnProperty(g))if("selected"===g)e.selected=!1;else ud(e,t,g,null,r,f);for(c in r)if(f=r[c],m=n[c],r.hasOwnProperty(c)&&f!==m&&(null!=f||null!=m))if("selected"===c)e.selected=f&&"function"!==typeof f&&"symbol"!==typeof f;else ud(e,t,c,f,r,m);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var p in n)f=n[p],n.hasOwnProperty(p)&&null!=f&&!r.hasOwnProperty(p)&&ud(e,t,p,null,r,f);for(u in r)if(f=r[u],m=n[u],r.hasOwnProperty(u)&&f!==m&&(null!=f||null!=m))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(s(137,t));break;default:ud(e,t,u,f,r,m)}return;default:if(It(t)){for(var v in n)f=n[v],n.hasOwnProperty(v)&&void 0!==f&&!r.hasOwnProperty(v)&&dd(e,t,v,void 0,r,f);for(d in r)f=r[d],m=n[d],!r.hasOwnProperty(d)||f===m||void 0===f&&void 0===m||dd(e,t,d,f,r,m);return}}for(var y in n)f=n[y],n.hasOwnProperty(y)&&null!=f&&!r.hasOwnProperty(y)&&ud(e,t,y,null,r,f);for(h in r)f=r[h],m=n[h],!r.hasOwnProperty(h)||f===m||null==f&&null==m||ud(e,t,h,f,r,m)}(r,e.type,n,t),r[ze]=t}catch(a){Au(e,e.return,a)}}function xl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&Cd(e.type)||4===e.tag}function kl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||xl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&Cd(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Ot));else if(4!==r&&(27===r&&Cd(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(Cl(e,t,n),e=e.sibling;null!==e;)Cl(e,t,n),e=e.sibling}function El(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&(27===r&&Cd(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(El(e,t,n),e=e.sibling;null!==e;)El(e,t,n),e=e.sibling}function Il(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,a=t.attributes;a.length;)t.removeAttributeNode(a[0]);hd(t,r,n),t[He]=e,t[ze]=n}catch(i){Au(e,e.return,i)}}var Nl=!1,Pl=!1,_l=!1,Ol="function"===typeof WeakSet?WeakSet:Set,Rl=null;function Ml(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:Yl(e,n),4&r&&pl(5,n);break;case 1:if(Yl(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(s){Au(n,n.return,s)}else{var a=Ao(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(a,t,e.__reactInternalSnapshotBeforeUpdate)}catch(o){Au(n,n.return,o)}}64&r&&yl(n),512&r&&wl(n,n.return);break;case 3:if(Yl(e,n),64&r&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{Ci(e,t)}catch(s){Au(n,n.return,s)}}break;case 27:null===t&&4&r&&Il(n);case 26:case 5:Yl(e,n),null===t&&4&r&&Tl(n),512&r&&wl(n,n.return);break;case 12:Yl(e,n);break;case 31:Yl(e,n),4&r&&Bl(e,n);break;case 13:Yl(e,n),4&r&&Hl(e,n),64&r&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==n.readyState)t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}(e,n=Eu.bind(null,n))));break;case 22:if(!(r=null!==n.memoizedState||Nl)){t=null!==t&&null!==t.memoizedState||Pl,a=Nl;var i=Pl;Nl=r,(Pl=t)&&!i?Ql(e,n,0!==(8772&n.subtreeFlags)):Yl(e,n),Nl=a,Pl=i}break;case 30:break;default:Yl(e,n)}}function Dl(e){var t=e.alternate;null!==t&&(e.alternate=null,Dl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&$e(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Ll=null,Fl=!1;function jl(e,t,n){for(n=n.child;null!==n;)Ul(e,t,n),n=n.sibling}function Ul(e,t,n){if(ye&&"function"===typeof ye.onCommitFiberUnmount)try{ye.onCommitFiberUnmount(ve,n)}catch(i){}switch(n.tag){case 26:Pl||Sl(n,t),jl(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:Pl||Sl(n,t);var r=Ll,a=Fl;Cd(n.type)&&(Ll=n.stateNode,Fl=!1),jl(e,t,n),jd(n.stateNode),Ll=r,Fl=a;break;case 5:Pl||Sl(n,t);case 6:if(r=Ll,a=Fl,Ll=null,jl(e,t,n),Fl=a,null!==(Ll=r))if(Fl)try{(9===Ll.nodeType?Ll.body:"HTML"===Ll.nodeName?Ll.ownerDocument.body:Ll).removeChild(n.stateNode)}catch(s){Au(n,t,s)}else try{Ll.removeChild(n.stateNode)}catch(s){Au(n,t,s)}break;case 18:null!==Ll&&(Fl?(Ed(9===(e=Ll).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Wh(e)):Ed(Ll,n.stateNode));break;case 4:r=Ll,a=Fl,Ll=n.stateNode.containerInfo,Fl=!0,jl(e,t,n),Ll=r,Fl=a;break;case 0:case 11:case 14:case 15:vl(2,n,t),Pl||vl(4,n,t),jl(e,t,n);break;case 1:Pl||(Sl(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount&&bl(n,t,r)),jl(e,t,n);break;case 21:jl(e,t,n);break;case 22:Pl=(r=Pl)||null!==n.memoizedState,jl(e,t,n),Pl=r;break;default:jl(e,t,n)}}function Bl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&null!==(e=e.memoizedState))){e=e.dehydrated;try{Wh(e)}catch(n){Au(t,t.return,n)}}}function Hl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Wh(e)}catch(n){Au(t,t.return,n)}}function zl(e,t){var n=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Ol),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Ol),t;default:throw Error(s(435,e.tag))}}(e);t.forEach(function(t){if(!n.has(t)){n.add(t);var r=Iu.bind(null,e,t);t.then(r,r)}})}function ql(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r],i=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 27:if(Cd(l.type)){Ll=l.stateNode,Fl=!1;break e}break;case 5:Ll=l.stateNode,Fl=!1;break e;case 3:case 4:Ll=l.stateNode.containerInfo,Fl=!0;break e}l=l.return}if(null===Ll)throw Error(s(160));Ul(i,o,a),Ll=null,Fl=!1,null!==(i=a.alternate)&&(i.return=null),a.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)Vl(t,e),t=t.sibling}var Wl=null;function Vl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:ql(t,e),Kl(e),4&r&&(vl(3,e,e.return),pl(3,e),vl(5,e,e.return));break;case 1:ql(t,e),Kl(e),512&r&&(Pl||null===n||Sl(n,n.return)),64&r&&Nl&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r))));break;case 26:var a=Wl;if(ql(t,e),Kl(e),512&r&&(Pl||null===n||Sl(n,n.return)),4&r){var i=null!==n?n.memoizedState:null;if(r=e.memoizedState,null===n)if(null===r)if(null===e.stateNode){e:{r=e.type,n=e.memoizedProps,a=a.ownerDocument||a;t:switch(r){case"title":(!(i=a.getElementsByTagName("title")[0])||i[Ye]||i[He]||"http://www.w3.org/2000/svg"===i.namespaceURI||i.hasAttribute("itemprop"))&&(i=a.createElement(r),a.head.insertBefore(i,a.querySelector("head > title"))),hd(i,r,n),i[He]=e,et(i),r=i;break e;case"link":var o=nh("link","href",a).get(r+(n.href||""));if(o)for(var l=0;l<o.length;l++)if((i=o[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&i.getAttribute("rel")===(null==n.rel?null:n.rel)&&i.getAttribute("title")===(null==n.title?null:n.title)&&i.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){o.splice(l,1);break t}hd(i=a.createElement(r),r,n),a.head.appendChild(i);break;case"meta":if(o=nh("meta","content",a).get(r+(n.content||"")))for(l=0;l<o.length;l++)if((i=o[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&i.getAttribute("name")===(null==n.name?null:n.name)&&i.getAttribute("property")===(null==n.property?null:n.property)&&i.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&i.getAttribute("charset")===(null==n.charSet?null:n.charSet)){o.splice(l,1);break t}hd(i=a.createElement(r),r,n),a.head.appendChild(i);break;default:throw Error(s(468,r))}i[He]=e,et(i),r=i}e.stateNode=r}else rh(a,e.type,e.stateNode);else e.stateNode=Jd(a,r,e.memoizedProps);else i!==r?(null===i?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):i.count--,null===r?rh(a,e.type,e.stateNode):Jd(a,r,e.memoizedProps)):null===r&&null!==e.stateNode&&Al(e,e.memoizedProps,n.memoizedProps)}break;case 27:ql(t,e),Kl(e),512&r&&(Pl||null===n||Sl(n,n.return)),null!==n&&4&r&&Al(e,e.memoizedProps,n.memoizedProps);break;case 5:if(ql(t,e),Kl(e),512&r&&(Pl||null===n||Sl(n,n.return)),32&e.flags){a=e.stateNode;try{xt(a,"")}catch(g){Au(e,e.return,g)}}4&r&&null!=e.stateNode&&Al(e,a=e.memoizedProps,null!==n?n.memoizedProps:a),1024&r&&(_l=!0);break;case 6:if(ql(t,e),Kl(e),4&r){if(null===e.stateNode)throw Error(s(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(g){Au(e,e.return,g)}}break;case 3:if(th=null,a=Wl,Wl=Hd(t.containerInfo),ql(t,e),Wl=a,Kl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Wh(t.containerInfo)}catch(g){Au(e,e.return,g)}_l&&(_l=!1,Gl(e));break;case 4:r=Wl,Wl=Hd(e.stateNode.containerInfo),ql(t,e),Kl(e),Wl=r;break;case 12:default:ql(t,e),Kl(e);break;case 31:case 19:ql(t,e),Kl(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,zl(e,r)));break;case 13:ql(t,e),Kl(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(Oc=le()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,zl(e,r)));break;case 22:a=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,u=Nl,d=Pl;if(Nl=u||a,Pl=d||c,ql(t,e),Pl=d,Nl=u,Kl(e),8192&r)e:for(t=e.stateNode,t._visibility=a?-2&t._visibility:1|t._visibility,a&&(null===n||c||Nl||Pl||$l(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(i=c.stateNode,a)"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none";else{l=c.stateNode;var h=c.memoizedProps.style,f=void 0!==h&&null!==h&&h.hasOwnProperty("display")?h.display:null;l.style.display=null==f||"boolean"===typeof f?"":(""+f).trim()}}catch(g){Au(c,c.return,g)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=a?"":c.memoizedProps}catch(g){Au(c,c.return,g)}}}else if(18===t.tag){if(null===n){c=t;try{var m=c.stateNode;a?Id(m,!0):Id(c.stateNode,!1)}catch(g){Au(c,c.return,g)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(n=r.retryQueue)&&(r.retryQueue=null,zl(e,n))));case 30:case 21:}}function Kl(e){var t=e.flags;if(2&t){try{for(var n,r=e.return;null!==r;){if(xl(r)){n=r;break}r=r.return}if(null==n)throw Error(s(160));switch(n.tag){case 27:var a=n.stateNode;El(e,kl(e),a);break;case 5:var i=n.stateNode;32&n.flags&&(xt(i,""),n.flags&=-33),El(e,kl(e),i);break;case 3:case 4:var o=n.stateNode.containerInfo;Cl(e,kl(e),o);break;default:throw Error(s(161))}}catch(l){Au(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Gl(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Gl(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Yl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Ml(e,t.alternate,t),t=t.sibling}function $l(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:vl(4,t,t.return),$l(t);break;case 1:Sl(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&bl(t,t.return,n),$l(t);break;case 27:jd(t.stateNode);case 26:case 5:Sl(t,t.return),$l(t);break;case 22:null===t.memoizedState&&$l(t);break;default:$l(t)}e=e.sibling}}function Ql(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,a=e,i=t,s=i.flags;switch(i.tag){case 0:case 11:case 15:Ql(a,i,n),pl(4,i);break;case 1:if(Ql(a,i,n),"function"===typeof(a=(r=i).stateNode).componentDidMount)try{a.componentDidMount()}catch(c){Au(r,r.return,c)}if(null!==(a=(r=i).updateQueue)){var o=r.stateNode;try{var l=a.shared.hiddenCallbacks;if(null!==l)for(a.shared.hiddenCallbacks=null,a=0;a<l.length;a++)ki(l[a],o)}catch(c){Au(r,r.return,c)}}n&&64&s&&yl(i),wl(i,i.return);break;case 27:Il(i);case 26:case 5:Ql(a,i,n),n&&null===r&&4&s&&Tl(i),wl(i,i.return);break;case 12:Ql(a,i,n);break;case 31:Ql(a,i,n),n&&4&s&&Bl(a,i);break;case 13:Ql(a,i,n),n&&4&s&&Hl(a,i);break;case 22:null===i.memoizedState&&Ql(a,i,n),wl(i,i.return);break;case 30:break;default:Ql(a,i,n)}t=t.sibling}}function Jl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Ba(n))}function Xl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ba(e))}function Zl(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)ec(e,t,n,r),t=t.sibling}function ec(e,t,n,r){var a=t.flags;switch(t.tag){case 0:case 11:case 15:Zl(e,t,n,r),2048&a&&pl(9,t);break;case 1:case 31:case 13:default:Zl(e,t,n,r);break;case 3:Zl(e,t,n,r),2048&a&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ba(e)));break;case 12:if(2048&a){Zl(e,t,n,r),e=t.stateNode;try{var i=t.memoizedProps,s=i.id,o=i.onPostCommit;"function"===typeof o&&o(s,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){Au(t,t.return,l)}}else Zl(e,t,n,r);break;case 23:break;case 22:i=t.stateNode,s=t.alternate,null!==t.memoizedState?2&i._visibility?Zl(e,t,n,r):nc(e,t):2&i._visibility?Zl(e,t,n,r):(i._visibility|=2,tc(e,t,n,r,0!==(10256&t.subtreeFlags)||!1)),2048&a&&Jl(s,t);break;case 24:Zl(e,t,n,r),2048&a&&Xl(t.alternate,t)}}function tc(e,t,n,r,a){for(a=a&&(0!==(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var i=e,s=t,o=n,l=r,c=s.flags;switch(s.tag){case 0:case 11:case 15:tc(i,s,o,l,a),pl(8,s);break;case 23:break;case 22:var u=s.stateNode;null!==s.memoizedState?2&u._visibility?tc(i,s,o,l,a):nc(i,s):(u._visibility|=2,tc(i,s,o,l,a)),a&&2048&c&&Jl(s.alternate,s);break;case 24:tc(i,s,o,l,a),a&&2048&c&&Xl(s.alternate,s);break;default:tc(i,s,o,l,a)}t=t.sibling}}function nc(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,a=r.flags;switch(r.tag){case 22:nc(n,r),2048&a&&Jl(r.alternate,r);break;case 24:nc(n,r),2048&a&&Xl(r.alternate,r);break;default:nc(n,r)}t=t.sibling}}var rc=8192;function ac(e,t,n){if(e.subtreeFlags&rc)for(e=e.child;null!==e;)ic(e,t,n),e=e.sibling}function ic(e,t,n){switch(e.tag){case 26:ac(e,t,n),e.flags&rc&&null!==e.memoizedState&&function(e,t,n,r){if("stylesheet"===n.type&&("string"!==typeof r.media||!1!==matchMedia(r.media).matches)&&0===(4&n.state.loading)){if(null===n.instance){var a=Kd(r.href),i=t.querySelector(Gd(a));if(i)return null!==(t=i._p)&&"object"===typeof t&&"function"===typeof t.then&&(e.count++,e=sh.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=i,void et(i);i=t.ownerDocument||t,r=Yd(r),(a=Ud.get(a))&&Zd(r,a),et(i=i.createElement("link"));var s=i;s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),hd(i,"link",r),n.instance=i}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&0===(3&n.state.loading)&&(e.count++,n=sh.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}(n,Wl,e.memoizedState,e.memoizedProps);break;case 5:default:ac(e,t,n);break;case 3:case 4:var r=Wl;Wl=Hd(e.stateNode.containerInfo),ac(e,t,n),Wl=r;break;case 22:null===e.memoizedState&&(null!==(r=e.alternate)&&null!==r.memoizedState?(r=rc,rc=16777216,ac(e,t,n),rc=r):ac(e,t,n))}}function sc(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function oc(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Rl=r,uc(r,e)}sc(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)lc(e),e=e.sibling}function lc(e){switch(e.tag){case 0:case 11:case 15:oc(e),2048&e.flags&&vl(9,e,e.return);break;case 3:case 12:default:oc(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,cc(e)):oc(e)}}function cc(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Rl=r,uc(r,e)}sc(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:vl(8,t,t.return),cc(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,cc(t));break;default:cc(t)}e=e.sibling}}function uc(e,t){for(;null!==Rl;){var n=Rl;switch(n.tag){case 0:case 11:case 15:vl(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Ba(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,Rl=r;else e:for(n=e;null!==Rl;){var a=(r=Rl).sibling,i=r.return;if(Dl(r),r===n){Rl=null;break e}if(null!==a){a.return=i,Rl=a;break e}Rl=i}}}var dc={getCacheForType:function(e){var t=Oa(ja),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Oa(ja).controller.signal}},hc="function"===typeof WeakMap?WeakMap:Map,fc=0,mc=null,gc=null,pc=0,vc=0,yc=null,bc=!1,wc=!1,Sc=!1,Tc=0,Ac=0,xc=0,kc=0,Cc=0,Ec=0,Ic=0,Nc=null,Pc=null,_c=!1,Oc=0,Rc=0,Mc=1/0,Dc=null,Lc=null,Fc=0,jc=null,Uc=null,Bc=0,Hc=0,zc=null,qc=null,Wc=0,Vc=null;function Kc(){return 0!==(2&fc)&&0!==pc?pc&-pc:null!==M.T?zu():je()}function Gc(){if(0===Ec)if(0===(536870912&pc)||da){var e=xe;0===(3932160&(xe<<=1))&&(xe=262144),Ec=e}else Ec=536870912;return null!==(e=Oi.current)&&(e.flags|=32),Ec}function Yc(e,t,n){(e!==mc||2!==vc&&9!==vc)&&null===e.cancelPendingCommit||(tu(e,0),Xc(e,pc,Ec,!1)),Oe(e,n),0!==(2&fc)&&e===mc||(e===mc&&(0===(2&fc)&&(kc|=n),4===Ac&&Xc(e,pc,Ec,!1)),Du(e))}function $c(e,t,n){if(0!==(6&fc))throw Error(s(327));for(var r=!n&&0===(127&t)&&0===(t&e.expiredLanes)||Ie(e,t),a=r?function(e,t){var n=fc;fc|=2;var r=au(),a=iu();mc!==e||pc!==t?(Dc=null,Mc=le()+500,tu(e,t)):wc=Ie(e,t);e:for(;;)try{if(0!==vc&&null!==gc){t=gc;var i=yc;t:switch(vc){case 1:vc=0,yc=null,hu(e,t,i,1);break;case 2:case 9:if(ti(i)){vc=0,yc=null,du(t);break}t=function(){2!==vc&&9!==vc||mc!==e||(vc=7),Du(e)},i.then(t,t);break e;case 3:vc=7;break e;case 4:vc=5;break e;case 7:ti(i)?(vc=0,yc=null,du(t)):(vc=0,yc=null,hu(e,t,i,7));break;case 5:var o=null;switch(gc.tag){case 26:o=gc.memoizedState;case 5:case 27:var l=gc;if(o?ah(o):l.stateNode.complete){vc=0,yc=null;var c=l.sibling;if(null!==c)gc=c;else{var u=l.return;null!==u?(gc=u,fu(u)):gc=null}break t}}vc=0,yc=null,hu(e,t,i,5);break;case 6:vc=0,yc=null,hu(e,t,i,6);break;case 8:eu(),Ac=6;break e;default:throw Error(s(462))}}cu();break}catch(d){nu(e,d)}return xa=Aa=null,M.H=r,M.A=a,fc=n,null!==gc?0:(mc=null,pc=0,Pr(),Ac)}(e,t):ou(e,t,!0),i=r;;){if(0===a){wc&&!r&&Xc(e,t,0,!1);break}if(n=e.current.alternate,!i||Jc(n)){if(2===a){if(i=t,e.errorRecoveryDisabledLanes&i)var o=0;else o=0!==(o=-536870913&e.pendingLanes)?o:536870912&o?536870912:0;if(0!==o){t=o;e:{var l=e;a=Nc;var c=l.current.memoizedState.isDehydrated;if(c&&(tu(l,o).flags|=256),2!==(o=ou(l,o,!1))){if(Sc&&!c){l.errorRecoveryDisabledLanes|=i,kc|=i,a=4;break e}i=Pc,Pc=a,null!==i&&(null===Pc?Pc=i:Pc.push.apply(Pc,i))}a=o}if(i=!1,2!==a)continue}}if(1===a){tu(e,0),Xc(e,t,0,!0);break}e:{switch(r=e,i=a){case 0:case 1:throw Error(s(345));case 4:if((4194048&t)!==t)break;case 6:Xc(r,t,Ec,!bc);break e;case 2:Pc=null;break;case 3:case 5:break;default:throw Error(s(329))}if((62914560&t)===t&&10<(a=Oc+300-le())){if(Xc(r,t,Ec,!bc),0!==Ee(r,0,!0))break e;Bc=t,r.timeoutHandle=Sd(Qc.bind(null,r,n,Pc,Dc,_c,t,Ec,kc,Ic,bc,i,"Throttled",-0,0),a)}else Qc(r,n,Pc,Dc,_c,t,Ec,kc,Ic,bc,i,null,-0,0)}break}a=ou(e,t,!1),i=!1}Du(e)}function Qc(e,t,n,r,a,i,s,o,l,c,u,d,h,f){if(e.timeoutHandle=-1,8192&(d=t.subtreeFlags)||16785408===(16785408&d)){ic(t,i,d={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ot});var m=(62914560&i)===i?Oc-le():(4194048&i)===i?Rc-le():0;if(null!==(m=function(e,t){return e.stylesheets&&0===e.count&&lh(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var r=setTimeout(function(){if(e.stylesheets&&lh(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===ih&&(ih=62500*function(){if("function"===typeof performance.getEntriesByType){for(var e=0,t=0,n=performance.getEntriesByType("resource"),r=0;r<n.length;r++){var a=n[r],i=a.transferSize,s=a.initiatorType,o=a.duration;if(i&&o&&fd(s)){for(s=0,o=a.responseEnd,r+=1;r<n.length;r++){var l=n[r],c=l.startTime;if(c>o)break;var u=l.transferSize,d=l.initiatorType;u&&fd(d)&&(s+=u*((l=l.responseEnd)<o?1:(o-c)/(l-c)))}if(--r,t+=8*(i+s)/(a.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&"number"===typeof(e=navigator.connection.downlink)?e:5}());var a=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&lh(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>ih?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(r),clearTimeout(a)}}:null}(d,m)))return Bc=i,e.cancelPendingCommit=m(gu.bind(null,e,t,i,n,r,a,s,o,l,u,d,null,h,f)),void Xc(e,i,s,!c)}gu(e,t,i,n,r,a,s,o,l)}function Jc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!Xn(i(),a))return!1}catch(s){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Xc(e,t,n,r){t&=~Cc,t&=~kc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var a=t;0<a;){var i=31-we(a),s=1<<i;r[i]=-1,a&=~s}0!==n&&Re(e,n,t)}function Zc(){return 0!==(6&fc)||(Lu(0,!1),!1)}function eu(){if(null!==gc){if(0===vc)var e=gc.return;else xa=Aa=null,ss(e=gc),oi=null,li=0,e=gc;for(;null!==e;)gl(e.alternate,e),e=e.return;gc=null}}function tu(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,Td(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Bc=0,eu(),mc=e,gc=n=Br(e.current,null),pc=t,vc=0,yc=null,bc=!1,wc=Ie(e,t),Sc=!1,Ic=Ec=Cc=kc=xc=Ac=0,Pc=Nc=null,_c=!1,0!==(8&t)&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var a=31-we(r),i=1<<a;t|=e[a],r&=~i}return Tc=t,Pr(),n}function nu(e,t){zi=null,M.H=go,t===Ja||t===Za?(t=ii(),vc=3):t===Xa?(t=ii(),vc=4):vc=t===Oo?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,yc=t,null===gc&&(Ac=1,Eo(e,Yr(t,e.current)))}function ru(){var e=Oi.current;return null===e||((4194048&pc)===pc?null===Ri:((62914560&pc)===pc||0!==(536870912&pc))&&e===Ri)}function au(){var e=M.H;return M.H=go,null===e?go:e}function iu(){var e=M.A;return M.A=dc,e}function su(){Ac=4,bc||(4194048&pc)!==pc&&null!==Oi.current||(wc=!0),0===(134217727&xc)&&0===(134217727&kc)||null===mc||Xc(mc,pc,Ec,!1)}function ou(e,t,n){var r=fc;fc|=2;var a=au(),i=iu();mc===e&&pc===t||(Dc=null,tu(e,t)),t=!1;var s=Ac;e:for(;;)try{if(0!==vc&&null!==gc){var o=gc,l=yc;switch(vc){case 8:eu(),s=6;break e;case 3:case 2:case 9:case 6:null===Oi.current&&(t=!0);var c=vc;if(vc=0,yc=null,hu(e,o,l,c),n&&wc){s=0;break e}break;default:c=vc,vc=0,yc=null,hu(e,o,l,c)}}lu(),s=Ac;break}catch(u){nu(e,u)}return t&&e.shellSuspendCounter++,xa=Aa=null,fc=r,M.H=a,M.A=i,null===gc&&(mc=null,pc=0,Pr()),s}function lu(){for(;null!==gc;)uu(gc)}function cu(){for(;null!==gc&&!se();)uu(gc)}function uu(e){var t=sl(e.alternate,e,Tc);e.memoizedProps=e.pendingProps,null===t?fu(e):gc=t}function du(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Vo(n,t,t.pendingProps,t.type,void 0,pc);break;case 11:t=Vo(n,t,t.pendingProps,t.type.render,t.ref,pc);break;case 5:ss(t);default:gl(n,t),t=sl(n,t=gc=Hr(t,Tc),Tc)}e.memoizedProps=e.pendingProps,null===t?fu(e):gc=t}function hu(e,t,n,r){xa=Aa=null,ss(t),oi=null,li=0;var a=t.return;try{if(function(e,t,n,r,a){if(n.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){if(null!==(t=n.alternate)&&Na(t,n,a,!0),null!==(n=Oi.current)){switch(n.tag){case 31:case 13:return null===Ri?su():null===n.alternate&&0===Ac&&(Ac=3),n.flags&=-257,n.flags|=65536,n.lanes=a,r===ei?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),xu(e,r,a)),!1;case 22:return n.flags|=65536,r===ei?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),xu(e,r,a)),!1}throw Error(s(435,n.tag))}return xu(e,r,a),su(),!1}if(da)return null!==(t=Oi.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=a,r!==ma&&Sa(Yr(e=Error(s(422),{cause:r}),n))):(r!==ma&&Sa(Yr(t=Error(s(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,a&=-a,e.lanes|=a,r=Yr(r,n),Si(e,a=No(e.stateNode,r,a)),4!==Ac&&(Ac=2)),!1;var i=Error(s(520),{cause:r});if(i=Yr(i,n),null===Nc?Nc=[i]:Nc.push(i),4!==Ac&&(Ac=2),null===t)return!0;r=Yr(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=a&-a,n.lanes|=e,Si(n,e=No(n.stateNode,r,e)),!1;case 1:if(t=n.type,i=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==i&&"function"===typeof i.componentDidCatch&&(null===Lc||!Lc.has(i))))return n.flags|=65536,a&=-a,n.lanes|=a,_o(a=Po(a),e,n,r),Si(n,a),!1}n=n.return}while(null!==n);return!1}(e,a,t,n,pc))return Ac=1,Eo(e,Yr(n,e.current)),void(gc=null)}catch(i){if(null!==a)throw gc=a,i;return Ac=1,Eo(e,Yr(n,e.current)),void(gc=null)}32768&t.flags?(da||1===r?e=!0:wc||0!==(536870912&pc)?e=!1:(bc=e=!0,(2===r||9===r||3===r||6===r)&&(null!==(r=Oi.current)&&13===r.tag&&(r.flags|=16384))),mu(t,e)):fu(t)}function fu(e){var t=e;do{if(0!==(32768&t.flags))return void mu(t,bc);e=t.return;var n=fl(t.alternate,t,Tc);if(null!==n)return void(gc=n);if(null!==(t=t.sibling))return void(gc=t);gc=t=e}while(null!==t);0===Ac&&(Ac=5)}function mu(e,t){do{var n=ml(e.alternate,e);if(null!==n)return n.flags&=32767,void(gc=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(gc=e);gc=e=n}while(null!==e);Ac=6,gc=null}function gu(e,t,n,r,a,i,o,l,c){e.cancelPendingCommit=null;do{wu()}while(0!==Fc);if(0!==(6&fc))throw Error(s(327));if(null!==t){if(t===e.current)throw Error(s(177));if(i=t.lanes|t.childLanes,function(e,t,n,r,a,i){var s=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var o=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=s&~n;0<n;){var u=31-we(n),d=1<<u;o[u]=0,l[u]=-1;var h=c[u];if(null!==h)for(c[u]=null,u=0;u<h.length;u++){var f=h[u];null!==f&&(f.lane&=-536870913)}n&=~d}0!==r&&Re(e,r,0),0!==i&&0===a&&0!==e.tag&&(e.suspendedLanes|=i&~(s&~t))}(e,n,i|=Nr,o,l,c),e===mc&&(gc=mc=null,pc=0),Uc=t,jc=e,Bc=n,Hc=i,zc=a,qc=r,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,ae(he,function(){return Su(),null})):(e.callbackNode=null,e.callbackPriority=0),r=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||r){r=M.T,M.T=null,a=D.p,D.p=2,o=fc,fc|=4;try{!function(e,t){if(e=e.containerInfo,md=bh,ar(e=rr(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch(p){n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var m;h!==n||0!==a&&3!==h.nodeType||(l=o+a),h!==i||0!==r&&3!==h.nodeType||(c=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(m=h.firstChild);)f=h,h=m;for(;;){if(h===e)break t;if(f===n&&++u===a&&(l=o),f===i&&++d===r&&(c=o),null!==(m=h.nextSibling))break;f=(h=f).parentNode}h=m}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(gd={focusedElem:e,selectionRange:n},bh=!1,Rl=t;null!==Rl;)if(e=(t=Rl).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Rl=e;else for(;null!==Rl;){switch(i=(t=Rl).alternate,e=t.flags,t.tag){case 0:if(0!==(4&e)&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(n=0;n<e.length;n++)(a=e[n]).ref.impl=a.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==i){e=void 0,n=t,a=i.memoizedProps,i=i.memoizedState,r=n.stateNode;try{var g=Ao(n.type,a);e=r.getSnapshotBeforeUpdate(g,i),r.__reactInternalSnapshotBeforeUpdate=e}catch(v){Au(n,n.return,v)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))Nd(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Nd(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(s(163))}if(null!==(e=t.sibling)){e.return=t.return,Rl=e;break}Rl=t.return}}(e,t)}finally{fc=o,D.p=a,M.T=r}}Fc=1,pu(),vu(),yu()}}function pu(){if(1===Fc){Fc=0;var e=jc,t=Uc,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=M.T,M.T=null;var r=D.p;D.p=2;var a=fc;fc|=4;try{Vl(t,e);var i=gd,s=rr(e.containerInfo),o=i.focusedElem,l=i.selectionRange;if(s!==o&&o&&o.ownerDocument&&nr(o.ownerDocument.documentElement,o)){if(null!==l&&ar(o)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in o)o.selectionStart=c,o.selectionEnd=Math.min(u,o.value.length);else{var d=o.ownerDocument||document,h=d&&d.defaultView||window;if(h.getSelection){var f=h.getSelection(),m=o.textContent.length,g=Math.min(l.start,m),p=void 0===l.end?g:Math.min(l.end,m);!f.extend&&g>p&&(s=p,p=g,g=s);var v=tr(o,g),y=tr(o,p);if(v&&y&&(1!==f.rangeCount||f.anchorNode!==v.node||f.anchorOffset!==v.offset||f.focusNode!==y.node||f.focusOffset!==y.offset)){var b=d.createRange();b.setStart(v.node,v.offset),f.removeAllRanges(),g>p?(f.addRange(b),f.extend(y.node,y.offset)):(b.setEnd(y.node,y.offset),f.addRange(b))}}}}for(d=[],f=o;f=f.parentNode;)1===f.nodeType&&d.push({element:f,left:f.scrollLeft,top:f.scrollTop});for("function"===typeof o.focus&&o.focus(),o=0;o<d.length;o++){var w=d[o];w.element.scrollLeft=w.left,w.element.scrollTop=w.top}}bh=!!md,gd=md=null}finally{fc=a,D.p=r,M.T=n}}e.current=t,Fc=2}}function vu(){if(2===Fc){Fc=0;var e=jc,t=Uc,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=M.T,M.T=null;var r=D.p;D.p=2;var a=fc;fc|=4;try{Ml(e,t.alternate,t)}finally{fc=a,D.p=r,M.T=n}}Fc=3}}function yu(){if(4===Fc||3===Fc){Fc=0,oe();var e=jc,t=Uc,n=Bc,r=qc;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Fc=5:(Fc=0,Uc=jc=null,bu(e,e.pendingLanes));var a=e.pendingLanes;if(0===a&&(Lc=null),Fe(n),t=t.stateNode,ye&&"function"===typeof ye.onCommitFiberRoot)try{ye.onCommitFiberRoot(ve,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==r){t=M.T,a=D.p,D.p=2,M.T=null;try{for(var i=e.onRecoverableError,s=0;s<r.length;s++){var o=r[s];i(o.value,{componentStack:o.stack})}}finally{M.T=t,D.p=a}}0!==(3&Bc)&&wu(),Du(e),a=e.pendingLanes,0!==(261930&n)&&0!==(42&a)?e===Vc?Wc++:(Wc=0,Vc=e):Wc=0,Lu(0,!1)}}function bu(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Ba(t)))}function wu(){return pu(),vu(),yu(),Su()}function Su(){if(5!==Fc)return!1;var e=jc,t=Hc;Hc=0;var n=Fe(Bc),r=M.T,a=D.p;try{D.p=32>n?32:n,M.T=null,n=zc,zc=null;var i=jc,o=Bc;if(Fc=0,Uc=jc=null,Bc=0,0!==(6&fc))throw Error(s(331));var l=fc;if(fc|=4,lc(i.current),ec(i,i.current,o,n),fc=l,Lu(0,!1),ye&&"function"===typeof ye.onPostCommitFiberRoot)try{ye.onPostCommitFiberRoot(ve,i)}catch(c){}return!0}finally{D.p=a,M.T=r,bu(e,t)}}function Tu(e,t,n){t=Yr(n,t),null!==(e=bi(e,t=No(e.stateNode,t,2),2))&&(Oe(e,2),Du(e))}function Au(e,t,n){if(3===e.tag)Tu(e,e,n);else for(;null!==t;){if(3===t.tag){Tu(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Lc||!Lc.has(r))){e=Yr(n,e),null!==(r=bi(t,n=Po(2),2))&&(_o(n,r,t,e),Oe(r,2),Du(r));break}}t=t.return}}function xu(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new hc;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(Sc=!0,a.add(n),e=ku.bind(null,e,t,n),t.then(e,e))}function ku(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,mc===e&&(pc&n)===n&&(4===Ac||3===Ac&&(62914560&pc)===pc&&300>le()-Oc?0===(2&fc)&&tu(e,0):Cc|=n,Ic===pc&&(Ic=0)),Du(e)}function Cu(e,t){0===t&&(t=Pe()),null!==(e=Rr(e,t))&&(Oe(e,t),Du(e))}function Eu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Cu(e,n)}function Iu(e,t){var n=0;switch(e.tag){case 31:case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(s(314))}null!==r&&r.delete(t),Cu(e,n)}var Nu=null,Pu=null,_u=!1,Ou=!1,Ru=!1,Mu=0;function Du(e){e!==Pu&&null===e.next&&(null===Pu?Nu=Pu=e:Pu=Pu.next=e),Ou=!0,_u||(_u=!0,xd(function(){0!==(6&fc)?ae(ue,Fu):ju()}))}function Lu(e,t){if(!Ru&&Ou){Ru=!0;do{for(var n=!1,r=Nu;null!==r;){if(!t)if(0!==e){var a=r.pendingLanes;if(0===a)var i=0;else{var s=r.suspendedLanes,o=r.pingedLanes;i=(1<<31-we(42|e)+1)-1,i=201326741&(i&=a&~(s&~o))?201326741&i|1:i?2|i:0}0!==i&&(n=!0,Hu(r,i))}else i=pc,0===(3&(i=Ee(r,r===mc?i:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||Ie(r,i)||(n=!0,Hu(r,i));r=r.next}}while(n);Ru=!1}}function Fu(){ju()}function ju(){Ou=_u=!1;var e=0;0!==Mu&&function(){var e=window.event;if(e&&"popstate"===e.type)return e!==wd&&(wd=e,!0);return wd=null,!1}()&&(e=Mu);for(var t=le(),n=null,r=Nu;null!==r;){var a=r.next,i=Uu(r,t);0===i?(r.next=null,null===n?Nu=a:n.next=a,null===a&&(Pu=n)):(n=r,(0!==e||0!==(3&i))&&(Ou=!0)),r=a}0!==Fc&&5!==Fc||Lu(e,!1),0!==Mu&&(Mu=0)}function Uu(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=-62914561&e.pendingLanes;0<i;){var s=31-we(i),o=1<<s,l=a[s];-1===l?0!==(o&n)&&0===(o&r)||(a[s]=Ne(o,t)):l<=t&&(e.expiredLanes|=o),i&=~o}if(n=pc,n=Ee(e,e===(t=mc)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===n||e===t&&(2===vc||9===vc)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&ie(r),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||Ie(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&ie(r),Fe(n)){case 2:case 8:n=de;break;case 32:default:n=he;break;case 268435456:n=me}return r=Bu.bind(null,e),n=ae(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&ie(r),e.callbackPriority=2,e.callbackNode=null,2}function Bu(e,t){if(0!==Fc&&5!==Fc)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(wu()&&e.callbackNode!==n)return null;var r=pc;return 0===(r=Ee(e,e===mc?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:($c(e,r,t),Uu(e,le()),null!=e.callbackNode&&e.callbackNode===n?Bu.bind(null,e):null)}function Hu(e,t){if(wu())return null;$c(e,t,!0)}function zu(){if(0===Mu){var e=qa;0===e&&(e=Ae,0===(261888&(Ae<<=1))&&(Ae=256)),Mu=e}return Mu}function qu(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:_t(""+e)}function Wu(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Vu=0;Vu<xr.length;Vu++){var Ku=xr[Vu];kr(Ku.toLowerCase(),"on"+(Ku[0].toUpperCase()+Ku.slice(1)))}kr(pr,"onAnimationEnd"),kr(vr,"onAnimationIteration"),kr(yr,"onAnimationStart"),kr("dblclick","onDoubleClick"),kr("focusin","onFocus"),kr("focusout","onBlur"),kr(br,"onTransitionRun"),kr(wr,"onTransitionStart"),kr(Sr,"onTransitionCancel"),kr(Tr,"onTransitionEnd"),at("onMouseEnter",["mouseout","mouseover"]),at("onMouseLeave",["mouseout","mouseover"]),at("onPointerEnter",["pointerout","pointerover"]),at("onPointerLeave",["pointerout","pointerover"]),rt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),rt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),rt("onBeforeInput",["compositionend","keypress","textInput","paste"]),rt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),rt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),rt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Yu=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Gu));function $u(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var s=r.length-1;0<=s;s--){var o=r[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&a.isPropagationStopped())break e;i=o,a.currentTarget=c;try{i(a)}catch(u){Cr(u)}a.currentTarget=null,i=l}else for(s=0;s<r.length;s++){if(l=(o=r[s]).instance,c=o.currentTarget,o=o.listener,l!==i&&a.isPropagationStopped())break e;i=o,a.currentTarget=c;try{i(a)}catch(u){Cr(u)}a.currentTarget=null,i=l}}}}function Qu(e,t){var n=t[We];void 0===n&&(n=t[We]=new Set);var r=e+"__bubble";n.has(r)||(ed(t,e,2,!1),n.add(r))}function Ju(e,t,n){var r=0;t&&(r|=4),ed(n,e,r,t)}var Xu="_reactListening"+Math.random().toString(36).slice(2);function Zu(e){if(!e[Xu]){e[Xu]=!0,tt.forEach(function(t){"selectionchange"!==t&&(Yu.has(t)||Ju(t,!1,e),Ju(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Xu]||(t[Xu]=!0,Ju("selectionchange",!1,t))}}function ed(e,t,n,r){switch(Ch(t)){case 2:var a=wh;break;case 8:a=Sh;break;default:a=Th}n=a.bind(null,t,n,e),a=void 0,!zt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function td(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var o=r.stateNode.containerInfo;if(o===a)break;if(4===s)for(s=r.return;null!==s;){var c=s.tag;if((3===c||4===c)&&s.stateNode.containerInfo===a)return;s=s.return}for(;null!==o;){if(null===(s=Qe(o)))return;if(5===(c=s.tag)||6===c||26===c||27===c){r=i=s;continue e}o=o.parentNode}}r=r.return}Ut(function(){var r=i,a=Mt(n),s=[];e:{var o=Ar.get(e);if(void 0!==o){var c=nn,u=e;switch(e){case"keypress":if(0===Yt(n))break e;case"keydown":case"keyup":c=yn;break;case"focusin":u="focus",c=cn;break;case"focusout":u="blur",c=cn;break;case"beforeblur":case"afterblur":c=cn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=on;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=ln;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=wn;break;case pr:case vr:case yr:c=un;break;case Tr:c=Sn;break;case"scroll":case"scrollend":c=an;break;case"wheel":c=Tn;break;case"copy":case"cut":case"paste":c=dn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=bn;break;case"toggle":case"beforetoggle":c=An}var d=0!==(4&t),h=!d&&("scroll"===e||"scrollend"===e),f=d?null!==o?o+"Capture":null:o;d=[];for(var m,g=r;null!==g;){var p=g;if(m=p.stateNode,5!==(p=p.tag)&&26!==p&&27!==p||null===m||null===f||null!=(p=Bt(g,f))&&d.push(nd(g,p,m)),h)break;g=g.return}0<d.length&&(o=new c(o,u,null,n,a),s.push({event:o,listeners:d}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===Rt||!(u=n.relatedTarget||n.fromElement)||!Qe(u)&&!u[qe])&&(c||o)&&(o=a.window===a?a:(o=a.ownerDocument)?o.defaultView||o.parentWindow:window,c?(c=r,null!==(u=(u=n.relatedTarget||n.toElement)?Qe(u):null)&&(h=l(u),d=u.tag,u!==h||5!==d&&27!==d&&6!==d)&&(u=null)):(c=null,u=r),c!==u)){if(d=on,p="onMouseLeave",f="onMouseEnter",g="mouse","pointerout"!==e&&"pointerover"!==e||(d=bn,p="onPointerLeave",f="onPointerEnter",g="pointer"),h=null==c?o:Xe(c),m=null==u?o:Xe(u),(o=new d(p,g+"leave",c,n,a)).target=h,o.relatedTarget=m,p=null,Qe(a)===r&&((d=new d(f,g+"enter",u,n,a)).target=m,d.relatedTarget=h,p=d),h=p,c&&u)e:{for(d=ad,g=u,m=0,p=f=c;p;p=d(p))m++;p=0;for(var v=g;v;v=d(v))p++;for(;0<m-p;)f=d(f),m--;for(;0<p-m;)g=d(g),p--;for(;m--;){if(f===g||null!==g&&f===g.alternate){d=f;break e}f=d(f),g=d(g)}d=null}else d=null;null!==c&&id(s,o,c,d,!1),null!==u&&null!==h&&id(s,h,u,d,!0)}if("select"===(c=(o=r?Xe(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===c&&"file"===o.type)var y=Hn;else if(Dn(o))if(zn)y=Jn;else{y=$n;var b=Yn}else!(c=o.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==o.type&&"radio"!==o.type?r&&It(r.elementType)&&(y=Hn):y=Qn;switch(y&&(y=y(e,r))?Ln(s,y,n,a):(b&&b(e,o,r),"focusout"===e&&r&&"number"===o.type&&null!=r.memoizedProps.value&&wt(o,"number",o.value)),b=r?Xe(r):window,e){case"focusin":(Dn(b)||"true"===b.contentEditable)&&(sr=b,or=r,lr=null);break;case"focusout":lr=or=sr=null;break;case"mousedown":cr=!0;break;case"contextmenu":case"mouseup":case"dragend":cr=!1,ur(s,n,a);break;case"selectionchange":if(ir)break;case"keydown":case"keyup":ur(s,n,a)}var w;if(kn)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Rn?_n(e,n)&&(S="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(S="onCompositionStart");S&&(In&&"ko"!==n.locale&&(Rn||"onCompositionStart"!==S?"onCompositionEnd"===S&&Rn&&(w=Gt()):(Vt="value"in(Wt=a)?Wt.value:Wt.textContent,Rn=!0)),0<(b=rd(r,S)).length&&(S=new hn(S,e,null,n,a),s.push({event:S,listeners:b}),w?S.data=w:null!==(w=On(n))&&(S.data=w))),(w=En?function(e,t){switch(e){case"compositionend":return On(t);case"keypress":return 32!==t.which?null:(Pn=!0,Nn);case"textInput":return(e=t.data)===Nn&&Pn?null:e;default:return null}}(e,n):function(e,t){if(Rn)return"compositionend"===e||!kn&&_n(e,t)?(e=Gt(),Kt=Vt=Wt=null,Rn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return In&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(S=rd(r,"onBeforeInput")).length&&(b=new hn("onBeforeInput","beforeinput",null,n,a),s.push({event:b,listeners:S}),b.data=w)),function(e,t,n,r,a){if("submit"===t&&n&&n.stateNode===a){var i=qu((a[ze]||null).action),s=r.submitter;s&&null!==(t=(t=s[ze]||null)?qu(t.formAction):s.getAttribute("formAction"))&&(i=t,s=null);var o=new nn("action","action",null,r,a);e.push({event:o,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==Mu){var e=s?Wu(a,s):new FormData(a);eo(n,{pending:!0,data:e,method:a.method,action:i},null,e)}}else"function"===typeof i&&(o.preventDefault(),e=s?Wu(a,s):new FormData(a),eo(n,{pending:!0,data:e,method:a.method,action:i},i,e))},currentTarget:a}]})}}(s,e,r,n,a)}$u(s,t)})}function nd(e,t,n){return{instance:e,listener:t,currentTarget:n}}function rd(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;if(5!==(a=a.tag)&&26!==a&&27!==a||null===i||(null!=(a=Bt(e,n))&&r.unshift(nd(e,a,i)),null!=(a=Bt(e,t))&&r.push(nd(e,a,i))),3===e.tag)return r;e=e.return}return[]}function ad(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function id(e,t,n,r,a){for(var i=t._reactName,s=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(o=o.tag,null!==l&&l===r)break;5!==o&&26!==o&&27!==o||null===c||(l=c,a?null!=(c=Bt(n,i))&&s.unshift(nd(n,c,l)):a||null!=(c=Bt(n,i))&&s.push(nd(n,c,l))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var sd=/\r\n?/g,od=/\u0000|\uFFFD/g;function ld(e){return("string"===typeof e?e:""+e).replace(sd,"\n").replace(od,"")}function cd(e,t){return t=ld(t),ld(e)===t}function ud(e,t,n,r,a,i){switch(n){case"children":"string"===typeof r?"body"===t||"textarea"===t&&""===r||xt(e,r):("number"===typeof r||"bigint"===typeof r)&&"body"!==t&&xt(e,""+r);break;case"className":ct(e,"class",r);break;case"tabIndex":ct(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":ct(e,n,r);break;case"style":Et(e,r,i);break;case"data":if("object"!==t){ct(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==r||"function"===typeof r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=_t(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if("function"===typeof r){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof i&&("formAction"===n?("input"!==t&&ud(e,t,"name",a.name,a,null),ud(e,t,"formEncType",a.formEncType,a,null),ud(e,t,"formMethod",a.formMethod,a,null),ud(e,t,"formTarget",a.formTarget,a,null)):(ud(e,t,"encType",a.encType,a,null),ud(e,t,"method",a.method,a,null),ud(e,t,"target",a.target,a,null))),null==r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=_t(""+r),e.setAttribute(n,r);break;case"onClick":null!=r&&(e.onclick=Ot);break;case"onScroll":null!=r&&Qu("scroll",e);break;case"onScrollEnd":null!=r&&Qu("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(s(61));if(null!=(n=r.__html)){if(null!=a.children)throw Error(s(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"muted":e.muted=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"===typeof r||"boolean"===typeof r||"symbol"===typeof r){e.removeAttribute("xlink:href");break}n=_t(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===r?e.setAttribute(n,""):!1!==r&&null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":null==r||"function"===typeof r||"symbol"===typeof r||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":Qu("beforetoggle",e),Qu("toggle",e),lt(e,"popover",r);break;case"xlinkActuate":ut(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":ut(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":ut(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":ut(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":ut(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":ut(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":ut(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":ut(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":ut(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":lt(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&lt(e,n=Nt.get(n)||n,r)}}function dd(e,t,n,r,a,i){switch(n){case"style":Et(e,r,i);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(s(61));if(null!=(n=r.__html)){if(null!=a.children)throw Error(s(60));e.innerHTML=n}}break;case"children":"string"===typeof r?xt(e,r):("number"===typeof r||"bigint"===typeof r)&&xt(e,""+r);break;case"onScroll":null!=r&&Qu("scroll",e);break;case"onScrollEnd":null!=r&&Qu("scrollend",e);break;case"onClick":null!=r&&(e.onclick=Ot);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:nt.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(a=n.endsWith("Capture"),t=n.slice(2,a?n.length-7:void 0),"function"===typeof(i=null!=(i=e[ze]||null)?i[n]:null)&&e.removeEventListener(t,i,a),"function"!==typeof r)?n in e?e[n]=r:!0===r?e.setAttribute(n,""):lt(e,n,r):("function"!==typeof i&&null!==i&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,a)))}}function hd(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Qu("error",e),Qu("load",e);var r,a=!1,i=!1;for(r in n)if(n.hasOwnProperty(r)){var o=n[r];if(null!=o)switch(r){case"src":a=!0;break;case"srcSet":i=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:ud(e,t,r,o,n,null)}}return i&&ud(e,t,"srcSet",n.srcSet,n,null),void(a&&ud(e,t,"src",n.src,n,null));case"input":Qu("invalid",e);var l=r=o=i=null,c=null,u=null;for(a in n)if(n.hasOwnProperty(a)){var d=n[a];if(null!=d)switch(a){case"name":i=d;break;case"type":o=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":r=d;break;case"defaultValue":l=d;break;case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(s(137,t));break;default:ud(e,t,a,d,n,null)}}return void bt(e,r,l,c,u,o,i,!1);case"select":for(i in Qu("invalid",e),a=o=r=null,n)if(n.hasOwnProperty(i)&&null!=(l=n[i]))switch(i){case"value":r=l;break;case"defaultValue":o=l;break;case"multiple":a=l;default:ud(e,t,i,l,n,null)}return t=r,n=o,e.multiple=!!a,void(null!=t?St(e,!!a,t,!1):null!=n&&St(e,!!a,n,!0));case"textarea":for(o in Qu("invalid",e),r=i=a=null,n)if(n.hasOwnProperty(o)&&null!=(l=n[o]))switch(o){case"value":a=l;break;case"defaultValue":i=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(s(91));break;default:ud(e,t,o,l,n,null)}return void At(e,a,i,r);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(a=n[c]))if("selected"===c)e.selected=a&&"function"!==typeof a&&"symbol"!==typeof a;else ud(e,t,c,a,n,null);return;case"dialog":Qu("beforetoggle",e),Qu("toggle",e),Qu("cancel",e),Qu("close",e);break;case"iframe":case"object":Qu("load",e);break;case"video":case"audio":for(a=0;a<Gu.length;a++)Qu(Gu[a],e);break;case"image":Qu("error",e),Qu("load",e);break;case"details":Qu("toggle",e);break;case"embed":case"source":case"link":Qu("error",e),Qu("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(a=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:ud(e,t,u,a,n,null)}return;default:if(It(t)){for(d in n)n.hasOwnProperty(d)&&(void 0!==(a=n[d])&&dd(e,t,d,a,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(a=n[l])&&ud(e,t,l,a,n,null))}function fd(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}var md=null,gd=null;function pd(e){return 9===e.nodeType?e:e.ownerDocument}function vd(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function yd(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function bd(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var wd=null;var Sd="function"===typeof setTimeout?setTimeout:void 0,Td="function"===typeof clearTimeout?clearTimeout:void 0,Ad="function"===typeof Promise?Promise:void 0,xd="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof Ad?function(e){return Ad.resolve(null).then(e).catch(kd)}:Sd;function kd(e){setTimeout(function(){throw e})}function Cd(e){return"head"===e}function Ed(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)||"/&"===n){if(0===r)return e.removeChild(a),void Wh(t);r--}else if("$"===n||"$?"===n||"$~"===n||"$!"===n||"&"===n)r++;else if("html"===n)jd(e.ownerDocument.documentElement);else if("head"===n){jd(n=e.ownerDocument.head);for(var i=n.firstChild;i;){var s=i.nextSibling,o=i.nodeName;i[Ye]||"SCRIPT"===o||"STYLE"===o||"LINK"===o&&"stylesheet"===i.rel.toLowerCase()||n.removeChild(i),i=s}}else"body"===n&&jd(e.ownerDocument.body);n=a}while(n);Wh(t)}function Id(e,t){var n=e;e=0;do{var r=n.nextSibling;if(1===n.nodeType?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",""===n.getAttribute("style")&&n.removeAttribute("style")):3===n.nodeType&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===e)break;e--}else"$"!==n&&"$?"!==n&&"$~"!==n&&"$!"!==n||e++;n=r}while(n)}function Nd(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Nd(n),$e(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function Pd(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=Rd(e.nextSibling)))return null}return e}function _d(e){return"$?"===e.data||"$~"===e.data}function Od(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function Rd(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var Md=null;function Dd(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n||"/&"===n){if(0===t)return Rd(e.nextSibling);t--}else"$"!==n&&"$!"!==n&&"$?"!==n&&"$~"!==n&&"&"!==n||t++}e=e.nextSibling}return null}function Ld(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n||"$~"===n||"&"===n){if(0===t)return e;t--}else"/$"!==n&&"/&"!==n||t++}e=e.previousSibling}return null}function Fd(e,t,n){switch(t=pd(n),e){case"html":if(!(e=t.documentElement))throw Error(s(452));return e;case"head":if(!(e=t.head))throw Error(s(453));return e;case"body":if(!(e=t.body))throw Error(s(454));return e;default:throw Error(s(451))}}function jd(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);$e(e)}var Ud=new Map,Bd=new Set;function Hd(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var zd=D.d;D.d={f:function(){var e=zd.f(),t=Zc();return e||t},r:function(e){var t=Je(e);null!==t&&5===t.tag&&"form"===t.type?no(t):zd.r(e)},D:function(e){zd.D(e),Wd("dns-prefetch",e,null)},C:function(e,t){zd.C(e,t),Wd("preconnect",e,t)},L:function(e,t,n){zd.L(e,t,n);var r=qd;if(r&&e&&t){var a='link[rel="preload"][as="'+vt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(a+='[imagesrcset="'+vt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(a+='[imagesizes="'+vt(n.imageSizes)+'"]')):a+='[href="'+vt(e)+'"]';var i=a;switch(t){case"style":i=Kd(e);break;case"script":i=$d(e)}Ud.has(i)||(e=f({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Ud.set(i,e),null!==r.querySelector(a)||"style"===t&&r.querySelector(Gd(i))||"script"===t&&r.querySelector(Qd(i))||(hd(t=r.createElement("link"),"link",e),et(t),r.head.appendChild(t)))}},m:function(e,t){zd.m(e,t);var n=qd;if(n&&e){var r=t&&"string"===typeof t.as?t.as:"script",a='link[rel="modulepreload"][as="'+vt(r)+'"][href="'+vt(e)+'"]',i=a;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":i=$d(e)}if(!Ud.has(i)&&(e=f({rel:"modulepreload",href:e},t),Ud.set(i,e),null===n.querySelector(a))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Qd(i)))return}hd(r=n.createElement("link"),"link",e),et(r),n.head.appendChild(r)}}},X:function(e,t){zd.X(e,t);var n=qd;if(n&&e){var r=Ze(n).hoistableScripts,a=$d(e),i=r.get(a);i||((i=n.querySelector(Qd(a)))||(e=f({src:e,async:!0},t),(t=Ud.get(a))&&eh(e,t),et(i=n.createElement("script")),hd(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},r.set(a,i))}},S:function(e,t,n){zd.S(e,t,n);var r=qd;if(r&&e){var a=Ze(r).hoistableStyles,i=Kd(e);t=t||"default";var s=a.get(i);if(!s){var o={loading:0,preload:null};if(s=r.querySelector(Gd(i)))o.loading=5;else{e=f({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Ud.get(i))&&Zd(e,n);var l=s=r.createElement("link");et(l),hd(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){o.loading|=1}),l.addEventListener("error",function(){o.loading|=2}),o.loading|=4,Xd(s,t,r)}s={type:"stylesheet",instance:s,count:1,state:o},a.set(i,s)}}},M:function(e,t){zd.M(e,t);var n=qd;if(n&&e){var r=Ze(n).hoistableScripts,a=$d(e),i=r.get(a);i||((i=n.querySelector(Qd(a)))||(e=f({src:e,async:!0,type:"module"},t),(t=Ud.get(a))&&eh(e,t),et(i=n.createElement("script")),hd(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},r.set(a,i))}}};var qd="undefined"===typeof document?null:document;function Wd(e,t,n){var r=qd;if(r&&"string"===typeof t&&t){var a=vt(t);a='link[rel="'+e+'"][href="'+a+'"]',"string"===typeof n&&(a+='[crossorigin="'+n+'"]'),Bd.has(a)||(Bd.add(a),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(a)&&(hd(t=r.createElement("link"),"link",e),et(t),r.head.appendChild(t)))}}function Vd(e,t,n,r){var a,i,o,l,c=(c=K.current)?Hd(c):null;if(!c)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=Kd(n.href),(r=(n=Ze(c).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=Kd(n.href);var u=Ze(c).hoistableStyles,d=u.get(e);if(d||(c=c.ownerDocument||c,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,d),(u=c.querySelector(Gd(e)))&&!u._p&&(d.instance=u,d.state.loading=5),Ud.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Ud.set(e,n),u||(a=c,i=e,o=n,l=d.state,a.querySelector('link[rel="preload"][as="style"]['+i+"]")?l.loading=1:(i=a.createElement("link"),l.preload=i,i.addEventListener("load",function(){return l.loading|=1}),i.addEventListener("error",function(){return l.loading|=2}),hd(i,"link",o),et(i),a.head.appendChild(i))))),t&&null===r)throw Error(s(528,""));return d}if(t&&null!==r)throw Error(s(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=$d(n),(r=(n=Ze(c).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function Kd(e){return'href="'+vt(e)+'"'}function Gd(e){return'link[rel="stylesheet"]['+e+"]"}function Yd(e){return f({},e,{"data-precedence":e.precedence,precedence:null})}function $d(e){return'[src="'+vt(e)+'"]'}function Qd(e){return"script[async]"+e}function Jd(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+vt(n.href)+'"]');if(r)return t.instance=r,et(r),r;var a=f({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return et(r=(e.ownerDocument||e).createElement("style")),hd(r,"style",a),Xd(r,n.precedence,e),t.instance=r;case"stylesheet":a=Kd(n.href);var i=e.querySelector(Gd(a));if(i)return t.state.loading|=4,t.instance=i,et(i),i;r=Yd(n),(a=Ud.get(a))&&Zd(r,a),et(i=(e.ownerDocument||e).createElement("link"));var o=i;return o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),hd(i,"link",r),t.state.loading|=4,Xd(i,n.precedence,e),t.instance=i;case"script":return i=$d(n.src),(a=e.querySelector(Qd(i)))?(t.instance=a,et(a),a):(r=n,(a=Ud.get(i))&&eh(r=f({},n),a),et(a=(e=e.ownerDocument||e).createElement("script")),hd(a,"link",r),e.head.appendChild(a),t.instance=a);case"void":return null;default:throw Error(s(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,Xd(r,n.precedence,e));return t.instance}function Xd(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),a=r.length?r[r.length-1]:null,i=a,s=0;s<r.length;s++){var o=r[s];if(o.dataset.precedence===t)i=o;else if(i!==a)break}i?i.parentNode.insertBefore(e,i.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Zd(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function eh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var th=null;function nh(e,t,n){if(null===th){var r=new Map,a=th=new Map;a.set(n,r)}else(r=(a=th).get(n))||(r=new Map,a.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),a=0;a<n.length;a++){var i=n[a];if(!(i[Ye]||i[He]||"link"===e&&"stylesheet"===i.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==i.namespaceURI){var s=i.getAttribute(t)||"";s=e+s;var o=r.get(s);o?o.push(i):r.set(s,[i])}}return r}function rh(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function ah(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var ih=0;function sh(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)lh(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var oh=null;function lh(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,oh=new Map,t.forEach(ch,e),oh=null,sh.call(e))}function ch(e,t){if(!(4&t.state.loading)){var n=oh.get(e);if(n)var r=n.get(null);else{n=new Map,oh.set(e,n);for(var a=e.querySelectorAll("link[data-precedence],style[data-precedence]"),i=0;i<a.length;i++){var s=a[i];"LINK"!==s.nodeName&&"not all"===s.getAttribute("media")||(n.set(s.dataset.precedence,s),r=s)}r&&n.set(null,r)}s=(a=t.instance).getAttribute("data-precedence"),(i=n.get(s)||r)===r&&n.set(null,a),n.set(s,a),this.count++,r=sh.bind(this),a.addEventListener("load",r),a.addEventListener("error",r),i?i.parentNode.insertBefore(a,i.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(a,e.firstChild),t.state.loading|=4}}var uh={$$typeof:S,Provider:null,Consumer:null,_currentValue:L,_currentValue2:L,_threadCount:0};function dh(e,t,n,r,a,i,s,o,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=_e(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_e(0),this.hiddenUpdates=_e(null),this.identifierPrefix=r,this.onUncaughtError=a,this.onCaughtError=i,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function hh(e,t,n,r,a,i,s,o,l,c,u,d){return e=new dh(e,t,n,s,l,c,u,d,o),t=1,!0===i&&(t|=24),i=jr(3,null,null,t),e.current=i,i.stateNode=e,(t=Ua()).refCount++,e.pooledCache=t,t.refCount++,i.memoizedState={element:r,isDehydrated:n,cache:t},pi(i),e}function fh(e){return e?e=Lr:Lr}function mh(e,t,n,r,a,i){a=fh(a),null===r.context?r.context=a:r.pendingContext=a,(r=yi(t)).payload={element:n},null!==(i=void 0===i?null:i)&&(r.callback=i),null!==(n=bi(e,r,t))&&(Yc(n,0,t),wi(n,e,t))}function gh(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function ph(e,t){gh(e,t),(e=e.alternate)&&gh(e,t)}function vh(e){if(13===e.tag||31===e.tag){var t=Rr(e,67108864);null!==t&&Yc(t,0,67108864),ph(e,67108864)}}function yh(e){if(13===e.tag||31===e.tag){var t=Kc(),n=Rr(e,t=Le(t));null!==n&&Yc(n,0,t),ph(e,t)}}var bh=!0;function wh(e,t,n,r){var a=M.T;M.T=null;var i=D.p;try{D.p=2,Th(e,t,n,r)}finally{D.p=i,M.T=a}}function Sh(e,t,n,r){var a=M.T;M.T=null;var i=D.p;try{D.p=8,Th(e,t,n,r)}finally{D.p=i,M.T=a}}function Th(e,t,n,r){if(bh){var a=Ah(r);if(null===a)td(e,t,r,xh,n),Dh(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return Ih=Lh(Ih,e,t,n,r,a),!0;case"dragenter":return Nh=Lh(Nh,e,t,n,r,a),!0;case"mouseover":return Ph=Lh(Ph,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return _h.set(i,Lh(_h.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Oh.set(i,Lh(Oh.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Dh(e,r),4&t&&-1<Mh.indexOf(e)){for(;null!==a;){var i=Je(a);if(null!==i)switch(i.tag){case 3:if((i=i.stateNode).current.memoizedState.isDehydrated){var s=Ce(i.pendingLanes);if(0!==s){var o=i;for(o.pendingLanes|=2,o.entangledLanes|=2;s;){var l=1<<31-we(s);o.entanglements[1]|=l,s&=~l}Du(i),0===(6&fc)&&(Mc=le()+500,Lu(0,!1))}}break;case 31:case 13:null!==(o=Rr(i,2))&&Yc(o,0,2),Zc(),ph(i,2)}if(null===(i=Ah(r))&&td(e,t,r,xh,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else td(e,t,r,null,n)}}function Ah(e){return kh(e=Mt(e))}var xh=null;function kh(e){if(xh=null,null!==(e=Qe(e))){var t=l(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=c(t)))return e;e=null}else if(31===n){if(null!==(e=u(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return xh=e,null}function Ch(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ce()){case ue:return 2;case de:return 8;case he:case fe:return 32;case me:return 268435456;default:return 32}default:return 32}}var Eh=!1,Ih=null,Nh=null,Ph=null,_h=new Map,Oh=new Map,Rh=[],Mh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Dh(e,t){switch(e){case"focusin":case"focusout":Ih=null;break;case"dragenter":case"dragleave":Nh=null;break;case"mouseover":case"mouseout":Ph=null;break;case"pointerover":case"pointerout":_h.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Oh.delete(t.pointerId)}}function Lh(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=Je(t))&&vh(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Fh(e){var t=Qe(e.target);if(null!==t){var n=l(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=c(n)))return e.blockedOn=t,void Ue(e.priority,function(){yh(n)})}else if(31===t){if(null!==(t=u(n)))return e.blockedOn=t,void Ue(e.priority,function(){yh(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function jh(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Ah(e.nativeEvent);if(null!==n)return null!==(t=Je(n))&&vh(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);Rt=r,n.target.dispatchEvent(r),Rt=null,t.shift()}return!0}function Uh(e,t,n){jh(e)&&n.delete(t)}function Bh(){Eh=!1,null!==Ih&&jh(Ih)&&(Ih=null),null!==Nh&&jh(Nh)&&(Nh=null),null!==Ph&&jh(Ph)&&(Ph=null),_h.forEach(Uh),Oh.forEach(Uh)}function Hh(e,t){e.blockedOn===t&&(e.blockedOn=null,Eh||(Eh=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Bh)))}var zh=null;function qh(e){zh!==e&&(zh=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){zh===e&&(zh=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],a=e[t+2];if("function"!==typeof r){if(null===kh(r||n))continue;break}var i=Je(n);null!==i&&(e.splice(t,3),t-=3,eo(i,{pending:!0,data:a,method:n.method,action:r},r,a))}}))}function Wh(e){function t(t){return Hh(t,e)}null!==Ih&&Hh(Ih,e),null!==Nh&&Hh(Nh,e),null!==Ph&&Hh(Ph,e),_h.forEach(t),Oh.forEach(t);for(var n=0;n<Rh.length;n++){var r=Rh[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<Rh.length&&null===(n=Rh[0]).blockedOn;)Fh(n),null===n.blockedOn&&Rh.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var a=n[r],i=n[r+1],s=a[ze]||null;if("function"===typeof i)s||qh(n);else if(s){var o=null;if(i&&i.hasAttribute("formAction")){if(a=i,s=i[ze]||null)o=s.formAction;else if(null!==kh(a))continue}else o=s.action;"function"===typeof o?n[r+1]=o:(n.splice(r,3),r-=3),qh(n)}}}function Vh(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return a=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==a&&(a(),a=null),r||setTimeout(n,20)}function n(){if(!r&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"===typeof navigation){var r=!1,a=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){r=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==a&&(a(),a=null)}}}function Kh(e){this._internalRoot=e}function Gh(e){this._internalRoot=e}Gh.prototype.render=Kh.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));mh(t.current,Kc(),e,t,null,null)},Gh.prototype.unmount=Kh.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;mh(e.current,2,null,e,null,null),Zc(),t[qe]=null}},Gh.prototype.unstable_scheduleHydration=function(e){if(e){var t=je();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Rh.length&&0!==t&&t<Rh[n].priority;n++);Rh.splice(n,0,e),0===n&&Fh(e)}};var Yh=a.version;if("19.2.0"!==Yh)throw Error(s(527,Yh,"19.2.0"));D.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var i=a.alternate;if(null===i){if(null!==(r=a.return)){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return d(a),e;if(i===r)return d(a),t;i=i.sibling}throw Error(s(188))}if(n.return!==r.return)n=a,r=i;else{for(var o=!1,c=a.child;c;){if(c===n){o=!0,n=a,r=i;break}if(c===r){o=!0,r=a,n=i;break}c=c.sibling}if(!o){for(c=i.child;c;){if(c===n){o=!0,n=i,r=a;break}if(c===r){o=!0,r=i,n=a;break}c=c.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?h(e):null)?null:e.stateNode};var $h={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:M,reconcilerVersion:"19.2.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Qh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qh.isDisabled&&Qh.supportsFiber)try{ve=Qh.inject($h),ye=Qh}catch(Xh){}}t.createRoot=function(e,t){if(!o(e))throw Error(s(299));var n=!1,r="",a=xo,i=ko,l=Co;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(a=t.onUncaughtError),void 0!==t.onCaughtError&&(i=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError)),t=hh(e,1,!1,null,0,n,r,null,a,i,l,Vh),e[qe]=t.current,Zu(e),new Kh(t)},t.hydrateRoot=function(e,t,n){if(!o(e))throw Error(s(299));var r=!1,a="",i=xo,l=ko,c=Co,u=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onUncaughtError&&(i=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.formState&&(u=n.formState)),(t=hh(e,1,!0,t,0,r,a,u,i,l,c,Vh)).context=fh(null),n=t.current,(a=yi(r=Le(r=Kc()))).callback=null,bi(n,a,r),n=r,t.current.lanes=n,Oe(t,n),Du(t),e[qe]=t.current,Zu(e),new Gh(t)},t.version="19.2.0"},119:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(863)},340:(e,t,n)=>{e.exports=n(487)},352:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(85)},414:(e,t,n)=>{e.exports=n(916)},487:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,s=a>>>1;r<s;){var o=2*(r+1)-1,l=e[o],c=o+1,u=e[c];if(0>i(l,n))c<a&&0>i(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<a&&0>i(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,f=3,m=!1,g=!1,p=!1,v=!1,y="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,w="undefined"!==typeof setImmediate?setImmediate:null;function S(e){for(var t=r(u);null!==t;){if(null===t.callback)a(u);else{if(!(t.startTime<=e))break;a(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function T(e){if(p=!1,S(e),!g)if(null!==r(c))g=!0,x||(x=!0,A());else{var t=r(u);null!==t&&O(T,t.startTime-e)}}var A,x=!1,k=-1,C=5,E=-1;function I(){return!!v||!(t.unstable_now()-E<C)}function N(){if(v=!1,x){var e=t.unstable_now();E=e;var n=!0;try{e:{g=!1,p&&(p=!1,b(k),k=-1),m=!0;var i=f;try{t:{for(S(e),h=r(c);null!==h&&!(h.expirationTime>e&&I());){var s=h.callback;if("function"===typeof s){h.callback=null,f=h.priorityLevel;var o=s(h.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof o){h.callback=o,S(e),n=!0;break t}h===r(c)&&a(c),S(e)}else a(c);h=r(c)}if(null!==h)n=!0;else{var l=r(u);null!==l&&O(T,l.startTime-e),n=!1}}break e}finally{h=null,f=i,m=!1}n=void 0}}finally{n?A():x=!1}}}if("function"===typeof w)A=function(){w(N)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,_=P.port2;P.port1.onmessage=N,A=function(){_.postMessage(null)}}else A=function(){y(N,0)};function O(e,n){k=y(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_requestPaint=function(){v=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,a,i){var s=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?s+i:s:i=s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:a,priorityLevel:e,startTime:i,expirationTime:o=i+o,sortIndex:-1},i>s?(e.sortIndex=i,n(u,e),null===r(c)&&e===r(u)&&(p?(b(k),k=-1):p=!0,O(T,i-s))):(e.sortIndex=o,n(c,e),g||m||(g=!0,x||(x=!0,A()))),e},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},863:(e,t,n)=>{var r=n(950);function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var s={d:{f:i,r:function(){throw Error(a(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},o=Symbol.for("react.portal");var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(a(299));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:o,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=l.T,n=s.p;try{if(l.T=null,s.p=2,e)return e()}finally{l.T=t,s.p=n,s.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,s.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&s.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin),a="string"===typeof t.integrity?t.integrity:void 0,i="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?s.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:a,fetchPriority:i}):"script"===n&&s.d.X(e,{crossOrigin:r,integrity:a,fetchPriority:i,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=c(t.as,t.crossOrigin);s.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&s.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin);s.d.L(e,n,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=c(t.as,t.crossOrigin);s.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else s.d.m(e)},t.requestFormReset=function(e){s.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return l.H.useFormState(e,t,n)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.2.0"},916:(e,t)=>{var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function a(e,t,r){var a=null;if(void 0!==r&&(a=""+r),void 0!==t.key&&(a=""+t.key),"key"in t)for(var i in r={},t)"key"!==i&&(r[i]=t[i]);else r=t;return t=r.ref,{$$typeof:n,type:e,key:a,ref:void 0!==t?t:null,props:r}}t.Fragment=r,t.jsx=a,t.jsxs=a},950:(e,t,n)=>{e.exports=n(983)},983:(e,t)=>{var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.for("react.activity"),m=Symbol.iterator;var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,v={};function y(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||g}function b(){}function w(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||g}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=y.prototype;var S=w.prototype=new b;S.constructor=w,p(S,y.prototype),S.isPureReactComponent=!0;var T=Array.isArray;function A(){}var x={H:null,A:null,T:null,S:null},k=Object.prototype.hasOwnProperty;function C(e,t,r){var a=r.ref;return{$$typeof:n,type:e,key:t,ref:void 0!==a?a:null,props:r}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var I=/\/+/g;function N(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function P(e,t,a,i,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(o){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0;break;case h:return P((u=e._init)(e._payload),t,a,i,s)}}if(u)return s=s(e),u=""===i?"."+N(e,0):i,T(s)?(a="",null!=u&&(a=u.replace(I,"$&/")+"/"),P(s,t,a,"",function(e){return e})):null!=s&&(E(s)&&(l=s,c=a+(null==s.key||e&&e.key===s.key?"":(""+s.key).replace(I,"$&/")+"/")+u,s=C(l.type,c,l.props)),t.push(s)),1;u=0;var d,f=""===i?".":i+":";if(T(e))for(var g=0;g<e.length;g++)u+=P(i=e[g],t,a,o=f+N(i,g),s);else if("function"===typeof(g=null===(d=e)||"object"!==typeof d?null:"function"===typeof(d=m&&d[m]||d["@@iterator"])?d:null))for(e=g.call(e),g=0;!(i=e.next()).done;)u+=P(i=i.value,t,a,o=f+N(i,g++),s);else if("object"===o){if("function"===typeof e.then)return P(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(A,A):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,a,i,s);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function _(e,t,n){if(null==e)return e;var r=[],a=0;return P(e,r,"","",function(e){return t.call(n,e,a++)}),r}function O(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},M={map:_,forEach:function(e,t,n){_(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return _(e,function(){t++}),t},toArray:function(e){return _(e,function(e){return e})||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};t.Activity=f,t.Children=M,t.Component=y,t.Fragment=a,t.Profiler=s,t.PureComponent=w,t.StrictMode=i,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=x,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return x.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cacheSignal=function(){return null},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=p({},e.props),a=e.key;if(null!=t)for(i in void 0!==t.key&&(a=""+t.key),t)!k.call(t,i)||"key"===i||"__self"===i||"__source"===i||"ref"===i&&void 0===t.ref||(r[i]=t[i]);var i=arguments.length-2;if(1===i)r.children=n;else if(1<i){for(var s=Array(i),o=0;o<i;o++)s[o]=arguments[o+2];r.children=s}return C(e.type,a,r)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:o,_context:e},e},t.createElement=function(e,t,n){var r,a={},i=null;if(null!=t)for(r in void 0!==t.key&&(i=""+t.key),t)k.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(a[r]=t[r]);var s=arguments.length-2;if(1===s)a.children=n;else if(1<s){for(var o=Array(s),l=0;l<s;l++)o[l]=arguments[l+2];a.children=o}if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===a[r]&&(a[r]=s[r]);return C(e,i,a)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:O}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=x.T,n={};x.T=n;try{var r=e(),a=x.S;null!==a&&a(n,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(A,R)}catch(i){R(i)}finally{null!==t&&null!==n.types&&(t.types=n.types),x.T=t}},t.unstable_useCacheRefresh=function(){return x.H.useCacheRefresh()},t.use=function(e){return x.H.use(e)},t.useActionState=function(e,t,n){return x.H.useActionState(e,t,n)},t.useCallback=function(e,t){return x.H.useCallback(e,t)},t.useContext=function(e){return x.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return x.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return x.H.useEffect(e,t)},t.useEffectEvent=function(e){return x.H.useEffectEvent(e)},t.useId=function(){return x.H.useId()},t.useImperativeHandle=function(e,t,n){return x.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return x.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return x.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return x.H.useMemo(e,t)},t.useOptimistic=function(e,t){return x.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return x.H.useReducer(e,t,n)},t.useRef=function(e){return x.H.useRef(e)},t.useState=function(e){return x.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return x.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return x.H.useTransition()},t.version="19.2.0"}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,r)=>(n.f[r](e,t),t),[])),n.u=e=>"static/js/"+e+".2765b8c2.chunk.js",n.miniCssF=e=>{},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="evoke-schedule:";n.l=(r,a,i,s)=>{if(e[r])e[r].push(a);else{var o,l;if(void 0!==i)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+i){o=d;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+i),o.src=r),e[r]=[a];var h=(t,n)=>{o.onerror=o.onload=null,clearTimeout(f);var a=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach(e=>e(n)),t)return t(n)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),n.p="/",(()=>{var e={792:0};n.f.j=(t,r)=>{var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)r.push(a[2]);else{var i=new Promise((n,r)=>a=e[t]=[n,r]);r.push(a[2]=i);var s=n.p+n.u(t),o=new Error;n.l(s,r=>{if(n.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=r&&("load"===r.type?"missing":r.type),s=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+s+")",o.name="ChunkLoadError",o.type=i,o.request=s,a[1](o)}},"chunk-"+t,t)}};var t=(t,r)=>{var a,i,s=r[0],o=r[1],l=r[2],c=0;if(s.some(t=>0!==e[t])){for(a in o)n.o(o,a)&&(n.m[a]=o[a]);if(l)l(n)}for(t&&t(r);c<s.length;c++)i=s[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0},r=self.webpackChunkevoke_schedule=self.webpackChunkevoke_schedule||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=n(950),a=n(352);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function s(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:t+""}function o(e,t,n){return(t=s(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function u(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}const d=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},h=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim()};var f={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const m=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],g=(0,r.forwardRef)((e,t)=>{let{color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:s,className:o="",children:l,iconNode:d}=e,g=u(e,m);return(0,r.createElement)("svg",c(c(c({ref:t},f),{},{width:a,height:a,stroke:n,strokeWidth:s?24*Number(i)/Number(a):i,className:h("lucide",o)},!l&&!(e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(g)&&{"aria-hidden":"true"}),g),[...d.map(e=>{let[t,n]=e;return(0,r.createElement)(t,n)}),...Array.isArray(l)?l:[l]])}),p=["className"],v=(e,t)=>{const n=(0,r.forwardRef)((n,a)=>{let{className:i}=n,s=u(n,p);return(0,r.createElement)(g,c({ref:a,iconNode:t,className:h("lucide-".concat((o=d(e),o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase())),"lucide-".concat(e),i)},s));var o});return n.displayName=d(e),n},y=v("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),b=v("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),w=v("log-in",[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]]),S=v("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),T=v("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),A=v("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),x=v("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),k=v("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),C=v("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),E=v("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),I=v("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),N=v("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),P=v("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),_=v("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),O=v("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),R=v("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),M={RBT:{level:1,name:"RBT"},BS:{level:2,name:"Behavior Specialist"},BCBA:{level:3,name:"BCBA"},EA:{level:4,name:"Educational Assistant"},MHA:{level:5,name:"Mental Health Assistant"},CC:{level:6,name:"Clinical Coordinator"},Trainer:{level:7,name:"Trainer"},Teacher:{level:8,name:"Teacher"},Director:{level:9,name:"Director"}},D=M,L={PRIMARY:"Primary",SECONDARY:"Secondary"},F={PRIMARY:{AM:{start:"8:45",end:"11:30"},PM:{start:"12:00",end:"15:00"}},SECONDARY:{AM:{start:"8:45",end:"12:00"},PM:{start:"12:30",end:"15:00"}}},j={ONE_TO_ONE:"1:1",TWO_TO_ONE:"2:1",ONE_TO_TWO:"1:2"};class U{constructor(e){let{id:t,listItemId:n=null,name:r,role:a,email:i="",userId:s=null,staffPerson:o=null,primaryProgram:l=!1,secondaryProgram:c=!1,isActive:u=!0,absentAM:d=!1,absentPM:h=!1,absentFullDay:f=!1,outOfSessionAM:m=!1,outOfSessionPM:g=!1,outOfSessionFullDay:p=!1}=e;this.id=t,this.listItemId=n,this.name=r,this.role=a,this.email=i,this.userId=s,this.staffPerson=o,"string"===typeof l?(this.primaryProgram=!0,this.primaryProgramType=l):(this.primaryProgram=l,this.primaryProgramType=l?L.PRIMARY:null),"string"===typeof c?(this.secondaryProgram=!0,this.secondaryProgramType=c):(this.secondaryProgram=c,this.secondaryProgramType=c?L.SECONDARY:null),this.isActive=u,this.absentFullDay=f,this.absentAM=!!f||d,this.absentPM=!!f||h,this.outOfSessionFullDay=p,this.outOfSessionAM=!!p||m,this.outOfSessionPM=!!p||g}getRoleLevel(){var e;return(null===(e=M[this.role])||void 0===e?void 0:e.level)||0}canWorkProgram(e){return e===L.PRIMARY||"Primary"===e?this.primaryProgram:(e===L.SECONDARY||"Secondary"===e)&&this.secondaryProgram}canDo1To1Sessions(){return!["Teacher","Trainer","Director","BCBA"].includes(this.role)}canDoDirectSessions(){return["RBT","BS","Behavior Specialist","Senior RBT"].includes(this.role)}isAvailableForSession(e){return!!this.isActive&&(!this.absentFullDay&&!this.outOfSessionFullDay&&("AM"===e?!this.absentAM&&!this.outOfSessionAM:"PM"!==e||!this.absentPM&&!this.outOfSessionPM))}getAttendanceStatus(){return this.absentFullDay||this.absentAM&&this.absentPM?"Absent Full Day":this.absentAM?"Absent AM":this.absentPM?"Absent PM":this.outOfSessionFullDay||this.outOfSessionAM&&this.outOfSessionPM?"Out Full Day":this.outOfSessionAM?"Out AM":this.outOfSessionPM?"Out PM":"Present"}isPreferredDirectService(){return["RBT","BS","Behavior Specialist","Senior RBT"].includes(this.role)}}const B="certified",H="overlap-bcba",z="overlap-staff",q="trainer",W="solo";class V{constructor(e){let{id:t,name:n,program:r,ratio:a,ratioAM:i=j.ONE_TO_ONE,ratioPM:s=j.ONE_TO_ONE,isActive:o=!0,team:l=[],teamIds:c=[],pairedWith:u=null,absentAM:d=!1,absentPM:h=!1,absentFullDay:f=!1,teamTrainingStatus:m={}}=e;this.id=t,this.name=n,this.program=r,a?(this.ratioAM=a,this.ratioPM=a,this.ratio=a):(this.ratioAM=i,this.ratioPM=s,this.ratio=i),this.isActive=o,this.team=l,this.teamIds=c.length>0?c:l.map(e=>e.id).filter(Boolean),this.pairedWith=u,this.absentFullDay=f,this.absentAM=!!f||d,this.absentPM=!!f||h,this.teamTrainingStatus=m||{}}requiresMultipleStaff(){return("AM"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"AM")?this.ratioAM:this.ratioPM)===j.TWO_TO_ONE}getSessionRatio(e){return"AM"===e?this.ratioAM:this.ratioPM}isSmallGroup(){return("AM"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"AM")?this.ratioAM:this.ratioPM)===j.ONE_TO_TWO}isAvailableForSession(e){return!!this.isActive&&(!this.absentFullDay&&("AM"===e?!this.absentAM:"PM"!==e||!this.absentPM))}getAttendanceStatus(){return this.absentFullDay||this.absentAM&&this.absentPM?"Absent Full Day":this.absentAM?"Absent AM":this.absentPM?"Absent PM":"Present"}isPaired(){return null!==this.pairedWith&&void 0!==this.pairedWith}getPairedStudent(e){if(!this.isPaired())return null;return e.find(e=>e.id==this.pairedWith||e.id===this.pairedWith)||null}getStaffTrainingStatus(e){return this.teamTrainingStatus[e]||W}setStaffTrainingStatus(e,t){this.teamTrainingStatus[e]=t}isStaffCertified(e){const t=this.getStaffTrainingStatus(e);return t===B||t===W}}class K{constructor(e){let{id:t,staffId:n,staffName:r="",studentId:a,studentName:i="",session:s,program:o,date:l,isLocked:c=!1,assignedBy:u="auto"}=e;this.id=t,this.staffId=n,this.staffName=r,this.studentId=a,this.studentName=i,this.session=s,this.program=o,this.date=l,this.isLocked=c,this.assignedBy=u}getSessionTimes(){return F[this.program.toUpperCase()][this.session]}}class G{constructor(e){let{date:t,assignments:n=[],traineeAssignments:r=[],lockedAssignments:a=new Set,isFinalized:i=!1,lastModified:s=null,lastModifiedBy:o=null}=e;this.date=t,this.assignments=n,this.traineeAssignments=r,this.lockedAssignments=a,this.isFinalized=i,this.lastModified=s,this.lastModifiedBy=o}getAssignmentsForSession(e,t){return this.assignments.filter(n=>n.session===e&&n.program.toLowerCase()===t.toLowerCase())}getStaffAssignments(e){return this.assignments.filter(t=>t.staffId===e)}getStudentAssignments(e){return this.assignments.filter(t=>t.studentId===e)}isStaffAvailable(e,t,n){const r=this.assignments.filter(e=>e.session===t).some(t=>t.staffId===e),a=this.traineeAssignments.filter(e=>e.session===t).some(t=>t.staffId===e);return!r&&!a}hasStaffWorkedWithStudentToday(e,t){return this.assignments.some(n=>n.staffId===e&&n.studentId===t)}addAssignment(e){this.assignments.push(e)}removeAssignment(e){this.assignments=this.assignments.filter(t=>t.id!==e)}removeStaffFromSessions(e,t){const n=this.assignments.length,r=this.traineeAssignments.length;this.assignments=this.assignments.filter(n=>!(n.staffId===e&&t.includes(n.session))),this.traineeAssignments=this.traineeAssignments.filter(n=>!(n.staffId===e&&t.includes(n.session)));return n-this.assignments.length+(r-this.traineeAssignments.length)}removeStudentFromSessions(e,t){const n=this.assignments.length,r=this.traineeAssignments.length;this.assignments=this.assignments.filter(n=>!(n.studentId===e&&t.includes(n.session))),this.traineeAssignments=this.traineeAssignments.filter(n=>!(n.studentId===e&&t.includes(n.session)));return n-this.assignments.length+(r-this.traineeAssignments.length)}lockAssignment(e){this.lockedAssignments.add(e)}unlockAssignment(e){this.lockedAssignments.delete(e)}isAssignmentLocked(e){return this.lockedAssignments.has(e)}addTraineeAssignment(e){this.traineeAssignments.push(e)}removeTraineeAssignment(e,t){this.traineeAssignments=this.traineeAssignments.filter(n=>!(n.studentId===e&&n.session===t))}getTraineeAssignment(e,t){return this.traineeAssignments.find(n=>n.studentId===e&&n.session===t)}}class Y{static validateAssignment(e,t,n,r){const a=[],i=n.find(t=>t.id===e.staffId);return i?(i.canWorkProgram(e.program)||a.push("".concat(i.name," is not assigned to ").concat(e.program," program")),t.isStaffAvailable(e.staffId,e.session,e.program)||a.push("".concat(i.name," is already assigned in ").concat(e.session," session")),t.hasStaffWorkedWithStudentToday(e.staffId,e.studentId)&&a.push("".concat(i.name," has already worked with this student today")),a):(a.push("Staff member not found"),a)}static validateSchedule(e,t,n){const r=[];for(const i of e.assignments){const a=new G({date:e.date,assignments:e.assignments.filter(e=>e.id!==i.id),lockedAssignments:e.lockedAssignments,isFinalized:e.isFinalized}),s=this.validateAssignment(i,a,t,n);r.push(...s.map(e=>"Assignment ".concat(i.id,": ").concat(e)))}const a={};for(const i of e.assignments){const e=n.find(e=>e.id===i.studentId);if(e){const t="".concat(i.session,"-").concat(i.program,"-").concat(e.id);a[t]=(a[t]||0)+1;(e.getSessionRatio?e.getSessionRatio(i.session):e.ratio)===j.TWO_TO_ONE&&a[t]<2&&r.push("".concat(e.name," requires 2:1 ratio but only has ").concat(a[t]," staff assigned"))}}return r}}class Q{static generateAssignmentId(){return"assignment_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}static formatDate(e){return e.toISOString().split("T")[0]}static sortStaffByHierarchy(e){return[...e].sort((e,t)=>e.getRoleLevel()-t.getRoleLevel())}static getAvailableStaffForStudent(e,t,n,r,a){return r.filter(r=>{if(!r.isActive)return!1;if(!r.isAvailableForSession(t))return!1;if(!r.canWorkProgram(n))return!1;if(!e.teamIds.includes(r.id))return!1;if(!a.isStaffAvailable(r.id,t,n))return!1;if(a.hasStaffWorkedWithStudentToday(r.id,e.id))return!1;const i=e.getStaffTrainingStatus?e.getStaffTrainingStatus(r.id):W;if(i===z||i===H)return!1;if(!r.canDoDirectSessions())return!1;return!(("AM"===t?e.ratioAM:e.ratioPM)===j.ONE_TO_ONE&&!r.canDo1To1Sessions())})}}const J={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},X=200,Z=400,ee=400,te=499,ne=500,re=599,ae="GET",ie="POST",se=[J.OPENID_SCOPE,J.PROFILE_SCOPE,J.OFFLINE_ACCESS_SCOPE],oe=[...se,J.EMAIL_SCOPE],le="Content-Type",ce="Content-Length",ue="Retry-After",de="X-AnchorMailbox",he="x-ms-request-id",fe="x-ms-httpver",me="active-account-filters",ge="common",pe="organizations",ve="consumers",ye="access_token",be="xms_cc",we="login",Se="select_account",Te="consent",Ae="none",xe="no_session",ke="code",Ce="id_token token refresh_token",Ee="query",Ie="fragment",Ne="query",Pe="authorization_code",_e="refresh_token",Oe="MSSTS",Re="ADFS",Me="Generic",De="-",Le=".",Fe={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},je="appmetadata",Ue="1",Be="authority-metadata",He=86400,ze="config",qe="cache",We="network",Ve="hardcoded_values",Ke={SCHEMA_VERSION:5,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},Ge={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},Ye=60,$e=3600,Qe="throttling",Je="retry-after, h429",Xe="invalid_grant",Ze="client_mismatch",et="1",tt="3",nt="4",rt="2",at="4",it="5",st="0",ot="1",lt="2",ct="3",ut="4",dt="pop";var ht;!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(ht||(ht={}));class ft{constructor(e,t,n){this.level=ht.Info;const r=e||ft.createDefaultLoggerOptions();this.localCallback=r.loggerCallback||(()=>{}),this.piiLoggingEnabled=r.piiLoggingEnabled||!1,this.level="number"===typeof r.logLevel?r.logLevel:ht.Info,this.correlationId=r.correlationId||J.EMPTY_STRING,this.packageName=t||J.EMPTY_STRING,this.packageVersion=n||J.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:ht.Info}}clone(e,t,n){return new ft({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const n=(new Date).toUTCString(),r="[".concat(n,"] : [").concat(t.correlationId||this.correlationId||"","]"),a="".concat(r," : ").concat(this.packageName,"@").concat(this.packageVersion," : ").concat(ht[t.logLevel]," - ").concat(e);this.executeCallback(t.logLevel,a,t.containsPii||!1)}executeCallback(e,t,n){this.localCallback&&this.localCallback(e,t,n)}error(e,t){this.logMessage(e,{logLevel:ht.Error,containsPii:!1,correlationId:t||J.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:ht.Error,containsPii:!0,correlationId:t||J.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:ht.Warning,containsPii:!1,correlationId:t||J.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:ht.Warning,containsPii:!0,correlationId:t||J.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:ht.Info,containsPii:!1,correlationId:t||J.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:ht.Info,containsPii:!0,correlationId:t||J.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:ht.Verbose,containsPii:!1,correlationId:t||J.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:ht.Verbose,containsPii:!0,correlationId:t||J.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:ht.Trace,containsPii:!1,correlationId:t||J.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:ht.Trace,containsPii:!0,correlationId:t||J.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}const mt="AAD",gt="OIDC",pt="EAR",vt="none",yt="unexpected_error",bt="post_request_failed",wt={[yt]:"Unexpected error in authentication.",[bt]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class St extends Error{constructor(e,t,n){super(t?"".concat(e,": ").concat(t):e),Object.setPrototypeOf(this,St.prototype),this.errorCode=e||J.EMPTY_STRING,this.errorMessage=t||J.EMPTY_STRING,this.subError=n||J.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function Tt(e,t){return new St(e,t?"".concat(wt[e]," ").concat(t):wt[e])}const At="client_info_decoding_error",xt="client_info_empty_error",kt="token_parsing_error",Ct="null_or_empty_token",Et="endpoints_resolution_error",It="network_error",Nt="openid_config_error",Pt="hash_not_deserialized",_t="invalid_state",Ot="state_mismatch",Rt="state_not_found",Mt="nonce_mismatch",Dt="auth_time_not_found",Lt="max_age_transpired",Ft="multiple_matching_tokens",jt="multiple_matching_accounts",Ut="multiple_matching_appMetadata",Bt="request_cannot_be_made",Ht="cannot_remove_empty_scope",zt="cannot_append_scopeset",qt="empty_input_scopeset",Wt="device_code_polling_cancelled",Vt="device_code_expired",Kt="device_code_unknown_error",Gt="no_account_in_silent_request",Yt="invalid_cache_record",$t="invalid_cache_environment",Qt="no_account_found",Jt="no_crypto_object",Xt="unexpected_credential_type",Zt="invalid_assertion",en="invalid_client_credential",tn="token_refresh_required",nn="user_timeout_reached",rn="token_claims_cnf_required_for_signedjwt",an="authorization_code_missing_from_server_response",sn="binding_key_not_removed",on="end_session_endpoint_not_supported",ln="key_id_missing",cn="no_network_connectivity",un="user_canceled",dn="missing_tenant_id_error",hn="method_not_implemented",fn="nested_app_auth_bridge_disabled",mn={[At]:"The client info could not be parsed/decoded correctly",[xt]:"The client info was empty",[kt]:"Token cannot be parsed",[Ct]:"The token is null or empty",[Et]:"Endpoints cannot be resolved",[It]:"Network request failed",[Nt]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[Pt]:"The hash parameters could not be deserialized",[_t]:"State was not the expected format",[Ot]:"State mismatch error",[Rt]:"State not found",[Mt]:"Nonce mismatch error",[Dt]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[Lt]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[Ft]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[jt]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[Ut]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[Bt]:"Token request cannot be made without authorization code or refresh token.",[Ht]:"Cannot remove null or empty scope from ScopeSet",[zt]:"Cannot append ScopeSet",[qt]:"Empty input ScopeSet cannot be processed",[Wt]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[Vt]:"Device code is expired.",[Kt]:"Device code stopped polling for unknown reasons.",[Gt]:"Please pass an account object, silent flow is not supported without account information",[Yt]:"Cache record object was null or undefined.",[$t]:"Invalid environment when attempting to create cache entry",[Qt]:"No account found in cache for given key.",[Jt]:"No crypto object detected.",[Xt]:"Unexpected credential type.",[Zt]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[en]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[tn]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[nn]:"User defined timeout for device code polling reached",[rn]:"Cannot generate a POP jwt if the token_claims are not populated",[an]:"Server response does not contain an authorization code to proceed",[sn]:"Could not remove the credential's binding key from storage.",[on]:"The provided authority does not support logout",[ln]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[cn]:"No network connectivity. Check your internet connection.",[un]:"User cancelled the flow.",[dn]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[hn]:"This method has not been implemented",[fn]:"The nested app auth bridge is disabled"};class gn extends St{constructor(e,t){super(e,t?"".concat(mn[e],": ").concat(t):mn[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,gn.prototype)}}function pn(e,t){return new gn(e,t)}const vn={createNewGuid:()=>{throw pn(hn)},base64Decode:()=>{throw pn(hn)},base64Encode:()=>{throw pn(hn)},base64UrlEncode:()=>{throw pn(hn)},encodeKid:()=>{throw pn(hn)},async getPublicKeyThumbprint(){throw pn(hn)},async removeTokenBindingKey(){throw pn(hn)},async clearKeystore(){throw pn(hn)},async signJwt(){throw pn(hn)},async hashString(){throw pn(hn)}},yn="@azure/msal-common",bn="15.13.0",wn="redirect_uri_empty",Sn="claims_request_parsing_error",Tn="authority_uri_insecure",An="url_parse_error",xn="empty_url_error",kn="empty_input_scopes_error",Cn="invalid_claims",En="token_request_empty",In="logout_request_empty",Nn="invalid_code_challenge_method",Pn="pkce_params_missing",_n="invalid_cloud_discovery_metadata",On="invalid_authority_metadata",Rn="untrusted_authority",Mn="missing_ssh_jwk",Dn="missing_ssh_kid",Ln="missing_nonce_authentication_header",Fn="invalid_authentication_header",jn="cannot_set_OIDCOptions",Un="cannot_allow_platform_broker",Bn="authority_mismatch",Hn="invalid_request_method_for_EAR",zn="invalid_authorize_post_body_parameters",qn={[wn]:"A redirect URI is required for all calls, and none has been set.",[Sn]:"Could not parse the given claims request object.",[Tn]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[An]:"URL could not be parsed into appropriate segments.",[xn]:"URL was empty or null.",[kn]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[Cn]:"Given claims parameter must be a stringified JSON object.",[En]:"Token request was empty and not found in cache.",[In]:"The logout request was null or undefined.",[Nn]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[Pn]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[_n]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[On]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[Rn]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[Mn]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[Dn]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[Ln]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[Fn]:"Invalid authentication header provided",[jn]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[Un]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[Bn]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority.",[zn]:"Invalid authorize post body parameters provided. If you are using authorizePostBodyParameters, the request method must be POST. Please check the request method and parameters.",[Hn]:"Invalid request method for EAR protocol mode. The request method cannot be GET when using EAR protocol mode. Please change the request method to POST."};class Wn extends St{constructor(e){super(e,qn[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,Wn.prototype)}}function Vn(e){return new Wn(e)}class Kn{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return 0===Object.keys(t).length}catch(t){}return!0}static startsWith(e,t){return 0===e.indexOf(t)}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},n=e.split("&"),r=e=>decodeURIComponent(e.replace(/\+/g," "));return n.forEach(e=>{if(e.trim()){const[n,a]=e.split(/=(.+)/g,2);n&&a&&(t[r(n)]=r(a))}}),t}static trimArrayEntries(e){return e.map(e=>e.trim())}static removeEmptyStringsFromArray(e){return e.filter(e=>!!e)}static jsonParseHelper(e){try{return JSON.parse(e)}catch(t){return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}class Gn{constructor(e){const t=e?Kn.trimArrayEntries([...e]):[],n=t?Kn.removeEmptyStringsFromArray(t):[];if(!n||!n.length)throw Vn(kn);this.scopes=new Set,n.forEach(e=>this.scopes.add(e))}static fromString(e){const t=(e||J.EMPTY_STRING).split(" ");return new Gn(t)}static createSearchScopes(e){const t=e&&e.length>0?e:[...se],n=new Gn(t);return n.containsOnlyOIDCScopes()?n.removeScope(J.OFFLINE_ACCESS_SCOPE):n.removeOIDCScopes(),n}containsScope(e){const t=this.printScopesLowerCase().split(" "),n=new Gn(t);return!!e&&n.scopes.has(e.toLowerCase())}containsScopeSet(e){return!(!e||e.scopes.size<=0)&&(this.scopes.size>=e.scopes.size&&e.asArray().every(e=>this.containsScope(e)))}containsOnlyOIDCScopes(){let e=0;return oe.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(e=>this.appendScope(e))}catch(t){throw pn(zt)}}removeScope(e){if(!e)throw pn(Ht);this.scopes.delete(e.trim())}removeOIDCScopes(){oe.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw pn(qt);const t=new Set;return e.scopes.forEach(e=>t.add(e.toLowerCase())),this.scopes.forEach(e=>t.add(e.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw pn(qt);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),n=e.getScopeCount(),r=this.getScopeCount();return t.size<r+n}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){if(this.scopes){return this.asArray().join(" ")}return J.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}const Yn=["isHomeTenant"],$n=["isHomeTenant"];function Qn(e,t){return!!e&&!!t&&e===t.split(".")[1]}function Jn(e,t,n,r){if(r){const{oid:t,sub:n,tid:a,name:i,tfp:s,acr:o,preferred_username:l,upn:c,login_hint:u}=r,d=a||s||o||"";return{tenantId:d,localAccountId:t||n||"",name:i,username:l||c||"",loginHint:u,isHomeTenant:Qn(d,e)}}return{tenantId:n,localAccountId:t,username:"",isHomeTenant:Qn(n,e)}}function Xn(e,t,n,r){let a=e;if(t){const{isHomeTenant:n}=t,r=u(t,Yn);a=c(c({},e),r)}if(n){const t=Jn(e.homeAccountId,e.localAccountId,e.tenantId,n),{isHomeTenant:i}=t,s=u(t,$n);return a=c(c(c({},a),s),{},{idTokenClaims:n,idToken:r}),a}return a}function Zn(e,t){const n=function(e){if(!e)throw pn(Ct);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw pn(kt);return t[2]}(e);try{const e=t(n);return JSON.parse(e)}catch(r){throw pn(kt)}}function er(e,t){if(0===t||Date.now()-3e5>e+t)throw pn(Lt)}function tr(e){if(!e)return e;let t=e.toLowerCase();return Kn.endsWith(t,"?")?t=t.slice(0,-1):Kn.endsWith(t,"?/")&&(t=t.slice(0,-2)),Kn.endsWith(t,"/")||(t+="/"),t}function nr(e){return e.startsWith("#/")?e.substring(2):e.startsWith("#")||e.startsWith("?")?e.substring(1):e}function rr(e){if(!e||e.indexOf("=")<0)return null;try{const t=nr(e),n=Object.fromEntries(new URLSearchParams(t));if(n.code||n.ear_jwe||n.error||n.error_description||n.state)return n}catch(t){throw pn(Pt)}return null}function ar(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;const r=new Array;return e.forEach((e,a)=>{!t&&n&&a in n?r.push("".concat(a,"=").concat(e)):r.push("".concat(a,"=").concat(encodeURIComponent(e)))}),r.join("&")}function ir(e){if(!e)return e;const t=e.split("#")[0];try{const e=new URL(t);return tr(e.origin+e.pathname+e.search)}catch(n){return tr(t)}}class sr{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw Vn(xn);e.includes("#")||(this._urlString=sr.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return Kn.endsWith(t,"?")?t=t.slice(0,-1):Kn.endsWith(t,"?/")&&(t=t.slice(0,-2)),Kn.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch(t){throw Vn(An)}if(!e.HostNameAndPort||!e.PathSegments)throw Vn(An);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw Vn(Tn)}static appendQueryString(e,t){return t?e.indexOf("?")<0?"".concat(e,"?").concat(t):"".concat(e,"&").concat(t):e}static removeHashFromUrl(e){return sr.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),n=t.PathSegments;return!e||0===n.length||n[0]!==ge&&n[0]!==pe||(n[0]=e),sr.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Vn(An);const n={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let r=n.AbsolutePath.split("/");return r=r.filter(e=>e&&e.length>0),n.PathSegments=r,n.QueryString&&n.QueryString.endsWith("/")&&(n.QueryString=n.QueryString.substring(0,n.QueryString.length-1)),n}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=e.match(t);if(!n)throw Vn(An);return n[2]}static getAbsoluteUrl(e,t){if(e[0]===J.FORWARD_SLASH){const n=new sr(t).getUrlComponents();return n.Protocol+"//"+n.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new sr(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!rr(e)}}const or={"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},lr={metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},cr=new Set;function ur(e,t,n,r){if(null===r||void 0===r||r.trace("getAliasesFromMetadata called with source: ".concat(n)),e&&t){const a=dr(t,e);if(a)return null===r||void 0===r||r.trace("getAliasesFromMetadata: found cloud discovery metadata in ".concat(n,", returning aliases")),a.aliases;null===r||void 0===r||r.trace("getAliasesFromMetadata: did not find cloud discovery metadata in ".concat(n))}return null}function dr(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(r.aliases.includes(t))return r}return null}lr.metadata.forEach(e=>{e.aliases.forEach(e=>{cr.add(e)})});const hr="cache_quota_exceeded",fr="cache_error_unknown",mr={[hr]:"Exceeded cache storage capacity.",[fr]:"Unexpected error occurred when using cache storage."};class gr extends St{constructor(e,t){const n=t||(mr[e]?mr[e]:mr[fr]);super("".concat(e,": ").concat(n)),Object.setPrototypeOf(this,gr.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=n}}function pr(e){return e instanceof Error?"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name||e.message.includes("exceeded the quota")?new gr(hr):new gr(e.name,e.message):new gr(fr)}class vr{constructor(e,t,n,r,a){this.clientId=e,this.cryptoImpl=t,this.commonLogger=n.clone(yn,bn),this.staticAuthorityOptions=a,this.performanceClient=r}getAllAccounts(e,t){return this.buildTenantProfiles(this.getAccountsFilteredBy(e,t),t,e)}getAccountInfoFilteredBy(e,t){if(0===Object.keys(e).length||Object.values(e).every(e=>!e))return this.commonLogger.warning("getAccountInfoFilteredBy: Account filter is empty or invalid, returning null"),null;const n=this.getAllAccounts(e,t);if(n.length>1){return n.sort(e=>e.idTokenClaims?-1:1)[0]}return 1===n.length?n[0]:null}getBaseAccountInfo(e,t){const n=this.getAccountsFilteredBy(e,t);return n.length>0?n[0].getAccountInfo():null}buildTenantProfiles(e,t,n){return e.flatMap(e=>this.getTenantProfilesFromAccountEntity(e,t,null===n||void 0===n?void 0:n.tenantId,n))}getTenantedAccountInfoByFilter(e,t,n,r,a){let i,s=null;if(a&&!this.tenantProfileMatchesFilter(n,a))return null;const o=this.getIdToken(e,r,t,n.tenantId);return o&&(i=Zn(o.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(i,a))?null:(s=Xn(e,n,i,null===o||void 0===o?void 0:o.secret),s)}getTenantProfilesFromAccountEntity(e,t,n,r){const a=e.getAccountInfo();let i=a.tenantProfiles||new Map;const s=this.getTokenKeys();if(n){const e=i.get(n);if(!e)return[];i=new Map([[n,e]])}const o=[];return i.forEach(e=>{const n=this.getTenantedAccountInfoByFilter(a,s,e,t,r);n&&o.push(n)}),o}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId))&&((!t.name||e.name===t.name)&&(void 0===t.isHomeTenant||e.isHomeTenant===t.isHomeTenant))}idTokenClaimsMatchTenantProfileFilter(e,t){if(t){if(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId))return!1;if(t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint))return!1;if(t.username&&!this.matchUsername(e.preferred_username,t.username))return!1;if(t.name&&!this.matchName(e,t.name))return!1;if(t.sid&&!this.matchSid(e,t.sid))return!1}return!0}async saveCacheRecord(e,t,n){if(!e)throw pn(Yt);try{e.account&&await this.setAccount(e.account,t),e.idToken&&!1!==(null===n||void 0===n?void 0:n.idToken)&&await this.setIdTokenCredential(e.idToken,t),e.accessToken&&!1!==(null===n||void 0===n?void 0:n.accessToken)&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&!1!==(null===n||void 0===n?void 0:n.refreshToken)&&await this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata,t)}catch(a){var r;throw null===(r=this.commonLogger)||void 0===r||r.error("CacheManager.saveCacheRecord: failed"),a instanceof St?a:pr(a)}}async saveAccessToken(e,t){const n={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},r=this.getTokenKeys(),a=Gn.fromString(e.target);r.accessToken.forEach(e=>{if(!this.accessTokenKeyMatchesFilter(e,n,!1))return;const r=this.getAccessTokenCredential(e,t);if(r&&this.credentialMatchesFilter(r,n)){Gn.fromString(r.target).intersectingScopeSets(a)&&this.removeAccessToken(e,t)}}),await this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e,t){const n=this.getAccountKeys(),r=[];return n.forEach(n=>{var a;const i=this.getAccount(n,t);if(!i)return;if(e.homeAccountId&&!this.matchHomeAccountId(i,e.homeAccountId))return;if(e.username&&!this.matchUsername(i.username,e.username))return;if(e.environment&&!this.matchEnvironment(i,e.environment))return;if(e.realm&&!this.matchRealm(i,e.realm))return;if(e.nativeAccountId&&!this.matchNativeAccountId(i,e.nativeAccountId))return;if(e.authorityType&&!this.matchAuthorityType(i,e.authorityType))return;const s={localAccountId:null===e||void 0===e?void 0:e.localAccountId,name:null===e||void 0===e?void 0:e.name},o=null===(a=i.tenantProfiles)||void 0===a?void 0:a.filter(e=>this.tenantProfileMatchesFilter(e,s));o&&0===o.length||r.push(i)}),r}credentialMatchesFilter(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"===typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===Fe.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===Ge.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0}getAppMetadataFilteredBy(e){const t=this.getKeys(),n={};return t.forEach(t=>{if(!this.isAppMetadata(t))return;const r=this.getAppMetadata(t);r&&(e.environment&&!this.matchEnvironment(r,e.environment)||e.clientId&&!this.matchClientId(r,e.clientId)||(n[t]=r))}),n}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let n=null;return t.forEach(t=>{if(!this.isAuthorityMetadata(t)||-1===t.indexOf(this.clientId))return;const r=this.getAuthorityMetadata(t);r&&-1!==r.aliases.indexOf(e)&&(n=r)}),n}removeAllAccounts(e){this.getAllAccounts({},e).forEach(t=>{this.removeAccount(t,e)})}removeAccount(e,t){this.removeAccountContext(e,t);this.getAccountKeys().filter(t=>t.includes(e.homeAccountId)&&t.includes(e.environment)).forEach(e=>{this.removeItem(e,t),this.performanceClient.incrementFields({accountsRemoved:1},t)})}removeAccountContext(e,t){const n=this.getTokenKeys(),r=t=>t.includes(e.homeAccountId)&&t.includes(e.environment);n.idToken.filter(r).forEach(e=>{this.removeIdToken(e,t)}),n.accessToken.filter(r).forEach(e=>{this.removeAccessToken(e,t)}),n.refreshToken.filter(r).forEach(e=>{this.removeRefreshToken(e,t)})}removeAccessToken(e,t){const n=this.getAccessTokenCredential(e,t);if(this.removeItem(e,t),this.performanceClient.incrementFields({accessTokensRemoved:1},t),!n||n.credentialType.toLowerCase()!==Fe.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()||n.tokenType!==Ge.POP)return;const r=n.keyId;r&&this.cryptoImpl.removeTokenBindingKey(r).catch(()=>{var e;this.commonLogger.error("Failed to remove token binding key ".concat(r),t),null===(e=this.performanceClient)||void 0===e||e.incrementFields({removeTokenBindingKeyFailure:1},t)})}removeAppMetadata(e){return this.getKeys().forEach(t=>{this.isAppMetadata(t)&&this.removeItem(t,e)}),!0}getIdToken(e,t,n,r,a){this.commonLogger.trace("CacheManager - getIdToken called");const i={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:Fe.ID_TOKEN,clientId:this.clientId,realm:r},s=this.getIdTokensByFilter(i,t,n),o=s.size;if(o<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(o>1){let n=s;if(!r){const t=new Map;s.forEach((n,r)=>{n.realm===e.tenantId&&t.set(r,n)});const r=t.size;if(r<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),s.values().next().value;if(1===r)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),t.values().next().value;n=t}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),n.forEach((e,n)=>{this.removeIdToken(n,t)}),a&&t&&a.addFields({multiMatchedID:s.size},t),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),s.values().next().value}getIdTokensByFilter(e,t,n){const r=n&&n.idToken||this.getTokenKeys().idToken,a=new Map;return r.forEach(n=>{if(!this.idTokenKeyMatchesFilter(n,c({clientId:this.clientId},e)))return;const r=this.getIdTokenCredential(n,t);r&&this.credentialMatchesFilter(r,e)&&a.set(n,r)}),a}idTokenKeyMatchesFilter(e,t){const n=e.toLowerCase();return(!t.clientId||-1!==n.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==n.indexOf(t.homeAccountId.toLowerCase()))}removeIdToken(e,t){this.removeItem(e,t)}removeRefreshToken(e,t){this.removeItem(e,t)}getAccessToken(e,t,n,r){const a=t.correlationId;this.commonLogger.trace("CacheManager - getAccessToken called",a);const i=Gn.createSearchScopes(t.scopes),s=t.authenticationScheme||Ge.BEARER,o=s&&s.toLowerCase()!==Ge.BEARER.toLowerCase()?Fe.ACCESS_TOKEN_WITH_AUTH_SCHEME:Fe.ACCESS_TOKEN,l={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:o,clientId:this.clientId,realm:r||e.tenantId,target:i,tokenType:s,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},c=n&&n.accessToken||this.getTokenKeys().accessToken,u=[];c.forEach(e=>{if(this.accessTokenKeyMatchesFilter(e,l,!0)){const t=this.getAccessTokenCredential(e,a);t&&this.credentialMatchesFilter(t,l)&&u.push(t)}});const d=u.length;return d<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found",a),null):d>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them",a),u.forEach(e=>{this.removeAccessToken(this.generateCredentialKey(e),a)}),this.performanceClient.addFields({multiMatchedAT:u.length},a),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token",a),u[0])}accessTokenKeyMatchesFilter(e,t,n){const r=e.toLowerCase();if(t.clientId&&-1===r.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===r.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===r.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===r.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target){const e=t.target.asArray();for(let t=0;t<e.length;t++){if(n&&!r.includes(e[t].toLowerCase()))return!1;if(!n&&r.includes(e[t].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e,t){const n=this.getTokenKeys(),r=[];return n.accessToken.forEach(n=>{if(!this.accessTokenKeyMatchesFilter(n,e,!0))return;const a=this.getAccessTokenCredential(n,t);a&&this.credentialMatchesFilter(a,e)&&r.push(a)}),r}getRefreshToken(e,t,n,r,a){this.commonLogger.trace("CacheManager - getRefreshToken called");const i=t?Ue:void 0,s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:Fe.REFRESH_TOKEN,clientId:this.clientId,familyId:i},o=r&&r.refreshToken||this.getTokenKeys().refreshToken,l=[];o.forEach(e=>{if(this.refreshTokenKeyMatchesFilter(e,s)){const t=this.getRefreshTokenCredential(e,n);t&&this.credentialMatchesFilter(t,s)&&l.push(t)}});const c=l.length;return c<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(c>1&&a&&n&&a.addFields({multiMatchedRT:c},n),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),l[0])}refreshTokenKeyMatchesFilter(e,t){const n=e.toLowerCase();return(!t.familyId||-1!==n.indexOf(t.familyId.toLowerCase()))&&(!(!t.familyId&&t.clientId&&-1===n.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==n.indexOf(t.homeAccountId.toLowerCase())))}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},n=this.getAppMetadataFilteredBy(t),r=Object.keys(n).map(e=>n[e]),a=r.length;if(a<1)return null;if(a>1)throw pn(Ut);return r[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!(!t||t.familyId!==Ue)}matchHomeAccountId(e,t){return!("string"!==typeof e.homeAccountId||t!==e.homeAccountId)}matchLocalAccountIdFromTokenClaims(e,t){return t===(e.oid||e.sub)}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){var n;return!(t.toLowerCase()!==(null===(n=e.name)||void 0===n?void 0:n.toLowerCase()))}matchUsername(e,t){return!(!e||"string"!==typeof e||(null===t||void 0===t?void 0:t.toLowerCase())!==e.toLowerCase())}matchUserAssertionHash(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const n=function(e,t){let n;const r=e.canonicalAuthority;if(r){var a;const i=new sr(r).getUrlComponents().HostNameAndPort;n=ur(i,null===(a=e.cloudDiscoveryMetadata)||void 0===a?void 0:a.metadata,ze,t)||ur(i,lr.metadata,Ve,t)||e.knownAuthorities}return n||[]}(this.staticAuthorityOptions,this.commonLogger);if(n.includes(t)&&n.includes(e.environment))return!0}const n=this.getAuthorityMetadataByAlias(t);return!!(n&&n.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!(!e.clientId||t!==e.clientId)}matchFamilyId(e,t){return!(!e.familyId||t!==e.familyId)}matchRealm(e,t){var n;return!((null===(n=e.realm)||void 0===n?void 0:n.toLowerCase())!==t.toLowerCase())}matchNativeAccountId(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||(e.preferred_username===t||e.upn===t)}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!(!e.authorityType||t.toLowerCase()!==e.authorityType.toLowerCase())}matchTarget(e,t){if(e.credentialType!==Fe.ACCESS_TOKEN&&e.credentialType!==Fe.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)return!1;return Gn.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!(!e.tokenType||e.tokenType!==t)}matchKeyId(e,t){return!(!e.keyId||e.keyId!==t)}isAppMetadata(e){return-1!==e.indexOf(je)}isAuthorityMetadata(e){return-1!==e.indexOf(Be)}generateAuthorityMetadataCacheKey(e){return"".concat(Be,"-").concat(this.clientId,"-").concat(e)}static toObject(e,t){for(const n in t)e[n]=t[n];return e}}class yr extends vr{async setAccount(){throw pn(hn)}getAccount(){throw pn(hn)}async setIdTokenCredential(){throw pn(hn)}getIdTokenCredential(){throw pn(hn)}async setAccessTokenCredential(){throw pn(hn)}getAccessTokenCredential(){throw pn(hn)}async setRefreshTokenCredential(){throw pn(hn)}getRefreshTokenCredential(){throw pn(hn)}setAppMetadata(){throw pn(hn)}getAppMetadata(){throw pn(hn)}setServerTelemetry(){throw pn(hn)}getServerTelemetry(){throw pn(hn)}setAuthorityMetadata(){throw pn(hn)}getAuthorityMetadata(){throw pn(hn)}getAuthorityMetadataKeys(){throw pn(hn)}setThrottlingCache(){throw pn(hn)}getThrottlingCache(){throw pn(hn)}removeItem(){throw pn(hn)}getKeys(){throw pn(hn)}getAccountKeys(){throw pn(hn)}getTokenKeys(){throw pn(hn)}generateCredentialKey(){throw pn(hn)}generateAccountKey(){throw pn(hn)}}const br="acquireTokenByCode",wr="acquireTokenByRefreshToken",Sr="acquireTokenSilent",Tr="acquireTokenSilentAsync",Ar="acquireTokenPopup",xr="acquireTokenPreRedirect",kr="acquireTokenRedirect",Cr="cryptoOptsGetPublicKeyThumbprint",Er="cryptoOptsSignJwt",Ir="silentCacheClientAcquireToken",Nr="silentIframeClientAcquireToken",Pr="awaitConcurrentIframe",_r="silentRefreshClientAcquireToken",Or="ssoSilent",Rr="standardInteractionClientGetDiscoveredAuthority",Mr="nativeInteractionClientAcquireToken",Dr="networkClientSendPostRequestAsync",Lr="refreshTokenClientExecutePostToTokenEndpoint",Fr="authorizationCodeClientExecutePostToTokenEndpoint",jr="refreshTokenClientExecuteTokenRequest",Ur="refreshTokenClientAcquireToken",Br="refreshTokenClientAcquireTokenWithCachedRefreshToken",Hr="refreshTokenClientAcquireTokenByRefreshToken",zr="refreshTokenClientCreateTokenRequestBody",qr="acquireTokenFromCache",Wr="silentFlowClientAcquireCachedToken",Vr="silentFlowClientGenerateResultFromCacheRecord",Kr="acquireTokenBySilentIframe",Gr="initializeBaseRequest",Yr="initializeSilentRequest",$r="initializeClientApplication",Qr="initializeCache",Jr="silentIframeClientTokenHelper",Xr="silentHandlerInitiateAuthRequest",Zr="silentHandlerMonitorIframeForHash",ea="silentHandlerLoadFrame",ta="silentHandlerLoadFrameSync",na="standardInteractionClientCreateAuthCodeClient",ra="standardInteractionClientGetClientConfiguration",aa="standardInteractionClientInitializeAuthorizationRequest",ia="getAuthCodeUrl",sa="getStandardParams",oa="handleCodeResponseFromServer",la="handleCodeResponse",ca="handleResponseEar",ua="handleResponsePlatformBroker",da="handleResponseCode",ha="updateTokenEndpointAuthority",fa="authClientAcquireToken",ma="authClientExecuteTokenRequest",ga="authClientCreateTokenRequestBody",pa="popTokenGenerateCnf",va="popTokenGenerateKid",ya="handleServerTokenResponse",ba="deserializeResponse",wa="authorityFactoryCreateDiscoveredInstance",Sa="authorityResolveEndpointsAsync",Ta="authorityGetCloudDiscoveryMetadataFromNetwork",Aa="authorityUpdateCloudDiscoveryMetadata",xa="authorityGetEndpointMetadataFromNetwork",ka="authorityUpdateEndpointMetadata",Ca="authorityUpdateMetadataWithRegionalInformation",Ea="regionDiscoveryDetectRegion",Ia="regionDiscoveryGetRegionFromIMDS",Na="regionDiscoveryGetCurrentVersion",Pa="acquireTokenByCodeAsync",_a="handleRedirectPromise",Oa="handleNativeRedirectPromise",Ra="nativeMessageHandlerHandshake",Ma="removeHiddenIframe",Da="clearTokensAndKeysWithClaims",La="cacheManagerGetRefreshToken",Fa="importExistingCache",ja="setUserData",Ua="localStorageUpdated",Ba="generatePkceCodes",Ha="generateCodeVerifier",za="generateCodeChallengeFromVerifier",qa="sha256Digest",Wa="getRandomValues",Va="generateHKDF",Ka="generateBaseKey",Ga="base64Decode",Ya="urlEncodeArr",$a="encrypt",Qa="decrypt",Ja="generateEarKey",Xa="decryptEarResponse",Za=(new Map([[br,"ATByCode"],[wr,"ATByRT"],[Sr,"ATS"],[Tr,"ATSAsync"],[Ar,"ATPopup"],[kr,"ATRedirect"],[Cr,"CryptoGetPKThumb"],[Er,"CryptoSignJwt"],[Ir,"SltCacheClientAT"],[Nr,"SltIframeClientAT"],[_r,"SltRClientAT"],[Or,"SsoSlt"],[Rr,"StdIntClientGetDiscAuth"],["fetchAccountIdWithNativeBroker","FetchAccIdWithNtvBroker"],[Mr,"NtvIntClientAT"],["baseClientCreateTokenRequestHeaders","BaseClientCreateTReqHead"],[Dr,"NetClientSendPost"],[Lr,"RTClientExecPost"],[Fr,"AuthCodeClientExecPost"],["brokerHandshake","BrokerHandshake"],["acquireTokenByRefreshTokenInBroker","ATByRTInBroker"],["acquireTokenByBroker","ATByBroker"],[jr,"RTClientExecTReq"],[Ur,"RTClientAT"],[Br,"RTClientATWithCachedRT"],[Hr,"RTClientATByRT"],[zr,"RTClientCreateTReqBody"],[qr,"ATFromCache"],[Wr,"SltFlowClientATCached"],[Vr,"SltFlowClientGenResFromCache"],[Kr,"ATBySltIframe"],[Gr,"InitBaseReq"],[Yr,"InitSltReq"],[$r,"InitClientApplication"],[Qr,"InitCache"],[Fa,"importCache"],[ja,"setUserData"],[Ua,"localStorageUpdated"],[Jr,"SIClientTHelper"],[Xr,"SHandlerInitAuthReq"],[Zr,"SltHandlerMonitorIframeForHash"],[ea,"SHandlerLoadFrame"],[ta,"SHandlerLoadFrameSync"],[na,"StdIntClientCreateAuthCodeClient"],[ra,"StdIntClientGetClientConf"],[aa,"StdIntClientInitAuthReq"],[ia,"GetAuthCodeUrl"],[oa,"HandleCodeResFromServer"],[la,"HandleCodeResp"],[ca,"HandleRespEar"],[da,"HandleRespCode"],[ua,"HandleRespPlatBroker"],[ha,"UpdTEndpointAuth"],[fa,"AuthClientAT"],[ma,"AuthClientExecTReq"],[ga,"AuthClientCreateTReqBody"],[pa,"PopTGenCnf"],[va,"PopTGenKid"],[ya,"HandleServerTRes"],[ba,"DeserializeRes"],[wa,"AuthFactCreateDiscInst"],[Sa,"AuthResolveEndpointsAsync"],["authorityResolveEndpointsFromLocalSources","AuthResolveEndpointsFromLocal"],[Ta,"AuthGetCDMetaFromNet"],[Aa,"AuthUpdCDMeta"],[xa,"AuthUpdCDMetaFromNet"],[ka,"AuthUpdEndpointMeta"],[Ca,"AuthUpdMetaWithRegInfo"],[Ea,"RegDiscDetectReg"],[Ia,"RegDiscGetRegFromIMDS"],[Na,"RegDiscGetCurrentVer"],[Pa,"ATByCodeAsync"],["getEndpointMetadataFromNetwork","GetEndpointMetaFromNet"],["getCloudDiscoveryMetadataFromNetworkMeasurement","GetCDMetaFromNet"],[_a,"HandleRedirectPromise"],[Oa,"HandleNtvRedirectPromise"],["updateCloudDiscoveryMetadataMeasurement","UpdateCDMeta"],["usernamePasswordClientAcquireToken","UserPassClientAT"],[Ra,"NtvMsgHandlerHandshake"],["nativeGenerateAuthResult","NtvGenAuthRes"],[Ma,"RemoveHiddenIframe"],[Da,"ClearTAndKeysWithClaims"],[La,"CacheManagerGetRT"],[Ba,"GenPkceCodes"],[Ha,"GenCodeVerifier"],[za,"GenCodeChallengeFromVerifier"],[qa,"Sha256Digest"],[Wa,"GetRandomValues"],[Va,"genHKDF"],[Ka,"genBaseKey"],[Ga,"b64Decode"],[Ya,"urlEncArr"],[$a,"encrypt"],[Qa,"decrypt"],[Ja,"genEarKey"],[Xa,"decryptEarResp"]]),1);new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status","multiMatchedAT","multiMatchedID","multiMatchedRT","unencryptedCacheCount","encryptedCacheExpiredCount","oldAccountCount","oldAccessCount","oldIdCount","oldRefreshCount","currAccountCount","currAccessCount","currIdCount","currRefreshCount","expiredCacheRemovedCount","upgradedCacheCount"]);class ei{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class ti{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:Za,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new ei}}startPerformanceMeasurement(){return new ei}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}const ni={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},ri={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:ht.Info,correlationId:J.EMPTY_STRING},ai={claimsBasedCachingEnabled:!1},ii={async sendGetRequestAsync(){throw pn(hn)},async sendPostRequestAsync(){throw pn(hn)}},si={sku:J.SKU,version:bn,cpu:J.EMPTY_STRING,os:J.EMPTY_STRING},oi={clientSecret:J.EMPTY_STRING,clientAssertion:void 0},li={azureCloudInstance:vt,tenant:"".concat(J.DEFAULT_COMMON_TENANT)},ci={application:{appName:"",appVersion:""}};function ui(e){return e.authOptions.authority.options.protocolMode===gt}const di={sendGetRequestAsync:()=>Promise.reject(pn(hn)),sendPostRequestAsync:()=>Promise.reject(pn(hn))},hi="invalid_grant",fi=483,mi=600,gi="msal",pi=30,vi="msal.js.browser",yi="53ee284d-920a-4b59-9d30-a60315b26836",bi="ppnbnpeolgkicgegkbkbjmhlideopiji",wi="MATS",Si="MicrosoftEntra",Ti="DOM API",Ai="get-token-and-sign-out",xi="PlatformAuthDOMHandler",ki="PlatformAuthExtensionHandler",Ci="Handshake",Ei="HandshakeResponse",Ii="GetToken",Ni="Response",Pi="localStorage",_i="sessionStorage",Oi="memoryStorage",Ri="GET",Mi="POST",Di="signin",Li="signout",Fi="request.origin",ji="urlHash",Ui="request.params",Bi="code.verifier",Hi="interaction.status",zi="request.native",qi="wrapper.sku",Wi="wrapper.version",Vi=861,Ki=862,Gi=863,Yi=865,$i=866,Qi=61,Ji=961,Xi=962;var Zi;!function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(Zi||(Zi={}));const es={scopes:se},ts="msal.db",ns="".concat(ts,".keys"),rs=0,as=1,is=2,ss=3,os=4,ls=5,cs=[rs,ls,os],us="pkce_not_created",ds="ear_jwk_empty",hs="ear_jwe_empty",fs="crypto_nonexistent",ms="empty_navigate_uri",gs="hash_empty_error",ps="no_state_in_hash",vs="hash_does_not_contain_known_properties",ys="unable_to_parse_state",bs="state_interaction_type_mismatch",ws="interaction_in_progress",Ss="popup_window_error",Ts="empty_window_error",As="user_cancelled",xs="monitor_popup_timeout",ks="monitor_window_timeout",Cs="redirect_in_iframe",Es="block_iframe_reload",Is="block_nested_popups",Ns="iframe_closed_prematurely",Ps="silent_logout_unsupported",_s="no_account_error",Os="silent_prompt_value_error",Rs="no_token_request_cache_error",Ms="unable_to_parse_token_request_cache_error",Ds="auth_request_not_set_error",Ls="invalid_cache_type",Fs="non_browser_environment",js="database_not_open",Us="no_network_connectivity",Bs="post_request_failed",Hs="get_request_failed",zs="failed_to_parse_response",qs="unable_to_load_token",Ws="crypto_key_not_found",Vs="auth_code_required",Ks="auth_code_or_nativeAccountId_required",Gs="spa_code_and_nativeAccountId_present",Ys="database_unavailable",$s="unable_to_acquire_token_from_native_platform",Qs="native_handshake_timeout",Js="native_extension_not_installed",Xs="native_connection_not_established",Zs="uninitialized_public_client_application",eo="native_prompt_not_supported",to="invalid_base64_string",no="invalid_pop_token_request",ro="failed_to_build_headers",ao="failed_to_parse_headers",io="failed_to_decrypt_ear_response",so="timed_out",oo="For more visit: aka.ms/msaljs/browser-errors",lo={[us]:"The PKCE code challenge and verifier could not be generated.",[ds]:"No EAR encryption key provided. This is unexpected.",[hs]:"Server response does not contain ear_jwe property. This is unexpected.",[fs]:"The crypto object or function is not available.",[ms]:"Navigation URI is empty. Please check stack trace for more info.",[gs]:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ".concat(oo),[ps]:"Hash does not contain state. Please verify that the request originated from msal.",[vs]:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ".concat(oo),[ys]:"Unable to parse state. Please verify that the request originated from msal.",[bs]:"Hash contains state but the interaction type does not match the caller.",[ws]:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ".concat(oo),[Ss]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[Ts]:"window.open returned null or undefined window object.",[As]:"User cancelled the flow.",[xs]:"Token acquisition in popup failed due to timeout.  ".concat(oo),[ks]:"Token acquisition in iframe failed due to timeout.  ".concat(oo),[Cs]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[Es]:"Request was blocked inside an iframe because MSAL detected an authentication response.  ".concat(oo),[Is]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[Ns]:"The iframe being monitored was closed prematurely.",[Ps]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[_s]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[Os]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[Rs]:"No token request found in cache.",[Ms]:"The cached token request could not be parsed.",[Ds]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[Ls]:"Invalid cache type",[Fs]:"Login and token requests are not supported in non-browser environments.",[js]:"Database is not open!",[Us]:"No network connectivity. Check your internet connection.",[Bs]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[Hs]:"Network request failed. Please check the network trace to determine root cause.",[zs]:"Failed to parse network response. Check network trace.",[qs]:"Error loading token to cache.",[Ws]:"Cryptographic Key or Keypair not found in browser storage.",[Vs]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[Ks]:"An authorization code or nativeAccountId must be provided to this flow.",[Gs]:"Request cannot contain both spa code and native account id.",[Ys]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[$s]:"Unable to acquire token from native platform.  ".concat(oo),[Qs]:"Timed out while attempting to establish connection to browser extension",[Js]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[Xs]:"Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ".concat(oo),[Zs]:"You must call and await the initialize function before attempting to call any other MSAL API.  ".concat(oo),[eo]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[to]:"Invalid base64 encoded string.",[no]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[ro]:"Failed to build request headers object.",[ao]:"Failed to parse response headers",[io]:"Failed to decrypt ear response",[so]:"The request timed out."};class co extends St{constructor(e,t){super(e,lo[e],t),Object.setPrototypeOf(this,co.prototype),this.name="BrowserAuthError"}}function uo(e,t){return new co(e,t)}class ho{navigateInternal(e,t){return ho.defaultNavigateWindow(e,t)}navigateExternal(e,t){return ho.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((e,n)=>{setTimeout(()=>{n(uo(so,"failed_to_redirect"))},t.timeout)})}}class fo extends St{constructor(e,t,n){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,fo.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=n}}function mo(e,t,n,r){return e.errorMessage="".concat(e.errorMessage,", additionalErrorInfo: error.name:").concat(null===r||void 0===r?void 0:r.name,", error.message:").concat(null===r||void 0===r?void 0:r.message),new fo(e,t,n)}class go{async sendGetRequestAsync(e,t){let n,r={},a=0;const i=po(t);try{n=await fetch(e,{method:Ri,headers:i})}catch(s){throw mo(uo(window.navigator.onLine?Hs:Us),void 0,void 0,s)}r=vo(n.headers);try{return a=n.status,{headers:r,body:await n.json(),status:a}}catch(s){throw mo(uo(zs),a,r,s)}}async sendPostRequestAsync(e,t){const n=t&&t.body||"",r=po(t);let a,i=0,s={};try{a=await fetch(e,{method:Mi,headers:r,body:n})}catch(o){throw mo(uo(window.navigator.onLine?Bs:Us),void 0,void 0,o)}s=vo(a.headers);try{return i=a.status,{headers:s,body:await a.json(),status:i}}catch(o){throw mo(uo(zs),i,s,o)}}}function po(e){try{const t=new Headers;if(!e||!e.headers)return t;const n=e.headers;return Object.entries(n).forEach(e=>{let[n,r]=e;t.append(n,r)}),t}catch(t){throw mo(uo(ro),void 0,void 0,t)}}function vo(e){try{const t={};return e.forEach((e,n)=>{t[n]=e}),t}catch(t){throw uo(ao)}}const yo="client_id",bo="redirect_uri",wo="token_type",So="req_cnf",To="return_spa_code",Ao="x-client-xtra-sku",xo="brk_client_id",ko="brk_redirect_uri",Co="instance_aware";function Eo(e,t,n){if(!t)return;const r=e.get(yo);r&&e.has(xo)&&(null===n||void 0===n||n.addFields({embeddedClientId:r,embeddedRedirectUri:e.get(bo)},t))}function Io(e,t){e.set("response_type",t)}function No(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:se;!n||r.includes("openid")||t.includes("openid")||r.push("openid");const a=n?[...t||[],...r]:t||[],i=new Gn(a);e.set("scope",i.printScopes())}function Po(e,t){e.set(yo,t)}function _o(e,t){e.set(bo,t)}function Oo(e,t){e.set("login_hint",t)}function Ro(e,t){e.set(de,"UPN:".concat(t))}function Mo(e,t){e.set(de,"Oid:".concat(t.uid,"@").concat(t.utid))}function Do(e,t){e.set("sid",t)}function Lo(e,t,n){const r=$o(t,n);try{JSON.parse(r)}catch(a){throw Vn(Cn)}e.set("claims",r)}function Fo(e,t){e.set("client-request-id",t)}function jo(e,t){e.set("x-client-SKU",t.sku),e.set("x-client-VER",t.version),t.os&&e.set("x-client-OS",t.os),t.cpu&&e.set("x-client-CPU",t.cpu)}function Uo(e,t){null!==t&&void 0!==t&&t.appName&&e.set("x-app-name",t.appName),null!==t&&void 0!==t&&t.appVersion&&e.set("x-app-ver",t.appVersion)}function Bo(e,t){t&&e.set("state",t)}function Ho(e,t,n){if(!t||!n)throw Vn(Pn);e.set("code_challenge",t),e.set("code_challenge_method",n)}function zo(e,t){e.set("client_secret",t)}function qo(e,t){t&&e.set("client_assertion",t)}function Wo(e,t){t&&e.set("client_assertion_type",t)}function Vo(e,t){e.set("grant_type",t)}function Ko(e){e.set("client_info","1")}function Go(e){e.has(Co)||e.set(Co,"true")}function Yo(e,t){Object.entries(t).forEach(t=>{let[n,r]=t;!e.has(n)&&r&&e.set(n,r)})}function $o(e,t){let n;if(e)try{n=JSON.parse(e)}catch(r){throw Vn(Cn)}else n={};return t&&t.length>0&&(n.hasOwnProperty(ye)||(n[ye]={}),n[ye][be]={values:t}),JSON.stringify(n)}function Qo(e,t){t&&(e.set(wo,Ge.POP),e.set(So,t))}function Jo(e,t){t&&(e.set(wo,Ge.SSH),e.set(So,t))}function Xo(e,t){e.set("x-client-current-telemetry",t.generateCurrentRequestHeaderValue()),e.set("x-client-last-telemetry",t.generateLastRequestHeaderValue())}function Zo(e){e.set("x-ms-lib-capability",Je)}function el(e,t,n){e.has(xo)||e.set(xo,t),e.has(ko)||e.set(ko,n)}function tl(e){return encodeURIComponent(rl(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function nl(e){return al(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function rl(e){return al((new TextEncoder).encode(e))}function al(e){const t=Array.from(e,e=>String.fromCodePoint(e)).join("");return btoa(t)}function il(e){return(new TextDecoder).decode(sl(e))}function sl(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw uo(to)}const n=atob(t);return Uint8Array.from(n,e=>e.codePointAt(0)||0)}const ol="AES-GCM",ll="HKDF",cl="SHA-256",ul=new Uint8Array([1,0,1]),dl="0123456789abcdef",hl=new Uint32Array(1),fl="raw",ml="encrypt",gl="decrypt",pl={name:"RSASSA-PKCS1-v1_5",hash:cl,modulusLength:2048,publicExponent:ul};async function vl(e,t,n){null===t||void 0===t||t.addQueueMeasurement(qa,n);const r=(new TextEncoder).encode(e);return window.crypto.subtle.digest(cl,r)}function yl(e){return window.crypto.getRandomValues(e)}function bl(){return window.crypto.getRandomValues(hl),hl[0]}function wl(){const e=Date.now(),t=1024*bl()+(1023&bl()),n=new Uint8Array(16),r=Math.trunc(t/2**30),a=t&2**30-1,i=bl();n[0]=e/2**40,n[1]=e/2**32,n[2]=e/2**24,n[3]=e/65536,n[4]=e/256,n[5]=e,n[6]=112|r>>>8,n[7]=r,n[8]=128|a>>>24,n[9]=a>>>16,n[10]=a>>>8,n[11]=a,n[12]=i>>>24,n[13]=i>>>16,n[14]=i>>>8,n[15]=i;let s="";for(let o=0;o<n.length;o++)s+=dl.charAt(n[o]>>>4),s+=dl.charAt(15&n[o]),3!==o&&5!==o&&7!==o&&9!==o||(s+="-");return s}async function Sl(e){return window.crypto.subtle.exportKey("jwk",e)}async function Tl(){const e=await xl(),t={alg:"dir",kty:"oct",k:nl(new Uint8Array(e))};return rl(JSON.stringify(t))}async function Al(e,t){const n=t.split(".");if(5!==n.length)throw uo(io,"jwe_length");const r=await async function(e){const t=il(e),n=sl(JSON.parse(t).k);return window.crypto.subtle.importKey(fl,n,ol,!1,[gl])}(e).catch(()=>{throw uo(io,"import_key")});try{const e=(new TextEncoder).encode(n[0]),t=sl(n[2]),a=sl(n[3]),i=sl(n[4]),s=8*i.byteLength,o=new Uint8Array(a.length+i.length);o.set(a),o.set(i,a.length);const l=await window.crypto.subtle.decrypt({name:ol,iv:t,tagLength:s,additionalData:e},r,o);return(new TextDecoder).decode(l)}catch(a){throw uo(io,"decrypt")}}async function xl(){const e=await window.crypto.subtle.generateKey({name:ol,length:256},!0,[ml,gl]);return window.crypto.subtle.exportKey(fl,e)}async function kl(e){return window.crypto.subtle.importKey(fl,e,ll,!1,["deriveKey"])}async function Cl(e,t,n){return window.crypto.subtle.deriveKey({name:ll,salt:t,hash:cl,info:(new TextEncoder).encode(n)},e,{name:ol,length:256},!1,[ml,gl])}async function El(e,t,n){const r=(new TextEncoder).encode(t),a=window.crypto.getRandomValues(new Uint8Array(16)),i=await Cl(e,a,n),s=await window.crypto.subtle.encrypt({name:ol,iv:new Uint8Array(12)},i,r);return{data:nl(new Uint8Array(s)),nonce:nl(a)}}async function Il(e,t,n,r){const a=sl(r),i=await Cl(e,sl(t),n),s=await window.crypto.subtle.decrypt({name:ol,iv:new Uint8Array(12)},i,a);return(new TextDecoder).decode(s)}async function Nl(e){const t=await vl(e);return nl(new Uint8Array(t))}const Pl="storage_not_supported",_l="stubbed_public_client_application_called",Ol="in_mem_redirect_unavailable",Rl={[Pl]:"Given storage configuration option was not supported.",[_l]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[Ol]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};class Ml extends St{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,Ml.prototype)}}function Dl(e){return new Ml(e,Rl[e])}function Ll(e){e.location.hash="","function"===typeof e.history.replaceState&&e.history.replaceState(null,"","".concat(e.location.origin).concat(e.location.pathname).concat(e.location.search))}function Fl(){return window.parent!==window}function jl(){return"undefined"!==typeof window&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function Ul(){if("undefined"!==typeof window&&window.opener&&window.opener!==window&&"string"===typeof window.name&&0===window.name.indexOf("".concat(gi,".")))throw uo(Is)}function Bl(){if("undefined"===typeof window)throw uo(Fs)}function Hl(e){if(!e)throw uo(Zs)}function zl(e){Bl(),function(){if(sr.hashContainsKnownProperties(window.location.hash)&&Fl())throw uo(Es)}(),Ul(),Hl(e)}function ql(e,t){if(zl(e),function(e){if(Fl()&&!e)throw uo(Cs)}(t.system.allowRedirectInIframe),t.cache.cacheLocation===Oi&&!t.cache.storeAuthStateInCookie)throw Dl(Ol)}function Wl(e){const t=document.createElement("link");t.rel="preconnect",t.href=new URL(e).origin,t.crossOrigin="anonymous",document.head.appendChild(t),window.setTimeout(()=>{try{document.head.removeChild(t)}catch(e){}},1e4)}const Vl=1e4;const Kl="4.25.0",Gl="msal",Yl="browser",$l="".concat(Gl,".").concat(Yl,".log.level"),Ql="".concat(Gl,".").concat(Yl,".log.pii"),Jl=("".concat(Gl,".").concat(Yl,".performance.enabled"),"".concat(Gl,".").concat(Yl,".platform.auth.dom")),Xl="".concat(Gl,".version"),Zl="account.keys",ec="token.keys";function tc(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return e<1?"".concat(Gl,".").concat(Zl):"".concat(Gl,".").concat(e,".").concat(Zl)}function nc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t<1?"".concat(Gl,".").concat(ec,".").concat(e):"".concat(Gl,".").concat(t,".").concat(ec,".").concat(e)}class rc{static loggerCallback(e,t){switch(e){case ht.Error:return void console.error(t);case ht.Info:return void console.info(t);case ht.Verbose:return void console.debug(t);case ht.Warning:return void console.warn(t);default:return void console.log(t)}}constructor(e){var t,n;let r;this.browserEnvironment="undefined"!==typeof window,this.config=function(e,t){let{auth:n,cache:r,system:a,telemetry:i}=e;const s={clientId:J.EMPTY_STRING,authority:"".concat(J.DEFAULT_AUTHORITY),knownAuthorities:[],cloudDiscoveryMetadata:J.EMPTY_STRING,authorityMetadata:J.EMPTY_STRING,redirectUri:"undefined"!==typeof window?jl():"",postLogoutRedirectUri:J.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:mt,OIDCOptions:{serverResponseType:Ie,defaultScopes:[J.OPENID_SCOPE,J.PROFILE_SCOPE,J.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:vt,tenant:J.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1,encodeExtraQueryParams:!1},o={cacheLocation:_i,cacheRetentionDays:5,temporaryCacheLocation:_i,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!r||r.cacheLocation!==Pi),claimsBasedCachingEnabled:!1},l={loggerCallback:()=>{},logLevel:ht.Info,piiLoggingEnabled:!1},u=c(c({},ni),{},{loggerOptions:l,networkClient:t?new go:di,navigationClient:new ho,loadFrameTimeout:0,windowHashTimeout:(null===a||void 0===a?void 0:a.loadFrameTimeout)||6e4,iframeHashTimeout:(null===a||void 0===a?void 0:a.loadFrameTimeout)||Vl,navigateFrameWait:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowPlatformBroker:!1,nativeBrokerHandshakeTimeout:(null===a||void 0===a?void 0:a.nativeBrokerHandshakeTimeout)||2e3,pollIntervalMilliseconds:pi}),d=c(c(c({},u),a),{},{loggerOptions:(null===a||void 0===a?void 0:a.loggerOptions)||l}),h={application:{appName:J.EMPTY_STRING,appVersion:J.EMPTY_STRING},client:new ti};(null===n||void 0===n?void 0:n.protocolMode)!==gt&&null!==n&&void 0!==n&&n.OIDCOptions&&new ft(d.loggerOptions).warning(JSON.stringify(Vn(jn)));if(null!==n&&void 0!==n&&n.protocolMode&&n.protocolMode===gt&&null!==d&&void 0!==d&&d.allowPlatformBroker)throw Vn(Un);return{auth:c(c(c({},s),n),{},{OIDCOptions:c(c({},s.OIDCOptions),null===n||void 0===n?void 0:n.OIDCOptions)}),cache:c(c({},o),r),system:d,telemetry:c(c({},h),i)}}(e,this.browserEnvironment);try{r=window[_i]}catch(u){}const a=null===(t=r)||void 0===t?void 0:t.getItem($l),i=null===(n=r)||void 0===n||null===(n=n.getItem(Ql))||void 0===n?void 0:n.toLowerCase(),s="true"===i||"false"!==i&&void 0,o=c({},this.config.system.loggerOptions),l=a&&Object.keys(ht).includes(a)?ht[a]:void 0;l&&(o.loggerCallback=rc.loggerCallback,o.logLevel=l),void 0!==s&&(o.piiLoggingEnabled=s),this.logger=new ft(o,"@azure/msal-browser",Kl),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}class ac extends rc{getModuleName(){return ac.MODULE_NAME}getId(){return ac.ID}async initialize(){return this.available="undefined"!==typeof window,this.available}}ac.MODULE_NAME="",ac.ID="StandardOperatingContext";const ic="missing_kid_error",sc="missing_alg_error",oc={[ic]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[sc]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class lc extends St{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,lc.prototype)}}function cc(e){return new lc(e,oc[e])}class uc{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw cc(ic);if(!e.alg)throw cc(sc);const t=new uc({typ:e.typ||dt,kid:e.kid,alg:e.alg});return JSON.stringify(t)}}class dc{constructor(){this.dbName=ts,this.version=1,this.tableName=ns,this.dbOpen=!1}async open(){return new Promise((e,t)=>{const n=window.indexedDB.open(this.dbName,this.version);n.addEventListener("upgradeneeded",e=>{e.target.result.createObjectStore(this.tableName)}),n.addEventListener("success",t=>{const n=t;this.db=n.target.result,this.dbOpen=!0,e()}),n.addEventListener("error",()=>t(uo(Ys)))})}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(uo(js));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);r.addEventListener("success",e=>{const n=e;this.closeConnection(),t(n.target.result)}),r.addEventListener("error",e=>{this.closeConnection(),n(e)})})}async setItem(e,t){return await this.validateDbIsOpen(),new Promise((n,r)=>{if(!this.db)return r(uo(js));const a=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);a.addEventListener("success",()=>{this.closeConnection(),n()}),a.addEventListener("error",e=>{this.closeConnection(),r(e)})})}async removeItem(e){return await this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(uo(js));const r=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);r.addEventListener("success",()=>{this.closeConnection(),t()}),r.addEventListener("error",e=>{this.closeConnection(),n(e)})})}async getKeys(){return await this.validateDbIsOpen(),new Promise((e,t)=>{if(!this.db)return t(uo(js));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();n.addEventListener("success",t=>{const n=t;this.closeConnection(),e(n.target.result)}),n.addEventListener("error",e=>{this.closeConnection(),t(e)})})}async containsKey(e){return await this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(uo(js));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);r.addEventListener("success",e=>{const n=e;this.closeConnection(),t(1===n.target.result)}),r.addEventListener("error",e=>{this.closeConnection(),n(e)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,t)=>{const n=window.indexedDB.deleteDatabase(ts),r=setTimeout(()=>t(!1),200);n.addEventListener("success",()=>(clearTimeout(r),e(!0))),n.addEventListener("blocked",()=>(clearTimeout(r),e(!0))),n.addEventListener("error",()=>(clearTimeout(r),t(!1)))})}}class hc{constructor(){this.cache=new Map}async initialize(){}getItem(e){return this.cache.get(e)||null}getUserData(e){return this.getItem(e)}setItem(e,t){this.cache.set(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach((t,n)=>{e.push(n)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}decryptData(){return Promise.resolve(null)}}class fc{constructor(e){this.inMemoryCache=new hc,this.indexedDBCache=new dc,this.logger=e}handleDatabaseAccessError(e){if(!(e instanceof co&&e.errorCode===Ys))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(n){this.handleDatabaseAccessError(n)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(n){this.handleDatabaseAccessError(n)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(t){this.handleDatabaseAccessError(t)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(0===e.length)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(t){this.handleDatabaseAccessError(t)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(n){this.handleDatabaseAccessError(n)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}class mc{constructor(e,t,n){this.logger=e,function(e){if(!window)throw uo(Fs);if(!window.crypto)throw uo(fs);if(!e&&!window.crypto.subtle)throw uo(fs,"crypto_subtle_undefined")}(null!==n&&void 0!==n&&n),this.cache=new fc(this.logger),this.performanceClient=t}createNewGuid(){return wl()}base64Encode(e){return rl(e)}base64Decode(e){return il(e)}base64UrlEncode(e){return tl(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){var t;const n=null===(t=this.performanceClient)||void 0===t?void 0:t.startMeasurement(Cr,e.correlationId),r=await async function(e,t){return window.crypto.subtle.generateKey(pl,e,t)}(mc.EXTRACTABLE,mc.POP_KEY_USAGES),a=await Sl(r.publicKey),i=gc({e:a.e,kty:a.kty,n:a.n}),s=await this.hashString(i),o=await Sl(r.privateKey),l=await async function(e,t,n){return window.crypto.subtle.importKey("jwk",e,pl,t,n)}(o,!1,["sign"]);return await this.cache.setItem(s,{privateKey:l,publicKey:r.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),n&&n.end({success:!0}),s}async removeTokenBindingKey(e){await this.cache.removeItem(e);if(await this.cache.containsKey(e))throw pn(sn)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error("Clearing keystore failed with error: ".concat(e.message)):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,n,r){var a;const i=null===(a=this.performanceClient)||void 0===a?void 0:a.startMeasurement(Er,r),s=await this.cache.getItem(t);if(!s)throw uo(Ws);const o=await Sl(s.publicKey),l=gc(o),u=tl(JSON.stringify({kid:t})),d=tl(uc.getShrHeaderString(c(c({},null===n||void 0===n?void 0:n.header),{},{alg:o.alg,kid:u})));e.cnf={jwk:JSON.parse(l)};const h=tl(JSON.stringify(e)),f="".concat(d,".").concat(h),m=(new TextEncoder).encode(f),g=await async function(e,t){return window.crypto.subtle.sign(pl,e,t)}(s.privateKey,m),p=nl(new Uint8Array(g)),v="".concat(f,".").concat(p);return i&&i.end({success:!0}),v}async hashString(e){return Nl(e)}}function gc(e){return JSON.stringify(e,Object.keys(e).sort())}mc.POP_KEY_USAGES=["sign","verify"],mc.EXTRACTABLE=!0;const pc=0,vc=1,yc=2,bc=3;const wc=(e,t,n,r,a)=>function(){n.trace("Executing function ".concat(t));const i=null===r||void 0===r?void 0:r.startMeasurement(t,a);if(a){const e=t+"CallCount";null===r||void 0===r||r.incrementFields({[e]:1},a)}try{const r=e(...arguments);return null===i||void 0===i||i.end({success:!0}),n.trace("Returning result from ".concat(t)),r}catch(s){n.trace("Error occurred in ".concat(t));try{n.trace(JSON.stringify(s))}catch(s){n.trace("Unable to print error message.")}throw null===i||void 0===i||i.end({success:!1},s),s}},Sc=(e,t,n,r,a)=>function(){n.trace("Executing function ".concat(t));const i=null===r||void 0===r?void 0:r.startMeasurement(t,a);if(a){const e=t+"CallCount";null===r||void 0===r||r.incrementFields({[e]:1},a)}return null===r||void 0===r||r.setPreQueueTime(t,a),e(...arguments).then(e=>(n.trace("Returning result from ".concat(t)),null===i||void 0===i||i.end({success:!0}),e)).catch(e=>{n.trace("Error occurred in ".concat(t));try{n.trace(JSON.stringify(e))}catch(e){n.trace("Unable to print error message.")}throw null===i||void 0===i||i.end({success:!1},e),e})};class Tc{constructor(e,t,n,r){this.networkInterface=e,this.logger=t,this.performanceClient=n,this.correlationId=r}async detectRegion(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(Ea,this.correlationId);let r=e;if(r)t.region_source=tt;else{const e=Tc.IMDS_OPTIONS;try{const n=await Sc(this.getRegionFromIMDS.bind(this),Ia,this.logger,this.performanceClient,this.correlationId)(J.IMDS_VERSION,e);if(n.status===X&&(r=n.body,t.region_source=nt),n.status===ee){const n=await Sc(this.getCurrentVersion.bind(this),Na,this.logger,this.performanceClient,this.correlationId)(e);if(!n)return t.region_source=et,null;const a=await Sc(this.getRegionFromIMDS.bind(this),Ia,this.logger,this.performanceClient,this.correlationId)(n,e);a.status===X&&(r=a.body,t.region_source=nt)}}catch(a){return t.region_source=et,null}}return r||(t.region_source=et),r||null}async getRegionFromIMDS(e,t){var n;return null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(Ia,this.correlationId),this.networkInterface.sendGetRequestAsync("".concat(J.IMDS_ENDPOINT,"?api-version=").concat(e,"&format=text"),t,J.IMDS_TIMEOUT)}async getCurrentVersion(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Na,this.correlationId);try{const t=await this.networkInterface.sendGetRequestAsync("".concat(J.IMDS_ENDPOINT,"?format=json"),e);return t.status===ee&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?t.body["newest-versions"][0]:null}catch(n){return null}}}function Ac(){return Math.round((new Date).getTime()/1e3)}function xc(e){return e.getTime()/1e3}function kc(e){return e?new Date(1e3*Number(e)):new Date}function Cc(e,t){const n=Number(e)||0;return Ac()+t>n}function Ec(e,t){const n=Number(e)+24*t*60*60*1e3;return Date.now()>n}function Ic(e,t,n,r,a){return{credentialType:Fe.ID_TOKEN,homeAccountId:e,environment:t,clientId:r,secret:n,realm:a,lastUpdatedAt:Date.now().toString()}}function Nc(e,t,n,r,a,i,s,o,l,c,u,d,h,f,m){var g,p;const v={homeAccountId:e,credentialType:Fe.ACCESS_TOKEN,secret:n,cachedAt:Ac().toString(),expiresOn:s.toString(),extendedExpiresOn:o.toString(),environment:t,clientId:r,realm:a,target:i,tokenType:u||Ge.BEARER,lastUpdatedAt:Date.now().toString()};if(d&&(v.userAssertionHash=d),c&&(v.refreshOn=c.toString()),f&&(v.requestedClaims=f,v.requestedClaimsHash=m),(null===(g=v.tokenType)||void 0===g?void 0:g.toLowerCase())!==Ge.BEARER.toLowerCase())switch(v.credentialType=Fe.ACCESS_TOKEN_WITH_AUTH_SCHEME,v.tokenType){case Ge.POP:const e=Zn(n,l);if(null===e||void 0===e||null===(p=e.cnf)||void 0===p||!p.kid)throw pn(rn);v.keyId=e.cnf.kid;break;case Ge.SSH:v.keyId=h}return v}function Pc(e,t,n,r,a,i,s){const o={credentialType:Fe.REFRESH_TOKEN,homeAccountId:e,environment:t,clientId:r,secret:n,lastUpdatedAt:Date.now().toString()};return i&&(o.userAssertionHash=i),a&&(o.familyId=a),s&&(o.expiresOn=s.toString()),o}function _c(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")}function Oc(e){return!!e&&(_c(e)&&e.hasOwnProperty("realm")&&e.hasOwnProperty("target")&&(e.credentialType===Fe.ACCESS_TOKEN||e.credentialType===Fe.ACCESS_TOKEN_WITH_AUTH_SCHEME))}function Rc(e){return!!e&&(_c(e)&&e.credentialType===Fe.REFRESH_TOKEN)}function Mc(){return Ac()+He}function Dc(e,t,n){e.authorization_endpoint=t.authorization_endpoint,e.token_endpoint=t.token_endpoint,e.end_session_endpoint=t.end_session_endpoint,e.issuer=t.issuer,e.endpointsFromNetwork=n,e.jwks_uri=t.jwks_uri}function Lc(e,t,n){e.aliases=t.aliases,e.preferred_cache=t.preferred_cache,e.preferred_network=t.preferred_network,e.aliasesFromNetwork=n}function Fc(e){return e.expiresAt<=Ac()}Tc.IMDS_OPTIONS={headers:{Metadata:"true"}};class jc{constructor(e,t,n,r,a,i,s,o){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=n,this.authorityOptions=r,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=a,this.performanceClient=s,this.correlationId=i,this.managedIdentity=o||!1,this.regionDiscovery=new Tc(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(J.CIAM_AUTH_URL))return bc;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case J.ADFS:return vc;case J.DSTS:return yc}return pc}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new sr(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw pn(Et)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw pn(Et)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw pn(Et)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw pn(on);return this.replacePath(this.metadata.end_session_endpoint)}throw pn(Et)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw pn(Et)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw pn(Et)}canReplaceTenant(e){return 1===e.PathSegments.length&&!jc.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===pc&&this.protocolMode!==gt}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const n=new sr(this.metadata.canonical_authority).getUrlComponents(),r=n.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((e,a)=>{let i=r[a];if(0===a&&this.canReplaceTenant(n)){const e=new sr(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];i!==e&&(this.logger.verbose("Replacing tenant domain name ".concat(i," with id ").concat(e)),i=e)}e!==i&&(t=t.replace("/".concat(i,"/"),"/".concat(e,"/")))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===vc||this.protocolMode===gt&&!this.isAliasOfKnownMicrosoftAuthority(e)?"".concat(this.canonicalAuthority,".well-known/openid-configuration"):"".concat(this.canonicalAuthority,"v2.0/.well-known/openid-configuration")}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){var e,t;null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(Sa,this.correlationId);const n=this.getCurrentMetadataEntity(),r=await Sc(this.updateCloudDiscoveryMetadata.bind(this),Aa,this.logger,this.performanceClient,this.correlationId)(n);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,n.preferred_network);const a=await Sc(this.updateEndpointMetadata.bind(this),ka,this.logger,this.performanceClient,this.correlationId)(n);this.updateCachedMetadata(n,r,{source:a}),null===(t=this.performanceClient)||void 0===t||t.addFields({cloudDiscoverySource:r,authorityEndpointSource:a},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:Mc(),jwks_uri:""}),e}updateCachedMetadata(e,t,n){t!==qe&&(null===n||void 0===n?void 0:n.source)!==qe&&(e.expiresAt=Mc(),e.canonical_authority=this.canonicalAuthority);const r=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(r,e),this.metadata=e}async updateEndpointMetadata(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(ka,this.correlationId);const n=this.updateEndpointMetadataFromLocalSources(e);if(n){var r;if(n.source===Ve)if(null!==(r=this.authorityOptions.azureRegionConfiguration)&&void 0!==r&&r.azureRegion&&n.metadata){Dc(e,await Sc(this.updateMetadataWithRegionalInformation.bind(this),Ca,this.logger,this.performanceClient,this.correlationId)(n.metadata),!1),e.canonical_authority=this.canonicalAuthority}return n.source}let a=await Sc(this.getEndpointMetadataFromNetwork.bind(this),xa,this.logger,this.performanceClient,this.correlationId)();var i;if(a)return null!==(i=this.authorityOptions.azureRegionConfiguration)&&void 0!==i&&i.azureRegion&&(a=await Sc(this.updateMetadataWithRegionalInformation.bind(this),Ca,this.logger,this.performanceClient,this.correlationId)(a)),Dc(e,a,!0),We;throw pn(Nt,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),Dc(e,t,!1),{source:ze};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const t=this.getEndpointMetadataFromHardcodedValues();if(t)return Dc(e,t,!1),{source:Ve,metadata:t};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const n=Fc(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!n?(this.logger.verbose("Found endpoint metadata in the cache."),{source:qe}):(n&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new sr(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw Vn(On)}return null}async getEndpointMetadataFromNetwork(){var e;null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(xa,this.correlationId);const t={},n=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose("Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ".concat(n));try{const e=await this.networkInterface.sendGetRequestAsync(n,t),r=function(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}(e.body);return r?e.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(r){return this.logger.verbose("Authority.getEndpointMetadataFromNetwork: ".concat(r)),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in or?or[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){var t,n;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Ca,this.correlationId);const r=null===(n=this.authorityOptions.azureRegionConfiguration)||void 0===n?void 0:n.azureRegion;if(r){var a;if(r!==J.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=rt,this.regionDiscoveryMetadata.region_used=r,jc.replaceWithRegionalInformation(e,r);const t=await Sc(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),Ea,this.logger,this.performanceClient,this.correlationId)(null===(a=this.authorityOptions.azureRegionConfiguration)||void 0===a?void 0:a.environmentRegion,this.regionDiscoveryMetadata);if(t)return this.regionDiscoveryMetadata.region_outcome=at,this.regionDiscoveryMetadata.region_used=t,jc.replaceWithRegionalInformation(e,t);this.regionDiscoveryMetadata.region_outcome=it}return e}async updateCloudDiscoveryMetadata(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Aa,this.correlationId);const n=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(n)return n;const r=await Sc(this.getCloudDiscoveryMetadataFromNetwork.bind(this),Ta,this.logger,this.performanceClient,this.correlationId)();if(r)return Lc(e,r,!0),We;throw Vn(Rn)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii("Known Authorities: ".concat(this.authorityOptions.knownAuthorities||J.NOT_APPLICABLE)),this.logger.verbosePii("Authority Metadata: ".concat(this.authorityOptions.authorityMetadata||J.NOT_APPLICABLE)),this.logger.verbosePii("Canonical Authority: ".concat(e.canonical_authority||J.NOT_APPLICABLE));const t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),Lc(e,t,!1),ze;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const t=(n=this.hostnameAndPort,dr(lr.metadata,n));if(t)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),Lc(e,t,!1),Ve;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}var n;const r=Fc(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!r?(this.logger.verbose("Found cloud discovery metadata in the cache."),qe):(r&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===bc)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),jc.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=dr(JSON.parse(this.authorityOptions.cloudDiscoveryMetadata).metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),e)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),e;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(e){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Vn(_n)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),jc.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){var e;null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(Ta,this.correlationId);const t="".concat(J.AAD_INSTANCE_DISCOVERY_ENDPT).concat(this.canonicalAuthority,"oauth2/v2.0/authorize"),n={};let r=null;try{const e=await this.networkInterface.sendGetRequestAsync(t,n);let a,i;if(function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(e.body))a=e.body,i=a.metadata,this.logger.verbosePii("tenant_discovery_endpoint is: ".concat(a.tenant_discovery_endpoint));else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(e.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(this.logger.warning("A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ".concat(e.status)),a=e.body,a.error===J.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning("The CloudInstanceDiscoveryErrorResponse error is ".concat(a.error)),this.logger.warning("The CloudInstanceDiscoveryErrorResponse error description is ".concat(a.error_description)),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),i=[]}this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),r=dr(i,this.hostnameAndPort)}catch(a){if(a instanceof St)this.logger.error("There was a network error while attempting to get the cloud discovery instance metadata.\nError: ".concat(a.errorCode,"\nError Description: ").concat(a.errorMessage));else{const e=a;this.logger.error("A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: ".concat(e.name,"\nError Description: ").concat(e.message))}return null}return r||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),r=jc.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),r}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(e=>e&&sr.getDomainFromUrl(e).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let n;if(t&&t.azureCloudInstance!==vt){const e=t.tenant?t.tenant:J.DEFAULT_COMMON_TENANT;n="".concat(t.azureCloudInstance,"/").concat(e,"/")}return n||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return J.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw pn(Et)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return cr.has(e)}static isPublicCloudAuthority(e){return J.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,n){const r=new sr(e);r.validateAsUri();const a=r.getUrlComponents();let i="".concat(t,".").concat(a.HostNameAndPort);this.isPublicCloudAuthority(a.HostNameAndPort)&&(i="".concat(t,".").concat(J.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX));const s=sr.constructAuthorityUriFromObject(c(c({},r.getUrlComponents()),{},{HostNameAndPort:i})).urlString;return n?"".concat(s,"?").concat(n):s}static replaceWithRegionalInformation(e,t){const n=c({},e);return n.authorization_endpoint=jc.buildRegionalAuthorityString(n.authorization_endpoint,t),n.token_endpoint=jc.buildRegionalAuthorityString(n.token_endpoint,t),n.end_session_endpoint&&(n.end_session_endpoint=jc.buildRegionalAuthorityString(n.end_session_endpoint,t)),n}static transformCIAMAuthority(e){let t=e;const n=new sr(e).getUrlComponents();if(0===n.PathSegments.length&&n.HostNameAndPort.endsWith(J.CIAM_AUTH_URL)){const e=n.HostNameAndPort.split(".")[0];t="".concat(t).concat(e).concat(J.AAD_TENANT_DOMAIN_SUFFIX)}return t}}function Uc(e){return e.endsWith(J.FORWARD_SLASH)?e:"".concat(e).concat(J.FORWARD_SLASH)}jc.reservedTenantDomains=new Set(["{tenant}","{tenantid}",ge,ve,pe]);const Bc="no_tokens_found",Hc="native_account_unavailable",zc="refresh_token_expired",qc="ux_not_allowed",Wc="bad_token",Vc=["interaction_required","consent_required","login_required",Wc,qc],Kc=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],Gc={[Bc]:"No refresh token found in the cache. Please sign-in.",[Hc]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[zc]:"Refresh token has expired.",[Wc]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve.",[qc]:"`canShowUI` flag in Edge was set to false. User interaction required on web page. Please invoke an interactive API to resolve."};class Yc extends St{constructor(e,t,n,r,a,i,s,o){super(e,t,n),Object.setPrototypeOf(this,Yc.prototype),this.timestamp=r||J.EMPTY_STRING,this.traceId=a||J.EMPTY_STRING,this.correlationId=i||J.EMPTY_STRING,this.claims=s||J.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=o}}function $c(e,t,n){const r=!!e&&Vc.indexOf(e)>-1,a=!!n&&Kc.indexOf(n)>-1,i=!!t&&Vc.some(e=>t.indexOf(e)>-1);return r||i||a}function Qc(e){return new Yc(e,Gc[e])}function Jc(e,t){if(!e)throw pn(xt);try{const n=t(e);return JSON.parse(n)}catch(n){throw pn(At)}}function Xc(e){if(!e)throw pn(At);const t=e.split(Le,2);return{uid:t[0],utid:t.length<2?J.EMPTY_STRING:t[1]}}function Zc(e){if(e){return e.tid||e.tfp||e.acr||null}return null}class eu{getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,loginHint:this.loginHint,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e])),dataBoundary:this.dataBoundary}}isSingleTenant(){return!this.tenantProfiles}static createAccount(e,t,n){var r,a,i,s,o,l,c,u,d;const h=new eu;let f;t.authorityType===vc?h.authorityType=Re:t.protocolMode===gt?h.authorityType=Me:h.authorityType=Oe,e.clientInfo&&n&&(f=Jc(e.clientInfo,n),f.xms_tdbr&&(h.dataBoundary="EU"===f.xms_tdbr?"EU":"None")),h.clientInfo=e.clientInfo,h.homeAccountId=e.homeAccountId,h.nativeAccountId=e.nativeAccountId;const m=e.environment||t&&t.getPreferredCache();if(!m)throw pn($t);h.environment=m,h.realm=(null===(r=f)||void 0===r?void 0:r.utid)||Zc(e.idTokenClaims)||"",h.localAccountId=(null===(a=f)||void 0===a?void 0:a.uid)||(null===(i=e.idTokenClaims)||void 0===i?void 0:i.oid)||(null===(s=e.idTokenClaims)||void 0===s?void 0:s.sub)||"";const g=(null===(o=e.idTokenClaims)||void 0===o?void 0:o.preferred_username)||(null===(l=e.idTokenClaims)||void 0===l?void 0:l.upn),p=null!==(c=e.idTokenClaims)&&void 0!==c&&c.emails?e.idTokenClaims.emails[0]:null;if(h.username=g||p||"",h.loginHint=null===(u=e.idTokenClaims)||void 0===u?void 0:u.login_hint,h.name=(null===(d=e.idTokenClaims)||void 0===d?void 0:d.name)||"",h.cloudGraphHostName=e.cloudGraphHostName,h.msGraphHost=e.msGraphHost,e.tenantProfiles)h.tenantProfiles=e.tenantProfiles;else{const t=Jn(e.homeAccountId,h.localAccountId,h.realm,e.idTokenClaims);h.tenantProfiles=[t]}return h}static createFromAccountInfo(e,t,n){var r;const a=new eu;return a.authorityType=e.authorityType||Me,a.homeAccountId=e.homeAccountId,a.localAccountId=e.localAccountId,a.nativeAccountId=e.nativeAccountId,a.realm=e.tenantId,a.environment=e.environment,a.username=e.username,a.name=e.name,a.loginHint=e.loginHint,a.cloudGraphHostName=t,a.msGraphHost=n,a.tenantProfiles=Array.from((null===(r=e.tenantProfiles)||void 0===r?void 0:r.values())||[]),a.dataBoundary=e.dataBoundary,a}static generateHomeAccountId(e,t,n,r,a){if(t!==vc&&t!==yc){if(e)try{const t=Jc(e,r.base64Decode);if(t.uid&&t.utid)return"".concat(t.uid,".").concat(t.utid)}catch(i){}n.warning("No client info in response")}return(null===a||void 0===a?void 0:a.sub)||""}static isAccountEntity(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"))}static accountInfoIsEqual(e,t,n){if(!e||!t)return!1;let r=!0;if(n){const n=e.idTokenClaims||{},a=t.idTokenClaims||{};r=n.iat===a.iat&&n.nonce===a.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.loginHint===t.loginHint&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&r}}function tu(e,t,n){var r;return{clientId:e,authority:t.authority,scopes:t.scopes,homeAccountIdentifier:n,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid,embeddedClientId:t.embeddedClientId||(null===(r=t.tokenBodyParameters)||void 0===r?void 0:r.clientId)}}const nu=864e5,ru="Lax",au="None";class iu{initialize(){return Promise.resolve()}getItem(e){const t="".concat(encodeURIComponent(e)),n=document.cookie.split(";");for(let r=0;r<n.length;r++){const e=n[r],[a,...i]=decodeURIComponent(e).trim().split("="),s=i.join("=");if(a===t)return s}return""}getUserData(){throw pn(hn)}setItem(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ru,i="".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t),";path=/;SameSite=").concat(a,";");if(n){const e=function(e){const t=new Date,n=new Date(t.getTime()+e*nu);return n.toUTCString()}(n);i+="expires=".concat(e,";")}(r||a===au)&&(i+="Secure;"),document.cookie=i}async setUserData(){return Promise.reject(pn(hn))}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),t=[];return e.forEach(e=>{const n=decodeURIComponent(e).trim().split("=");t.push(n[0])}),t}containsKey(e){return this.getKeys().includes(e)}decryptData(){return Promise.resolve(null)}}function su(e,t){const n=e.getItem(tc(t));return n?JSON.parse(n):[]}function ou(e,t,n){const r=t.getItem(nc(e,n));if(r){const e=JSON.parse(r);if(e&&e.hasOwnProperty("idToken")&&e.hasOwnProperty("accessToken")&&e.hasOwnProperty("refreshToken"))return e}return{idToken:[],accessToken:[],refreshToken:[]}}function lu(e){return e.hasOwnProperty("id")&&e.hasOwnProperty("nonce")&&e.hasOwnProperty("data")}const cu="msal.cache.encryption";class uu{constructor(e,t,n){if(!window.localStorage)throw Dl(Pl);this.memoryStorage=new hc,this.initialized=!1,this.clientId=e,this.logger=t,this.performanceClient=n,this.broadcast=new BroadcastChannel("msal.broadcast.cache")}async initialize(e){const t=new iu,n=t.getItem(cu);let r={key:"",id:""};if(n)try{r=JSON.parse(n)}catch(a){}if(r.key&&r.id){const t=wc(sl,Ga,this.logger,this.performanceClient,e)(r.key);this.encryptionCookie={id:r.id,key:await Sc(kl,Va,this.logger,this.performanceClient,e)(t)}}else{const n=wl(),r=await Sc(xl,Ka,this.logger,this.performanceClient,e)(),a=wc(nl,Ya,this.logger,this.performanceClient,e)(new Uint8Array(r));this.encryptionCookie={id:n,key:await Sc(kl,Va,this.logger,this.performanceClient,e)(r)};const i={id:n,key:a};t.setItem(cu,JSON.stringify(i),0,!0,au)}await Sc(this.importExistingCache.bind(this),Fa,this.logger,this.performanceClient,e)(e),this.broadcast.addEventListener("message",this.updateCache.bind(this)),this.initialized=!0}getItem(e){return window.localStorage.getItem(e)}getUserData(e){if(!this.initialized)throw uo(Zs);return this.memoryStorage.getItem(e)}async decryptData(e,t,n){if(!this.initialized||!this.encryptionCookie)throw uo(Zs);if(t.id!==this.encryptionCookie.id)return this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},n),null;const r=await Sc(Il,Qa,this.logger,this.performanceClient,n)(this.encryptionCookie.key,t.nonce,this.getContext(e),t.data);if(!r)return null;try{return JSON.parse(r)}catch(a){return this.performanceClient.incrementFields({encryptedCacheCorruptionCount:1},n),null}}setItem(e,t){window.localStorage.setItem(e,t)}async setUserData(e,t,n,r){if(!this.initialized||!this.encryptionCookie)throw uo(Zs);const{data:a,nonce:i}=await Sc(El,$a,this.logger,this.performanceClient,n)(this.encryptionCookie.key,t,this.getContext(e)),s={id:this.encryptionCookie.id,nonce:i,data:a,lastUpdatedAt:r};this.memoryStorage.setItem(e,t),this.setItem(e,JSON.stringify(s)),this.broadcast.postMessage({key:e,value:t,context:this.getContext(e)})}removeItem(e){this.memoryStorage.containsKey(e)&&(this.memoryStorage.removeItem(e),this.broadcast.postMessage({key:e,value:null,context:this.getContext(e)})),window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}clear(){this.memoryStorage.clear();su(this).forEach(e=>this.removeItem(e));const e=ou(this.clientId,this);e.idToken.forEach(e=>this.removeItem(e)),e.accessToken.forEach(e=>this.removeItem(e)),e.refreshToken.forEach(e=>this.removeItem(e)),this.getKeys().forEach(e=>{(e.startsWith(Gl)||-1!==e.indexOf(this.clientId))&&this.removeItem(e)})}async importExistingCache(e){if(!this.encryptionCookie)return;let t=su(this);t=await this.importArray(t,e),t.length?this.setItem(tc(),JSON.stringify(t)):this.removeItem(tc());const n=ou(this.clientId,this);n.idToken=await this.importArray(n.idToken,e),n.accessToken=await this.importArray(n.accessToken,e),n.refreshToken=await this.importArray(n.refreshToken,e),n.idToken.length||n.accessToken.length||n.refreshToken.length?this.setItem(nc(this.clientId),JSON.stringify(n)):this.removeItem(nc(this.clientId))}async getItemFromEncryptedCache(e,t){if(!this.encryptionCookie)return null;const n=this.getItem(e);if(!n)return null;let r;try{r=JSON.parse(n)}catch(a){return null}return lu(r)?r.id!==this.encryptionCookie.id?(this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},t),null):Sc(Il,Qa,this.logger,this.performanceClient,t)(this.encryptionCookie.key,r.nonce,this.getContext(e),r.data):(this.performanceClient.incrementFields({unencryptedCacheCount:1},t),r)}async importArray(e,t){const n=[],r=[];return e.forEach(e=>{const a=this.getItemFromEncryptedCache(e,t).then(t=>{t?(this.memoryStorage.setItem(e,t),n.push(e)):this.removeItem(e)});r.push(a)}),await Promise.all(r),n}getContext(e){let t="";return e.includes(this.clientId)&&(t=this.clientId),t}updateCache(e){this.logger.trace("Updating internal cache from broadcast event");const t=this.performanceClient.startMeasurement(Ua);t.add({isBackground:!0});const{key:n,value:r,context:a}=e.data;return n?a&&a!==this.clientId?(this.logger.trace("Ignoring broadcast event from clientId: ".concat(a)),void t.end({success:!1,errorCode:"contextMismatch"})):(r?(this.memoryStorage.setItem(n,r),this.logger.verbose("Updated item in internal cache")):(this.memoryStorage.removeItem(n),this.logger.verbose("Removed item from internal cache")),void t.end({success:!0})):(this.logger.error("Broadcast event missing key"),void t.end({success:!1,errorCode:"noKey"}))}}class du{constructor(){if(!window.sessionStorage)throw Dl(Pl)}async initialize(){}getItem(e){return window.sessionStorage.getItem(e)}getUserData(e){return this.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}decryptData(){return Promise.resolve(null)}}const hu="msal:initializeStart",fu="msal:initializeEnd",mu="msal:accountAdded",gu="msal:accountRemoved",pu="msal:activeAccountChanged",vu="msal:loginStart",yu="msal:loginSuccess",bu="msal:loginFailure",wu="msal:acquireTokenStart",Su="msal:acquireTokenSuccess",Tu="msal:acquireTokenFailure",Au="msal:acquireTokenFromNetworkStart",xu="msal:ssoSilentStart",ku="msal:ssoSilentSuccess",Cu="msal:ssoSilentFailure",Eu="msal:acquireTokenByCodeStart",Iu="msal:acquireTokenByCodeSuccess",Nu="msal:acquireTokenByCodeFailure",Pu="msal:handleRedirectStart",_u="msal:handleRedirectEnd",Ou="msal:popupOpened",Ru="msal:logoutStart",Mu="msal:logoutSuccess",Du="msal:logoutFailure",Lu="msal:logoutEnd",Fu="msal:restoreFromBFCache";function ju(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class Uu extends vr{constructor(e,t,n,r,a,i,s){super(e,n,r,a,s),this.cacheConfig=t,this.logger=r,this.internalStorage=new hc,this.browserStorage=Bu(e,t.cacheLocation,r,a),this.temporaryCacheStorage=Bu(e,t.temporaryCacheLocation,r,a),this.cookieStorage=new iu,this.eventHandler=i}async initialize(e){this.performanceClient.addFields({cacheLocation:this.cacheConfig.cacheLocation,cacheRetentionDays:this.cacheConfig.cacheRetentionDays},e),await this.browserStorage.initialize(e),await this.migrateExistingCache(e),this.trackVersionChanges(e)}async migrateExistingCache(e){const t=su(this.browserStorage,0),n=ou(this.clientId,this.browserStorage,0);this.performanceClient.addFields({oldAccountCount:t.length,oldAccessCount:n.accessToken.length,oldIdCount:n.idToken.length,oldRefreshCount:n.refreshToken.length},e);const r=su(this.browserStorage,1),a=ou(this.clientId,this.browserStorage,1);this.performanceClient.addFields({currAccountCount:r.length,currAccessCount:a.accessToken.length,currIdCount:a.idToken.length,currRefreshCount:a.refreshToken.length},e),await Promise.all([this.updateV0ToCurrent(1,t,r,e),this.updateV0ToCurrent(1,n.idToken,a.idToken,e),this.updateV0ToCurrent(1,n.accessToken,a.accessToken,e),this.updateV0ToCurrent(1,n.refreshToken,a.refreshToken,e)]),t.length>0?this.browserStorage.setItem(tc(0),JSON.stringify(t)):this.browserStorage.removeItem(tc(0)),r.length>0?this.browserStorage.setItem(tc(1),JSON.stringify(r)):this.browserStorage.removeItem(tc(1)),this.setTokenKeys(n,e,0),this.setTokenKeys(a,e,1)}async updateV0ToCurrent(e,t,n,r){const a=[];for(const i of[...t]){const s=this.browserStorage.getItem(i),o=this.validateAndParseJson(s||"");if(!o){ju(t,i);continue}o.lastUpdatedAt||(o.lastUpdatedAt=Date.now().toString(),this.setItem(i,JSON.stringify(o),r));const l=lu(o)?await this.browserStorage.decryptData(i,o,r):o;let c;if(l&&(Oc(l)||Rc(l))&&(c=l.expiresOn),!l||Ec(o.lastUpdatedAt,this.cacheConfig.cacheRetentionDays)||c&&Cc(c,300))this.browserStorage.removeItem(i),ju(t,i),this.performanceClient.incrementFields({expiredCacheRemovedCount:1},r);else if(this.cacheConfig.cacheLocation!==Pi||lu(o)){const t="".concat(Gl,".").concat(e).concat("-").concat(i),s=this.browserStorage.getItem(t);if(!s){a.push(this.setUserData(t,JSON.stringify(l),r,o.lastUpdatedAt).then(()=>{n.push(t),this.performanceClient.incrementFields({upgradedCacheCount:1},r)}));continue}{const e=this.validateAndParseJson(s);if(Number(o.lastUpdatedAt)>Number(e.lastUpdatedAt)){a.push(this.setUserData(t,JSON.stringify(l),r,o.lastUpdatedAt).then(()=>{this.performanceClient.incrementFields({updatedCacheFromV0Count:1},r)}));continue}}}}return Promise.all(a)}trackVersionChanges(e){const t=this.browserStorage.getItem(Xl);t&&(this.logger.info("MSAL.js was last initialized by version: ".concat(t)),this.performanceClient.addFields({previousLibraryVersion:t},e)),t!==Kl&&this.setItem(Xl,Kl,e)}validateAndParseJson(e){if(!e)return null;try{const t=JSON.parse(e);return t&&"object"===typeof t?t:null}catch(t){return null}}setItem(e,t,n){let r=0,a=[];for(let s=0;s<=20;s++)try{this.browserStorage.setItem(e,t),s>0&&(s<=r?this.removeAccessTokenKeys(a.slice(0,s),n,0):(this.removeAccessTokenKeys(a.slice(0,r),n,0),this.removeAccessTokenKeys(a.slice(r,s),n)));break}catch(i){const o=pr(i);if(!(o.errorCode===hr&&s<20))throw o;if(!a.length){const n=e===nc(this.clientId,0)?JSON.parse(t).accessToken:this.getTokenKeys(0).accessToken,i=e===nc(this.clientId)?JSON.parse(t).accessToken:this.getTokenKeys().accessToken;a=[...n,...i],r=n.length}if(a.length<=s)throw o;this.removeAccessToken(a[s],n,!1)}}async setUserData(e,t,n,r){let a=0,i=[];for(let o=0;o<=20;o++)try{await Sc(this.browserStorage.setUserData.bind(this.browserStorage),ja,this.logger,this.performanceClient)(e,t,n,r),o>0&&(o<=a?this.removeAccessTokenKeys(i.slice(0,o),n,0):(this.removeAccessTokenKeys(i.slice(0,a),n,0),this.removeAccessTokenKeys(i.slice(a,o),n)));break}catch(s){const e=pr(s);if(!(e.errorCode===hr&&o<20))throw e;if(!i.length){const e=this.getTokenKeys(0).accessToken,t=this.getTokenKeys().accessToken;i=[...e,...t],a=e.length}if(i.length<=o)throw e;this.removeAccessToken(i[o],n,!1)}}getAccount(e,t){this.logger.trace("BrowserCacheManager.getAccount called");const n=this.browserStorage.getUserData(e);if(!n)return this.removeAccountKeyFromMap(e,t),null;const r=this.validateAndParseJson(n);return r&&eu.isAccountEntity(r)?vr.toObject(new eu,r):null}async setAccount(e,t){this.logger.trace("BrowserCacheManager.setAccount called");const n=this.generateAccountKey(e.getAccountInfo()),r=Date.now().toString();e.lastUpdatedAt=r,await this.setUserData(n,JSON.stringify(e),t,r);const a=this.addAccountKeyToMap(n,t);this.cacheConfig.cacheLocation===Pi&&a&&this.eventHandler.emitEvent(mu,void 0,e.getAccountInfo())}getAccountKeys(){return su(this.browserStorage)}addAccountKeyToMap(e,t){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii("BrowserCacheManager.addAccountKeyToMap called with key: ".concat(e));const n=this.getAccountKeys();return-1===n.indexOf(e)?(n.push(e),this.setItem(tc(),JSON.stringify(n),t),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added"),!0):(this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map"),!1)}removeAccountKeyFromMap(e,t){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii("BrowserCacheManager.removeAccountKeyFromMap called with key: ".concat(e));const n=this.getAccountKeys(),r=n.indexOf(e);if(r>-1){if(n.splice(r,1),0===n.length)return void this.removeItem(tc());this.setItem(tc(),JSON.stringify(n),t),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")}else this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}removeAccount(e,t){const n=this.getActiveAccount(t);(null===n||void 0===n?void 0:n.homeAccountId)===e.homeAccountId&&(null===n||void 0===n?void 0:n.environment)===e.environment&&this.setActiveAccount(null,t),super.removeAccount(e,t),this.removeAccountKeyFromMap(this.generateAccountKey(e),t),this.browserStorage.getKeys().forEach(t=>{t.includes(e.homeAccountId)&&t.includes(e.environment)&&this.browserStorage.removeItem(t)}),this.cacheConfig.cacheLocation===Pi&&this.eventHandler.emitEvent(gu,void 0,e)}removeIdToken(e,t){super.removeIdToken(e,t);const n=this.getTokenKeys(),r=n.idToken.indexOf(e);r>-1&&(this.logger.info("idToken removed from tokenKeys map"),n.idToken.splice(r,1),this.setTokenKeys(n,t))}removeAccessToken(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super.removeAccessToken(e,t),n&&this.removeAccessTokenKeys([e],t)}removeAccessTokenKeys(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.logger.trace("removeAccessTokenKey called");const r=this.getTokenKeys(n);let a=0;if(e.forEach(e=>{const t=r.accessToken.indexOf(e);t>-1&&(r.accessToken.splice(t,1),a++)}),a>0)return this.logger.info("removed ".concat(a," accessToken keys from tokenKeys map")),void this.setTokenKeys(r,t,n)}removeRefreshToken(e,t){super.removeRefreshToken(e,t);const n=this.getTokenKeys(),r=n.refreshToken.indexOf(e);r>-1&&(this.logger.info("refreshToken removed from tokenKeys map"),n.refreshToken.splice(r,1),this.setTokenKeys(n,t))}getTokenKeys(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return ou(this.clientId,this.browserStorage,e)}setTokenKeys(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;0!==e.idToken.length||0!==e.accessToken.length||0!==e.refreshToken.length?this.setItem(nc(this.clientId,n),JSON.stringify(e),t):this.removeItem(nc(this.clientId,n))}getIdTokenCredential(e,t){const n=this.browserStorage.getUserData(e);if(!n)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeIdToken(e,t),null;const r=this.validateAndParseJson(n);return r&&(a=r)&&_c(a)&&a.hasOwnProperty("realm")&&a.credentialType===Fe.ID_TOKEN?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null);var a}async setIdTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const n=this.generateCredentialKey(e),r=Date.now().toString();e.lastUpdatedAt=r,await this.setUserData(n,JSON.stringify(e),t,r);const a=this.getTokenKeys();-1===a.idToken.indexOf(n)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),a.idToken.push(n),this.setTokenKeys(a,t))}getAccessTokenCredential(e,t){const n=this.browserStorage.getUserData(e);if(!n)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeAccessTokenKeys([e],t),null;const r=this.validateAndParseJson(n);return r&&Oc(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null)}async setAccessTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const n=this.generateCredentialKey(e),r=Date.now().toString();e.lastUpdatedAt=r,await this.setUserData(n,JSON.stringify(e),t,r);const a=this.getTokenKeys(),i=a.accessToken.indexOf(n);-1!==i&&a.accessToken.splice(i,1),this.logger.trace("access token ".concat(-1===i?"added to":"updated in"," map")),a.accessToken.push(n),this.setTokenKeys(a,t)}getRefreshTokenCredential(e,t){const n=this.browserStorage.getUserData(e);if(!n)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeRefreshToken(e,t),null;const r=this.validateAndParseJson(n);return r&&Rc(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null)}async setRefreshTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const n=this.generateCredentialKey(e),r=Date.now().toString();e.lastUpdatedAt=r,await this.setUserData(n,JSON.stringify(e),t,r);const a=this.getTokenKeys();-1===a.refreshToken.indexOf(n)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),a.refreshToken.push(n),this.setTokenKeys(a,t))}getAppMetadata(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&(r=e,(a=n)&&0===r.indexOf(je)&&a.hasOwnProperty("clientId")&&a.hasOwnProperty("environment"))?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),n):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null);var r,a}setAppMetadata(e,t){this.logger.trace("BrowserCacheManager.setAppMetadata called");const n=function(e){let{environment:t,clientId:n}=e;return[je,t,n].join(De).toLowerCase()}(e);this.setItem(n,JSON.stringify(e),t)}getServerTelemetry(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&function(e,t){const n=0===e.indexOf(Ke.CACHE_KEY);let r=!0;return t&&(r=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),n&&r}(e,n)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),n):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)}setServerTelemetry(e,t,n){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t),n)}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&function(e,t){return!!t&&0===e.indexOf(Be)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri")}(e,n)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),n):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(e=>this.isAuthorityMetadata(e))}setWrapperMetadata(e,t){this.internalStorage.setItem(qi,e),this.internalStorage.setItem(Wi,t)}getWrapperMetadata(){return[this.internalStorage.getItem(qi)||J.EMPTY_STRING,this.internalStorage.getItem(Wi)||J.EMPTY_STRING]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(e){const t=this.generateCacheKey(me),n=this.browserStorage.getItem(t);if(!n)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters found"),null;const r=this.validateAndParseJson(n);return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:r.homeAccountId,localAccountId:r.localAccountId,tenantId:r.tenantId},e)):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e,t){const n=this.generateCacheKey(me);if(e){this.logger.verbose("setActiveAccount: Active account set");const r={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId,lastUpdatedAt:Ac().toString()};this.setItem(n,JSON.stringify(r),t)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(n);this.eventHandler.emitEvent(pu)}getThrottlingCache(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&function(e,t){let n=!1;e&&(n=0===e.indexOf(Qe));let r=!0;return t&&(r=t.hasOwnProperty("throttleTime")),n&&r}(e,n)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),n):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)}setThrottlingCache(e,t,n){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t),n)}getTemporaryCache(e,t){const n=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const e=this.cookieStorage.getItem(n);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),e}const r=this.temporaryCacheStorage.getItem(n);if(!r){if(this.cacheConfig.cacheLocation===Pi){const e=this.browserStorage.getItem(n);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),e}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),r}setTemporaryCache(e,t,n){const r=n?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(r,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(r,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}clear(e){this.removeAllAccounts(e),this.removeAppMetadata(e),this.temporaryCacheStorage.getKeys().forEach(e=>{-1===e.indexOf(Gl)&&-1===e.indexOf(this.clientId)||this.removeTemporaryItem(e)}),this.browserStorage.getKeys().forEach(e=>{-1===e.indexOf(Gl)&&-1===e.indexOf(this.clientId)||this.browserStorage.removeItem(e)}),this.internalStorage.clear()}clearTokensAndKeysWithClaims(e){this.performanceClient.addQueueMeasurement(Da,e);const t=this.getTokenKeys();let n=0;t.accessToken.forEach(t=>{const r=this.getAccessTokenCredential(t,e);null!==r&&void 0!==r&&r.requestedClaimsHash&&t.includes(r.requestedClaimsHash.toLowerCase())&&(this.removeAccessToken(t,e),n++)}),n>0&&this.logger.warning("".concat(n," access tokens with claims in the cache keys have been removed from the cache."))}generateCacheKey(e){return Kn.startsWith(e,Gl)?e:"".concat(Gl,".").concat(this.clientId,".").concat(e)}generateCredentialKey(e){const t=e.credentialType===Fe.REFRESH_TOKEN&&e.familyId||e.clientId,n=e.tokenType&&e.tokenType.toLowerCase()!==Ge.BEARER.toLowerCase()?e.tokenType.toLowerCase():"";return["".concat(Gl,".").concat(1),e.homeAccountId,e.environment,e.credentialType,t,e.realm||"",e.target||"",e.requestedClaimsHash||"",n].join("-").toLowerCase()}generateAccountKey(e){const t=e.homeAccountId.split(".")[1];return["".concat(Gl,".").concat(1),e.homeAccountId,e.environment,t||e.tenantId||""].join("-").toLowerCase()}resetRequestCache(){this.logger.trace("BrowserCacheManager.resetRequestCache called"),this.removeTemporaryItem(this.generateCacheKey(Ui)),this.removeTemporaryItem(this.generateCacheKey(Bi)),this.removeTemporaryItem(this.generateCacheKey(Fi)),this.removeTemporaryItem(this.generateCacheKey(ji)),this.removeTemporaryItem(this.generateCacheKey(zi)),this.setInteractionInProgress(!1)}cacheAuthorizeRequest(e,t){this.logger.trace("BrowserCacheManager.cacheAuthorizeRequest called");const n=rl(JSON.stringify(e));if(this.setTemporaryCache(Ui,n,!0),t){const e=rl(t);this.setTemporaryCache(Bi,e,!0)}}getCachedRequest(){this.logger.trace("BrowserCacheManager.getCachedRequest called");const e=this.getTemporaryCache(Ui,!0);if(!e)throw uo(Rs);const t=this.getTemporaryCache(Bi,!0);let n,r="";try{n=JSON.parse(il(e)),t&&(r=il(t))}catch(a){throw this.logger.errorPii("Attempted to parse: ".concat(e)),this.logger.error("Parsing cached token request threw with error: ".concat(a)),uo(Ms)}return[n,r]}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(zi,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){var t;const n=null===(t=this.getInteractionInProgress())||void 0===t?void 0:t.clientId;return e?n===this.clientId:!!n}getInteractionInProgress(){const e="".concat(Gl,".").concat(Hi),t=this.getTemporaryCache(e,!1);try{return t?JSON.parse(t):null}catch(n){return this.logger.error("Cannot parse interaction status. Removing temporary cache items and clearing url hash. Retrying interaction should fix the error"),this.removeTemporaryItem(e),this.resetRequestCache(),Ll(window),null}}setInteractionInProgress(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Di;const r="".concat(Gl,".").concat(Hi);if(e){if(this.getInteractionInProgress())throw uo(ws);this.setTemporaryCache(r,JSON.stringify({clientId:this.clientId,type:n}),!1)}else e||(null===(t=this.getInteractionInProgress())||void 0===t?void 0:t.clientId)!==this.clientId||this.removeTemporaryItem(r)}async hydrateCache(e,t){var n,r,a;const i=Ic(null===(n=e.account)||void 0===n?void 0:n.homeAccountId,null===(r=e.account)||void 0===r?void 0:r.environment,e.idToken,this.clientId,e.tenantId);let s;t.claims&&(s=await this.cryptoImpl.hashString(t.claims));const o={idToken:i,accessToken:Nc(null===(a=e.account)||void 0===a?void 0:a.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?xc(e.expiresOn):0,e.extExpiresOn?xc(e.extExpiresOn):0,il,void 0,e.tokenType,void 0,t.sshKid,t.claims,s)};return this.saveCacheRecord(o,e.correlationId)}async saveCacheRecord(e,t,n){try{await super.saveCacheRecord(e,t,n)}catch(r){if(r instanceof gr&&this.performanceClient&&t)try{const e=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:e.refreshToken.length,cacheIdCount:e.idToken.length,cacheAtCount:e.accessToken.length},t)}catch(r){}throw r}}}function Bu(e,t,n,r){try{switch(t){case Pi:return new uu(e,n,r);case _i:return new du}}catch(a){n.error(a)}return new hc}class Hu{constructor(e){this.eventCallbacks=new Map,this.logger=e||new ft({}),"undefined"!==typeof BroadcastChannel&&(this.broadcastChannel=new BroadcastChannel("msal.broadcast.event")),this.invokeCrossTabCallbacks=this.invokeCrossTabCallbacks.bind(this)}addEventCallback(e,t,n){if("undefined"!==typeof window){const r=n||wl();return this.eventCallbacks.has(r)?(this.logger.error("Event callback with id: ".concat(r," is already registered. Please provide a unique id or remove the existing callback and try again.")),null):(this.eventCallbacks.set(r,[e,t||[]]),this.logger.verbose("Event callback registered with id: ".concat(r)),r)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback ".concat(e," removed."))}emitEvent(e,t,n,r){var a;const i={eventType:e,interactionType:t||null,payload:n||null,error:r||null,timestamp:Date.now()};switch(e){case mu:case gu:case pu:null===(a=this.broadcastChannel)||void 0===a||a.postMessage(i);break;default:this.invokeCallbacks(i)}}invokeCallbacks(e){this.eventCallbacks.forEach((t,n)=>{let[r,a]=t;(0===a.length||a.includes(e.eventType))&&(this.logger.verbose("Emitting event to callback ".concat(n,": ").concat(e.eventType)),r.apply(null,[e]))})}invokeCrossTabCallbacks(e){const t=e.data;this.invokeCallbacks(t)}subscribeCrossTab(){var e;null===(e=this.broadcastChannel)||void 0===e||e.addEventListener("message",this.invokeCrossTabCallbacks)}unsubscribeCrossTab(){var e;null===(e=this.broadcastChannel)||void 0===e||e.removeEventListener("message",this.invokeCrossTabCallbacks)}}const zu="home_account_id",qu="UPN";async function Wu(e,t,n,r,a,i,s){null===s||void 0===s||s.addQueueMeasurement(wa,i);const o=jc.transformCIAMAuthority(Uc(e)),l=new jc(o,t,n,r,a,i,s);try{return await Sc(l.resolveEndpointsAsync.bind(l),Sa,a,s,i)(),l}catch(c){throw pn(Et)}}class Vu extends St{constructor(e,t,n,r,a){super(e,t,n),this.name="ServerError",this.errorNo=r,this.status=a,Object.setPrototypeOf(this,Vu.prototype)}}class Ku{static generateThrottlingStorageKey(e){return"".concat(Qe,".").concat(JSON.stringify(e))}static preProcess(e,t,n){const r=Ku.generateThrottlingStorageKey(t),a=e.getThrottlingCache(r);if(a){var i;if(a.throttleTime<Date.now())return void e.removeItem(r,n);throw new Vu((null===(i=a.errorCodes)||void 0===i?void 0:i.join(" "))||J.EMPTY_STRING,a.errorMessage,a.subError)}}static postProcess(e,t,n,r){if(Ku.checkResponseStatus(n)||Ku.checkResponseForRetryAfter(n)){const a={throttleTime:Ku.calculateThrottleTime(parseInt(n.headers[ue])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};e.setThrottlingCache(Ku.generateThrottlingStorageKey(t),a,r)}}static checkResponseStatus(e){return 429===e.status||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return!!e.headers&&(e.headers.hasOwnProperty(ue)&&(e.status<200||e.status>=300))}static calculateThrottleTime(e){const t=e<=0?0:e,n=Date.now()/1e3;return Math.floor(1e3*Math.min(n+(t||Ye),n+$e))}static removeThrottle(e,t,n,r){const a=tu(t,n,r),i=this.generateThrottlingStorageKey(a);e.removeItem(i,n.correlationId)}}class Gu{constructor(e,t){this.config=function(e){let{authOptions:t,systemOptions:n,loggerOptions:r,cacheOptions:a,storageInterface:i,networkInterface:s,cryptoInterface:o,clientCredentials:l,libraryInfo:u,telemetry:d,serverTelemetryManager:h,persistencePlugin:f,serializableCache:m}=e;const g=c(c({},ri),r);return{authOptions:(p=t,c({clientCapabilities:[],azureCloudOptions:li,skipAuthorityMetadataCache:!1,instanceAware:!1,encodeExtraQueryParams:!1},p)),systemOptions:c(c({},ni),n),loggerOptions:g,cacheOptions:c(c({},ai),a),storageInterface:i||new yr(t.clientId,vn,new ft(g),new ti),networkInterface:s||ii,cryptoInterface:o||vn,clientCredentials:l||oi,libraryInfo:c(c({},si),u),telemetry:c(c({},ci),d),serverTelemetryManager:h||null,persistencePlugin:f||null,serializableCache:m||null};var p}(e),this.logger=new ft(this.config.loggerOptions,yn,bn),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[le]=J.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case zu:try{const n=Xc(e.credential);t[de]="Oid:".concat(n.uid,"@").concat(n.utid)}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case qu:t[de]="UPN: ".concat(e.credential)}return t}async executePostToTokenEndpoint(e,t,n,r,a,i){var s;i&&(null===(s=this.performanceClient)||void 0===s||s.addQueueMeasurement(i,a));const o=await this.sendPostRequest(r,e,{body:t,headers:n},a);return this.config.serverTelemetryManager&&o.status<500&&429!==o.status&&this.config.serverTelemetryManager.clearTelemetryCache(),o}async sendPostRequest(e,t,n,r){let a;Ku.preProcess(this.cacheManager,e,r);try{var i,s;a=await Sc(this.networkClient.sendPostRequestAsync.bind(this.networkClient),Dr,this.logger,this.performanceClient,r)(t,n);const e=a.headers||{};null===(i=this.performanceClient)||void 0===i||i.addFields({refreshTokenSize:(null===(s=a.body.refresh_token)||void 0===s?void 0:s.length)||0,httpVerToken:e[fe]||"",requestId:e[he]||""},r)}catch(l){if(l instanceof fo){const e=l.responseHeaders;var o;if(e)null===(o=this.performanceClient)||void 0===o||o.addFields({httpVerToken:e[fe]||"",requestId:e[he]||"",contentTypeHeader:e[le]||void 0,contentLengthHeader:e[ce]||void 0,httpStatus:l.httpStatus},r);throw l.error}throw l instanceof St?l:pn(It)}return Ku.postProcess(this.cacheManager,e,a,r),a}async updateAuthority(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(ha,t);const r="https://".concat(e,"/").concat(this.authority.tenant,"/"),a=await Wu(r,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=a}createTokenQueryParameters(e){const t=new Map;return e.embeddedClientId&&el(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenQueryParameters&&Yo(t,e.tokenQueryParameters),Fo(t,e.correlationId),Eo(t,e.correlationId,this.performanceClient),ar(t)}}class Yu{static setRequestState(e,t,n){const r=Yu.generateLibraryState(e,n);return t?"".concat(r).concat(J.RESOURCE_DELIM).concat(t):r}static generateLibraryState(e,t){if(!e)throw pn(Jt);const n={id:e.createNewGuid()};t&&(n.meta=t);const r=JSON.stringify(n);return e.base64Encode(r)}static parseRequestState(e,t){if(!e)throw pn(Jt);if(!t)throw pn(_t);try{const n=t.split(J.RESOURCE_DELIM),r=n[0],a=n.length>1?n.slice(1).join(J.RESOURCE_DELIM):J.EMPTY_STRING,i=e.base64Decode(r),s=JSON.parse(i);return{userRequestState:a||J.EMPTY_STRING,libraryState:s}}catch(n){throw pn(_t)}}}const $u="sw";class Qu{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(pa,e.correlationId);const r=await Sc(this.generateKid.bind(this),pa,t,this.performanceClient,e.correlationId)(e),a=this.cryptoUtils.base64UrlEncode(JSON.stringify(r));return{kid:r.kid,reqCnfString:a}}async generateKid(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(va,e.correlationId);return{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:$u}}async signPopToken(e,t,n){return this.signPayload(e,t,n)}async signPayload(e,t,n,r){const{resourceRequestMethod:a,resourceRequestUri:i,shrClaims:s,shrNonce:o,shrOptions:l}=n,u=i?new sr(i):void 0,d=null===u||void 0===u?void 0:u.getUrlComponents();return this.cryptoUtils.signJwt(c({at:e,ts:Ac(),m:null===a||void 0===a?void 0:a.toUpperCase(),u:null===d||void 0===d?void 0:d.HostNameAndPort,nonce:o||this.cryptoUtils.createNewGuid(),p:null===d||void 0===d?void 0:d.AbsolutePath,q:null!==d&&void 0!==d&&d.QueryString?[[],d.QueryString]:void 0,client_claims:s||void 0},r),t,l,n.correlationId)}}class Ju{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}class Xu{constructor(e,t,n,r,a,i,s){this.clientId=e,this.cacheStorage=t,this.cryptoObj=n,this.logger=r,this.serializableCache=a,this.persistencePlugin=i,this.performanceClient=s}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){var n;const r="Error(s): ".concat(e.error_codes||J.NOT_AVAILABLE," - Timestamp: ").concat(e.timestamp||J.NOT_AVAILABLE," - Description: ").concat(e.error_description||J.NOT_AVAILABLE," - Correlation ID: ").concat(e.correlation_id||J.NOT_AVAILABLE," - Trace ID: ").concat(e.trace_id||J.NOT_AVAILABLE),a=null!==(n=e.error_codes)&&void 0!==n&&n.length?e.error_codes[0]:void 0,i=new Vu(e.error,r,e.suberror,a,e.status);if(t&&e.status&&e.status>=ne&&e.status<=re)return void this.logger.warning("executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.\n".concat(i));if(t&&e.status&&e.status>=Z&&e.status<=te)return void this.logger.warning("executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.\n".concat(i));if($c(e.error,e.error_description,e.suberror))throw new Yc(e.error,e.error_description,e.suberror,e.timestamp||J.EMPTY_STRING,e.trace_id||J.EMPTY_STRING,e.correlation_id||J.EMPTY_STRING,e.claims||J.EMPTY_STRING,a);throw i}}async handleServerTokenResponse(e,t,n,r,a,i,s,o,l){var c;let u,d;if(null===(c=this.performanceClient)||void 0===c||c.addQueueMeasurement(ya,e.correlation_id),e.id_token){if(u=Zn(e.id_token||J.EMPTY_STRING,this.cryptoObj.base64Decode),a&&a.nonce&&u.nonce!==a.nonce)throw pn(Mt);if(r.maxAge||0===r.maxAge){const e=u.auth_time;if(!e)throw pn(Dt);er(e,r.maxAge)}}this.homeAccountIdentifier=eu.generateHomeAccountId(e.client_info||J.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,u),a&&a.state&&(d=Yu.parseRequestState(this.cryptoObj,a.state)),e.key_id=e.key_id||r.sshKid||void 0;const h=this.generateCacheRecord(e,t,n,r,u,i,a);let f;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),f=new Ju(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(f)),s&&!o&&h.account){const e=this.cacheStorage.generateAccountKey(h.account.getAccountInfo());if(!this.cacheStorage.getAccount(e,r.correlationId))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await Xu.generateAuthenticationResult(this.cryptoObj,t,h,!1,r,u,d,void 0,l)}await this.cacheStorage.saveCacheRecord(h,r.correlationId,r.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&f&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(f))}return Xu.generateAuthenticationResult(this.cryptoObj,t,h,!1,r,u,d,e,l)}generateCacheRecord(e,t,n,r,a,i,s){const o=t.getPreferredCache();if(!o)throw pn($t);const l=Zc(a);let c,u;e.id_token&&a&&(c=Ic(this.homeAccountIdentifier,o,e.id_token,this.clientId,l||""),u=Zu(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,r.correlationId,a,e.client_info,o,l,s,void 0,this.logger));let d=null;if(e.access_token){const a=e.scope?Gn.fromString(e.scope):new Gn(r.scopes||[]),s=("string"===typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,c=("string"===typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,u=("string"===typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,h=n+s,f=h+c,m=u&&u>0?n+u:void 0;d=Nc(this.homeAccountIdentifier,o,e.access_token,this.clientId,l||t.tenant||"",a.printScopes(),h,f,this.cryptoObj.base64Decode,m,e.token_type,i,e.key_id,r.claims,r.requestedClaimsHash)}let h=null;if(e.refresh_token){let t;if(e.refresh_token_expires_in){t=n+("string"===typeof e.refresh_token_expires_in?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in)}h=Pc(this.homeAccountIdentifier,o,e.refresh_token,this.clientId,e.foci,i,t)}let f=null;return e.foci&&(f={clientId:this.clientId,environment:o,familyId:e.foci}),{account:u,idToken:c,accessToken:d,refreshToken:h,appMetadata:f}}static async generateAuthenticationResult(e,t,n,r,a,i,s,o,l){var c,u,d,h,f;let m,g,p=J.EMPTY_STRING,v=[],y=null,b=J.EMPTY_STRING;if(n.accessToken){if(n.accessToken.tokenType!==Ge.POP||a.popKid)p=n.accessToken.secret;else{const t=new Qu(e),{secret:r,keyId:i}=n.accessToken;if(!i)throw pn(ln);p=await t.signPopToken(r,i,a)}v=Gn.fromString(n.accessToken.target).asArray(),y=kc(n.accessToken.expiresOn),m=kc(n.accessToken.extendedExpiresOn),n.accessToken.refreshOn&&(g=kc(n.accessToken.refreshOn))}n.appMetadata&&(b=n.appMetadata.familyId===Ue?Ue:"");const w=(null===i||void 0===i?void 0:i.oid)||(null===i||void 0===i?void 0:i.sub)||"",S=(null===i||void 0===i?void 0:i.tid)||"";null!==o&&void 0!==o&&o.spa_accountid&&n.account&&(n.account.nativeAccountId=null===o||void 0===o?void 0:o.spa_accountid);const T=n.account?Xn(n.account.getAccountInfo(),void 0,i,null===(c=n.idToken)||void 0===c?void 0:c.secret):null;return{authority:t.canonicalAuthority,uniqueId:w,tenantId:S,scopes:v,account:T,idToken:(null===n||void 0===n||null===(u=n.idToken)||void 0===u?void 0:u.secret)||"",idTokenClaims:i||{},accessToken:p,fromCache:r,expiresOn:y,extExpiresOn:m,refreshOn:g,correlationId:a.correlationId,requestId:l||J.EMPTY_STRING,familyId:b,tokenType:(null===(d=n.accessToken)||void 0===d?void 0:d.tokenType)||J.EMPTY_STRING,state:s?s.userRequestState:J.EMPTY_STRING,cloudGraphHostName:(null===(h=n.account)||void 0===h?void 0:h.cloudGraphHostName)||J.EMPTY_STRING,msGraphHost:(null===(f=n.account)||void 0===f?void 0:f.msGraphHost)||J.EMPTY_STRING,code:null===o||void 0===o?void 0:o.spa_code,fromNativeBroker:!1}}}function Zu(e,t,n,r,a,i,s,o,l,c,u,d){null===d||void 0===d||d.verbose("setCachedAccount called");const h=e.getAccountKeys().find(e=>e.startsWith(n));let f=null;h&&(f=e.getAccount(h,a));const m=f||eu.createAccount({homeAccountId:n,idTokenClaims:i,clientInfo:s,environment:o,cloudGraphHostName:null===c||void 0===c?void 0:c.cloud_graph_host_name,msGraphHost:null===c||void 0===c?void 0:c.msgraph_host,nativeAccountId:u},t,r),g=m.tenantProfiles||[],p=l||m.realm;if(p&&!g.find(e=>e.tenantId===p)){const e=Jn(n,m.localAccountId,p,i);g.push(e)}return m.tenantProfiles=g,m}async function ed(e,t,n){if("string"===typeof e)return e;return e({clientId:t,tokenEndpoint:n})}class td extends Gu{constructor(e,t){var n;super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=null===(n=this.config.authOptions.authority.options.OIDCOptions)||void 0===n?void 0:n.defaultScopes}async acquireToken(e,t){var n,r;if(null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(fa,e.correlationId),!e.code)throw pn(Bt);const a=Ac(),i=await Sc(this.executeTokenRequest.bind(this),ma,this.logger,this.performanceClient,e.correlationId)(this.authority,e),s=null===(r=i.headers)||void 0===r?void 0:r[he],o=new Xu(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return o.validateTokenResponse(i.body),Sc(o.handleServerTokenResponse.bind(o),ya,this.logger,this.performanceClient,e.correlationId)(i.body,this.authority,a,e,t,void 0,void 0,void 0,s)}getLogoutUri(e){if(!e)throw Vn(In);const t=this.createLogoutUrlQueryString(e);return sr.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(ma,t.correlationId);const r=this.createTokenQueryParameters(t),a=sr.appendQueryString(e.tokenEndpoint,r),i=await Sc(this.createTokenRequestBody.bind(this),ga,this.logger,this.performanceClient,t.correlationId)(t);let s;if(t.clientInfo)try{const e=Jc(t.clientInfo,this.cryptoUtils.base64Decode);s={credential:"".concat(e.uid).concat(Le).concat(e.utid),type:zu}}catch(c){this.logger.verbose("Could not parse client info for CCS Header: "+c)}const o=this.createTokenRequestHeaders(s||t.ccsCredential),l=tu(this.config.authOptions.clientId,t);return Sc(this.executePostToTokenEndpoint.bind(this),Fr,this.logger,this.performanceClient,t.correlationId)(a,i,o,l,t.correlationId,Fr)}async createTokenRequestBody(e){var t,n;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(ga,e.correlationId);const r=new Map;if(Po(r,e.embeddedClientId||(null===(n=e.tokenBodyParameters)||void 0===n?void 0:n[yo])||this.config.authOptions.clientId),this.includeRedirectUri)_o(r,e.redirectUri);else if(!e.redirectUri)throw Vn(wn);if(No(r,e.scopes,!0,this.oidcDefaultScopes),function(e,t){e.set("code",t)}(r,e.code),jo(r,this.config.libraryInfo),Uo(r,this.config.telemetry.application),Zo(r),this.serverTelemetryManager&&!ui(this.config)&&Xo(r,this.serverTelemetryManager),e.codeVerifier&&function(e,t){e.set("code_verifier",t)}(r,e.codeVerifier),this.config.clientCredentials.clientSecret&&zo(r,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const t=this.config.clientCredentials.clientAssertion;qo(r,await ed(t.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),Wo(r,t.assertionType)}if(Vo(r,Pe),Ko(r),e.authenticationScheme===Ge.POP){const t=new Qu(this.cryptoUtils,this.performanceClient);let n;if(e.popKid)n=this.cryptoUtils.encodeKid(e.popKid);else{n=(await Sc(t.generateCnf.bind(t),pa,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString}Qo(r,n)}else if(e.authenticationScheme===Ge.SSH){if(!e.sshJwk)throw Vn(Mn);Jo(r,e.sshJwk)}let a;if((!Kn.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&Lo(r,e.claims,this.config.authOptions.clientCapabilities),e.clientInfo)try{const t=Jc(e.clientInfo,this.cryptoUtils.base64Decode);a={credential:"".concat(t.uid).concat(Le).concat(t.utid),type:zu}}catch(i){this.logger.verbose("Could not parse client info for CCS Header: "+i)}else a=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&a)switch(a.type){case zu:try{Mo(r,Xc(a.credential))}catch(i){this.logger.verbose("Could not parse home account ID for CCS Header: "+i)}break;case qu:Ro(r,a.credential)}return e.embeddedClientId&&el(r,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&Yo(r,e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[To]||Yo(r,{[To]:"1"}),Eo(r,e.correlationId,this.performanceClient),ar(r)}createLogoutUrlQueryString(e){const t=new Map;return e.postLogoutRedirectUri&&function(e,t){e.set("post_logout_redirect_uri",t)}(t,e.postLogoutRedirectUri),e.correlationId&&Fo(t,e.correlationId),e.idTokenHint&&function(e,t){e.set("id_token_hint",t)}(t,e.idTokenHint),e.state&&Bo(t,e.state),e.logoutHint&&function(e,t){e.set("logout_hint",t)}(t,e.logoutHint),e.extraQueryParameters&&Yo(t,e.extraQueryParameters),this.config.authOptions.instanceAware&&Go(t),ar(t,this.config.authOptions.encodeExtraQueryParams,e.extraQueryParameters)}}function nd(e){const{skus:t,libraryName:n,libraryVersion:r,extensionName:a,extensionVersion:i}=e,s=new Map([[0,[n,r]],[2,[a,i]]]);let o=[];if(null!==t&&void 0!==t&&t.length){if(o=t.split(","),o.length<4)return t}else o=Array.from({length:4},()=>"|");return s.forEach((e,t)=>{var n,r;2===e.length&&null!==(n=e[0])&&void 0!==n&&n.length&&null!==(r=e[1])&&void 0!==r&&r.length&&function(e){const{skuArr:t,index:n,skuName:r,skuVersion:a}=e;if(n>=t.length)return;t[n]=[r,a].join("|")}({skuArr:o,index:t,skuName:e[0],skuVersion:e[1]})}),o.join(",")}class rd{constructor(e,t){this.cacheOutcome=st,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||J.EMPTY_STRING,this.wrapperVer=e.wrapperVer||J.EMPTY_STRING,this.telemetryCacheKey=Ke.CACHE_KEY+De+e.clientId}generateCurrentRequestHeaderValue(){const e="".concat(this.apiId).concat(Ke.VALUE_SEPARATOR).concat(this.cacheOutcome),t=[this.wrapperSKU,this.wrapperVer],n=this.getNativeBrokerErrorCode();null!==n&&void 0!==n&&n.length&&t.push("broker_error=".concat(n));const r=t.join(Ke.VALUE_SEPARATOR),a=[e,this.getRegionDiscoveryFields()].join(Ke.VALUE_SEPARATOR);return[Ke.SCHEMA_VERSION,a,r].join(Ke.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=rd.maxErrorsToSend(e),n=e.failedRequests.slice(0,2*t).join(Ke.VALUE_SEPARATOR),r=e.errors.slice(0,t).join(Ke.VALUE_SEPARATOR),a=e.errors.length,i=[a,t<a?Ke.OVERFLOW_TRUE:Ke.OVERFLOW_FALSE].join(Ke.VALUE_SEPARATOR);return[Ke.SCHEMA_VERSION,e.cacheHits,n,r,i].join(Ke.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=Ke.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof St?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(Ke.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId),e.cacheHits}getLastRequests(){return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||{failedRequests:[],errors:[],cacheHits:0}}clearTelemetryCache(){const e=this.getLastRequests(),t=rd.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey,this.correlationId);else{const n={failedRequests:e.failedRequests.slice(2*t),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n,this.correlationId)}}static maxErrorsToSend(e){let t,n=0,r=0;const a=e.errors.length;for(t=0;t<a;t++){const a=e.failedRequests[2*t]||J.EMPTY_STRING,i=e.failedRequests[2*t+1]||J.EMPTY_STRING,s=e.errors[t]||J.EMPTY_STRING;if(r+=a.toString().length+i.toString().length+s.length+3,!(r<Ke.MAX_LAST_HEADER_BYTES))break;n+=1}return n}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||J.EMPTY_STRING),e.push(this.regionSource||J.EMPTY_STRING),e.push(this.regionOutcome||J.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId)}static makeExtraSkuString(e){return nd(e)}}class ad{constructor(e,t,n,r,a,i,s,o,l){this.config=e,this.browserStorage=t,this.browserCrypto=n,this.networkClient=this.config.system.networkClient,this.eventHandler=a,this.navigationClient=i,this.platformAuthProvider=o,this.correlationId=l||wl(),this.logger=r.clone(vi,Kl,this.correlationId),this.performanceClient=s}async clearCacheOnLogout(e,t){if(t)try{this.browserStorage.removeAccount(t,e),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch(n){this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),this.browserStorage.clear(e),await this.browserCrypto.clearKeystore()}catch(r){this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri;return sr.getAbsoluteUrl(t,jl())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const n={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new rd(n,this.browserStorage)}async getDiscoveredAuthority(e){const{account:t}=e,n=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(Rr,this.correlationId);const r={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},a=e.requestAuthority||this.config.auth.authority,i=null!==n&&void 0!==n&&n.length?"true"===n:this.config.auth.instanceAware,s=t&&i?this.config.auth.authority.replace(sr.getDomainFromUrl(a),t.environment):a,o=jc.generateAuthority(s,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),l=await Sc(Wu,wa,this.logger,this.performanceClient,this.correlationId)(o,this.config.system.networkClient,this.browserStorage,r,this.logger,this.correlationId,this.performanceClient);if(t&&!l.isAlias(t.environment))throw Vn(Bn);return l}}async function id(e,t,n,r){n.addQueueMeasurement(Gr,e.correlationId);const a=e.authority||t.auth.authority,i=[...e&&e.scopes||[]],s=c(c({},e),{},{correlationId:e.correlationId,authority:a,scopes:i});if(s.authenticationScheme){if(s.authenticationScheme===Ge.SSH){if(!e.sshJwk)throw Vn(Mn);if(!e.sshKid)throw Vn(Dn)}r.verbose('Authentication Scheme set to "'.concat(s.authenticationScheme,'" as configured in Auth request'))}else s.authenticationScheme=Ge.BEARER,r.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return t.cache.claimsBasedCachingEnabled&&e.claims&&!Kn.isEmptyObj(e.claims)&&(s.requestedClaimsHash=await Nl(e.claims)),s}async function sd(e,t,n,r,a){r.addQueueMeasurement(Yr,e.correlationId);const i=await Sc(id,Gr,a,r,e.correlationId)(e,n,r,a);return c(c(c({},e),i),{},{account:t,forceRefresh:e.forceRefresh||!1})}function od(e,t){let n;const r=e.httpMethod;if(t===pt){if(n=r||ie,n!==ie)throw Vn(Hn)}else n=r||ae;if(e.authorizePostBodyParameters&&n!==ie)throw Vn(zn);return n}class ld extends ad{initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",null===e||void 0===e?void 0:e.correlationId);const t=c({correlationId:this.correlationId||wl()},e);if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const n=this.getLogoutHintFromIdTokenClaims(e.account);n&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=n)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=sr.getAbsoluteUrl(e.postLogoutRedirectUri,jl())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=sr.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,jl())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=sr.getAbsoluteUrl(jl(),jl())),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(na,this.correlationId);const t=await Sc(this.getClientConfiguration.bind(this),ra,this.logger,this.performanceClient,this.correlationId)(e);return new td(t,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:t,requestAuthority:n,requestAzureCloudOptions:r,requestExtraQueryParameters:a,account:i}=e;this.performanceClient.addQueueMeasurement(ra,this.correlationId);const s=await Sc(this.getDiscoveredAuthority.bind(this),Rr,this.logger,this.performanceClient,this.correlationId)({requestAuthority:n,requestAzureCloudOptions:r,requestExtraQueryParameters:a,account:i}),o=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:s,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:o.loggerCallback,piiLoggingEnabled:o.piiLoggingEnabled,logLevel:o.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:vi,version:Kl,cpu:J.EMPTY_STRING,os:J.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(aa,this.correlationId);const n=this.getRedirectUri(e.redirectUri),r={interactionType:t},a=Yu.setRequestState(this.browserCrypto,e&&e.state||J.EMPTY_STRING,r),i=await Sc(id,Gr,this.logger,this.performanceClient,this.correlationId)(c(c({},e),{},{correlationId:this.correlationId}),this.config,this.performanceClient,this.logger),s=c(c({},i),{},{redirectUri:n,state:a,nonce:e.nonce||wl(),responseMode:this.config.auth.OIDCOptions.serverResponseType}),o=c(c({},s),{},{httpMethod:od(s,this.config.auth.protocolMode)});if(e.loginHint||e.sid)return o;const l=e.account||this.browserStorage.getActiveAccount(this.correlationId);return l&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: ".concat(l.homeAccountId),this.correlationId),o.account=l),o}}function cd(e,t,n){const r=rr(e);if(!r)throw nr(e)?(n.error("A ".concat(t," is present in the iframe but it does not contain known properties. It's likely that the ").concat(t," has been replaced by code running on the redirectUri page.")),n.errorPii("The ".concat(t," detected is: ").concat(e)),uo(vs)):(n.error("The request has returned to the redirectUri but a ".concat(t," is not present. It's likely that the ").concat(t," has been removed or the page has been redirected by code running on the redirectUri page.")),uo(gs));return r}function ud(e,t,n){if(!e.state)throw uo(ps);const r=function(e,t){if(!t)return null;try{return Yu.parseRequestState(e,t).libraryState.meta}catch(n){throw pn(_t)}}(t,e.state);if(!r)throw uo(ys);if(r.interactionType!==n)throw uo(bs)}function dd(e,t,n,r){var a,i;const s=t.correlationId,o=new Map;Po(o,t.embeddedClientId||(null===(a=t.extraQueryParameters)||void 0===a?void 0:a[yo])||e.clientId);if(No(o,[...t.scopes||[],...t.extraScopesToConsent||[]],!0,null===(i=e.authority.options.OIDCOptions)||void 0===i?void 0:i.defaultScopes),_o(o,t.redirectUri),Fo(o,s),function(e,t){e.set("response_mode",t||Ne)}(o,t.responseMode),Ko(o),t.prompt&&(!function(e,t){e.set("prompt",t)}(o,t.prompt),null===r||void 0===r||r.addFields({prompt:t.prompt},s)),t.domainHint&&(!function(e,t){e.set("domain_hint",t)}(o,t.domainHint),null===r||void 0===r||r.addFields({domainHintFromRequest:!0},s)),t.prompt!==Se)if(t.sid&&t.prompt===Ae)n.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),Do(o,t.sid),null===r||void 0===r||r.addFields({sidFromRequest:!0},s);else if(t.account){const e=function(e){var t;return(null===(t=e.idTokenClaims)||void 0===t?void 0:t.sid)||null}(t.account);let a=function(e){var t;return e.loginHint||(null===(t=e.idTokenClaims)||void 0===t?void 0:t.login_hint)||null}(t.account);if(a&&t.domainHint&&(n.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),a=null),a){n.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),Oo(o,a),null===r||void 0===r||r.addFields({loginHintFromClaim:!0},s);try{Mo(o,Xc(t.account.homeAccountId))}catch(l){n.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e&&t.prompt===Ae){n.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),Do(o,e),null===r||void 0===r||r.addFields({sidFromClaim:!0},s);try{Mo(o,Xc(t.account.homeAccountId))}catch(l){n.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t.loginHint)n.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),Oo(o,t.loginHint),Ro(o,t.loginHint),null===r||void 0===r||r.addFields({loginHintFromRequest:!0},s);else if(t.account.username){n.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),Oo(o,t.account.username),null===r||void 0===r||r.addFields({loginHintFromUpn:!0},s);try{Mo(o,Xc(t.account.homeAccountId))}catch(l){n.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else t.loginHint&&(n.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),Oo(o,t.loginHint),Ro(o,t.loginHint),null===r||void 0===r||r.addFields({loginHintFromRequest:!0},s));else n.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return t.nonce&&function(e,t){e.set("nonce",t)}(o,t.nonce),t.state&&Bo(o,t.state),(t.claims||e.clientCapabilities&&e.clientCapabilities.length>0)&&Lo(o,t.claims,e.clientCapabilities),t.embeddedClientId&&el(o,e.clientId,e.redirectUri),!e.instanceAware||t.extraQueryParameters&&Object.keys(t.extraQueryParameters).includes(Co)||Go(o),o}function hd(e,t,n,r){const a=ar(t,n,r);return sr.appendQueryString(e.authorizationEndpoint,a)}function fd(e,t){if(!e.state||!t)throw e.state?pn(Rt,"Cached State"):pn(Rt,"Server State");let n,r;try{n=decodeURIComponent(e.state)}catch(a){throw pn(_t,e.state)}try{r=decodeURIComponent(t)}catch(a){throw pn(_t,e.state)}if(n!==r)throw pn(Ot);if(e.error||e.error_description||e.suberror){const t=function(e){var t,n;const r="code=",a=null===(t=e.error_uri)||void 0===t?void 0:t.lastIndexOf(r);return a&&a>=0?null===(n=e.error_uri)||void 0===n?void 0:n.substring(a+r.length):void 0}(e);if($c(e.error,e.error_description,e.suberror))throw new Yc(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",t);throw new Vu(e.error||"",e.error_description,e.suberror,t)}}class md{constructor(e,t,n,r,a){this.authModule=e,this.browserStorage=t,this.authCodeRequest=n,this.logger=r,this.performanceClient=a}async handleCodeResponse(e,t){let n;this.performanceClient.addQueueMeasurement(la,t.correlationId);try{n=function(e,t){if(fd(e,t),!e.code)throw pn(an);return e}(e,t.state)}catch(r){throw r instanceof Vu&&r.subError===As?uo(As):r}return Sc(this.handleCodeResponseFromServer.bind(this),oa,this.logger,this.performanceClient,t.correlationId)(n,t)}async handleCodeResponseFromServer(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.performanceClient.addQueueMeasurement(oa,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await Sc(this.authModule.updateAuthority.bind(this.authModule),ha,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),n&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const e=this.createCcsCredentials(t);e&&(this.authCodeRequest.ccsCredential=e)}return await Sc(this.authModule.acquireToken.bind(this.authModule),fa,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:zu}:e.loginHint?{credential:e.loginHint,type:qu}:null}}const gd="user_switch",pd={[gd]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class vd extends St{constructor(e,t,n){super(e,t),Object.setPrototypeOf(this,vd.prototype),this.name="NativeAuthError",this.ext=n}}function yd(e){if(e.ext&&e.ext.status&&"DISABLED"===e.ext.status)return!0;if(e.ext&&e.ext.error&&-2147186943===e.ext.error)return!0;switch(e.errorCode){case"ContentError":case"PageException":return!0;default:return!1}}function bd(e,t,n){if(n&&n.status)switch(n.status){case"ACCOUNT_UNAVAILABLE":return Qc(Hc);case"USER_INTERACTION_REQUIRED":return new Yc(e,t);case"USER_CANCEL":return uo(As);case"NO_NETWORK":return uo(Us);case"UX_NOT_ALLOWED":return Qc(qc)}return new vd(e,pd[e]||t,n)}class wd extends Gu{constructor(e,t){super(e,t)}async acquireCachedToken(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Wr,e.correlationId);let n=st;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!Kn.isEmptyObj(e.claims))throw this.setCacheOutcome(ot,e.correlationId),pn(tn);if(!e.account)throw pn(Gt);const r=e.account.tenantId||function(e){var t;const n=null===(t=new sr(e).getUrlComponents().PathSegments.slice(-1)[0])||void 0===t?void 0:t.toLowerCase();switch(n){case ge:case pe:case ve:return;default:return n}}(e.authority),a=this.cacheManager.getTokenKeys(),i=this.cacheManager.getAccessToken(e.account,e,a,r);if(!i)throw this.setCacheOutcome(lt,e.correlationId),pn(tn);if(s=i.cachedAt,Number(s)>Ac()||Cc(i.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(ct,e.correlationId),pn(tn);var s;i.refreshOn&&Cc(i.refreshOn,0)&&(n=ut);const o=e.authority||this.authority.getPreferredCache(),l={account:this.cacheManager.getAccount(this.cacheManager.generateAccountKey(e.account),e.correlationId),accessToken:i,idToken:this.cacheManager.getIdToken(e.account,e.correlationId,a,r,this.performanceClient),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(o)};return this.setCacheOutcome(n,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await Sc(this.generateResultFromCacheRecord.bind(this),Vr,this.logger,this.performanceClient,e.correlationId)(l,e),n]}setCacheOutcome(e,t){var n,r;null===(n=this.serverTelemetryManager)||void 0===n||n.setCacheOutcome(e),null===(r=this.performanceClient)||void 0===r||r.addFields({cacheOutcome:e},t),e!==st&&this.logger.info("Token refresh is required due to cache outcome: ".concat(e))}async generateResultFromCacheRecord(e,t){var n;let r;if(null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(Vr,t.correlationId),e.idToken&&(r=Zn(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||0===t.maxAge){var a;const e=null===(a=r)||void 0===a?void 0:a.auth_time;if(!e)throw pn(Dt);er(e,t.maxAge)}return Xu.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)}}class Sd extends ld{async acquireToken(e){this.performanceClient.addQueueMeasurement(Ir,e.correlationId);const t=this.initializeServerTelemetryManager(Qi),n=await Sc(this.getClientConfiguration.bind(this),ra,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),r=new wd(n,this.performanceClient);this.logger.verbose("Silent auth client created");try{const t=(await Sc(r.acquireCachedToken.bind(r),Wr,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),t}catch(a){throw a instanceof co&&a.errorCode===Ws&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),a}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t.correlationId,null===t||void 0===t?void 0:t.account)}}const Td=["prompt"],Ad=["scopes"];class xd extends ad{constructor(e,t,n,r,a,i,s,o,l,c,u,d){super(e,t,n,r,a,i,o,l,d),this.apiId=s,this.accountId=c,this.platformAuthProvider=l,this.nativeStorageManager=u,this.silentCacheClient=new Sd(e,this.nativeStorageManager,n,r,a,i,o,l,d);const h=this.platformAuthProvider.getExtensionName();this.skus=rd.makeExtraSkuString({libraryName:vi,libraryVersion:Kl,extensionName:h,extensionVersion:this.platformAuthProvider.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters=c(c({},e.extraParameters),{},{[Ao]:this.skus})}async acquireToken(e,t){this.performanceClient.addQueueMeasurement(Mr,this.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const n=this.performanceClient.startMeasurement(Mr,this.correlationId),r=Ac(),a=this.initializeServerTelemetryManager(this.apiId);try{const s=await this.initializeNativeRequest(e);try{const e=await this.acquireTokensFromCache(this.accountId,s);return n.end({success:!0,isNativeBroker:!1,fromCache:!0}),e}catch(i){if(t===as)throw this.logger.info("MSAL internal Cache does not contain tokens, return error as per cache policy"),n.end({success:!1,brokerErrorCode:"cache_request_failed"}),i;this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const o=await this.platformAuthProvider.sendMessage(s);return await this.handleNativeResponse(o,s,r).then(e=>(n.end({success:!0,isNativeBroker:!0,requestId:e.requestId}),a.clearNativeBrokerErrorCode(),e)).catch(e=>{throw n.end({success:!1,errorCode:e.errorCode,subErrorCode:e.subError}),e})}catch(i){throw i instanceof vd&&a.setNativeBrokerErrorCode(i.errorCode),n.end({success:!1}),i}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:Gn.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),pn(Qt);const n=this.browserStorage.getBaseAccountInfo({nativeAccountId:e},this.correlationId);if(!n)throw pn(Qt);try{const e=this.createSilentCacheRequest(t,n),r=await this.silentCacheClient.acquireToken(e),a=c(c({},n),{},{idTokenClaims:null===r||void 0===r?void 0:r.idTokenClaims,idToken:null===r||void 0===r?void 0:r.idToken});return c(c({},r),{},{account:a})}catch(r){throw r}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const n=Object.assign({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(e),e));delete n.onRedirectNavigate;const r=await this.initializeNativeRequest(n);try{await this.platformAuthProvider.sendMessage(r)}catch(s){if(s instanceof vd){if(this.initializeServerTelemetryManager(this.apiId).setNativeBrokerErrorCode(s.errorCode),yd(s))throw s}}this.browserStorage.setTemporaryCache(zi,JSON.stringify(r),!0);const a={apiId:Vi,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},i=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(i,a)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const n=this.browserStorage.getCachedNativeRequest();if(!n)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&(null===e||void 0===e||e.addFields({errorCode:"no_cached_request"},t)),null;const{prompt:r}=n,a=u(n,Td);r&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(zi));const i=Ac();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const t=await this.platformAuthProvider.sendMessage(a),n=await this.handleNativeResponse(t,a,i);return this.initializeServerTelemetryManager(this.apiId).clearNativeBrokerErrorCode(),e&&this.correlationId&&this.performanceClient.addFields({isNativeBroker:!0},this.correlationId),n}catch(s){throw s}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,t,n){var r,a;this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const i=Zn(e.id_token,il),s=this.createHomeAccountIdentifier(e,i),o=null===(r=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId},this.correlationId))||void 0===r?void 0:r.homeAccountId;if(null!==(a=t.extraParameters)&&void 0!==a&&a.child_client_id&&e.account.id!==t.accountId)this.logger.info("handleNativeServerResponse: Double broker flow detected, ignoring accountId mismatch");else if(s!==o&&e.account.id!==t.accountId)throw bd(gd);const l=await this.getDiscoveredAuthority({requestAuthority:t.authority}),c=Zu(this.browserStorage,l,s,il,this.correlationId,i,e.client_info,void 0,i.tid,void 0,e.account.id,this.logger);e.expires_in=Number(e.expires_in);const u=await this.generateAuthenticationResult(e,t,i,c,l.canonicalAuthority,n);return await this.cacheAccount(c,this.correlationId),await this.cacheNativeTokens(e,t,s,i,e.access_token,u.tenantId,n),u}createHomeAccountIdentifier(e,t){return eu.generateHomeAccountId(e.client_info||J.EMPTY_STRING,pc,this.logger,this.browserCrypto,t)}generateScopes(e,t){return t?Gn.fromString(t):Gn.fromString(e)}async generatePopAccessToken(e,t){if(t.tokenType===Ge.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const n=new Qu(this.browserCrypto),r={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw pn(ln);return n.signPopToken(e.access_token,t.keyId,r)}return e.access_token}async generateAuthenticationResult(e,t,n,r,a,i){const s=this.addTelemetryFromNativeResponse(e.properties.MATS),o=this.generateScopes(t.scope,e.scope),l=e.account.properties||{},c=l.UID||n.oid||n.sub||J.EMPTY_STRING,u=l.TenantId||n.tid||J.EMPTY_STRING,d=Xn(r.getAccountInfo(),void 0,n,e.id_token);d.nativeAccountId!==e.account.id&&(d.nativeAccountId=e.account.id);const h=await this.generatePopAccessToken(e,t),f=t.tokenType===Ge.POP?Ge.POP:Ge.BEARER;return{authority:a,uniqueId:c,tenantId:u,scopes:o.asArray(),account:d,idToken:e.id_token,idTokenClaims:n,accessToken:h,fromCache:!!s&&this.isResponseFromCache(s),expiresOn:kc(i+e.expires_in),tokenType:f,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}async cacheAccount(e,t){await this.browserStorage.setAccount(e,this.correlationId),this.browserStorage.removeAccountContext(e.getAccountInfo(),t)}cacheNativeTokens(e,t,n,r,a,i,s){const o=Ic(n,t.authority,e.id_token||"",t.clientId,r.tid||""),l=s+(t.tokenType===Ge.POP?J.SHR_NONCE_VALIDITY:("string"===typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),c=this.generateScopes(e.scope,t.scope),u={idToken:o,accessToken:Nc(n,t.authority,a,t.clientId,r.tid||i,c.printScopes(),l,0,il,void 0,t.tokenType,void 0,t.keyId)};return this.nativeStorageManager.saveCacheRecord(u,this.correlationId,t.storeInCache)}getExpiresInValue(e,t){return e===Ge.POP?J.SHR_NONCE_VALIDITY:("string"===typeof t?parseInt(t,10):t)||0}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.platformAuthProvider.getExtensionId(),extensionVersion:this.platformAuthProvider.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}getMATSFromResponse(e){if(e)try{return JSON.parse(e)}catch(t){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return"undefined"===typeof e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=await this.getCanonicalAuthority(e),{scopes:n}=e,r=u(e,Ad),a=new Gn(n||[]);a.appendScopes(se);const i=c(c({},r),{},{accountId:this.accountId,clientId:this.config.auth.clientId,authority:t.urlString,scope:a.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:this.getPrompt(e.prompt),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:c(c({},e.extraQueryParameters),e.tokenQueryParameters),extendedExpiryToken:!1,keyId:e.popKid});if(i.signPopToken&&e.popKid)throw uo(no);if(this.handleExtraBrokerParams(i),i.extraParameters=i.extraParameters||{},i.extraParameters.telemetry=wi,e.authenticationScheme===Ge.POP){const t={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},n=new Qu(this.browserCrypto);let r;if(i.keyId)r=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:i.keyId})),i.signPopToken=!1;else{const e=await Sc(n.generateCnf.bind(n),pa,this.logger,this.performanceClient,this.correlationId)(t,this.logger);r=e.reqCnfString,i.keyId=e.kid,i.signPopToken=!0}i.reqCnf=r}return this.addRequestSKUs(i),i}async getCanonicalAuthority(e){const t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const n=new sr(t);return n.validateAsUri(),n}getPrompt(e){switch(this.apiId){case Gi:case Qi:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),Ae}if(e)switch(e){case Ae:case Te:case we:case Se:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e;default:throw this.logger.trace("initializeNativeRequest: prompt = ".concat(e," is not compatible with native flow")),uo(eo)}else this.logger.trace("initializeNativeRequest: prompt was not provided")}handleExtraBrokerParams(e){var t;const n=e.extraParameters&&e.extraParameters.hasOwnProperty(xo)&&e.extraParameters.hasOwnProperty(ko)&&e.extraParameters.hasOwnProperty(yo);if(!e.embeddedClientId&&!n)return;let r="";const a=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,r=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[ko],r=e.extraParameters[yo]),e.extraParameters={child_client_id:r,child_redirect_uri:a},null===(t=this.performanceClient)||void 0===t||t.addFields({embeddedClientId:r,embeddedRedirectUri:a},this.correlationId)}}async function kd(e,t,n,r,a){const i=dd(c(c({},e.auth),{},{authority:t}),n,r,a);if(jo(i,{sku:vi,version:Kl,os:"",cpu:""}),e.auth.protocolMode!==gt&&Uo(i,e.telemetry.application),n.platformBroker&&(function(e){e.set("nativebroker","1")}(i),a.addFields({isPlatformAuthorizeRequest:!0},n.correlationId),n.authenticationScheme===Ge.POP)){const e=new mc(r,a),t=new Qu(e);let s;if(n.popKid)s=e.encodeKid(n.popKid);else{s=(await Sc(t.generateCnf.bind(t),pa,r,a,n.correlationId)(n,r)).reqCnfString}Qo(i,s)}return Eo(i,n.correlationId,a),i}async function Cd(e,t,n,r,a){if(!n.codeChallenge)throw Vn(Pn);const i=await Sc(kd,sa,r,a,n.correlationId)(e,t,n,r,a);return Io(i,ke),Ho(i,n.codeChallenge,J.S256_CODE_CHALLENGE_METHOD),Yo(i,n.extraQueryParameters||{}),hd(t,i,e.auth.encodeExtraQueryParams,n.extraQueryParameters)}async function Ed(e,t,n,r,a,i){if(!r.earJwk)throw uo(ds);const s=await kd(t,n,r,a,i);Io(s,Ce),function(e,t){e.set("ear_jwk",encodeURIComponent(t)),e.set("ear_jwe_crypto","eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0")}(s,r.earJwk);const o=new Map;Yo(o,r.extraQueryParameters||{});return Nd(e,hd(n,o,t.auth.encodeExtraQueryParams,r.extraQueryParameters),s)}async function Id(e,t,n,r,a,i){const s=await kd(t,n,r,a,i);Io(s,ke),Ho(s,r.codeChallenge,r.codeChallengeMethod||J.S256_CODE_CHALLENGE_METHOD),function(e,t){Object.entries(t).forEach(t=>{let[n,r]=t;r&&e.set(n,r)})}(s,r.authorizePostBodyParameters||{});const o=new Map;Yo(o,r.extraQueryParameters||{});return Nd(e,hd(n,o,t.auth.encodeExtraQueryParams,r.extraQueryParameters),s)}function Nd(e,t,n){const r=e.createElement("form");return r.method="post",r.action=t,n.forEach((t,n)=>{const a=e.createElement("input");a.hidden=!0,a.name=n,a.value=t,r.appendChild(a)}),e.body.appendChild(r),r}async function Pd(e,t,n,r,a,i,s,o,l,u){if(o.verbose("Account id found, calling WAM for token"),!u)throw uo(Xs);const d=new mc(o,l),h=new xd(r,a,d,o,s,r.system.navigationClient,n,l,u,t,i,e.correlationId),{userRequestState:f}=Yu.parseRequestState(d,e.state);return Sc(h.acquireToken.bind(h),Mr,o,l,e.correlationId)(c(c({},e),{},{state:f,prompt:void 0}))}async function _d(e,t,n,r,a,i,s,o,l,u,d,h){if(Ku.removeThrottle(s,a.auth.clientId,e),t.accountId)return Sc(Pd,ua,u,d,e.correlationId)(e,t.accountId,r,a,s,o,l,u,d,h);const f=c(c({},e),{},{code:t.code||"",codeVerifier:n}),m=new md(i,s,f,u,d);return await Sc(m.handleCodeResponse.bind(m),la,u,d,e.correlationId)(t,e)}async function Od(e,t,n,r,a,i,s,o,l,c,u){if(Ku.removeThrottle(i,r.auth.clientId,e),fd(t,e.state),!t.ear_jwe)throw uo(hs);if(!e.earJwk)throw uo(ds);const d=JSON.parse(await Sc(Al,Xa,l,c,e.correlationId)(e.earJwk,t.ear_jwe));if(d.accountId)return Sc(Pd,ua,l,c,e.correlationId)(e,d.accountId,n,r,i,s,o,l,c,u);const h=new Xu(r.auth.clientId,i,new mc(l,c),l,null,null,c);h.validateTokenResponse(d);const f={code:"",state:e.state,nonce:e.nonce,client_info:d.client_info,cloud_graph_host_name:d.cloud_graph_host_name,cloud_instance_host_name:d.cloud_instance_host_name,cloud_instance_name:d.cloud_instance_name,msgraph_host:d.msgraph_host};return await Sc(h.handleServerTokenResponse.bind(h),ya,l,c,e.correlationId)(d,a,Ac(),e,f,void 0,void 0,void 0,void 0)}async function Rd(e,t,n){e.addQueueMeasurement(Ba,n);const r=wc(Md,Ha,t,e,n)(e,t,n);return{verifier:r,challenge:await Sc(Dd,za,t,e,n)(r,e,t,n)}}function Md(e,t,n){try{const r=new Uint8Array(32);wc(yl,Wa,t,e,n)(r);return nl(r)}catch(r){throw uo(us)}}async function Dd(e,t,n,r){t.addQueueMeasurement(za,r);try{const a=await Sc(vl,qa,n,t,r)(e,t,r);return nl(new Uint8Array(a))}catch(a){throw uo(us)}}class Ld{constructor(e,t,n,r){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=r,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=n,this.handshakeEvent=n.startMeasurement(Ra),this.platformAuthType=ki}async sendMessage(e){this.logger.trace(this.platformAuthType+" - sendMessage called.");const t={method:Ii,request:e},n={channel:yi,extensionId:this.extensionId,responseId:wl(),body:t};this.logger.trace(this.platformAuthType+" - Sending request to browser extension"),this.logger.tracePii(this.platformAuthType+" - Sending request to browser extension: ".concat(JSON.stringify(n))),this.messageChannel.port1.postMessage(n);const r=await new Promise((e,t)=>{this.resolvers.set(n.responseId,{resolve:e,reject:t})});return this.validatePlatformBrokerResponse(r)}static async createProvider(e,t,n){e.trace("PlatformAuthExtensionHandler - createProvider called.");try{const r=new Ld(e,t,n,bi);return await r.sendHandshakeRequest(),r}catch(r){const a=new Ld(e,t,n);return await a.sendHandshakeRequest(),a}}async sendHandshakeRequest(){this.logger.trace(this.platformAuthType+" - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:yi,extensionId:this.extensionId,responseId:wl(),body:{method:Ci}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=e=>{this.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((t,n)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:n}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),n(uo(Qs)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(e){if(this.logger.trace(this.platformAuthType+" - onWindowMessage called"),e.source!==window)return;const t=e.data;if(t.channel&&t.channel===yi&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===Ci){const e=this.handshakeResolvers.get(t.responseId);if(!e)return void this.logger.trace(this.platformAuthType+".onWindowMessage - resolver can't be found for request ".concat(t.responseId));this.logger.verbose(t.extensionId?"Extension with id: ".concat(t.extensionId," not installed"):"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),e.reject(uo(Js))}}onChannelMessage(e){this.logger.trace(this.platformAuthType+" - onChannelMessage called.");const t=e.data,n=this.resolvers.get(t.responseId),r=this.handshakeResolvers.get(t.responseId);try{const e=t.body.method;if(e===Ni){if(!n)return;const e=t.body.response;if(this.logger.trace(this.platformAuthType+" - Received response from browser extension"),this.logger.tracePii(this.platformAuthType+" - Received response from browser extension: ".concat(JSON.stringify(e))),"Success"!==e.status)n.reject(bd(e.code,e.description,e.ext));else{if(!e.result)throw Tt(yt,"Event does not contain result.");e.result.code&&e.result.description?n.reject(bd(e.result.code,e.result.description,e.result.ext)):n.resolve(e.result)}this.resolvers.delete(t.responseId)}else if(e===Ei){if(!r)return void this.logger.trace(this.platformAuthType+".onChannelMessage - resolver can't be found for request ".concat(t.responseId));clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(this.platformAuthType+" - Received HandshakeResponse from extension: ".concat(this.extensionId)),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),r.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(a){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: ".concat(a)),this.logger.errorPii("Unable to parse ".concat(e)),n?n.reject(a):r&&r.reject(a)}}validatePlatformBrokerResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw Tt(yt,"Response missing expected properties.")}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}getExtensionName(){var e;return this.getExtensionId()===bi?"chrome":null!==(e=this.getExtensionId())&&void 0!==e&&e.length?"unknown":void 0}}const Fd=["accountId","clientId","authority","scope","redirectUri","correlationId","state","storeInCache","embeddedClientId","extraParameters"];class jd{constructor(e,t,n){this.logger=e,this.performanceClient=t,this.correlationId=n,this.platformAuthType=xi}static async createProvider(e,t,n){var r;if(e.trace("PlatformAuthDOMHandler: createProvider called"),null!==(r=window.navigator)&&void 0!==r&&r.platformAuthentication){const r=await window.navigator.platformAuthentication.getSupportedContracts(Si);if(null!==r&&void 0!==r&&r.includes(Ai))return e.trace("Platform auth api available in DOM"),new jd(e,t,n)}}getExtensionId(){return Si}getExtensionVersion(){return""}getExtensionName(){return Ti}async sendMessage(e){this.logger.trace(this.platformAuthType+" - Sending request to browser DOM API");try{const t=this.initializePlatformDOMRequest(e),n=await window.navigator.platformAuthentication.executeGetToken(t);return this.validatePlatformBrokerResponse(n)}catch(t){throw this.logger.error(this.platformAuthType+" - executeGetToken DOM API error"),t}}initializePlatformDOMRequest(e){this.logger.trace(this.platformAuthType+" - initializeNativeDOMRequest called");const{accountId:t,clientId:n,authority:r,scope:a,redirectUri:i,correlationId:s,state:o,storeInCache:l,embeddedClientId:d,extraParameters:h}=e,f=u(e,Fd),m=this.getDOMExtraParams(f);return{accountId:t,brokerId:this.getExtensionId(),authority:r,clientId:n,correlationId:s||this.correlationId,extraParameters:c(c({},h),m),isSecurityTokenService:!1,redirectUri:i,scope:a,state:o,storeInCache:l,embeddedClientId:d}}validatePlatformBrokerResponse(e){if(e.hasOwnProperty("isSuccess")){if(e.hasOwnProperty("accessToken")&&e.hasOwnProperty("idToken")&&e.hasOwnProperty("clientInfo")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scopes")&&e.hasOwnProperty("expiresIn"))return this.logger.trace(this.platformAuthType+" - platform broker returned successful and valid response"),this.convertToPlatformBrokerResponse(e);if(e.hasOwnProperty("error")){const t=e;if(!1===t.isSuccess&&t.error&&t.error.code)throw this.logger.trace(this.platformAuthType+" - platform broker returned error response"),bd(t.error.code,t.error.description,{error:parseInt(t.error.errorCode),protocol_error:t.error.protocolError,status:t.error.status,properties:t.error.properties})}}throw Tt(yt,"Response missing expected properties.")}convertToPlatformBrokerResponse(e){var t;this.logger.trace(this.platformAuthType+" - convertToNativeResponse called");return{access_token:e.accessToken,id_token:e.idToken,client_info:e.clientInfo,account:e.account,expires_in:e.expiresIn,scope:e.scopes,state:e.state||"",properties:e.properties||{},extendedLifetimeToken:null!==(t=e.extendedLifetimeToken)&&void 0!==t&&t,shr:e.proofOfPossessionPayload}}getDOMExtraParams(e){return c({},Object.entries(e).reduce((e,t)=>{let[n,r]=t;return e[n]=String(r),e},{}))}}async function Ud(e,t,n,r){e.trace("getPlatformAuthProvider called",n);const a=function(){let e;try{var t;return e=window[_i],"true"===(null===(t=e)||void 0===t?void 0:t.getItem(Jl))}catch(n){return!1}}();let i;e.trace("Has client allowed platform auth via DOM API: "+a);try{a&&(i=await jd.createProvider(e,t,n)),i||(e.trace("Platform auth via DOM API not available, checking for extension"),i=await Ld.createProvider(e,r||2e3,t))}catch(s){e.trace("Platform auth not available",s)}return i}function Bd(e,t,n,r){if(t.trace("isPlatformAuthAllowed called"),!e.system.allowPlatformBroker)return t.trace("isPlatformAuthAllowed: allowPlatformBroker is not enabled, returning false"),!1;if(!n)return t.trace("isPlatformAuthAllowed: Platform auth provider is not initialized, returning false"),!1;if(r)switch(r){case Ge.BEARER:case Ge.POP:return t.trace("isPlatformAuthAllowed: authenticationScheme is supported, returning true"),!0;default:return t.trace("isPlatformAuthAllowed: authenticationScheme is not supported, returning false"),!1}return!0}class Hd extends ld{constructor(e,t,n,r,a,i,s,o,l,c){super(e,t,n,r,a,i,s,l,c),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=o,this.eventHandler=a}acquireToken(e,t){let n;try{var r;if(n={popupName:this.generatePopupName(e.scopes||se,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:null!==(r=e.popupWindowParent)&&void 0!==r?r:window},this.performanceClient.addFields({isAsyncPopup:this.config.system.asyncPopups},this.correlationId),this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,n,t);{const r=c(c({},e),{},{httpMethod:od(e,this.config.auth.protocolMode)});return this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),n.popup=this.openSizedPopup("about:blank",n),this.acquireTokenPopupAsync(r,n,t)}}catch(a){return Promise.reject(a)}}logout(e){try{var t;this.logger.verbose("logoutPopup called");const n=this.initializeLogoutRequest(e),r={popupName:this.generateLogoutPopupName(n),popupWindowAttributes:(null===e||void 0===e?void 0:e.popupWindowAttributes)||{},popupWindowParent:null!==(t=null===e||void 0===e?void 0:e.popupWindowParent)&&void 0!==t?t:window},a=e&&e.authority,i=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(n,r,a,i)):(this.logger.verbose("asyncPopup set to false, opening popup"),r.popup=this.openSizedPopup("about:blank",r),this.logoutPopupAsync(n,r,a,i))}catch(n){return Promise.reject(n)}}async acquireTokenPopupAsync(e,t,n){this.logger.verbose("acquireTokenPopupAsync called");const r=await Sc(this.initializeAuthorizationRequest.bind(this),aa,this.logger,this.performanceClient,this.correlationId)(e,Zi.Popup);t.popup&&Wl(r.authority);const a=Bd(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme);return r.platformBroker=a,this.config.auth.protocolMode===pt?this.executeEarFlow(r,t):this.executeCodeFlow(r,t,n)}async executeCodeFlow(e,t,n){const r=e.correlationId,a=this.initializeServerTelemetryManager(Ki),i=n||await Sc(Rd,Ba,this.logger,this.performanceClient,r)(this.performanceClient,this.logger,r),s=c(c({},e),{},{codeChallenge:i.challenge});try{const n=await Sc(this.createAuthCodeClient.bind(this),na,this.logger,this.performanceClient,r)({serverTelemetryManager:a,requestAuthority:s.authority,requestAzureCloudOptions:s.azureCloudOptions,requestExtraQueryParameters:s.extraQueryParameters,account:s.account});if(s.httpMethod===ie)return await this.executeCodeFlowWithPost(s,t,n,i.verifier);{const a=await Sc(Cd,ia,this.logger,this.performanceClient,r)(this.config,n.authority,s,this.logger,this.performanceClient),o=this.initiateAuthRequest(a,t);this.eventHandler.emitEvent(Ou,Zi.Popup,{popupWindow:o},null);const l=await this.monitorPopupForHash(o,t.popupWindowParent),c=wc(cd,ba,this.logger,this.performanceClient,this.correlationId)(l,this.config.auth.OIDCOptions.serverResponseType,this.logger);return await Sc(_d,da,this.logger,this.performanceClient,r)(e,c,i.verifier,Ki,this.config,n,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}}catch(l){var o;throw null===(o=t.popup)||void 0===o||o.close(),l instanceof St&&(l.setCorrelationId(this.correlationId),a.cacheFailedRequest(l)),l}}async executeEarFlow(e,t){const n=e.correlationId,r=await Sc(this.getDiscoveredAuthority.bind(this),Rr,this.logger,this.performanceClient,n)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),a=await Sc(Tl,Ja,this.logger,this.performanceClient,n)(),i=c(c({},e),{},{earJwk:a}),s=t.popup||this.openPopup("about:blank",t);(await Ed(s.document,this.config,r,i,this.logger,this.performanceClient)).submit();const o=await Sc(this.monitorPopupForHash.bind(this),Zr,this.logger,this.performanceClient,n)(s,t.popupWindowParent),l=wc(cd,ba,this.logger,this.performanceClient,this.correlationId)(o,this.config.auth.OIDCOptions.serverResponseType,this.logger);return Sc(Od,ca,this.logger,this.performanceClient,n)(i,l,Ki,this.config,r,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async executeCodeFlowWithPost(e,t,n,r){const a=e.correlationId,i=await Sc(this.getDiscoveredAuthority.bind(this),Rr,this.logger,this.performanceClient,a)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),s=t.popup||this.openPopup("about:blank",t);(await Id(s.document,this.config,i,e,this.logger,this.performanceClient)).submit();const o=await Sc(this.monitorPopupForHash.bind(this),Zr,this.logger,this.performanceClient,a)(s,t.popupWindowParent),l=wc(cd,ba,this.logger,this.performanceClient,this.correlationId)(o,this.config.auth.OIDCOptions.serverResponseType,this.logger);return Sc(_d,da,this.logger,this.performanceClient,a)(e,l,r,Ki,this.config,n,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async logoutPopupAsync(e,t,n,r){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(Ru,Zi.Popup,e);const a=this.initializeServerTelemetryManager(Xi);try{await this.clearCacheOnLogout(this.correlationId,e.account);const o=await Sc(this.createAuthCodeClient.bind(this),na,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:a,requestAuthority:n,account:e.account||void 0});try{o.authority.endSessionEndpoint}catch(l){var i;if(null!==(i=e.account)&&void 0!==i&&i.homeAccountId&&e.postLogoutRedirectUri&&o.authority.protocolMode===gt){var s;if(this.eventHandler.emitEvent(Mu,Zi.Popup,e),r){const e={apiId:Xi,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=sr.getAbsoluteUrl(r,jl());await this.navigationClient.navigateInternal(t,e)}return void(null===(s=t.popup)||void 0===s||s.close())}}const c=o.getLogoutUri(e);this.eventHandler.emitEvent(Mu,Zi.Popup,e);const u=this.openPopup(c,t);if(this.eventHandler.emitEvent(Ou,Zi.Popup,{popupWindow:u},null),await this.monitorPopupForHash(u,t.popupWindowParent).catch(()=>{}),r){const e={apiId:Xi,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=sr.getAbsoluteUrl(r,jl());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: ".concat(t)),await this.navigationClient.navigateInternal(t,e)}else this.logger.verbose("No main window navigation requested")}catch(c){var o;throw null===(o=t.popup)||void 0===o||o.close(),c instanceof St&&(c.setCorrelationId(this.correlationId),a.cacheFailedRequest(c)),this.eventHandler.emitEvent(Du,Zi.Popup,null,c),this.eventHandler.emitEvent(Lu,Zi.Popup),c}this.eventHandler.emitEvent(Lu,Zi.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii("Navigate to: ".concat(e)),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),uo(ms)}monitorPopupForHash(e,t){return new Promise((t,n)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const r=setInterval(()=>{if(e.closed)return this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(r),void n(uo(As));let a="";try{a=e.location.href}catch(o){}if(!a||"about:blank"===a)return;clearInterval(r);let i="";const s=this.config.auth.OIDCOptions.serverResponseType;e&&(i=s===Ee?e.location.search:e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),t(i)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,t)})}openPopup(e,t){try{let n;if(t.popup?(n=t.popup,this.logger.verbosePii("Navigating popup window to: ".concat(e)),n.location.assign(e)):"undefined"===typeof t.popup&&(this.logger.verbosePii("Opening popup window to: ".concat(e)),n=this.openSizedPopup(e,t)),!n)throw uo(Ts);return n.focus&&n.focus(),this.currentWindow=n,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),n}catch(n){throw this.logger.error("error opening popup "+n.message),uo(Ss)}}openSizedPopup(e,t){var n,r,a,i;let{popupName:s,popupWindowAttributes:o,popupWindowParent:l}=t;const c=l.screenLeft?l.screenLeft:l.screenX,u=l.screenTop?l.screenTop:l.screenY,d=l.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,h=l.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let f=null===(n=o.popupSize)||void 0===n?void 0:n.width,m=null===(r=o.popupSize)||void 0===r?void 0:r.height,g=null===(a=o.popupPosition)||void 0===a?void 0:a.top,p=null===(i=o.popupPosition)||void 0===i?void 0:i.left;return(!f||f<0||f>d)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),f=fi),(!m||m<0||m>h)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),m=mi),(!g||g<0||g>h)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),g=Math.max(0,h/2-mi/2+u)),(!p||p<0||p>d)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),p=Math.max(0,d/2-fi/2+c)),l.open(e,s,"width=".concat(f,", height=").concat(m,", top=").concat(g,", left=").concat(p,", scrollbars=yes"))}unloadWindow(e){this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow)}generatePopupName(e,t){return"".concat(gi,".").concat(this.config.auth.clientId,".").concat(e.join("-"),".").concat(t,".").concat(this.correlationId)}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return"".concat(gi,".").concat(this.config.auth.clientId,".").concat(t,".").concat(this.correlationId)}}class zd extends ld{constructor(e,t,n,r,a,i,s,o,l,c){super(e,t,n,r,a,i,s,l,c),this.nativeStorage=o}async acquireToken(e){const t=await Sc(this.initializeAuthorizationRequest.bind(this),aa,this.logger,this.performanceClient,this.correlationId)(e,Zi.Redirect);t.platformBroker=Bd(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme);const n=e=>{e.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.resetRequestCache(),this.eventHandler.emitEvent(Fu,Zi.Redirect))},r=this.getRedirectStartPage(e.redirectStartPage);this.logger.verbosePii("Redirect start page: ".concat(r)),this.browserStorage.setTemporaryCache(Fi,r,!0),window.addEventListener("pageshow",n);try{this.config.auth.protocolMode===pt?await this.executeEarFlow(t):await this.executeCodeFlow(t,e.onRedirectNavigate)}catch(a){throw a instanceof St&&a.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",n),a}}async executeCodeFlow(e,t){const n=e.correlationId,r=this.initializeServerTelemetryManager(Vi),a=await Sc(Rd,Ba,this.logger,this.performanceClient,n)(this.performanceClient,this.logger,n),i=c(c({},e),{},{codeChallenge:a.challenge});this.browserStorage.cacheAuthorizeRequest(i,a.verifier);try{if(i.httpMethod===ie)return await this.executeCodeFlowWithPost(i);{const n=await Sc(this.createAuthCodeClient.bind(this),na,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:i.authority,requestAzureCloudOptions:i.azureCloudOptions,requestExtraQueryParameters:i.extraQueryParameters,account:i.account}),a=await Sc(Cd,ia,this.logger,this.performanceClient,e.correlationId)(this.config,n.authority,i,this.logger,this.performanceClient);return await this.initiateAuthRequest(a,t)}}catch(s){throw s instanceof St&&(s.setCorrelationId(this.correlationId),r.cacheFailedRequest(s)),s}}async executeEarFlow(e){const t=e.correlationId,n=await Sc(this.getDiscoveredAuthority.bind(this),Rr,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),r=await Sc(Tl,Ja,this.logger,this.performanceClient,t)(),a=c(c({},e),{},{earJwk:r});this.browserStorage.cacheAuthorizeRequest(a);return(await Ed(document,this.config,n,a,this.logger,this.performanceClient)).submit(),new Promise((e,t)=>{setTimeout(()=>{t(uo(so,"failed_to_redirect"))},this.config.system.redirectNavigationTimeout)})}async executeCodeFlowWithPost(e){const t=e.correlationId,n=await Sc(this.getDiscoveredAuthority.bind(this),Rr,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});this.browserStorage.cacheAuthorizeRequest(e);return(await Id(document,this.config,n,e,this.logger,this.performanceClient)).submit(),new Promise((e,t)=>{setTimeout(()=>{t(uo(so,"failed_to_redirect"))},this.config.system.redirectNavigationTimeout)})}async handleRedirectPromise(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;const a=this.initializeServerTelemetryManager(Yi);try{const[i,s]=this.getRedirectResponse(e||"");if(!i)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.resetRequestCache(),"back_forward"!==function(){if("undefined"===typeof window||"undefined"===typeof window.performance||"function"!==typeof window.performance.getEntriesByType)return;const e=window.performance.getEntriesByType("navigation"),t=e.length?e[0]:void 0;return null===t||void 0===t?void 0:t.type}()?r.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const o=this.browserStorage.getTemporaryCache(Fi,!0)||J.EMPTY_STRING,l=ir(o);if(l===ir(window.location.href)&&this.config.auth.navigateToLoginRequestUrl){this.logger.verbose("Current page is loginRequestUrl, handling response"),o.indexOf("#")>-1&&function(e){const t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""}(o);return await this.handleResponse(i,t,n,a)}if(!this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(i,t,n,a);if(!Fl()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(ji,s,!0);const e={apiId:Yi,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let r=!0;if(o&&"null"!==o)this.logger.verbose("Navigating to loginRequestUrl: ".concat(o)),r=await this.navigationClient.navigateInternal(o,e);else{const t=function(){const e=new sr(window.location.href).getUrlComponents();return"".concat(e.Protocol,"//").concat(e.HostNameAndPort,"/")}();this.browserStorage.setTemporaryCache(Fi,t,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),r=await this.navigationClient.navigateInternal(t,e)}if(!r)return await this.handleResponse(i,t,n,a)}return null}catch(i){throw i instanceof St&&(i.setCorrelationId(this.correlationId),a.cacheFailedRequest(i)),i}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(t=this.config.auth.OIDCOptions.serverResponseType===Ee?window.location.search:window.location.hash);let n=rr(t);if(n){try{ud(n,this.browserCrypto,Zi.Redirect)}catch(a){return a instanceof St&&this.logger.error("Interaction type validation failed due to ".concat(a.errorCode,": ").concat(a.errorMessage)),[null,""]}return Ll(window),this.logger.verbose("Hash contains known properties, returning response hash"),[n,t]}const r=this.browserStorage.getTemporaryCache(ji,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(ji)),r&&(n=rr(r),n)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[n,r]):[null,""]}async handleResponse(e,t,n,r){if(!e.state)throw uo(ps);if(e.ear_jwe){const n=await Sc(this.getDiscoveredAuthority.bind(this),Rr,this.logger,this.performanceClient,t.correlationId)({requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account});return Sc(Od,ca,this.logger,this.performanceClient,t.correlationId)(t,e,Vi,this.config,n,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}const a=await Sc(this.createAuthCodeClient.bind(this),na,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:t.authority});return Sc(_d,da,this.logger,this.performanceClient,t.correlationId)(t,e,n,Vi,this.config,a,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: ".concat(e));const n={apiId:Vi,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},r=t||this.config.auth.onRedirectNavigate;if("function"===typeof r){this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback");return!1!==r(e)?(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),void await this.navigationClient.navigateExternal(e,n)):void this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation")}return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),void await this.navigationClient.navigateExternal(e,n)}throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),uo(ms)}async logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e),n=this.initializeServerTelemetryManager(Ji);try{this.eventHandler.emitEvent(Ru,Zi.Redirect,e),await this.clearCacheOnLogout(this.correlationId,t.account);const i={apiId:Ji,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},s=await Sc(this.createAuthCodeClient.bind(this),na,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:e&&e.authority,requestExtraQueryParameters:null===e||void 0===e?void 0:e.extraQueryParameters,account:e&&e.account||void 0});if(s.authority.protocolMode===gt)try{s.authority.endSessionEndpoint}catch(a){var r;if(null!==(r=t.account)&&void 0!==r&&r.homeAccountId)return void this.eventHandler.emitEvent(Mu,Zi.Redirect,t)}const o=s.getLogoutUri(t);if(this.eventHandler.emitEvent(Mu,Zi.Redirect,t),!e||"function"!==typeof e.onRedirectNavigate)return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,Li),void await this.navigationClient.navigateExternal(o,i);if(!1!==e.onRedirectNavigate(o))return this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,Li),void await this.navigationClient.navigateExternal(o,i);this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation")}catch(i){throw i instanceof St&&(i.setCorrelationId(this.correlationId),n.cacheFailedRequest(i)),this.eventHandler.emitEvent(Du,Zi.Redirect,null,i),this.eventHandler.emitEvent(Lu,Zi.Redirect),i}this.eventHandler.emitEvent(Lu,Zi.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return sr.getAbsoluteUrl(t,jl())}}async function qd(e,t,n,r,a){if(t.addQueueMeasurement(Xr,r),!e)throw n.info("Navigate url is empty"),uo(ms);return a?Sc(Gd,ea,n,t,r)(e,a,t,r):wc(Yd,ta,n,t,r)(e)}async function Wd(e,t,n,r,a){const i=$d();if(!i.contentDocument)throw"No document associated with iframe!";return(await Id(i.contentDocument,e,t,n,r,a)).submit(),i}async function Vd(e,t,n,r,a){const i=$d();if(!i.contentDocument)throw"No document associated with iframe!";return(await Ed(i.contentDocument,e,t,n,r,a)).submit(),i}async function Kd(e,t,n,r,a,i,s){return r.addQueueMeasurement(Zr,i),new Promise((r,i)=>{t<Vl&&a.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower (".concat(t,"ms) than the default (").concat(Vl,"ms). This may result in timeouts."));const o=window.setTimeout(()=>{window.clearInterval(l),i(uo(ks))},t),l=window.setInterval(()=>{let t="";const n=e.contentWindow;try{t=n?n.location.href:""}catch(i){}if(!t||"about:blank"===t)return;let a="";n&&(a=s===Ee?n.location.search:n.location.hash),window.clearTimeout(o),window.clearInterval(l),r(a)},n)}).finally(()=>{wc(Qd,Ma,a,r,i)(e)})}function Gd(e,t,n,r){return n.addQueueMeasurement(ea,r),new Promise((n,r)=>{const a=$d();window.setTimeout(()=>{a?(a.src=e,n(a)):r("Unable to load iframe")},t)})}function Yd(e){const t=$d();return t.src=e,t}function $d(){const e=document.createElement("iframe");return e.className="msalSilentIframe",e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(e),e}function Qd(e){document.body===e.parentNode&&document.body.removeChild(e)}class Jd extends ld{constructor(e,t,n,r,a,i,s,o,l,c,u){super(e,t,n,r,a,i,o,c,u),this.apiId=s,this.nativeStorage=l}async acquireToken(e){this.performanceClient.addQueueMeasurement(Nr,e.correlationId),e.loginHint||e.sid||e.account&&e.account.username||this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const t=c({},e);t.prompt?t.prompt!==Ae&&t.prompt!==xe&&(this.logger.warning("SilentIframeClient. Replacing invalid prompt ".concat(t.prompt," with ").concat(Ae)),t.prompt=Ae):t.prompt=Ae;const n=await Sc(this.initializeAuthorizationRequest.bind(this),aa,this.logger,this.performanceClient,e.correlationId)(t,Zi.Silent);return n.platformBroker=Bd(this.config,this.logger,this.platformAuthProvider,n.authenticationScheme),Wl(n.authority),this.config.auth.protocolMode===pt?this.executeEarFlow(n):this.executeCodeFlow(n)}async executeCodeFlow(e){let t;const n=this.initializeServerTelemetryManager(this.apiId);try{return t=await Sc(this.createAuthCodeClient.bind(this),na,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:n,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),await Sc(this.silentTokenHelper.bind(this),Jr,this.logger,this.performanceClient,e.correlationId)(t,e)}catch(r){if(r instanceof St&&(r.setCorrelationId(this.correlationId),n.cacheFailedRequest(r)),!t||!(r instanceof St)||r.errorCode!==hi)throw r;return this.performanceClient.addFields({retryError:r.errorCode},this.correlationId),await Sc(this.silentTokenHelper.bind(this),Jr,this.logger,this.performanceClient,this.correlationId)(t,e)}}async executeEarFlow(e){const t=e.correlationId,n=await Sc(this.getDiscoveredAuthority.bind(this),Rr,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),r=await Sc(Tl,Ja,this.logger,this.performanceClient,t)(),a=c(c({},e),{},{earJwk:r}),i=await Sc(Vd,Xr,this.logger,this.performanceClient,t)(this.config,n,a,this.logger,this.performanceClient),s=this.config.auth.OIDCOptions.serverResponseType,o=await Sc(Kd,Zr,this.logger,this.performanceClient,t)(i,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,t,s),l=wc(cd,ba,this.logger,this.performanceClient,t)(o,s,this.logger);return Sc(Od,ca,this.logger,this.performanceClient,t)(a,l,this.apiId,this.config,n,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}logout(){return Promise.reject(uo(Ps))}async silentTokenHelper(e,t){const n=t.correlationId;this.performanceClient.addQueueMeasurement(Jr,n);const r=await Sc(Rd,Ba,this.logger,this.performanceClient,n)(this.performanceClient,this.logger,n),a=c(c({},t),{},{codeChallenge:r.challenge});let i;if(t.httpMethod===ie)i=await Sc(Wd,Xr,this.logger,this.performanceClient,n)(this.config,e.authority,a,this.logger,this.performanceClient);else{const t=await Sc(Cd,ia,this.logger,this.performanceClient,n)(this.config,e.authority,a,this.logger,this.performanceClient);i=await Sc(qd,Xr,this.logger,this.performanceClient,n)(t,this.performanceClient,this.logger,n,this.config.system.navigateFrameWait)}const s=this.config.auth.OIDCOptions.serverResponseType,o=await Sc(Kd,Zr,this.logger,this.performanceClient,n)(i,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,n,s),l=wc(cd,ba,this.logger,this.performanceClient,n)(o,s,this.logger);return Sc(_d,da,this.logger,this.performanceClient,n)(t,l,r.verifier,this.apiId,this.config,e,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}}class Xd extends Gu{constructor(e,t){super(e,t)}async acquireToken(e){var t,n;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Ur,e.correlationId);const r=Ac(),a=await Sc(this.executeTokenRequest.bind(this),jr,this.logger,this.performanceClient,e.correlationId)(e,this.authority),i=null===(n=a.headers)||void 0===n?void 0:n[he],s=new Xu(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return s.validateTokenResponse(a.body),Sc(s.handleServerTokenResponse.bind(s),ya,this.logger,this.performanceClient,e.correlationId)(a.body,this.authority,r,e,void 0,void 0,!0,e.forceCache,i)}async acquireTokenByRefreshToken(e){var t;if(!e)throw Vn(En);if(null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Hr,e.correlationId),!e.account)throw pn(Gt);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await Sc(this.acquireTokenWithCachedRefreshToken.bind(this),Br,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(n){const t=n instanceof Yc&&n.errorCode===Bc,r=n instanceof Vu&&n.errorCode===Xe&&n.subError===Ze;if(t||r)return Sc(this.acquireTokenWithCachedRefreshToken.bind(this),Br,this.logger,this.performanceClient,e.correlationId)(e,!1);throw n}return Sc(this.acquireTokenWithCachedRefreshToken.bind(this),Br,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(Br,e.correlationId);const r=wc(this.cacheManager.getRefreshToken.bind(this.cacheManager),La,this.logger,this.performanceClient,e.correlationId)(e.account,t,e.correlationId,void 0,this.performanceClient);if(!r)throw Qc(Bc);var a;if(r.expiresOn&&Cc(r.expiresOn,e.refreshTokenExpirationOffsetSeconds||300))throw null===(a=this.performanceClient)||void 0===a||a.addFields({rtExpiresOnMs:Number(r.expiresOn)},e.correlationId),Qc(zc);const i=c(c({},e),{},{refreshToken:r.secret,authenticationScheme:e.authenticationScheme||Ge.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:zu}});try{return await Sc(this.acquireToken.bind(this),Ur,this.logger,this.performanceClient,e.correlationId)(i)}catch(o){var s;if(o instanceof Yc)if(null===(s=this.performanceClient)||void 0===s||s.addFields({rtExpiresOnMs:Number(r.expiresOn)},e.correlationId),o.subError===Wc){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const t=this.cacheManager.generateCredentialKey(r);this.cacheManager.removeRefreshToken(t,e.correlationId)}throw o}}async executeTokenRequest(e,t){var n;null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(jr,e.correlationId);const r=this.createTokenQueryParameters(e),a=sr.appendQueryString(t.tokenEndpoint,r),i=await Sc(this.createTokenRequestBody.bind(this),zr,this.logger,this.performanceClient,e.correlationId)(e),s=this.createTokenRequestHeaders(e.ccsCredential),o=tu(this.config.authOptions.clientId,e);return Sc(this.executePostToTokenEndpoint.bind(this),Lr,this.logger,this.performanceClient,e.correlationId)(a,i,s,o,e.correlationId,Lr)}async createTokenRequestBody(e){var t,n,r;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(zr,e.correlationId);const a=new Map;if(Po(a,e.embeddedClientId||(null===(n=e.tokenBodyParameters)||void 0===n?void 0:n[yo])||this.config.authOptions.clientId),e.redirectUri&&_o(a,e.redirectUri),No(a,e.scopes,!0,null===(r=this.config.authOptions.authority.options.OIDCOptions)||void 0===r?void 0:r.defaultScopes),Vo(a,_e),Ko(a),jo(a,this.config.libraryInfo),Uo(a,this.config.telemetry.application),Zo(a),this.serverTelemetryManager&&!ui(this.config)&&Xo(a,this.serverTelemetryManager),function(e,t){e.set("refresh_token",t)}(a,e.refreshToken),this.config.clientCredentials.clientSecret&&zo(a,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const t=this.config.clientCredentials.clientAssertion;qo(a,await ed(t.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),Wo(a,t.assertionType)}if(e.authenticationScheme===Ge.POP){const t=new Qu(this.cryptoUtils,this.performanceClient);let n;if(e.popKid)n=this.cryptoUtils.encodeKid(e.popKid);else{n=(await Sc(t.generateCnf.bind(t),pa,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString}Qo(a,n)}else if(e.authenticationScheme===Ge.SSH){if(!e.sshJwk)throw Vn(Mn);Jo(a,e.sshJwk)}if((!Kn.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&Lo(a,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case zu:try{Mo(a,Xc(e.ccsCredential.credential))}catch(i){this.logger.verbose("Could not parse home account ID for CCS Header: "+i)}break;case qu:Ro(a,e.ccsCredential.credential)}return e.embeddedClientId&&el(a,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&Yo(a,e.tokenBodyParameters),Eo(a,e.correlationId,this.performanceClient),ar(a)}}class Zd extends ld{async acquireToken(e){this.performanceClient.addQueueMeasurement(_r,e.correlationId);const t=await Sc(id,Gr,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),n=c(c({},e),t);e.redirectUri&&(n.redirectUri=this.getRedirectUri(e.redirectUri));const r=this.initializeServerTelemetryManager(Qi),a=await this.createRefreshTokenClient({serverTelemetryManager:r,authorityUrl:n.authority,azureCloudOptions:n.azureCloudOptions,account:n.account});return Sc(a.acquireTokenByRefreshToken.bind(a),Hr,this.logger,this.performanceClient,e.correlationId)(n).catch(e=>{throw e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e),e})}logout(){return Promise.reject(uo(Ps))}async createRefreshTokenClient(e){const t=await Sc(this.getClientConfiguration.bind(this),ra,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new Xd(t,this.performanceClient)}}class eh{constructor(e,t,n,r){this.isBrowserEnvironment="undefined"!==typeof window,this.config=e,this.storage=t,this.logger=n,this.cryptoObj=r}async loadExternalTokens(e,t,n){if(!this.isBrowserEnvironment)throw uo(Fs);const r=e.correlationId||wl(),a=t.id_token?Zn(t.id_token,il):void 0,i={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},s=e.authority?new jc(jc.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,i,this.logger,e.correlationId||wl()):void 0,o=await this.loadAccount(e,n.clientInfo||t.client_info||"",r,a,s),l=await this.loadIdToken(t,o.homeAccountId,o.environment,o.realm,r),c=await this.loadAccessToken(e,t,o.homeAccountId,o.environment,o.realm,n,r),u=await this.loadRefreshToken(t,o.homeAccountId,o.environment,r);return this.generateAuthenticationResult(e,{account:o,idToken:l,accessToken:c,refreshToken:u},a,s)}async loadAccount(e,t,n,r,a){if(this.logger.verbose("TokenCache - loading account"),e.account){const t=eu.createFromAccountInfo(e.account);return await this.storage.setAccount(t,n),t}if(!a||!t&&!r)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),uo(qs);const i=eu.generateHomeAccountId(t,a.authorityType,this.logger,this.cryptoObj,r),s=null===r||void 0===r?void 0:r.tid,o=Zu(this.storage,a,i,il,n,r,t,a.hostnameAndPort,s,void 0,void 0,this.logger);return await this.storage.setAccount(o,n),o}async loadIdToken(e,t,n,r,a){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const i=Ic(t,n,e.id_token,this.config.auth.clientId,r);return await this.storage.setIdTokenCredential(i,a),i}async loadAccessToken(e,t,n,r,a,i,s){if(!t.access_token)return this.logger.verbose("TokenCache - no access token found in response"),null;if(!t.expires_in)return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;if(!t.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null;this.logger.verbose("TokenCache - loading access token");const o=t.scope?Gn.fromString(t.scope):new Gn(e.scopes),l=i.expiresOn||t.expires_in+Ac(),c=i.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+Ac(),u=Nc(n,r,t.access_token,this.config.auth.clientId,a,o.printScopes(),l,c,il);return await this.storage.setAccessTokenCredential(u,s),u}async loadRefreshToken(e,t,n,r){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const a=Pc(t,n,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return await this.storage.setRefreshTokenCredential(a,r),a}generateAuthenticationResult(e,t,n,r){var a,i,s;let o,l="",c=[],u=null;null!==t&&void 0!==t&&t.accessToken&&(l=t.accessToken.secret,c=Gn.fromString(t.accessToken.target).asArray(),u=kc(t.accessToken.expiresOn),o=kc(t.accessToken.extendedExpiresOn));const d=t.account;return{authority:r?r.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:c,account:d.getAccountInfo(),idToken:(null===(a=t.idToken)||void 0===a?void 0:a.secret)||"",idTokenClaims:n||{},accessToken:l,fromCache:!0,expiresOn:u,correlationId:e.correlationId||"",requestId:"",extExpiresOn:o,familyId:(null===(i=t.refreshToken)||void 0===i?void 0:i.familyId)||"",tokenType:(null===t||void 0===t||null===(s=t.accessToken)||void 0===s?void 0:s.tokenType)||"",state:e.state||"",cloudGraphHostName:d.cloudGraphHostName||"",msGraphHost:d.msGraphHost||"",fromNativeBroker:!1}}}class th extends td{constructor(e){super(e),this.includeRedirectUri=!1}}class nh extends ld{constructor(e,t,n,r,a,i,s,o,l,c){super(e,t,n,r,a,i,o,l,c),this.apiId=s}async acquireToken(e){if(!e.code)throw uo(Vs);const t=await Sc(this.initializeAuthorizationRequest.bind(this),aa,this.logger,this.performanceClient,e.correlationId)(e,Zi.Silent),n=this.initializeServerTelemetryManager(this.apiId);try{const r=c(c({},t),{},{code:e.code}),a=await Sc(this.getClientConfiguration.bind(this),ra,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:n,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),i=new th(a);this.logger.verbose("Auth code client created");const s=new md(i,this.browserStorage,r,this.logger,this.performanceClient);return await Sc(s.handleCodeResponseFromServer.bind(s),oa,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(r){throw r instanceof St&&(r.setCorrelationId(this.correlationId),n.cacheFailedRequest(r)),r}}logout(){return Promise.reject(uo(Ps))}}function rh(e,t,n){try{zl(e)}catch(r){throw t.end({success:!1},r,n),r}}class ah{constructor(e){var t,n,r,a;this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new mc(this.logger,this.performanceClient):vn,this.eventHandler=new Hu(this.logger),this.browserStorage=this.isBrowserEnvironment?new Uu(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,function(e){const t=e.cloudDiscoveryMetadata;let n;if(t)try{n=JSON.parse(t)}catch(r){throw Vn(_n)}return{canonicalAuthority:e.authority?Uc(e.authority):void 0,knownAuthorities:e.knownAuthorities,cloudDiscoveryMetadata:n}}(this.config.auth)):(t=this.config.auth.clientId,n=this.logger,r=this.performanceClient,a=this.eventHandler,new Uu(t,{cacheLocation:Oi,cacheRetentionDays:5,temporaryCacheLocation:Oi,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1},vn,n,r,a));const i={cacheLocation:Oi,cacheRetentionDays:5,temporaryCacheLocation:Oi,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new Uu(this.config.auth.clientId,i,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler),this.tokenCache=new eh(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static async createController(e,t){const n=new ah(e);return await n.initialize(t),n}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e,t){if(this.logger.trace("initialize called"),this.initialized)return void this.logger.info("initialize has already been called, exiting early.");if(!this.isBrowserEnvironment)return this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,void this.eventHandler.emitEvent(fu);const n=(null===e||void 0===e?void 0:e.correlationId)||this.getRequestCorrelationId(),r=this.config.system.allowPlatformBroker,a=this.performanceClient.startMeasurement($r,n);if(this.eventHandler.emitEvent(hu),!t)try{this.logMultipleInstances(a)}catch(i){}if(await Sc(this.browserStorage.initialize.bind(this.browserStorage),Qr,this.logger,this.performanceClient,n)(n),r)try{this.platformAuthProvider=await Ud(this.logger,this.performanceClient,n,this.config.system.nativeBrokerHandshakeTimeout)}catch(s){this.logger.verbose(s)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),wc(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),Da,this.logger,this.performanceClient,n)(n)),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(n),this.initialized=!0,this.eventHandler.emitEvent(fu),a.end({allowPlatformBroker:r,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),Hl(this.initialized),this.isBrowserEnvironment){const t=e||"";let n=this.redirectResponse.get(t);return"undefined"===typeof n?(n=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,n),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),n}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){var t;if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;if((null===(t=this.browserStorage.getInteractionInProgress())||void 0===t?void 0:t.type)===Li)return this.logger.verbose("handleRedirectPromise removing interaction_in_progress flag and returning null after sign-out"),this.browserStorage.setInteractionInProgress(!1),Promise.resolve(null);const n=this.getAllAccounts(),r=this.browserStorage.getCachedNativeRequest(),a=r&&this.platformAuthProvider&&!e;let i,s;this.eventHandler.emitEvent(Pu,Zi.Redirect);try{if(a&&this.platformAuthProvider){i=this.performanceClient.startMeasurement(kr,(null===r||void 0===r?void 0:r.correlationId)||""),this.logger.trace("handleRedirectPromise - acquiring token from native platform"),i.add({isPlatformBrokerRequest:!0});const e=new xd(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Yi,this.performanceClient,this.platformAuthProvider,r.accountId,this.nativeInternalStorage,r.correlationId);s=Sc(e.handleRedirectPromise.bind(e),Oa,this.logger,this.performanceClient,i.event.correlationId)(this.performanceClient,i.event.correlationId)}else{const[t,n]=this.browserStorage.getCachedRequest(),r=t.correlationId;i=this.performanceClient.startMeasurement(kr,r),this.logger.trace("handleRedirectPromise - acquiring token from web flow");const a=this.createRedirectClient(r);s=Sc(a.handleRedirectPromise.bind(a),_a,this.logger,this.performanceClient,i.event.correlationId)(e,t,n,i)}}catch(o){throw this.browserStorage.resetRequestCache(),o}return s.then(e=>{if(e){this.browserStorage.resetRequestCache();n.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(yu,Zi.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(Su,Zi.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),i.end({success:!0},void 0,e.account)}else i.event.errorCode?i.end({success:!1},void 0):i.discard();return this.eventHandler.emitEvent(_u,Zi.Redirect),e}).catch(e=>{this.browserStorage.resetRequestCache();const t=e;throw n.length>0?this.eventHandler.emitEvent(Tu,Zi.Redirect,null,t):this.eventHandler.emitEvent(bu,Zi.Redirect,null,t),this.eventHandler.emitEvent(_u,Zi.Redirect),i.end({success:!1},t),e})}async acquireTokenRedirect(e){const t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);const n=this.performanceClient.startMeasurement(xr,t);n.add({scenarioId:e.scenarioId});const r=e.onRedirectNavigate;if(r)e.onRedirectNavigate=t=>{const a="function"===typeof r?r(t):void 0;return n.add({navigateCallbackResult:!1!==a}),n.event=n.end({success:!0},void 0,e.account)||n.event,a};else{const t=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=r=>{const a="function"===typeof t?t(r):void 0;return n.add({navigateCallbackResult:!1!==a}),n.event=n.end({success:!0},void 0,e.account)||n.event,a}}const a=this.getAllAccounts().length>0;try{let r;if(ql(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,Di),a?this.eventHandler.emitEvent(wu,Zi.Redirect,e):this.eventHandler.emitEvent(vu,Zi.Redirect,e),this.platformAuthProvider&&this.canUsePlatformBroker(e)){r=new xd(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Vi,this.performanceClient,this.platformAuthProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,n).catch(r=>{if(n.add({brokerErrorName:r.name,brokerErrorCode:r.errorCode}),r instanceof vd&&yd(r)){this.platformAuthProvider=void 0;return this.createRedirectClient(t).acquireToken(e)}if(r instanceof Yc){this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow");return this.createRedirectClient(t).acquireToken(e)}throw r})}else{r=this.createRedirectClient(t).acquireToken(e)}return await r}catch(i){throw this.browserStorage.resetRequestCache(),2===n.event.status?this.performanceClient.startMeasurement(kr,t).end({success:!1},i,e.account):n.end({success:!1},i,e.account),a?this.eventHandler.emitEvent(Tu,Zi.Redirect,null,i):this.eventHandler.emitEvent(bu,Zi.Redirect,null,i),i}}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(Ar,t);n.add({scenarioId:e.scenarioId});try{this.logger.verbose("acquireTokenPopup called",t),rh(this.initialized,n,e.account),this.browserStorage.setInteractionInProgress(!0,Di)}catch(s){return Promise.reject(s)}const r=this.getAllAccounts();let a;r.length>0?this.eventHandler.emitEvent(wu,Zi.Popup,e):this.eventHandler.emitEvent(vu,Zi.Popup,e);const i=this.getPreGeneratedPkceCodes(t);if(this.canUsePlatformBroker(e))n.add({isPlatformBrokerRequest:!0}),a=this.acquireTokenNative(c(c({},e),{},{correlationId:t}),Ki).then(e=>(n.end({success:!0},void 0,e.account),e)).catch(r=>{if(n.add({brokerErrorName:r.name,brokerErrorCode:r.errorCode}),r instanceof vd&&yd(r)){this.platformAuthProvider=void 0;return this.createPopupClient(t).acquireToken(e,i)}if(r instanceof Yc){this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow");return this.createPopupClient(t).acquireToken(e,i)}throw r});else{a=this.createPopupClient(t).acquireToken(e,i)}return a.then(e=>(r.length<this.getAllAccounts().length?this.eventHandler.emitEvent(yu,Zi.Popup,e):this.eventHandler.emitEvent(Su,Zi.Popup,e),n.end({success:!0,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length},void 0,e.account),e)).catch(t=>(r.length>0?this.eventHandler.emitEvent(Tu,Zi.Popup,null,t):this.eventHandler.emitEvent(bu,Zi.Popup,null,t),n.end({success:!1},t,e.account),Promise.reject(t))).finally(async()=>{this.browserStorage.setInteractionInProgress(!1),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(t)})}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){var t,n;const r=this.getRequestCorrelationId(e),a=c(c({},e),{},{prompt:e.prompt,correlationId:r});let i;if(this.ssoSilentMeasurement=this.performanceClient.startMeasurement(Or,r),null===(t=this.ssoSilentMeasurement)||void 0===t||t.add({scenarioId:e.scenarioId}),rh(this.initialized,this.ssoSilentMeasurement,e.account),null===(n=this.ssoSilentMeasurement)||void 0===n||n.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",r),this.eventHandler.emitEvent(xu,Zi.Silent,a),this.canUsePlatformBroker(a)){var s;null===(s=this.ssoSilentMeasurement)||void 0===s||s.add({isPlatformBrokerRequest:!0}),i=this.acquireTokenNative(a,Gi).catch(e=>{var t;if(null===(t=this.ssoSilentMeasurement)||void 0===t||t.add({brokerErrorName:e.name,brokerErrorCode:e.errorCode}),e instanceof vd&&yd(e)){this.platformAuthProvider=void 0;return this.createSilentIframeClient(a.correlationId).acquireToken(a)}throw e})}else{i=this.createSilentIframeClient(a.correlationId).acquireToken(a)}return i.then(e=>{var t;return this.eventHandler.emitEvent(ku,Zi.Silent,e),null===(t=this.ssoSilentMeasurement)||void 0===t||t.end({success:!0,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length},void 0,e.account),e}).catch(t=>{var n;throw this.eventHandler.emitEvent(Cu,Zi.Silent,null,t),null===(n=this.ssoSilentMeasurement)||void 0===n||n.end({success:!1},t,e.account),t}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(e){const t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);const n=this.performanceClient.startMeasurement(br,t);rh(this.initialized,n),this.eventHandler.emitEvent(Eu,Zi.Silent,e),n.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw uo(Gs);if(e.code){const r=e.code;let a=this.hybridAuthCodeResponses.get(r);return a?(this.logger.verbose("Existing acquireTokenByCode request found",t),n.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),a=this.acquireTokenByCodeAsync(c(c({},e),{},{correlationId:t})).then(e=>(this.eventHandler.emitEvent(Iu,Zi.Silent,e),this.hybridAuthCodeResponses.delete(r),n.end({success:!0,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length},void 0,e.account),e)).catch(e=>{throw this.hybridAuthCodeResponses.delete(r),this.eventHandler.emitEvent(Nu,Zi.Silent,null,e),n.end({success:!1},e),e}),this.hybridAuthCodeResponses.set(r,a)),await a}if(e.nativeAccountId){if(this.canUsePlatformBroker(e,e.nativeAccountId)){n.add({isPlatformBrokerRequest:!0});const r=await this.acquireTokenNative(c(c({},e),{},{correlationId:t}),$i,e.nativeAccountId).catch(e=>{throw e instanceof vd&&yd(e)&&(this.platformAuthProvider=void 0),n.add({brokerErrorName:e.name,brokerErrorCode:e.errorCode}),e});return n.end({success:!0},void 0,r.account),r}throw uo($s)}throw uo(Ks)}catch(r){throw this.eventHandler.emitEvent(Nu,Zi.Silent,null,r),n.end({success:!1},r),r}}async acquireTokenByCodeAsync(e){var t;this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(Pa,e.correlationId),null===(t=this.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement);const n=this.createSilentAuthCodeClient(e.correlationId);return await n.acquireToken(e).then(e=>{var t;return null===(t=this.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.end({success:!0,fromCache:e.fromCache}),e}).catch(e=>{var t;throw null===(t=this.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.end({success:!1},e),e}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(qr,e.correlationId),t){case rs:case as:case is:const t=this.createSilentCacheClient(e.correlationId);return Sc(t.acquireToken.bind(t),Ir,this.logger,this.performanceClient,e.correlationId)(e);default:throw pn(tn)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(wr,e.correlationId),t){case rs:case is:case ss:case os:const t=this.createSilentRefreshClient(e.correlationId);return Sc(t.acquireToken.bind(t),_r,this.logger,this.performanceClient,e.correlationId)(e);default:throw pn(tn)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(Kr,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return Sc(t.acquireToken.bind(t),Nr,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect(c({correlationId:t},e))}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);ql(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,Li);return this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);zl(this.initialized),this.browserStorage.setInteractionInProgress(!0,Li);return this.createPopupClient(t).logout(e).finally(()=>{this.browserStorage.setInteractionInProgress(!1)})}catch(t){return Promise.reject(t)}}async clearCache(e){if(!this.isBrowserEnvironment)return void this.logger.info("in non-browser environment, returning early.");const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){const t=this.getRequestCorrelationId();return function(e,t,n,r,a){return e.verbose("getAllAccounts called"),n?t.getAllAccounts(a||{},r):[]}(this.logger,this.browserStorage,this.isBrowserEnvironment,t,e)}getAccount(e){const t=this.getRequestCorrelationId();return function(e,t,n,r){const a=n.getAccountInfoFilteredBy(e,r);return a?(t.verbose("getAccount: Account matching provided filter found, returning"),a):(t.verbose("getAccount: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}getAccountByUsername(e){const t=this.getRequestCorrelationId();return function(e,t,n,r){if(t.trace("getAccountByUsername called"),!e)return t.warning("getAccountByUsername: No username provided"),null;const a=n.getAccountInfoFilteredBy({username:e},r);return a?(t.verbose("getAccountByUsername: Account matching username found, returning"),t.verbosePii("getAccountByUsername: Returning signed-in accounts matching username: ".concat(e)),a):(t.verbose("getAccountByUsername: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}getAccountByHomeId(e){const t=this.getRequestCorrelationId();return function(e,t,n,r){if(t.trace("getAccountByHomeId called"),!e)return t.warning("getAccountByHomeId: No homeAccountId provided"),null;const a=n.getAccountInfoFilteredBy({homeAccountId:e},r);return a?(t.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),t.verbosePii("getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ".concat(e)),a):(t.verbose("getAccountByHomeId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}getAccountByLocalId(e){const t=this.getRequestCorrelationId();return function(e,t,n,r){if(t.trace("getAccountByLocalId called"),!e)return t.warning("getAccountByLocalId: No localAccountId provided"),null;const a=n.getAccountInfoFilteredBy({localAccountId:e},r);return a?(t.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),t.verbosePii("getAccountByLocalId: Returning signed-in accounts matching localAccountId: ".concat(e)),a):(t.verbose("getAccountByLocalId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}setActiveAccount(e){const t=this.getRequestCorrelationId();!function(e,t,n){t.setActiveAccount(e,n)}(e,this.browserStorage,t)}getActiveAccount(){const e=this.getRequestCorrelationId();return function(e,t){return e.getActiveAccount(t)}(this.browserStorage,e)}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const n=eu.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return await this.browserStorage.setAccount(n,e.correlationId),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,n,r){if(this.logger.trace("acquireTokenNative called"),!this.platformAuthProvider)throw uo(Xs);return new xd(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.platformAuthProvider,n||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e,r)}canUsePlatformBroker(e,t){if(this.logger.trace("canUsePlatformBroker called"),!this.platformAuthProvider)return this.logger.trace("canUsePlatformBroker: platform broker unavilable, returning false"),!1;if(!Bd(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme))return this.logger.trace("canUsePlatformBroker: isBrokerAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case Ae:case Te:case we:case Se:this.logger.trace("canUsePlatformBroker: prompt is compatible with platform broker flow");break;default:return this.logger.trace("canUsePlatformBroker: prompt = ".concat(e.prompt," is not compatible with platform broker flow, returning false")),!1}return!(!t&&!this.getNativeAccountId(e))||(this.logger.trace("canUsePlatformBroker: nativeAccountId is not available, returning false"),!1)}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new Hd(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createRedirectClient(e){return new zd(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createSilentIframeClient(e){return new Jd(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Gi,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createSilentCacheClient(e){return new Sd(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.platformAuthProvider,e)}createSilentRefreshClient(e){return new Zd(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.platformAuthProvider,e)}createSilentAuthCodeClient(e){return new nh(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,$i,this.performanceClient,this.platformAuthProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return Bl(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){this.config.cache.cacheLocation===Pi?this.eventHandler.subscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}disableAccountStorageEvents(){this.config.cache.cacheLocation===Pi?this.eventHandler.unsubscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return null!==e&&void 0!==e&&e.correlationId?e.correlationId:this.isBrowserEnvironment?wl():J.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect(c({correlationId:t},e||es))}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup(c({correlationId:t},e||es))}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(Sr,t);n.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),rh(this.initialized,n,e.account),this.logger.verbose("acquireTokenSilent called",t);const r=e.account||this.getActiveAccount();if(!r)throw uo(_s);return this.acquireTokenSilentDeduped(e,r,t).then(r=>(n.end({success:!0,fromCache:r.fromCache,accessTokenSize:r.accessToken.length,idTokenSize:r.idToken.length},void 0,r.account),c(c({},r),{},{state:e.state,correlationId:t}))).catch(e=>{throw e instanceof St&&e.setCorrelationId(t),n.end({success:!1},e,r),e})}async acquireTokenSilentDeduped(e,t,n){const r=tu(this.config.auth.clientId,c(c({},e),{},{authority:e.authority||this.config.auth.authority,correlationId:n}),t.homeAccountId),a=JSON.stringify(r),i=this.activeSilentTokenRequests.get(a);if("undefined"===typeof i){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",n),this.performanceClient.addFields({deduped:!1},n);const r=Sc(this.acquireTokenSilentAsync.bind(this),Tr,this.logger,this.performanceClient,n)(c(c({},e),{},{correlationId:n}),t);return this.activeSilentTokenRequests.set(a,r),r.finally(()=>{this.activeSilentTokenRequests.delete(a)})}return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",n),this.performanceClient.addFields({deduped:!0},n),i}async acquireTokenSilentAsync(e,t){const n=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(Tr,e.correlationId),this.eventHandler.emitEvent(wu,Zi.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",n);const r=await Sc(sd,Yr,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),a=e.cacheLookupPolicy||rs;return this.acquireTokenSilentNoIframe(r,a).catch(async e=>{const t=function(e,t){const n=!(e instanceof Yc&&e.subError!==Wc),r=e.errorCode===hi||e.errorCode===tn,a=n&&r||e.errorCode===Bc||e.errorCode===zc,i=cs.includes(t);return a&&i}(e,a);if(t){if(this.activeIframeRequest){if(a!==ls){const[t,n]=this.activeIframeRequest;this.logger.verbose("Iframe request is already in progress, awaiting resolution for request with correlationId: ".concat(n),r.correlationId);const i=this.performanceClient.startMeasurement(Pr,r.correlationId);i.add({awaitIframeCorrelationId:n});const s=await t;if(i.end({success:s}),s)return this.logger.verbose("Parallel iframe request with correlationId: ".concat(n," succeeded. Retrying cache and/or RT redemption"),r.correlationId),this.acquireTokenSilentNoIframe(r,a);throw this.logger.info("Iframe request with correlationId: ".concat(n," failed. Interaction is required.")),e}return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",r.correlationId),Sc(this.acquireTokenBySilentIframe.bind(this),Kr,this.logger,this.performanceClient,r.correlationId)(r)}{let e;return this.activeIframeRequest=[new Promise(t=>{e=t}),r.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",r.correlationId),Sc(this.acquireTokenBySilentIframe.bind(this),Kr,this.logger,this.performanceClient,r.correlationId)(r).then(t=>(e(!0),t)).catch(t=>{throw e(!1),t}).finally(()=>{this.activeIframeRequest=void 0})}}throw e}).then(t=>(this.eventHandler.emitEvent(Su,Zi.Silent,t),this.performanceClient.addFields({fromCache:t.fromCache},e.correlationId),t)).catch(e=>{throw this.eventHandler.emitEvent(Tu,Zi.Silent,null,e),e}).finally(()=>{document.removeEventListener("visibilitychange",n)})}async acquireTokenSilentNoIframe(e,t){return Bd(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.performanceClient.addFields({isPlatformBrokerRequest:!0},e.correlationId),this.acquireTokenNative(e,Qi,e.account.nativeAccountId,t).catch(async t=>{if(this.performanceClient.addFields({brokerErrorName:t.name,brokerErrorCode:t.errorCode},e.correlationId),t instanceof vd&&yd(t))throw this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.platformAuthProvider=void 0,pn(tn);throw t})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),t===as&&this.logger.verbose("acquireTokenSilent - cache lookup policy set to AccessToken, attempting to acquire token from local cache"),Sc(this.acquireTokenFromCache.bind(this),qr,this.logger,this.performanceClient,e.correlationId)(e,t).catch(n=>{if(t===as)throw n;return this.eventHandler.emitEvent(Au,Zi.Silent,e),Sc(this.acquireTokenByRefreshToken.bind(this),wr,this.logger,this.performanceClient,e.correlationId)(e,t)}))}async preGeneratePkceCodes(e){return this.logger.verbose("Generating new PKCE codes"),this.pkceCode=await Sc(Rd,Ba,this.logger,this.performanceClient,e)(this.performanceClient,this.logger,e),Promise.resolve()}getPreGeneratedPkceCodes(e){this.logger.verbose("Attempting to pick up pre-generated PKCE codes");const t=this.pkceCode?c({},this.pkceCode):void 0;return this.pkceCode=void 0,this.logger.verbose("".concat(t?"Found":"Did not find"," pre-generated PKCE codes")),this.performanceClient.addFields({usePreGeneratedPkce:!!t},e),t}logMultipleInstances(e){const t=this.config.auth.clientId;if(!window)return;window.msal=window.msal||{},window.msal.clientIds=window.msal.clientIds||[];window.msal.clientIds.length>0&&this.logger.verbose("There is already an instance of MSAL.js in the window."),window.msal.clientIds.push(t),function(e,t,n){var r;const a=(null===(r=window.msal)||void 0===r?void 0:r.clientIds)||[],i=a.length,s=a.filter(t=>t===e).length;s>1&&n.warning("There is already an instance of MSAL.js in the window with the same client id."),t.add({msalInstanceCount:i,sameClientIdInstanceCount:s})}(t,e,this.logger)}}class ih{static async createPublicClientApplication(e){const t=await async function(e,t){const n=new ac(e);return await n.initialize(),ah.createController(n,t)}(e);return new ih(e,t)}constructor(e,t){this.isBroker=!1,this.controller=t||new ah(new ac(e))}async initialize(e){return this.controller.initialize(e,this.isBroker)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}class sh{constructor(e){console.log("\ud83d\udd27 SharePointService constructor received config:",e),this.config={siteUrl:(null===e||void 0===e?void 0:e.siteUrl)||"https://evokebehavioralhealthcom.sharepoint.com/sites/Clinistrators",staffListName:(null===e||void 0===e?void 0:e.staffListName)||"Staff",studentsListName:(null===e||void 0===e?void 0:e.studentsListName)||"Clients",scheduleListName:(null===e||void 0===e?void 0:e.scheduleListName)||"ScheduleHistory",clientId:null===e||void 0===e?void 0:e.clientId,tenantId:null===e||void 0===e?void 0:e.tenantId,redirectUri:null===e||void 0===e?void 0:e.redirectUri},console.log("\ud83d\udd27 SharePointService final config:",this.config),this.siteUrl=this.config.siteUrl,this.msalConfig={auth:{clientId:this.config.clientId,authority:"https://login.microsoftonline.com/".concat(this.config.tenantId),redirectUri:this.config.redirectUri},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1}},this.msalInstance=new ih(this.msalConfig),this.isInitialized=!1,this.accessToken=null,this.tokenExpiry=null,this.requestDigest=null,this.digestExpiry=null,this.loginRequest={scopes:["https://evokebehavioralhealthcom.sharepoint.com/.default"],prompt:"select_account"},this.maxRetries=3,this.retryDelay=1e3,console.log("\ud83d\udd27 SharePointService initialized:",{siteUrl:this.config.siteUrl,clientId:this.config.clientId,redirectUri:this.config.redirectUri,scopes:this.loginRequest.scopes})}async initializeMSAL(){if(!this.isInitialized)try{console.log("\ud83d\udd04 Initializing MSAL..."),await this.msalInstance.initialize(),this.isInitialized=!0,console.log("\u2705 MSAL initialized successfully")}catch(e){throw console.error("\u274c MSAL initialization failed:",e),e}}async login(){try{console.log("\ud83d\udd10 Starting MSAL login..."),await this.initializeMSAL();const t=this.msalInstance.getAllAccounts();if(t.length>0)try{const e=await this.msalInstance.acquireTokenSilent(c(c({},this.loginRequest),{},{account:t[0]}));return this.accessToken=e.accessToken,this.tokenExpiry=e.expiresOn.getTime(),console.log("\u2705 Silent login successful"),!0}catch(e){console.log("\u26a0\ufe0f Silent login failed, will redirect...")}return console.log("\ud83d\udd17 Redirecting to Microsoft login..."),console.log("\ud83d\udccb Login request:",this.loginRequest),await this.msalInstance.loginRedirect(this.loginRequest),!1}catch(t){throw console.error("\u274c MSAL login failed:",t),t}}async checkAuthentication(){try{await this.initializeMSAL();const t=await this.msalInstance.handleRedirectPromise();if(t)return console.log("\u2705 Login redirect handled successfully"),console.log("\ud83d\udccb Token response:",{scopes:t.scopes,tokenType:t.tokenType,expiresOn:t.expiresOn}),this.accessToken=t.accessToken,this.tokenExpiry=t.expiresOn.getTime(),!0;const n=this.msalInstance.getAllAccounts();if(n.length>0){console.log("\u2705 Found existing account:",n[0].username);try{const e=await this.msalInstance.acquireTokenSilent(c(c({},this.loginRequest),{},{account:n[0]}));return this.accessToken=e.accessToken,this.tokenExpiry=e.expiresOn.getTime(),console.log("\u2705 Token acquired silently"),!0}catch(e){return console.log("\u26a0\ufe0f Silent token acquisition failed:",e.message),!1}}return console.log("\u26a0\ufe0f No authenticated accounts found"),!1}catch(e){return console.error("\u274c Authentication check failed:",e),!1}}async getCachedToken(){try{await this.initializeMSAL();const e=this.msalInstance.getAllAccounts();if(0===e.length)return null;const t=await this.msalInstance.acquireTokenSilent(c(c({},this.loginRequest),{},{account:e[0]}));return console.log("\u2705 Retrieved token silently from MSAL"),this.tokenExpiry=t.expiresOn.getTime(),t.accessToken}catch(e){return console.log("\u26a0\ufe0f Could not get token silently:",e.message),null}}forceLogout(){console.log("\ud83d\udeaa Logging out with MSAL..."),this.accessToken=null,this.tokenExpiry=null;const e=this.msalInstance.getAllAccounts();e.length>0&&this.msalInstance.logoutRedirect({account:e[0]})}isAuthenticated(){return!!(this.accessToken&&this.tokenExpiry&&Date.now()<this.tokenExpiry)}async retryFetch(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.maxRetries;for(let a=0;a<=n;a++)try{console.log("\ud83d\udd04 API call attempt ".concat(a+1,"/").concat(n+1,": ").concat(e));const r=await fetch(e,t);if(r.ok||r.status>=400&&r.status<500)return r;if(a<n){const e=this.retryDelay*Math.pow(2,a);console.log("\u23f3 Retrying in ".concat(e,"ms due to server error: ").concat(r.status)),await new Promise(t=>setTimeout(t,e));continue}return r}catch(r){if(console.error("\u274c API call attempt ".concat(a+1," failed:"),r.message),a<n&&("TypeError"===r.name||r.message.includes("fetch"))){const e=this.retryDelay*Math.pow(2,a);console.log("\u23f3 Retrying in ".concat(e,"ms due to network error")),await new Promise(t=>setTimeout(t,e));continue}throw r}}async getRequestDigest(){if(this.requestDigest&&this.digestExpiry&&Date.now()<this.digestExpiry)return this.requestDigest;try{const e=await fetch("".concat(this.config.siteUrl,"/_api/contextinfo"),{method:"POST",headers:{Accept:"application/json;odata=verbose",Authorization:"Bearer ".concat(this.accessToken)}});if(e.ok){const t=await e.json();return this.requestDigest=t.d.GetContextWebInformation.FormDigestValue,this.digestExpiry=Date.now()+1e3*t.d.GetContextWebInformation.FormDigestTimeoutSeconds-6e4,this.requestDigest}throw 401===e.status?new Error("Authentication failed. Please make sure you are logged in and have access to this SharePoint site."):new Error("Failed to get request digest: ".concat(e.status))}catch(e){throw console.error("Error getting request digest:",e),e}}async getHeaders(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t={Accept:"application/json;odata=verbose",Authorization:"Bearer ".concat(this.accessToken)};if(e){const e=await this.getRequestDigest();t["X-RequestDigest"]=e,t["Content-Type"]="application/json;odata=verbose"}return t}async makeRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.accessToken)throw new Error("No access token available. Please login first.");try{const n=await fetch(e,t);if(401===n.status)throw new Error("Authentication failed. Access token may have expired.");return n}catch(n){throw console.error("SharePoint request failed:",n),n}}async loadStaff(){try{console.log("\ud83d\udd0d Loading staff from SharePoint REST API...");const e=await this.getHeaders(),t="".concat(this.config.siteUrl,"/_api/web/lists/getbytitle('").concat(this.config.staffListName,"')/items?")+"$select=Id,StaffPerson/Id,StaffPerson/Title,StaffPerson/EMail,Role,PrimaryProgram,SecondaryProgram,IsActive,AbsentAM,AbsentPM,AbsentFullDay,OutOfSessionAM,OutOfSessionPM,OutOfSessionFullDay&$expand=StaffPerson&$top=5000";console.log("\ud83d\udccb Fetching staff from:",t);const n=await this.makeRequest(t,{headers:e});if(!n.ok){const e=await n.text();throw console.error("SharePoint Staff API Error:",n.status,e),new Error("Failed to load staff: ".concat(n.status," - ").concat(e))}const r=await n.json();console.log("\ud83d\udd0d Raw SharePoint staff response:",r);const a=r.d.results||[];return console.log("\u2705 Found ".concat(a.length," staff members")),a.length>0&&console.log("\ud83d\udccb First staff item:",a[0]),a.map(e=>{const t=e.StaffPerson,n=t?t.Title:"Unknown Staff",r=t?t.EMail:"",a=new U({id:t?t.Id:e.Id,listItemId:e.Id,name:n,role:e.Role||"RBT",email:r,primaryProgram:!0===e.PrimaryProgram,secondaryProgram:!0===e.SecondaryProgram,isActive:!1!==e.IsActive,absentAM:!0===e.AbsentAM,absentPM:!0===e.AbsentPM,absentFullDay:!0===e.AbsentFullDay,outOfSessionAM:!0===e.OutOfSessionAM,outOfSessionPM:!0===e.OutOfSessionPM,outOfSessionFullDay:!0===e.OutOfSessionFullDay});return console.log("\u2705 Loaded staff: ".concat(a.name," (").concat(a.role,") - Primary: ").concat(a.primaryProgram,", Secondary: ").concat(a.secondaryProgram)),a})}catch(e){throw console.error("Error loading staff:",e),e}}async loadClientTeamMembers(){try{console.log("\ud83d\udd0d Loading client team members from ClientTeamMembers list...");const e=await this.getHeaders(),t="".concat(this.config.siteUrl,"/_api/web/lists/getbytitle('ClientTeamMembers')/items?")+"$select=Id,ClientID,ClientName,StaffMember/Id,StaffMember/Title,StaffMember/EMail,TrainingStatus,IsActive,DateAdded&$expand=StaffMember&$filter=IsActive eq true&$top=5000";console.log("\ud83d\udccb Fetching team members from:",t);const n=await this.makeRequest(t,{headers:e});if(!n.ok){const e=await n.text();if(console.error("\u274c SharePoint ClientTeamMembers API Error:",n.status,e),404===n.status)return console.warn("\u26a0\ufe0f ClientTeamMembers list not found - using legacy Team field instead"),[];throw new Error("Failed to load client team members: ".concat(n.status," - ").concat(e))}const r=(await n.json()).d.results||[];console.log("\u2705 Found ".concat(r.length," client team member assignments"));const a={};return r.forEach(e=>{const t=e.ClientID;a[t]||(a[t]=[]),e.StaffMember&&a[t].push({id:e.StaffMember.Id,title:e.StaffMember.Title,name:e.StaffMember.Title,email:e.StaffMember.EMail||"",trainingStatus:e.TrainingStatus||"solo"})}),console.log("\ud83d\udcca Team members grouped by client:",Object.keys(a).length,"clients have teams"),a}catch(e){return console.error("\u274c Error loading client team members:",e),{}}}async loadStudents(){try{console.log("\ud83d\udd0d Loading students from SharePoint REST API...");const e=await this.getHeaders(),t="".concat(this.config.siteUrl,"/_api/web/lists/getbytitle('").concat(this.config.studentsListName,"')/items?")+"$select=Id,Title,Program,RatioAM,RatioPM,IsActive,PairedWith,Team/Id,Team/Title,Team/EMail,AbsentAM,AbsentPM,AbsentFullDay,TeamTrainingStatus&$expand=Team&$top=5000";console.log("\ud83d\udccb Fetching students from:",t);const n=await this.makeRequest(t,{headers:e});if(!n.ok){const e=await n.text();throw console.error("\u274c SharePoint Students API Error:",n.status,e),new Error("Failed to load students: ".concat(n.status," - ").concat(e))}const r=await n.json();console.log("\ud83d\udd0d Raw SharePoint students response:",r);const a=r.d.results||[];console.log("\u2705 Found ".concat(a.length," students")),a.length>0&&(console.log("\ud83d\udccb First student item:",a[0]),console.log("\ud83d\udccb First student team data:",a[0].Team));const i=await this.loadClientTeamMembers();return this.parseStudents(a,i)}catch(e){throw console.error("\u274c Error loading students:",e),e}}parseStudents(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.log("\ud83d\udd0d Parsing ".concat(e.length," students"));const n=e.map(e=>{console.log("\ud83d\udd0d Processing student: ".concat(e.Title));let n=[],r=[],a={};if(t[e.Id]&&t[e.Id].length>0)console.log("  \ud83d\udccb Using ClientTeamMembers list for ".concat(e.Title)),n=t[e.Id],r=n.map(e=>e.id),n.forEach(e=>{a[e.id]=e.trainingStatus||"solo"}),console.log("  \u2705 ".concat(e.Title," has ").concat(n.length," team members from ClientTeamMembers list"));else if(e.Team){console.log("  \ud83d\udccb Using legacy Team field for ".concat(e.Title)),e.Team.results&&Array.isArray(e.Team.results)?(console.log("  \ud83d\udccb Team data for ".concat(e.Title,":"),e.Team.results),n=e.Team.results.map(e=>({id:e.Id,title:e.Title,name:e.Title,email:e.EMail||""})),r=n.map(e=>e.id)):e.Team.Id&&(console.log("  \ud83d\udccb Single team member for ".concat(e.Title,":"),e.Team),n=[{id:e.Team.Id,title:e.Team.Title,name:e.Team.Title,email:e.Team.EMail||""}],r=[e.Team.Id]);try{a=e.TeamTrainingStatus?JSON.parse(e.TeamTrainingStatus):{}}catch(s){console.warn("  \u26a0\ufe0f Failed to parse TeamTrainingStatus for ".concat(e.Title,":"),s),a={}}console.log("  \u2705 ".concat(e.Title," has ").concat(n.length," team members from legacy Team field"))}const i=new V({id:e.Id,name:e.Title,program:e.Program||L.PRIMARY,ratioAM:e.RatioAM||"1:1",ratioPM:e.RatioPM||"1:1",isActive:!1!==e.IsActive,team:n,teamIds:r,pairedWith:e.PairedWith||null,absentAM:!0===e.AbsentAM,absentPM:!0===e.AbsentPM,absentFullDay:!0===e.AbsentFullDay,teamTrainingStatus:a});return n.length>0?console.log("\u2705 ".concat(e.Title," has ").concat(n.length," team members:"),n.map(e=>e.title||e.name)):console.log("\u26a0\ufe0f ".concat(e.Title," has no team members")),i});return console.log("\ud83d\udcca STUDENT LOAD SUMMARY:"),console.log("  Total students: ".concat(n.length)),console.log("  Students with teams: ".concat(n.filter(e=>e.team&&e.team.length>0).length)),n}async loadSchedule(e){try{return console.log("\ud83d\udcc5 Schedule loading temporarily disabled - returning empty schedule"),new G({date:e,assignments:[],traineeAssignments:[],lockedAssignments:new Set,isFinalized:!1})}catch(t){return console.error("Error in loadSchedule:",t),new G({date:e,traineeAssignments:[]})}}async saveStaff(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{const n=await this.getHeaders(!0);t&&(n["X-HTTP-Method"]="MERGE",n["If-Match"]="*");const r=e.listItemId||e.id,a=t?"".concat(this.config.siteUrl,"/_api/web/lists/getbytitle('").concat(this.config.staffListName,"')/items(").concat(r,")"):"".concat(this.config.siteUrl,"/_api/web/lists/getbytitle('").concat(this.config.staffListName,"')/items"),i={__metadata:{type:"SP.Data.StaffListItem"},Role:e.role,PrimaryProgram:e.primaryProgram,SecondaryProgram:e.secondaryProgram,IsActive:e.isActive,AbsentAM:e.absentAM||!1,AbsentPM:e.absentPM||!1,AbsentFullDay:e.absentFullDay||!1,OutOfSessionAM:e.outOfSessionAM||!1,OutOfSessionPM:e.outOfSessionPM||!1,OutOfSessionFullDay:e.outOfSessionFullDay||!1},s=await this.makeRequest(a,{method:"POST",headers:n,body:JSON.stringify(i)});if(!s.ok)throw new Error("Failed to save staff: ".concat(s.status));return s}catch(n){throw console.error("Error saving staff:",n),n}}async saveClientTeamMember(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"solo",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;try{const s=await this.getHeaders(!0);a&&i&&(s["X-HTTP-Method"]="MERGE",s["If-Match"]="*");const o=a&&i?"".concat(this.config.siteUrl,"/_api/web/lists/getbytitle('ClientTeamMembers')/items(").concat(i,")"):"".concat(this.config.siteUrl,"/_api/web/lists/getbytitle('ClientTeamMembers')/items"),l={__metadata:{type:"SP.Data.ClientTeamMembersListItem"},Title:"".concat(t," - ").concat(n.name),ClientID:e,ClientName:t,StaffMemberId:n.id,TrainingStatus:r,IsActive:!0,DateAdded:(new Date).toISOString()},c=await this.makeRequest(o,{method:"POST",headers:s,body:JSON.stringify(l)});if(!c.ok){const e=await c.text();throw console.error("Failed to save team member: ".concat(c.status),e),new Error("Failed to save team member: ".concat(c.status))}return console.log("\u2705 Team member saved: ".concat(n.name," \u2192 ").concat(t," (").concat(r,")")),!0}catch(s){throw console.error("Error saving client team member:",s),s}}async deleteClientTeamMember(e){try{const t=await this.getHeaders(!0);t["X-HTTP-Method"]="DELETE",t["If-Match"]="*";const n="".concat(this.config.siteUrl,"/_api/web/lists/getbytitle('ClientTeamMembers')/items(").concat(e,")"),r=await this.makeRequest(n,{method:"POST",headers:t});if(!r.ok)throw new Error("Failed to delete team member: ".concat(r.status));return console.log("\u2705 Team member deleted: ".concat(e)),!0}catch(t){throw console.error("Error deleting client team member:",t),t}}async syncStudentTeamToList(e){try{console.log("\ud83d\udd04 Syncing team for ".concat(e.name," to ClientTeamMembers list..."));const n=await this.getHeaders(),r="".concat(this.config.siteUrl,"/_api/web/lists/getbytitle('ClientTeamMembers')/items?")+"$filter=ClientID eq ".concat(e.id," and IsActive eq true&")+"$select=Id,StaffMember/Id&$expand=StaffMember",a=await this.makeRequest(r,{headers:n});let i=[];if(!a.ok)return console.warn("  ClientTeamMembers list may not exist - skipping sync"),!1;i=(await a.json()).d.results||[],console.log("  Found ".concat(i.length," existing team members in list"));const s=i.map(e=>{var t;return null===(t=e.StaffMember)||void 0===t?void 0:t.Id}).filter(Boolean),o=e.teamIds,l=o.filter(e=>!s.includes(e)),c=i.filter(e=>{var t;return!o.includes(null===(t=e.StaffMember)||void 0===t?void 0:t.Id)});console.log("  To add: ".concat(l.length,", To remove: ").concat(c.length));for(const e of c)await this.deleteClientTeamMember(e.Id);for(const t of l){const n=e.team.find(e=>e.id===t);if(n){const r=e.getStaffTrainingStatus(t);await this.saveClientTeamMember(e.id,e.name,n,r)}}for(const u of i){var t;if(o.includes(null===(t=u.StaffMember)||void 0===t?void 0:t.Id)){const t=e.getStaffTrainingStatus(u.StaffMember.Id);await this.saveClientTeamMember(e.id,e.name,{id:u.StaffMember.Id,name:u.StaffMember.Title},t,!0,u.Id)}}return console.log("\u2705 Team sync complete for ".concat(e.name)),!0}catch(n){return console.error("Error syncing student team to list:",n),!1}}async saveStudent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{const n=await this.getHeaders(!0);t&&(n["X-HTTP-Method"]="MERGE",n["If-Match"]="*");const r=t?"".concat(this.config.siteUrl,"/_api/web/lists/getbytitle('").concat(this.config.studentsListName,"')/items(").concat(e.id,")"):"".concat(this.config.siteUrl,"/_api/web/lists/getbytitle('").concat(this.config.studentsListName,"')/items"),a=e.team&&e.team.length>0?e.team.map(e=>e.id||e.userId).filter(e=>e):[],i={__metadata:{type:"SP.Data.ClientsListItem"},Title:e.name,Program:e.program,RatioAM:e.ratioAM,RatioPM:e.ratioPM,IsActive:e.isActive,TeamId:{results:a},AbsentAM:e.absentAM||!1,AbsentPM:e.absentPM||!1,AbsentFullDay:e.absentFullDay||!1,TeamTrainingStatus:e.teamTrainingStatus?JSON.stringify(e.teamTrainingStatus):"{}"},s=await this.makeRequest(r,{method:"POST",headers:n,body:JSON.stringify(i)});if(!s.ok)throw new Error("Failed to save student: ".concat(s.status));return t&&this.syncStudentTeamToList(e).catch(e=>{console.warn("\u26a0\ufe0f Failed to sync team to ClientTeamMembers list:",e.message),console.log("  \u2192 Falling back to legacy Team field storage")}),s}catch(n){throw console.error("Error saving student:",n),n}}async deleteStaff(e){try{console.log("\ud83d\uddd1\ufe0f Deleting staff member with ID: ".concat(e));const t=await this.getHeaders(!0);t["X-HTTP-Method"]="DELETE",t["If-Match"]="*";const n="".concat(this.config.siteUrl,"/_api/web/lists/getbytitle('").concat(this.config.staffListName,"')/items(").concat(e,")"),r=await this.makeRequest(n,{method:"POST",headers:t});if(!r.ok){const e=await r.text();throw console.error("Failed to delete staff: ".concat(r.status),e),new Error("Failed to delete staff: ".concat(r.status))}return console.log("\u2705 Staff member ".concat(e," deleted successfully")),!0}catch(t){throw console.error("Error deleting staff:",t),t}}async deleteStudent(e){try{console.log("\ud83d\uddd1\ufe0f Deleting student with ID: ".concat(e));const t=await this.getHeaders(!0);t["X-HTTP-Method"]="DELETE",t["If-Match"]="*";const n="".concat(this.config.siteUrl,"/_api/web/lists/getbytitle('").concat(this.config.studentsListName,"')/items(").concat(e,")"),r=await this.makeRequest(n,{method:"POST",headers:t});if(!r.ok){const e=await r.text();throw console.error("Failed to delete student: ".concat(r.status),e),new Error("Failed to delete student: ".concat(r.status))}return console.log("\u2705 Student ".concat(e," deleted successfully")),!0}catch(t){throw console.error("Error deleting student:",t),t}}async saveSchedule(e){try{var t,n;if(console.log("\ud83d\udd10 Checking authentication status..."),!this.isAuthenticated()){console.error("\u274c Cannot save schedule - not authenticated"),console.log("\ud83d\udd04 Attempting to re-authenticate...");if(!await this.checkAuthentication())throw console.error("\u274c Re-authentication failed"),new Error("Authentication required - please sign in again");console.log("\u2705 Re-authentication successful")}console.log("\ud83d\udcbe Saving schedule to SharePoint...",e.date),console.log("\ud83d\udd0d Debugging: Listing all available SharePoint lists..."),console.log("\ud83c\udf10 Site URL:",this.siteUrl),console.log("\ud83d\udd17 Full API URL:","".concat(this.siteUrl,"/_api/web/lists"));try{const e=await this.retryFetch("".concat(this.siteUrl,"/_api/web/lists"),{method:"GET",headers:{Authorization:"Bearer ".concat(this.accessToken),Accept:"application/json;odata=verbose"}});if(!e.ok)return console.error("\u274c Failed to retrieve lists:",e.status),!1;{const t=await e.json();console.log("\ud83d\udccb Available lists on site:"),t.d.results.forEach(e=>{console.log("  - ".concat(e.Title," (Internal: ").concat(e.EntityTypeName,")"))});const n=t.d.results.find(e=>"ScheduleHistory"===e.Title||"ScheduleHistory"===e.EntityTypeName),r=t.d.results.find(e=>"DailyAssignments"===e.Title||"DailyAssignments"===e.EntityTypeName);if(console.log("\ufffd ScheduleHistory found in list:",!!n),console.log("\ud83d\udd0d DailyAssignments found in list:",!!r),n&&console.log("\u2705 ScheduleHistory list details:",{Title:n.Title,EntityTypeName:n.EntityTypeName,Id:n.Id}),r&&console.log("\u2705 DailyAssignments list details:",{Title:r.Title,EntityTypeName:r.EntityTypeName,Id:r.Id}),!n||!r)return console.log("\u274c Required lists not found. Cannot save schedule history."),!1;console.log("\u2705 Both required lists found! Proceeding with schedule save...")}}catch(r){return console.error("\u274c Error retrieving lists:",r),!1}const a={__metadata:{type:"SP.Data.ABASchedulesListItem"},Title:"Schedule_".concat(e.date),ScheduleDate:e.date,IsFinalized:e.isFinalized||!1,TotalAssignments:e.assignments.length,CreatedDate:(new Date).toISOString(),CreatedBy:(null===(t=this.currentUser)||void 0===t?void 0:t.displayName)||"System",LastModified:(new Date).toISOString(),LastModifiedBy:(null===(n=this.currentUser)||void 0===n?void 0:n.displayName)||"System",AssignmentsSummary:this.generateAssignmentsSummary(e.assignments),TraineeAssignments:e.traineeAssignments?JSON.stringify(e.traineeAssignments):"[]"};console.log("\ud83d\udcbe Prepared schedule data for SharePoint:",a);const i=await fetch("".concat(this.siteUrl,"/_api/web/lists/getbytitle('ScheduleHistory')/items"),{method:"POST",headers:{Authorization:"Bearer ".concat(this.accessToken),Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":await this.getRequestDigest()},body:JSON.stringify(a)});if(!i.ok){const e=await i.text();return console.error("Failed to save schedule metadata:",e),!1}const s=(await i.json()).d.ID;console.log("\u2705 Schedule metadata saved with ID:",s);const o=e.assignments.map(e=>this.saveAssignmentToHistory(e,s)),l=await Promise.allSettled(o),c=l.filter(e=>"fulfilled"===e.status),u=l.filter(e=>"rejected"===e.status);return console.log("\u2705 Saved ".concat(c.length," assignments, ").concat(u.length," failed")),u.length>0&&console.warn("Some assignments failed to save:",u),!0}catch(r){return console.error("Error saving schedule:",r),!1}}generateAssignmentsSummary(e){const t={totalAssignments:e.length,byProgram:{},bySession:{},staffCount:new Set(e.map(e=>e.staffId)).size,studentCount:new Set(e.map(e=>e.studentId)).size};return e.forEach(e=>{t.byProgram[e.program]=(t.byProgram[e.program]||0)+1,t.bySession[e.session]=(t.bySession[e.session]||0)+1}),JSON.stringify(t)}async saveAssignmentToHistory(e,t){try{const n={__metadata:{type:"SP.Data.ABAAssignmentsListItem"},Title:"Assignment_".concat(e.staffId,"_").concat(e.studentId,"_").concat(e.session),ScheduleID:t,ScheduleDate:e.date||(new Date).toISOString().split("T")[0],StaffID:e.staffId,StaffName:e.staffName||"",StudentID:e.studentId,StudentName:e.studentName||"",Session:e.session,Program:e.program,AssignmentType:e.type||"Standard",CreatedDate:(new Date).toISOString(),IsLocked:e.isLocked||!1};console.log("\ud83d\udcbe Saving assignment to DailyAssignments list:",n);const r=await fetch("".concat(this.siteUrl,"/_api/web/lists/getbytitle('DailyAssignments')/items"),{method:"POST",headers:{Authorization:"Bearer ".concat(this.accessToken),Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":await this.getRequestDigest()},body:JSON.stringify(n)});if(!r.ok){const t=await r.text();return console.error("\u274c Failed to save assignment to ABAAssignments list:",r.status,t),{success:!1,assignment:e,error:t}}const a=await r.json();return console.log("\u2705 Assignment saved successfully, ID:",a.d.ID),{success:!0,id:a.d.ID,assignment:e}}catch(n){return console.error("\u274c Error saving assignment:",n),{success:!1,assignment:e,error:n.message}}}async getScheduleHistory(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:7;try{if(!this.isAuthenticated())return console.error("Cannot load schedule history - not authenticated"),[];const r=new Date,a=new Date(r);a.setDate(a.getDate()-n);const i="StaffID eq ".concat(e," and StudentID eq ").concat(t," and ScheduleDate ge '").concat(a.toISOString().split("T")[0],"' and ScheduleDate le '").concat(r.toISOString().split("T")[0],"'"),s=await fetch("".concat(this.siteUrl,"/_api/web/lists/getbytitle('ABAAssignments')/items?$filter=").concat(encodeURIComponent(i),"&$orderby=ScheduleDate desc"),{method:"GET",headers:{Authorization:"Bearer ".concat(this.accessToken),Accept:"application/json;odata=verbose"}});if(!s.ok)return console.error("Failed to load schedule history"),[];return(await s.json()).d.results.map(e=>({date:e.ScheduleDate,staffId:e.StaffID,studentId:e.StudentID,session:e.Session,program:e.Program}))}catch(r){return console.error("Error loading schedule history:",r),[]}}async checkConsecutiveDaysRule(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;try{const r=await this.getScheduleHistory(e,t,n+2);if(0===r.length)return{allowed:!0,consecutiveDays:0};const a=r.sort((e,t)=>new Date(e.date)-new Date(t.date));let i=0;(new Date).toISOString().split("T")[0];for(let e=a.length-1;e>=0;e--){const t=a[e].date,n=new Date;if(n.setDate(n.getDate()-(i+1)),t!==n.toISOString().split("T")[0])break;i++}return{allowed:i<n,consecutiveDays:i,message:i>=n?"".concat(e," has worked with ").concat(t," for ").concat(i," consecutive days. Consider assigning different staff."):null}}catch(r){return console.error("Error checking consecutive days rule:",r),{allowed:!0,consecutiveDays:0,error:r.message}}}async saveAttendanceHistory(e,t,n){try{if(!this.isAuthenticated())return console.error("Cannot save attendance history - not authenticated"),!1;const r="string"===typeof n?n:n.toISOString().split("T")[0];console.log("\ud83d\udcbe Saving attendance history for ".concat(r,"..."));const a=[];if(e.forEach(e=>{(e.absentAM||e.absentPM||e.absentFullDay)&&a.push({__metadata:{type:"SP.Data.DailyAttendanceListItem"},Title:"".concat(e.name,"_").concat(r),AttendanceDate:r,PersonType:"Staff",PersonID:e.id,PersonName:e.name,AbsentAM:e.absentAM||!1,AbsentPM:e.absentPM||!1,AbsentFullDay:e.absentFullDay||!1,CreatedDate:(new Date).toISOString()})}),t.forEach(e=>{(e.absentAM||e.absentPM||e.absentFullDay)&&a.push({__metadata:{type:"SP.Data.DailyAttendanceListItem"},Title:"".concat(e.name,"_").concat(r),AttendanceDate:r,PersonType:"Student",PersonID:e.id,PersonName:e.name,AbsentAM:e.absentAM||!1,AbsentPM:e.absentPM||!1,AbsentFullDay:e.absentFullDay||!1,CreatedDate:(new Date).toISOString()})}),0===a.length)return console.log("\u2705 No absences to save for this date"),!0;console.log("\ud83d\udcdd Saving ".concat(a.length," attendance records..."));const i=await this.getRequestDigest(),s=a.map(e=>fetch("".concat(this.siteUrl,"/_api/web/lists/getbytitle('DailyAttendance')/items"),{method:"POST",headers:{Authorization:"Bearer ".concat(this.accessToken),Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-RequestDigest":i},body:JSON.stringify(e)}).then(t=>t.ok?{success:!0}:(console.error("Failed to save attendance record for ".concat(e.PersonName)),{success:!1})).catch(t=>(console.error("Error saving attendance for ".concat(e.PersonName,":"),t),{success:!1}))),o=(await Promise.all(s)).filter(e=>e.success).length;return console.log("\u2705 Saved ".concat(o,"/").concat(a.length," attendance records")),o===a.length}catch(r){return console.error("Error saving attendance history:",r),!1}}async clearAllAttendanceInSharePoint(e,t){try{if(!this.isAuthenticated())return console.error("Cannot clear attendance - not authenticated"),!1;console.log("\ud83e\uddf9 Clearing attendance flags in SharePoint for ALL staff and students...");const n=[...e.map(async e=>{const t=new U(c(c({},e),{},{absentAM:!1,absentPM:!1,absentFullDay:!1}));return this.saveStaff(t,!0).catch(t=>(console.error("Failed to clear attendance for staff ".concat(e.name,":"),t),{success:!1}))}),...t.map(async e=>{const t=new V(c(c({},e),{},{absentAM:!1,absentPM:!1,absentFullDay:!1}));return this.saveStudent(t,!0).catch(t=>(console.error("Failed to clear attendance for student ".concat(e.name,":"),t),{success:!1}))})];return await Promise.all(n),console.log("\u2705 Attendance cleared in SharePoint for",e.length,"staff and",t.length,"students"),!0}catch(n){return console.error("Error clearing attendance in SharePoint:",n),!1}}}class oh{constructor(e){this.config=e,this.accessToken=null}setAccessToken(e){this.accessToken=e}getHeaders(){const e={Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"};return this.accessToken&&(e.Authorization="Bearer ".concat(this.accessToken)),e}async searchUsers(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{const n=await fetch("".concat(this.config.siteUrl,"/_api/web/siteusers?$filter=substringof('").concat(e,"',Title) or substringof('").concat(e,"',Email)&$top=").concat(t),{headers:this.getHeaders()});if(!n.ok)throw new Error("Failed to search users: ".concat(n.status));return(await n.json()).d.results.map(e=>({id:e.Id,title:e.Title,email:e.Email,loginName:e.LoginName,principalType:e.PrincipalType}))}catch(n){throw console.error("Error searching users:",n),n}}async getUserById(e){try{const t=await fetch("".concat(this.config.siteUrl,"/_api/web/siteusers/getbyid(").concat(e,")"),{headers:this.getHeaders()});if(!t.ok)throw new Error("Failed to get user: ".concat(t.status));const n=await t.json();return{id:n.d.Id,title:n.d.Title,email:n.d.Email,loginName:n.d.LoginName,principalType:n.d.PrincipalType}}catch(t){throw console.error("Error getting user by ID:",t),t}}async resolveUserByEmail(e){try{const t=await fetch("".concat(this.config.siteUrl,"/_api/web/ensureuser"),{method:"POST",headers:c(c({},this.getHeaders()),{},{"X-RequestDigest":await this.getRequestDigest()}),body:JSON.stringify({logonName:e})});if(!t.ok)throw new Error("Failed to resolve user: ".concat(t.status));const n=await t.json();return{id:n.d.Id,title:n.d.Title,email:n.d.Email,loginName:n.d.LoginName,principalType:n.d.PrincipalType}}catch(t){throw console.error("Error resolving user by email:",t),t}}async getRequestDigest(){try{const e=await fetch("".concat(this.config.siteUrl,"/_api/contextinfo"),{method:"POST",headers:this.getHeaders()});if(!e.ok)throw new Error("Failed to get request digest: ".concat(e.status));return(await e.json()).d.GetContextWebInformation.FormDigestValue}catch(e){throw console.error("Error getting request digest:",e),e}}formatForPeoplePicker(e){return e&&0!==e.length?{results:e}:null}extractUserIds(e){return e&&e.results?e.results.map(e=>e.Id||e.id):[]}async getAllSiteUsers(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];try{let t="".concat(this.config.siteUrl,"/_api/web/siteusers?$top=1000");e&&(t+="&$filter=PrincipalType eq 1");const n=await fetch(t,{headers:this.getHeaders()});if(!n.ok){if(401===n.status)return console.warn("User does not have permission to query all site users. Using limited fallback."),[];throw new Error("Failed to get site users: ".concat(n.status))}return(await n.json()).d.results.filter(e=>e.Title&&e.Email).map(e=>({id:e.Id,title:e.Title,email:e.Email,loginName:e.LoginName,principalType:e.PrincipalType})).sort((e,t)=>e.title.localeCompare(t.title))}catch(t){return console.error("Error getting all site users:",t),[]}}async validateUserIds(e){const t=[],n=[];for(const a of e)try{const e=await this.getUserById(a);t.push(e)}catch(r){n.push(a)}return{validUsers:t,invalidIds:n}}}class lh{constructor(){this.debugMode=!1,this.maxIterations=50,this.maxChainDepth=5}getStaffPriorityScore(e){return{RBT:1,BS:5,BCBA:10,EA:15,CC:20,MHA:21,Teacher:999,Director:999,TEACHER:999,DIRECTOR:999}[e.role]||50}canStaffDoDirectService(e){return!["Teacher","Director","TEACHER","DIRECTOR"].includes(e.role)&&e.canDoDirectSessions()}isStaffInTrainingForStudent(e,t){if(!t.getStaffTrainingStatus)return!1;const n=t.getStaffTrainingStatus(e.id),r=n===z||n===H;return r&&console.log("  \ud83c\udf93 ".concat(e.name," is in training for ").concat(t.name," (").concat(n,") - excluding from main assignment")),r}sortStaffForStudentStrict(e,t,n){return[...t].sort((t,r)=>{const a=e.teamIds.includes(t.id),i=e.teamIds.includes(r.id);if(a&&!i)return-1;if(!a&&i)return 1;const s=this.getStaffPriorityScore(t),o=this.getStaffPriorityScore(r);return s!==o?s-o:"PM"===n&&s===o?Math.random()-.5:t.name.localeCompare(r.name)})}countUnassignedStudents(e,t){let n=0;const r=["AM","PM"];return t.filter(e=>e.isActive).forEach(t=>{r.forEach(r=>{t.isAvailableForSession(r)&&(this.isStudentAssigned(t.id,r,t.program,e)||n++)})}),n}findReplacementStaff(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];const s=r.filter(r=>!!r.isActive&&(!!r.isAvailableForSession(t)&&(!!r.canWorkProgram(n)&&(!i.includes(r.id)&&(!!e.teamIds.includes(r.id)&&(!!this.canStaffDoDirectService(r)&&(!!a.isStaffAvailable(r.id,t,n)&&(!a.hasStaffWorkedWithStudentToday(r.id,e.id)&&!this.isStaffInTrainingForStudent(r,e)))))))));if(0===s.length)return null;return this.sortStaffForStudentStrict(e,s,t)[0]}async findSimpleSwapWithUnassignedStaff(e,t,n,r,a,i){console.log("    \ud83d\udca1 SMART STRATEGY: Looking for unassigned staff who can enable swaps...");const s=r.filter(r=>!!r.isActive&&(!!r.canWorkProgram(n)&&(!!this.canStaffDoDirectService(r)&&(!!["RBT","BS"].includes(r.role)&&(!e.teamIds.includes(r.id)&&i.isStaffAvailable(r.id,t,n))))));console.log("    \ud83d\udcca Found ".concat(s.length," unassigned RBT/BS not on ").concat(e.name,"'s team in ").concat(n," ").concat(t));const o=r.filter(t=>e.teamIds.includes(t.id)&&this.canStaffDoDirectService(t));for(const l of o){if(i.isStaffAvailable(l.id,t,n)){console.log("    \u23ed\ufe0f ".concat(l.name," is already available in ").concat(t," ").concat(n));continue}const o=i.assignments.filter(e=>e.staffId===l.id&&e.session===t&&e.program===n);if(0!==o.length)for(const c of o){const o=a.find(e=>e.id===c.studentId);if(!o){console.log("    \u26a0\ufe0f Could not find student with id ".concat(c.studentId));continue}console.log("    \ud83d\udd0d ".concat(l.name," is with ").concat(o.name));let u=!1;for(const a of s){if(!o.teamIds.includes(a.id)){console.log("      \u23ed\ufe0f ".concat(a.name," is NOT on ").concat(o.name,"'s team"));continue}u=!0,console.log("      \ud83d\udca1 ".concat(a.name," (unassigned, not on ").concat(e.name,"'s team) IS on ").concat(o.name,"'s team! Attempting swap..."));const s=[];s.push(c);const d=i.assignments.filter(e=>e.staffId===l.id&&e.session===t&&e.program===n&&e.id!==c.id);s.push(...d);const h=[...i.assignments];s.forEach(e=>{const t=i.assignments.findIndex(t=>t.id===e.id);t>-1&&i.assignments.splice(t,1)}),console.log("      \ud83d\udd27 Temporarily removed ".concat(s.length," conflicting assignment(s) for validation"));const f=new K({id:Q.generateAssignmentId(),staffId:a.id,staffName:a.name,studentId:o.id,studentName:o.name,session:t,program:n,date:i.date,isLocked:!1,assignedBy:"smart-swap"}),m=new K({id:Q.generateAssignmentId(),staffId:l.id,staffName:l.name,studentId:e.id,studentName:e.name,session:t,program:n,date:i.date,isLocked:!1,assignedBy:"smart-swap"});console.log("      \ud83d\udd0d Validating: ".concat(a.name," \u2192 ").concat(o.name));const g=Y.validateAssignment(f,i,r,[o]);console.log("      \ud83d\udd0d Validating: ".concat(l.name," \u2192 ").concat(e.name));const p=Y.validateAssignment(m,i,r,[e]);if(i.assignments=h,0===g.length&&0===p.length)return console.log("      \u2705 SMART SWAP SUCCESS! ".concat(a.name," \u2192 ").concat(o.name,", ").concat(l.name," \u2192 ").concat(e.name)),{success:!0,swaps:[{description:"Smart swap: ".concat(a.name," covers ").concat(o.name,", freeing ").concat(l.name," for ").concat(e.name)}],newAssignments:[f,m],changes:[...s.map(e=>({type:"remove",assignmentId:e.id})),{type:"add",assignment:f},{type:"add",assignment:m}],description:"".concat(a.name," \u2192 ").concat(o.name,", ").concat(l.name," \u2192 ").concat(e.name)};console.log("      \u274c Validation failed: ".concat([...g,...p].join(", ")))}u||console.log("      \u274c No eligible unassigned RBT/BS found for ".concat(o.name))}else console.log("    \u26a0\ufe0f No assignments found for ".concat(l.name," in ").concat(t," ").concat(n))}return console.log("    \u274c No simple swaps found with unassigned RBT/BS not on ".concat(e.name,"'s team")),{success:!1}}async findAndSwapUnderutilizedStaff(e,t,n,r,a,i){console.log("    \ud83d\udd0d ULTRA-AGGRESSIVE: Looking for swap chains for ".concat(e.name,"..."));this.getRequiredStaffCount(e,t);const s=r.filter(t=>e.teamIds.includes(t.id)&&this.canStaffDoDirectService(t));if(console.log("    \ud83d\udcca ".concat(e.name," has ").concat(s.length," team members total")),0===s.length)return console.log("    \u274c No team members at all - cannot proceed"),{success:!1};for(const o of s){if(console.log("\n    \ud83d\udd04 Trying to free up: ".concat(o.name," (").concat(o.role,")")),i.isStaffAvailable(o.id,t,n)){console.log("      \u2705 ".concat(o.name," is already available!"));const a=new K({id:Q.generateAssignmentId(),staffId:o.id,staffName:o.name,studentId:e.id,studentName:e.name,session:t,program:n,date:i.date,isLocked:!1,assignedBy:"reshuffle-direct"});if(0===Y.validateAssignment(a,i,r,[e]).length)return console.log("      \u2705 DIRECT ASSIGNMENT SUCCESS!"),{success:!0,swaps:[{description:"Direct assignment: ".concat(o.name," \u2192 ").concat(e.name)}],newAssignments:[a],changes:[{type:"add",assignment:a}],description:"".concat(o.name," directly assigned to ").concat(e.name)}}const s=await this.findSwapChain(o,e,t,n,r,a,i,3);if(s.success)return console.log("      \u2705 SWAP CHAIN SUCCESS! Chain length: ".concat(s.chain.length)),s}return console.log("    \u274c Could not free any of ".concat(s.length," team members")),{success:!1}}async findSwapChain(e,t,n,r,a,i,s,o){let l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:new Set;if(console.log("      \ud83d\udd17 Finding swap chain for ".concat(e.name," (depth ").concat(o,")")),l.has(e.id)||o<=0)return{success:!1};l.add(e.id);const c=s.assignments.filter(t=>t.staffId===e.id);if(0===c.length)return{success:!1};for(const u of c){const c=i.find(e=>e.id===u.studentId);if(!c)continue;if(u.session===n&&u.program===r){console.log("        \u23ed\ufe0f ".concat(e.name," already in ").concat(n," ").concat(r,", checking next..."));continue}console.log("        \ud83d\udccc ".concat(e.name," currently with ").concat(c.name," (").concat(u.program," ").concat(u.session,")"));const d=this.findPotentialReplacements(c,u.session,u.program,a,s,[e.id]);console.log("        \ud83d\udd0d Found ".concat(d.length," potential replacements for ").concat(c.name));for(const h of d)if(console.log("          \ud83d\udca1 Trying ".concat(h.name," (").concat(h.role,") as replacement")),s.isStaffAvailable(h.id,u.session,u.program)){console.log("          \u2705 Direct swap available!");const o=this.createSwapChain(e,t,n,r,c,u,h,s,a,i);if(o.success)return o}else{console.log("          \ud83d\udd04 ".concat(h.name," is busy, trying recursive chain..."));const d=await this.findSwapChain(h,c,u.session,u.program,a,i,s,o-1,new Set(l));if(d.success){console.log("          \u2705 Recursive chain found! Combining...");const o=this.createSwapChain(e,t,n,r,c,u,h,s,a,i);if(o.success)return{success:!0,chain:[...d.chain,...o.chain],swaps:[...d.swaps,...o.swaps],newAssignments:[...d.newAssignments,...o.newAssignments],changes:[...d.changes,...o.changes],description:"Multi-level chain: ".concat(d.description," \u2192 ").concat(o.description)}}}}return{success:!1}}findPotentialReplacements(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];const s=r.filter(t=>!!t.isActive&&(!!t.canWorkProgram(n)&&(!i.includes(t.id)&&(!!e.teamIds.includes(t.id)&&!!this.canStaffDoDirectService(t)))));return this.sortStaffForStudentStrict(e,s,t)}createSwapChain(e,t,n,r,a,i,s,o,l,c){console.log("          \ud83d\udd28 Creating swap chain:"),console.log("             1. ".concat(s.name," \u2192 ").concat(a.name," (").concat(i.program," ").concat(i.session,")")),console.log("             2. ".concat(e.name," \u2192 ").concat(t.name," (").concat(r," ").concat(n,")"));const u=new K({id:Q.generateAssignmentId(),staffId:s.id,staffName:s.name,studentId:a.id,studentName:a.name,session:i.session,program:i.program,date:o.date,isLocked:!1,assignedBy:"chain-swap"}),d=new K({id:Q.generateAssignmentId(),staffId:e.id,staffName:e.name,studentId:t.id,studentName:t.name,session:n,program:r,date:o.date,isLocked:!1,assignedBy:"chain-swap"}),h=Y.validateAssignment(u,o,l,[a]),f=Y.validateAssignment(d,o,l,[t]);return h.length>0?(console.log("          \u274c Replacement validation failed: ".concat(h.join(", "))),{success:!1}):f.length>0?(console.log("          \u274c Final validation failed: ".concat(f.join(", "))),{success:!1}):{success:!0,chain:[{from:s.name,to:a.name},{from:e.name,to:t.name}],swaps:[{description:"Chain: ".concat(s.name," \u2192 ").concat(a.name,", ").concat(e.name," \u2192 ").concat(t.name)}],newAssignments:[u,d],changes:[{type:"remove",assignmentId:i.id},{type:"add",assignment:u},{type:"add",assignment:d}],description:"".concat(s.name," covers ").concat(a.name,", freeing ").concat(e.name," for ").concat(t.name)}}async redistributeFromOverAssigned(e,t,n,r,a,i){return console.log("    \ud83d\udd0d Looking for over-assigned students..."),{success:!1}}async performFullScheduleReshuffle(e,t,n){console.log("\n\ud83d\udd04 ========== FULL SCHEDULE RESHUFFLE =========="),console.log("\ud83d\udcca Starting comprehensive reassignment to eliminate all gaps...");const r=["AM","PM"],a=[L.PRIMARY,L.SECONDARY],i=[];for(const c of a)for(const t of r)n.filter(e=>e.isActive&&e.program===c).forEach(n=>{n.isAvailableForSession(t)&&(this.isStudentAssigned(n.id,t,c,e)||i.push({student:n,session:t,program:c}))});if(0===i.length)return console.log("\u2705 No unassigned students - schedule is complete!"),{success:!0,swaps:[]};console.log("\ud83d\udccb Found ".concat(i.length," unassigned student-sessions")),i.forEach(e=>{console.log("  - ".concat(e.student.name," (").concat(e.program," ").concat(e.session,")"))});const s=[],o=[];let l=0;for(;i.length>0&&l<20;){l++,console.log("\n\ud83d\udd04 Reshuffle Iteration ".concat(l,"/").concat(20));const r=c({},i[0]),{student:a,session:u,program:d}=r;console.log("\n\ud83c\udfaf Attempting to assign: ".concat(a.name," (").concat(d," ").concat(u,")"));const h=await this.findSimpleSwapWithUnassignedStaff(a,u,d,t,n,e);if(h.success){console.log("  \u2705 SUCCESS via smart swap: ".concat(h.description)),s.push(...h.swaps),o.push(...h.newAssignments),h.changes.forEach(t=>{"add"===t.type?e.addAssignment(t.assignment):"remove"===t.type&&e.removeAssignment(t.assignmentId)}),i.shift();continue}const f=await this.findAndSwapUnderutilizedStaff(a,u,d,t,n,e);if(f.success){console.log("  \u2705 SUCCESS via swap: ".concat(f.description)),s.push(...f.swaps),o.push(...f.newAssignments),f.changes.forEach(t=>{"add"===t.type?e.addAssignment(t.assignment):"remove"===t.type&&e.removeAssignment(t.assignmentId)}),i.shift();continue}const m=await this.redistributeFromOverAssigned(a,u,d,t,n,e);if(m.success)console.log("  \u2705 SUCCESS via redistribution: ".concat(m.description)),s.push(...m.swaps),o.push(...m.newAssignments),m.changes.forEach(t=>{"add"===t.type?e.addAssignment(t.assignment):"remove"===t.type&&e.removeAssignment(t.assignmentId)}),i.shift();else if(console.log("  \u274c Cannot assign ".concat(a.name," - moving to end of queue")),i.push(i.shift()),l%i.length===0){console.log("  \ud83d\uded1 No progress after full cycle - stopping reshuffle");break}}return console.log("\n\ud83c\udfaf RESHUFFLE COMPLETE:"),console.log("  Iterations: ".concat(l)),console.log("  Swaps made: ".concat(s.length)),console.log("  New assignments: ".concat(o.length)),console.log("  Remaining unassigned: ".concat(i.length)),{success:0===i.length,swaps:s,newAssignments:o,remainingUnassigned:i}}async autoAssignSchedule(e,t,n){const r=[],a=[];console.log("\n\ud83d\ude80 ========== STARTING AUTO-ASSIGNMENT ==========");const i=t.filter(e=>e.isActive),s=n.filter(e=>e.isActive);console.log("\ud83d\udcca Active: ".concat(i.length," staff, ").concat(s.length," students")),console.log("\ud83d\udcca Attendance - Staff absent AM: ".concat(i.filter(e=>e.absentAM||e.absentFullDay).length,", PM: ").concat(i.filter(e=>e.absentPM||e.absentFullDay).length)),console.log("\ud83d\udcca Attendance - Students absent AM: ".concat(s.filter(e=>e.absentAM||e.absentFullDay).length,", PM: ").concat(s.filter(e=>e.absentPM||e.absentFullDay).length));const o=["AM","PM"],l=[L.PRIMARY,L.SECONDARY];for(const h of l)for(const t of o){console.log("\n\ud83d\udccb ===== ".concat(h," ").concat(t," ====="));const n=s.filter(n=>n.program===h&&n.isAvailableForSession(t)&&!this.isStudentAssigned(n.id,t,h,e)),o=this.prioritizeStudents(n,t);for(const l of o)try{if(l.isPaired()){const c=l.getPairedStudent(s);if(c&&n.includes(c)){const n=await this.assignPairedStudents(l,c,t,h,i,e);if(n.length>0){r.push(...n),n.forEach(t=>e.addAssignment(t));const t=o.indexOf(c);t>-1&&o.splice(t,1)}else a.push("Could not assign paired: ".concat(l.name," & ").concat(c.name));continue}}const c=await this.assignStudent(l,t,h,i,e);c.length>0?(r.push(...c),c.forEach(t=>e.addAssignment(t))):a.push("Could not assign: ".concat(l.name," in ").concat(h," ").concat(t))}catch(d){a.push("Error: ".concat(l.name," - ").concat(d.message))}}console.log("\n\u2705 PHASE 1 COMPLETE: ".concat(r.length," assignments created"));const c=this.countUnassignedStudents(e,n);if(c>0){console.log("\n\ud83d\udd04 PHASE 2: ".concat(c," gaps found - initiating FULL RESHUFFLE"));const i=await this.performFullScheduleReshuffle(e,t,n);i.success?(console.log("\n\ud83c\udf89 RESHUFFLE SUCCESS: All students assigned!"),r.push(...i.newAssignments)):(console.log("\n\u26a0\ufe0f RESHUFFLE INCOMPLETE: ".concat(i.remainingUnassigned.length," still unassigned")),i.remainingUnassigned.forEach(e=>{a.push("Final gap: ".concat(e.student.name," in ").concat(e.program," ").concat(e.session))}))}else console.log("\n\u2705 PHASE 2: No gaps found - schedule is perfect!");const u=this.countUnassignedStudents(e,n);if(u>0){console.log("\n\ud83d\udd00 PHASE 3: ".concat(u," gaps remain - attempting SWAP OPTIMIZATION"));const a=await this.performSwapOptimization(e,t,n);a.swapsMade>0?(console.log("\n\u2705 SWAP OPTIMIZATION: Made ".concat(a.swapsMade," swaps, filled ").concat(a.gapsFilled," gaps")),r.push(...a.newAssignments),a.swaps.forEach(e=>{console.log("  \u2713 ".concat(e.description))})):console.log("\n\u26a0\ufe0f SWAP OPTIMIZATION: No beneficial swaps found")}return console.log("\n\ud83c\udfaf ========== AUTO-ASSIGNMENT COMPLETE =========="),console.log("\ud83d\udcca Total assignments: ".concat(r.length)),console.log("\u274c Errors: ".concat(a.length)),{assignments:r,errors:a}}async assignStudent(e,t,n,r,a){const i=[],s=this.getRequiredStaffCount(e,t);if(console.log("\n\ud83c\udfaf Assigning ".concat(e.name," for ").concat(n," ").concat(t," (needs ").concat(s," staff)")),e.isSmallGroup(t))return this.assignSmallGroupStudent(e,t,n,r,a);const o=Q.getAvailableStaffForStudent(e,t,n,r,a);let l=o.filter(t=>{var n,r;if(!(e.teamIds.includes(t.id)||t.email&&(null===(n=e.team)||void 0===n?void 0:n.some(e=>{var n,r;return(null===(n=e.email)||void 0===n?void 0:n.toLowerCase())===(null===(r=t.email)||void 0===r?void 0:r.toLowerCase())}))||(null===(r=e.team)||void 0===r?void 0:r.some(e=>{var n,r;return(null===(n=e.title||e.name)||void 0===n?void 0:n.toLowerCase())===(null===(r=t.name)||void 0===r?void 0:r.toLowerCase())}))))return!1;return["Teacher","Director","TEACHER","DIRECTOR"].includes(t.role)?(console.log("  \ud83d\udeab BLOCKING ".concat(t.name,": ").concat(t.role," cannot do direct service")),!1):t.canDoDirectSessions()?!this.isStaffInTrainingForStudent(t,e)||(console.log("  \ud83d\udeab EXCLUDING ".concat(t.name,": In training for ").concat(e.name," (trainee only)")),!1):(console.log("  \ud83d\udeab BLOCKING ".concat(t.name,": Cannot do direct sessions")),!1)});console.log("  \ud83d\udcca Team staff breakdown:"),console.log("    Total available: ".concat(o.length)),console.log("    Team members: ".concat(l.length));const c=l.filter(e=>"RBT"===e.role||"BS"===e.role),u=l.filter(e=>"EA"===e.role),d=l.filter(e=>"RBT"!==e.role&&"BS"!==e.role&&"EA"!==e.role);let h;if(console.log("    RBT/BS: ".concat(c.length)),console.log("    EA: ".concat(u.length)),console.log("    Other: ".concat(d.length)),c.length>=s?(h=c,console.log("  \u2705 Using ONLY RBT/BS staff")):c.length+u.length>=s?(h=[...c,...u],console.log("  \u26a0\ufe0f Using RBT/BS + EA staff (".concat(c.length," RBT/BS + ").concat(Math.min(u.length,s-c.length)," EA)"))):(h=l,console.log("  \ud83d\udea8 Using all available team staff (still short)")),h.length<s)return console.log("  \u274c INSUFFICIENT: Need ".concat(s,", have ").concat(h.length," team members")),[];const f=this.sortStaffForStudentWithShuffling(e,h,t);console.log("  \ud83d\udccb Assignment order:"),f.slice(0,s).forEach((e,t)=>{console.log("    ".concat(t+1,". ").concat(e.name," (").concat(e.role,")"))});for(let m=0;m<s&&m<f.length;m++){const s=new K({id:Q.generateAssignmentId(),staffId:f[m].id,staffName:f[m].name,studentId:e.id,studentName:e.name,session:t,program:n,date:a.date,isLocked:!1,assignedBy:"auto"}),o=Y.validateAssignment(s,a,r,[e]);0===o.length?(i.push(s),console.log("  \u2705 Assigned ".concat(f[m].name," (").concat(f[m].role,")"))):console.log("  \u274c Cannot assign ".concat(f[m].name,": ").concat(o.join(", ")))}return i}assignSmallGroupStudent(e,t,n,r,a){if("function"!==typeof a.getAssignmentsForSession)return console.error("Schedule object missing getAssignmentsForSession method",a),[];const i=a.getAssignmentsForSession(t,n);for(const l of i){const s=this.findStudentById(l.studentId);if(s&&s.isSmallGroup(t)){if(1===i.filter(e=>e.staffId===l.staffId).length){const i=r.find(e=>e.id===l.staffId);if(i&&this.canStaffWorkWithStudent(i,e,a)){const r=new K({id:Q.generateAssignmentId(),staffId:l.staffId,staffName:i.name,studentId:e.id,studentName:e.name,session:t,program:n,date:a.date,isLocked:!1,assignedBy:"auto"});return this.log("  Added ".concat(e.name," to existing small group with ").concat(i.name)),[r]}}}}let s=Q.getAvailableStaffForStudent(e,t,n,r,a).filter(t=>!!e.teamIds.includes(t.id)&&!this.isStaffInTrainingForStudent(t,e));const o=s.filter(e=>e.isPreferredDirectService());if(s=o.length>0?o:s.filter(e=>e.canDoDirectSessions()),s.length>0){const r=this.sortStaffForStudentWithShuffling(e,s,t),i=new K({id:Q.generateAssignmentId(),staffId:r[0].id,staffName:r[0].name,studentId:e.id,studentName:e.name,session:t,program:n,date:a.date,isLocked:!1,assignedBy:"auto"});return this.log("  Started new small group with ".concat(r[0].name," for ").concat(e.name)),[i]}return[]}sortStaffForStudent(e,t){return[...t].sort((t,n)=>{const r=e.teamIds.includes(t.id),a=e.teamIds.includes(n.id);if(r&&!a)return-1;if(!r&&a)return 1;const i=t.isPreferredDirectService(),s=n.isPreferredDirectService();if(i&&!s)return-1;if(!i&&s)return 1;const o=t.getRoleLevel(),l=n.getRoleLevel();return o!==l?o-l:t.name.localeCompare(n.name)})}sortStaffForStudentWithShuffling(e,t,n){const r=t.filter(e=>e.isPreferredDirectService()),a=r.length>0?r:t,i="PM"===n?3.5:2.5;return[...a].map(t=>({staff:t,isTeamMember:e.teamIds.includes(t.id),roleLevel:t.getRoleLevel(),isPreferred:t.isPreferredDirectService(),randomFactor:Math.random()*i})).sort((e,t)=>{if(e.isTeamMember&&!t.isTeamMember)return-1;if(!e.isTeamMember&&t.isTeamMember)return 1;if(e.isPreferred&&!t.isPreferred)return-1;if(!e.isPreferred&&t.isPreferred)return 1;return e.roleLevel+e.randomFactor-(t.roleLevel+t.randomFactor)}).map(e=>e.staff)}prioritizeStudents(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"AM";return[...e].sort((e,n)=>{if(e.requiresMultipleStaff(t)&&!n.requiresMultipleStaff(t))return-1;if(!e.requiresMultipleStaff(t)&&n.requiresMultipleStaff(t))return 1;const r=e.teamIds.length,a=n.teamIds.length;return r!==a?r-a:e.name.localeCompare(n.name)})}getRequiredStaffCount(e){switch("AM"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"AM")?e.ratioAM:e.ratioPM){case j.TWO_TO_ONE:return 2;case j.ONE_TO_ONE:case j.ONE_TO_TWO:default:return 1}}isStudentAssigned(e,t,n,r){if("function"!==typeof r.getAssignmentsForSession)return console.error("Schedule object missing getAssignmentsForSession method",r),!1;return r.getAssignmentsForSession(t,n).some(t=>t.studentId===e)}canStaffWorkWithStudent(e,t,n){return!n.hasStaffWorkedWithStudentToday(e.id,t.id)}findStudentById(e){return null}optimizeAssignments(e,t,n){return this.log("Assignment optimization not yet implemented"),e.assignments}setDebugMode(e){this.debugMode=e}log(e){this.debugMode&&console.log("[AutoAssignment] ".concat(e))}generateStats(e,t,n){const r={totalAssignments:e.assignments.length,staffUtilization:{},unassignedStudents:[],assignmentsBySession:{},ratioDistribution:{}};t.filter(e=>e.isActive).forEach(t=>{const n=e.getStaffAssignments(t.id);r.staffUtilization[t.name]={assignmentCount:n.length,utilizationRate:n.length/2}});const a=n.filter(e=>e.isActive);return a.forEach(t=>{const n=e.getStudentAssignments(t.id);n.length<2&&r.unassignedStudents.push({name:t.name,assignmentCount:n.length,requiredCount:2})}),["AM","PM"].forEach(t=>{[L.PRIMARY,L.SECONDARY].forEach(n=>{const a="".concat(n,"_").concat(t);"function"===typeof e.getAssignmentsForSession?r.assignmentsBySession[a]=e.getAssignmentsForSession(t,n).length:(r.assignmentsBySession[a]=0,console.error("Schedule object missing getAssignmentsForSession method in stats collection"))})}),Object.values(j).forEach(e=>{const t=a.filter(t=>t.ratio===e).length;r.ratioDistribution[e]=t}),r}async assignPairedStudents(e,t,n,r,a,i){const s=[];if(this.log("\n\ud83d\udd17 Assigning paired students: ".concat(e.name," and ").concat(t.name," (").concat(r," ").concat(n,")")),this.isStudentAssigned(e.id,n,r,i)||this.isStudentAssigned(t.id,n,r,i))return this.log("  \u26a0\ufe0f One of the paired students is already assigned"),[];const o=this.getRequiredStaffCount(e,n),l=this.getRequiredStaffCount(t,n),c=e.isSmallGroup(n)&&t.isSmallGroup(n),u=c?1:o+l;this.log("  Need: ".concat(e.name,"=").concat(o," staff, ").concat(t.name,"=").concat(l," staff, total=").concat(u).concat(c?" (shared for 1:2 pair)":"")),this.log("  ".concat(e.name," team (").concat(e.teamIds.length,"): ").concat(a.filter(t=>e.teamIds.includes(t.id)).map(e=>e.name).join(", "))),this.log("  ".concat(t.name," team (").concat(t.teamIds.length,"): ").concat(a.filter(e=>t.teamIds.includes(e.id)).map(e=>e.name).join(", ")));const d=Q.getAvailableStaffForStudent(e,n,r,a,i).filter(n=>this.canStaffWorkWithStudent(n,t,i)?!!t.teamIds.includes(n.id)||(this.log("  \u274c ".concat(n.name," is on ").concat(e.name,"'s team but NOT on ").concat(t.name,"'s team")),!1):(this.log("  \u274c ".concat(n.name," already worked with ").concat(t.name," today")),!1));if(this.log("  \u2705 Shared team members available (".concat(d.length,"): ").concat(d.map(e=>e.name).join(", "))),d.length<u)return this.log("  \u274c INSUFFICIENT STAFF: Need ".concat(u,", have ").concat(d.length)),[];const h=this.sortStaffForStudent(e,d);if(e.isSmallGroup(n)&&t.isSmallGroup(n)){if(this.log("Both students are 1:2 ratio - assigning same staff to both"),0===h.length)return this.log("No available staff for paired 1:2 students"),[];const o=h[0],l=new K({id:Q.generateAssignmentId(),staffId:o.id,staffName:o.name,studentId:e.id,studentName:e.name,session:n,program:r,date:i.date,isLocked:!1,assignedBy:"auto-paired"}),c=new K({id:Q.generateAssignmentId(),staffId:o.id,staffName:o.name,studentId:t.id,studentName:t.name,session:n,program:r,date:i.date,isLocked:!1,assignedBy:"auto-paired"}),u=Y.validateAssignment(l,i,a,[e,t]),d=Y.validateAssignment(c,i,a,[e,t]);if(0!==u.length||0!==d.length)return this.log("  Cannot assign ".concat(o.name," to paired students: ").concat([...u,...d].join(", "))),[];s.push(l,c),this.log("  Assigned ".concat(o.name," to both ").concat(e.name," and ").concat(t.name," (shared 1:2)"))}else{this.log("Assigning staff for ratios: ".concat(e.getSessionRatio(n)," and ").concat(t.getSessionRatio(n)));const c=Math.max(o,l);for(let u=0;u<c&&u<h.length;u++){const c=h[u];if(u<o){const o=new K({id:Q.generateAssignmentId(),staffId:c.id,staffName:c.name,studentId:e.id,studentName:e.name,session:n,program:r,date:i.date,isLocked:!1,assignedBy:"auto-paired"}),l=Y.validateAssignment(o,i,a,[e,t]);if(0!==l.length)return this.log("  Cannot assign ".concat(c.name," to ").concat(e.name,": ").concat(l.join(", "))),[];s.push(o),this.log("  Assigned ".concat(c.name," to ").concat(e.name," (paired)"))}if(u<l){const o=new K({id:Q.generateAssignmentId(),staffId:c.id,staffName:c.name,studentId:t.id,studentName:t.name,session:n,program:r,date:i.date,isLocked:!1,assignedBy:"auto-paired"}),l=Y.validateAssignment(o,i,a,[e,t]);if(0!==l.length)return this.log("  Cannot assign ".concat(c.name," to ").concat(t.name,": ").concat(l.join(", "))),[];s.push(o),this.log("  Assigned ".concat(c.name," to ").concat(t.name," (paired)"))}}}const f=s.filter(t=>t.studentId===e.id),m=s.filter(e=>e.studentId===t.id);return f.length===o&&m.length===l?(this.log("Successfully assigned ".concat(s.length," staff to paired students")),s):(this.log("Failed to assign sufficient staff to paired students"),[])}async validateStaffSwap(e,t,n,r,a,i,s){const o=s.find(t=>t.id===e.studentId);if(!o)return!1;const l=new K({id:Q.generateAssignmentId(),staffId:n.id,staffName:n.name,studentId:o.id,studentName:o.name,session:e.session,program:e.program,date:a.date,isLocked:!1,assignedBy:"auto-swap"}),c=Y.validateAssignment(l,a,i,[o]);if(c.length>0)return console.log("      \u274c Replacement validation failed: ".concat(c.join(", "))),!1;const u=new K({id:Q.generateAssignmentId(),staffId:t.id,staffName:t.name,studentId:r.id,studentName:r.name,session:e.session,program:e.program,date:a.date,isLocked:!1,assignedBy:"auto-swap"}),d=Y.validateAssignment(u,a,i,[r]);return!(d.length>0)||(console.log("      \u274c New assignment validation failed: ".concat(d.join(", "))),!1)}async executeStaffSwap(e,t,n,r,a,i,s){try{const o=e.studentId,l=e.studentName||"",c=new K({id:Q.generateAssignmentId(),staffId:n.id,staffName:n.name,studentId:o,studentName:l,session:a,program:i,date:s.date,isLocked:!1,assignedBy:"auto-swap"}),u=new K({id:Q.generateAssignmentId(),staffId:t.id,staffName:t.name,studentId:r.id,studentName:r.name,session:a,program:i,date:s.date,isLocked:!1,assignedBy:"auto-swap"});return{success:!0,swap:{originalAssignment:e,replacementAssignment:c,newAssignment:u,unassignedStudent:r.name,description:"".concat(n.name,"(").concat(n.role,") \u2192 Student").concat(o,", ").concat(t.name,"(").concat(t.role,") \u2192 ").concat(r.name)},newAssignments:[c,u]}}catch(o){return console.log("      \u274c Swap execution failed: ".concat(o.message)),{success:!1}}}generateUltimateFinalReport(e,t,n){const r=["AM","PM"],a=(L.PRIMARY,L.SECONDARY,[]);let i=0;return n.forEach(t=>{const n=[];r.forEach(r=>{if(t.program){this.isStudentAssigned(t.id,r,t.program,e)?i++:n.push("".concat(t.program," ").concat(r))}}),n.length>0&&a.push({name:t.name,missingSessions:n})}),{totalStudents:n.length,assignedStudents:n.length-a.length,unassignedStudents:a,totalAssignments:i}}async validateChainReassignment(e,t,n,r,a,i,s){const o=s.find(t=>t.id===e.studentId);if(!o)return!1;const l=new K({id:Q.generateAssignmentId(),staffId:n.id,studentId:o.id,session:e.session,program:e.program,date:a.date,isLocked:!1,assignedBy:"auto-chain"});if(Y.validateAssignment(l,a,i,[o]).length>0)return!1;const c=new K({id:Q.generateAssignmentId(),staffId:t.id,studentId:r.id,session:e.session,program:e.program,date:a.date,isLocked:!1,assignedBy:"auto-chain"});return 0===Y.validateAssignment(c,a,i,[r]).length}async executeChainReassignment(e,t,n,r,a,i,s){try{const o=e.studentId,l=new K({id:Q.generateAssignmentId(),staffId:n.id,studentId:o,session:a,program:i,date:s.date,isLocked:!1,assignedBy:"auto-chain"}),c=new K({id:Q.generateAssignmentId(),staffId:t.id,studentId:r.id,session:a,program:i,date:s.date,isLocked:!1,assignedBy:"auto-chain"});return{success:!0,swaps:[{type:"chain",description:"Chain: ".concat(n.name,"(").concat(n.role,") \u2192 Student").concat(o,", ").concat(t.name,"(").concat(t.role,") \u2192 ").concat(r.name)}],newAssignments:[l,c],changes:[{type:"remove",assignmentId:e.id},{type:"add",assignment:l},{type:"add",assignment:c}],description:"".concat(n.name," \u2192 Student").concat(o,", ").concat(t.name," \u2192 ").concat(r.name)}}catch(o){return{success:!1}}}async executeCrossSessionReallocation(e,t,n,r,a,i,s,o){try{const l=e.studentId,c=new K({id:Q.generateAssignmentId(),staffId:n.id,studentId:l,session:i,program:s,date:o.date,isLocked:!1,assignedBy:"auto-cross"}),u=new K({id:Q.generateAssignmentId(),staffId:t.id,studentId:r.id,session:a,program:s,date:o.date,isLocked:!1,assignedBy:"auto-cross"});return{success:!0,swaps:[{type:"cross-session",description:"Cross-session: ".concat(n.name," \u2192 ").concat(i,", ").concat(t.name," \u2192 ").concat(a," with ").concat(r.name)}],newAssignments:[c,u],changes:[{type:"remove",assignmentId:e.id},{type:"add",assignment:c},{type:"add",assignment:u}],description:"".concat(t.name," moved from ").concat(i," to ").concat(a," for ").concat(r.name)}}catch(l){return{success:!1}}}async performSwapOptimization(e,t,n){const r=[],a=[];let i=0,s=0;const o=t.filter(e=>e.isActive),l=n.filter(e=>e.isActive),c=["AM","PM"],u=[L.PRIMARY,L.SECONDARY];for(const d of u)for(const t of c){console.log("\n\ud83d\udd0d SMART SWAP: Checking ".concat(d," ").concat(t," for swap opportunities..."));const n=l.filter(e=>e.program===d&&e.isAvailableForSession(t));for(const l of n){if(this.isStudentAssigned(l.id,t,d,e))continue;if(console.log("\n\ud83d\udd00 GAP DETECTED: ".concat(l.name," (").concat(d," ").concat(t,")")),console.log("   Team: ".concat(l.teamIds.length," members")),l.isPaired&&l.isPaired()){console.log("   \u26a0\ufe0f Skipping ".concat(l.name," - paired student (must be assigned with partner)"));continue}const c=o.filter(n=>{if(!n.isAvailableForSession(t))return!1;if(!n.canWorkProgram(d))return!1;if(!this.canStaffDoDirectService(n))return!1;return!e.assignments.some(e=>e.staffId===n.id&&e.session===t)});if(0===c.length){console.log("   \u274c No unassigned staff available this session");continue}console.log("   \u2713 Found ".concat(c.length," unassigned staff:"),c.map(e=>e.name).join(", "));let u=!1;for(const h of c){console.log("\n   \ud83d\udd0d Checking if ".concat(h.name," can enable a swap..."));for(const c of n){if(c.id===l.id)continue;const n=e.assignments.find(e=>e.studentId===c.id&&e.session===t&&e.program===d&&!e.isLocked&&"manual"!==e.assignedBy);if(!n)continue;const f=o.find(e=>e.id===n.staffId);if(!f)continue;const m=l.teamIds.includes(f.id),g=c.teamIds.includes(h.id);if(c.isPaired&&c.isPaired()){console.log("      \u26a0\ufe0f Skipping ".concat(c.name," - paired student (1:2 ratio), can't swap"));continue}if(e.hasStaffWorkedWithStudentToday(h.id,c.id)){console.log("      \u26a0\ufe0f Skipping - ".concat(h.name," already worked with ").concat(c.name," today"));continue}if(e.hasStaffWorkedWithStudentToday(f.id,l.id))console.log("      \u26a0\ufe0f Skipping - ".concat(f.name," already worked with ").concat(l.name," today"));else if(m&&g){console.log("\n   \u2705 SWAP OPPORTUNITY:"),console.log("      \u2022 ".concat(h.name," can work with ").concat(c.name)),console.log("      \u2022 ".concat(f.name," (currently with ").concat(c.name,") can work with ").concat(l.name)),console.log("      SWAP: ".concat(h.name," \u2192 ").concat(c.name,", ").concat(f.name," \u2192 ").concat(l.name)),e.removeAssignment(n.id);const o=new K({id:Q.generateAssignmentId(),staffId:h.id,staffName:h.name,studentId:c.id,studentName:c.name,session:t,program:d,date:e.date,isLocked:!1,assignedBy:"auto-swap"}),m=new K({id:Q.generateAssignmentId(),staffId:f.id,staffName:f.name,studentId:l.id,studentName:l.name,session:t,program:d,date:e.date,isLocked:!1,assignedBy:"auto-swap"});e.addAssignment(o),e.addAssignment(m),a.push(o,m),r.push({oldAssignment:n,description:"".concat(h.name," \u2192 ").concat(c.name,", ").concat(f.name," \u2192 ").concat(l.name)}),i++,s++,u=!0;break}}if(u)break}u||console.log("   \u274c No swap found to fill ".concat(l.name,"'s gap"))}}return console.log("\n\u2705 SMART SWAP COMPLETE: ".concat(i," swaps, ").concat(s," gaps filled")),{swapsMade:i,gapsFilled:s,swaps:r,newAssignments:a}}}var ch={version:"0.18.5"},uh=1200,dh=1252,hh=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],fh={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},mh=function(e){-1!=hh.indexOf(e)&&(dh=fh[0]=e)};var gh=function(e){uh=e,mh(e)};function ph(){gh(1200),mh(1252)}function vh(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}var yh,bh=function(e){return String.fromCharCode(e)},wh=function(e){return String.fromCharCode(e)};var Sh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Th(e){for(var t="",n=0,r=0,a=0,i=0,s=0,o=0,l=0,c=0;c<e.length;)i=(n=e.charCodeAt(c++))>>2,s=(3&n)<<4|(r=e.charCodeAt(c++))>>4,o=(15&r)<<2|(a=e.charCodeAt(c++))>>6,l=63&a,isNaN(r)?o=l=64:isNaN(a)&&(l=64),t+=Sh.charAt(i)+Sh.charAt(s)+Sh.charAt(o)+Sh.charAt(l);return t}function Ah(e){var t="",n=0,r=0,a=0,i=0,s=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)n=Sh.indexOf(e.charAt(l++))<<2|(i=Sh.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(n),r=(15&i)<<4|(s=Sh.indexOf(e.charAt(l++)))>>2,64!==s&&(t+=String.fromCharCode(r)),a=(3&s)<<6|(o=Sh.indexOf(e.charAt(l++))),64!==o&&(t+=String.fromCharCode(a));return t}var xh=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),kh=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Ch(e){return xh?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function Eh(e){return xh?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var Ih=function(e){return xh?kh(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function Nh(e){if("undefined"===typeof ArrayBuffer)return Ih(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}function Ph(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}var _h=xh?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:kh(e)}))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),a=0;for(t=0,n=0;t<e.length;n+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if("string"==typeof e[t])throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}))};var Oh=/\u0000/g,Rh=/[\u0001-\u0006]/g;function Mh(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function Dh(e,t){var n=""+e;return n.length>=t?n:Yf("0",t-n.length)+n}function Lh(e,t){var n=""+e;return n.length>=t?n:Yf(" ",t-n.length)+n}function Fh(e,t){var n=""+e;return n.length>=t?n:n+Yf(" ",t-n.length)}var jh=Math.pow(2,32);function Uh(e,t){return e>jh||e<-jh?function(e,t){var n=""+Math.round(e);return n.length>=t?n:Yf("0",t-n.length)+n}(e,t):function(e,t){var n=""+e;return n.length>=t?n:Yf("0",t-n.length)+n}(Math.round(e),t)}function Bh(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var Hh=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],zh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var qh={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},Wh={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Vh={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Kh(e,t,n){for(var r=e<0?-1:1,a=e*r,i=0,s=1,o=0,l=1,c=0,u=0,d=Math.floor(a);c<t&&(o=(d=Math.floor(a))*s+i,u=d*c+l,!(a-d<5e-8));)a=1/(a-d),i=s,s=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=i):(u=c,o=s)),!n)return[0,r*o,u];var h=Math.floor(r*o/u);return[h,r*o-h*u,u]}function Gh(e,t,n){if(e>2958465||e<0)return null;var r=0|e,a=Math.floor(86400*(e-r)),i=0,s=[],o={D:r,T:a,u:86400*(e-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(r+=1462),o.u>.9999&&(o.u=0,86400==++a&&(o.T=a=0,++r,++o.D)),60===r)s=n?[1317,10,29]:[1900,2,29],i=3;else if(0===r)s=n?[1317,8,29]:[1900,1,0],i=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),r<60&&(i=(i+6)%7),n&&(i=function(e,t){t[0]-=581;var n=e.getDay();e<60&&(n=(n+6)%7);return n}(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var Yh=new Date(1899,11,31,0,0,0),$h=Yh.getTime(),Qh=new Date(1900,2,1,0,0,0);function Jh(e,t){var n=e.getTime();return t?n-=1262304e5:e>=Qh&&(n+=864e5),(n-($h+6e4*(e.getTimezoneOffset()-Yh.getTimezoneOffset())))/864e5}function Xh(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Zh(e){var t,n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=n>=-4&&n<=-1?e.toPrecision(10+n):Math.abs(n)<=9?function(e){var t=e<0?12:11,n=Xh(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10)).length<=t?n:e.toExponential(5)}(e):10===n?e.toFixed(10).substr(0,12):function(e){var t=Xh(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),Xh(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function ef(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):Zh(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return Tf(14,Jh(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function tf(e,t,n,r){var a,i="",s=0,o=0,l=n.y,c=0;switch(e){case 98:l=n.y+543;case 121:switch(t.length){case 1:case 2:a=l%100,c=2;break;default:a=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:a=n.m,c=t.length;break;case 3:return zh[n.m-1][1];case 5:return zh[n.m-1][0];default:return zh[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=n.d,c=t.length;break;case 3:return Hh[n.q][0];default:return Hh[n.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(n.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=n.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=n.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==n.u||"s"!=t&&"ss"!=t?(o=r>=2?3===r?1e3:100:1===r?10:1,(s=Math.round(o*(n.S+n.u)))>=60*o&&(s=0),"s"===t?0===s?"0":""+s/o:(i=Dh(s,2+r),"ss"===t?i.substr(0,2):"."+i.substr(2,t.length-1))):Dh(n.S,t.length);case 90:switch(t){case"[h]":case"[hh]":a=24*n.D+n.H;break;case"[m]":case"[mm]":a=60*(24*n.D+n.H)+n.M;break;case"[s]":case"[ss]":a=60*(60*(24*n.D+n.H)+n.M)+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:a=l,c=1}return c>0?Dh(a,c):""}function nf(e){if(e.length<=3)return e;for(var t=e.length%3,n=e.substr(0,t);t!=e.length;t+=3)n+=(n.length>0?",":"")+e.substr(t,3);return n}var rf=/%/g;function af(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+af(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),-1===(n=(t/Math.pow(10,i)).toPrecision(r+1+(a+i)%a)).indexOf("e")){var s=Math.floor(Math.log(t)*Math.LOG10E);for(-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(s-n.length+i):n+="E+"+(s-i);"0."===n.substr(0,2);)n=(n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,n,r){return t+n+r.substr(0,(a+i)%a)+"."+r.substr(i)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var sf=/# (\?+)( ?)\/( ?)(\d+)/;var of=/^#*0*\.([0#]+)/,lf=/\).*[0#]/,cf=/\(###\) ###\\?-####/;function uf(e){for(var t,n="",r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function df(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function hf(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function ff(e,t,n){if(40===e.charCodeAt(0)&&!t.match(lf)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?ff("n",r,n):"("+ff("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return pf(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(rf,""),a=t.length-r.length;return pf(e,r,n*Math.pow(10,2*a))+Yf("%",a)}(e,t,n);if(-1!==t.indexOf("E"))return af(t,n);if(36===t.charCodeAt(0))return"$"+ff(e,t.substr(" "==t.charAt(1)?2:1),n);var a,i,s,o,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+Uh(l,t.length);if(t.match(/^[#?]+$/))return"0"===(a=Uh(n,0))&&(a=""),a.length>t.length?a:uf(t.substr(0,t.length-a.length))+a;if(i=t.match(sf))return function(e,t,n){var r=parseInt(e[4],10),a=Math.round(t*r),i=Math.floor(a/r),s=a-i*r,o=r;return n+(0===i?"":""+i)+" "+(0===s?Yf(" ",e[1].length+1+e[4].length):Lh(s,e[1].length)+e[2]+"/"+e[3]+Dh(o,e[4].length))}(i,l,c);if(t.match(/^#+0+$/))return c+Uh(l,t.length-t.indexOf("0"));if(i=t.match(of))return a=df(n,i[1].length).replace(/^([^\.]+)$/,"$1."+uf(i[1])).replace(/\.$/,"."+uf(i[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+Yf("0",uf(i[1]).length-t.length)}),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+df(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+nf(Uh(l,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+ff(e,t,-n):nf(""+(Math.floor(n)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(n,i[1].length)))+"."+Dh(hf(n,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return ff(e,t.replace(/^#,#*,/,""),n);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Mh(ff(e,t.replace(/[\\-]/g,""),n)),s=0,Mh(Mh(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return s<a.length?a.charAt(s++):"0"===e?"0":""}));if(t.match(cf))return"("+(a=ff(e,"##########",n)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Kh(l,Math.pow(10,s)-1,!1),a=""+c," "==(u=pf("n",i[1],o[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],(u=Fh(o[2],s)).length<i[4].length&&(u=uf(i[4].substr(i[4].length-u.length))+u),a+=u;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),c+((o=Kh(l,Math.pow(10,s)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?Lh(o[1],s)+i[2]+"/"+i[3]+Fh(o[2],s):Yf(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Uh(n,0),t.length<=a.length?a:uf(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var d=t.indexOf(".")-s,h=t.length-a.length-d;return uf(t.substr(0,d)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=hf(n,i[1].length),n<0?"-"+ff(e,t,-n):nf(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Dh(0,3-e.length):"")+e})+"."+Dh(s,i[1].length);switch(t){case"###,##0.00":return ff(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var f=nf(Uh(l,0));return"0"!==f?c+f:"";case"###,###.00":return ff(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return ff(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function mf(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+mf(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),!(n=(t/Math.pow(10,i)).toPrecision(r+1+(a+i)%a)).match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(s-n.length+i):n+="E+"+(s-i),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,n,r){return t+n+r.substr(0,(a+i)%a)+"."+r.substr(i)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function gf(e,t,n){if(40===e.charCodeAt(0)&&!t.match(lf)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?gf("n",r,n):"("+gf("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return pf(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(rf,""),a=t.length-r.length;return pf(e,r,n*Math.pow(10,2*a))+Yf("%",a)}(e,t,n);if(-1!==t.indexOf("E"))return mf(t,n);if(36===t.charCodeAt(0))return"$"+gf(e,t.substr(" "==t.charAt(1)?2:1),n);var a,i,s,o,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+Dh(l,t.length);if(t.match(/^[#?]+$/))return a=""+n,0===n&&(a=""),a.length>t.length?a:uf(t.substr(0,t.length-a.length))+a;if(i=t.match(sf))return function(e,t,n){return n+(0===t?"":""+t)+Yf(" ",e[1].length+2+e[4].length)}(i,l,c);if(t.match(/^#+0+$/))return c+Dh(l,t.length-t.indexOf("0"));if(i=t.match(of))return a=(a=(""+n).replace(/^([^\.]+)$/,"$1."+uf(i[1])).replace(/\.$/,"."+uf(i[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+Yf("0",uf(i[1]).length-t.length)}),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+nf(""+l);if(i=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+gf(e,t,-n):nf(""+n)+"."+Yf("0",i[1].length);if(i=t.match(/^#,#*,#0/))return gf(e,t.replace(/^#,#*,/,""),n);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Mh(gf(e,t.replace(/[\\-]/g,""),n)),s=0,Mh(Mh(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return s<a.length?a.charAt(s++):"0"===e?"0":""}));if(t.match(cf))return"("+(a=gf(e,"##########",n)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Kh(l,Math.pow(10,s)-1,!1),a=""+c," "==(u=pf("n",i[1],o[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],(u=Fh(o[2],s)).length<i[4].length&&(u=uf(i[4].substr(i[4].length-u.length))+u),a+=u;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),c+((o=Kh(l,Math.pow(10,s)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?Lh(o[1],s)+i[2]+"/"+i[3]+Fh(o[2],s):Yf(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+n,t.length<=a.length?a:uf(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var d=t.indexOf(".")-s,h=t.length-a.length-d;return uf(t.substr(0,d)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+gf(e,t,-n):nf(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Dh(0,3-e.length):"")+e})+"."+Dh(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=nf(""+l);return"0"!==f?c+f:"";default:if(t.match(/\.[0#?]*$/))return gf(e,t.slice(0,t.lastIndexOf(".")),n)+uf(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function pf(e,t,n){return(0|n)===n?gf(e,t,n):ff(e,t,n)}var vf=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function yf(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":Bh(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(r=n;"]"!==e.charAt(t++)&&t<e.length;)r+=e.charAt(t);if(r.match(vf))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||"\\"==n&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var bf=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function wf(e,t){if(null==t)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0}return!1}function Sf(e,t){var n=function(e){for(var t=[],n=!1,r=0,a=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(a,r-a),a=r+1}if(t[t.length]=e.substr(a),!0===n)throw new Error("Format |"+e+"| unterminated string ");return t}(e),r=n.length,a=n[r-1].indexOf("@");if(r<4&&a>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if("number"!==typeof t)return[4,4===n.length||a>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=a>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=a>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=a>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"]}var i=t>0?n[0]:t<0?n[1]:n[2];if(-1===n[0].indexOf("[")&&-1===n[1].indexOf("["))return[r,i];if(null!=n[0].match(/\[[=<>]/)||null!=n[1].match(/\[[=<>]/)){var s=n[0].match(bf),o=n[1].match(bf);return wf(t,s)?[r,n[0]]:wf(t,o)?[r,n[1]]:[r,n[null!=s&&null!=o?2:1]]}return[r,i]}function Tf(e,t,n){null==n&&(n={});var r="";switch(typeof e){case"string":r="m/d/yy"==e&&n.dateNF?n.dateNF:e;break;case"number":null==(r=14==e&&n.dateNF?n.dateNF:(null!=n.table?n.table:qh)[e])&&(r=n.table&&n.table[Wh[e]]||qh[Wh[e]]),null==r&&(r=Vh[e]||"General")}if(Bh(r,0))return ef(t,n);t instanceof Date&&(t=Jh(t,n.date1904));var a=Sf(r,t);if(Bh(a[1]))return ef(t,n);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,n,r){for(var a,i,s,o=[],l="",c=0,u="",d="t",h="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!Bh(e,c))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(s=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(s);o[o.length]={t:"t",v:l},++c;break;case"\\":var f=e.charAt(++c),m="("===f||")"===f?f:"t";o[o.length]={t:m,v:f},++c;break;case"_":o[o.length]={t:"t",v:" "},c+=2;break;case"@":o[o.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==a&&null==(a=Gh(t,n,"2"===e.charAt(c+1))))return"";o[o.length]={t:"X",v:e.substr(c,2)},d=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==a&&null==(a=Gh(t,n)))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;"m"===u&&"h"===d.toLowerCase()&&(u="M"),"h"===u&&(u=h),o[o.length]={t:u,v:l},d=u;break;case"A":case"a":case"\u4e0a":var g={t:u,v:u};if(null==a&&(a=Gh(t,n)),"A/P"===e.substr(c,3).toUpperCase()?(null!=a&&(g.v=a.H>=12?"P":"A"),g.t="T",h="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=a&&(g.v=a.H>=12?"PM":"AM"),g.t="T",c+=5,h="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(c,5).toUpperCase()?(null!=a&&(g.v=a.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),g.t="T",c+=5,h="h"):(g.t="t",++c),null==a&&"T"===g.t)return"";o[o.length]=g,d=u;break;case"[":for(l=u;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(vf)){if(null==a&&null==(a=Gh(t,n)))return"";o[o.length]={t:"Z",v:l.toLowerCase()},d=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",yf(e)||(o[o.length]={t:"t",v:l}));break;case".":if(null!=a){for(l=u;++c<e.length&&"0"===(u=e.charAt(c));)l+=u;o[o.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;o[o.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;o[o.length]={t:u,v:l},d=u;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":o[o.length]={t:1===r?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);o[o.length]={t:"D",v:l};break;case" ":o[o.length]={t:u,v:u},++c;break;case"$":o[o.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"t",v:u},++c}var p,v=0,y=0;for(c=o.length-1,d="t";c>=0;--c)switch(o[c].t){case"h":case"H":o[c].t=h,d="h",v<1&&(v=1);break;case"s":(p=o[c].v.match(/\.0+$/))&&(y=Math.max(y,p[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":d=o[c].t;break;case"m":"s"===d&&(o[c].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&o[c].v.match(/[Hh]/)&&(v=1),v<2&&o[c].v.match(/[Mm]/)&&(v=2),v<3&&o[c].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M),a.M>=60&&(a.M=0,++a.H);break;case 2:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M)}var b,w="";for(c=0;c<o.length;++c)switch(o[c].t){case"t":case"T":case" ":case"D":break;case"X":o[c].v="",o[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[c].v=tf(o[c].t.charCodeAt(0),o[c].v,a,y),o[c].t="t";break;case"n":case"?":for(b=c+1;null!=o[b]&&("?"===(u=o[b].t)||"D"===u||(" "===u||"t"===u)&&null!=o[b+1]&&("?"===o[b+1].t||"t"===o[b+1].t&&"/"===o[b+1].v)||"("===o[c].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===o[b].v||" "===o[b].v&&null!=o[b+1]&&"?"==o[b+1].t));)o[c].v+=o[b].v,o[b]={v:"",t:";"},++b;w+=o[c].v,c=b-1;break;case"G":o[c].t="t",o[c].v=ef(t,n)}var S,T,A="";if(w.length>0){40==w.charCodeAt(0)?(S=t<0&&45===w.charCodeAt(0)?-t:t,T=pf("n",w,S)):(T=pf("n",w,S=t<0&&r>1?-t:t),S<0&&o[0]&&"t"==o[0].t&&(T=T.substr(1),o[0].v="-"+o[0].v)),b=T.length-1;var x=o.length;for(c=0;c<o.length;++c)if(null!=o[c]&&"t"!=o[c].t&&o[c].v.indexOf(".")>-1){x=c;break}var k=o.length;if(x===o.length&&-1===T.indexOf("E")){for(c=o.length-1;c>=0;--c)null!=o[c]&&-1!=="n?".indexOf(o[c].t)&&(b>=o[c].v.length-1?(b-=o[c].v.length,o[c].v=T.substr(b+1,o[c].v.length)):b<0?o[c].v="":(o[c].v=T.substr(0,b+1),b=-1),o[c].t="t",k=c);b>=0&&k<o.length&&(o[k].v=T.substr(0,b+1)+o[k].v)}else if(x!==o.length&&-1===T.indexOf("E")){for(b=T.indexOf(".")-1,c=x;c>=0;--c)if(null!=o[c]&&-1!=="n?".indexOf(o[c].t)){for(i=o[c].v.indexOf(".")>-1&&c===x?o[c].v.indexOf(".")-1:o[c].v.length-1,A=o[c].v.substr(i+1);i>=0;--i)b>=0&&("0"===o[c].v.charAt(i)||"#"===o[c].v.charAt(i))&&(A=T.charAt(b--)+A);o[c].v=A,o[c].t="t",k=c}for(b>=0&&k<o.length&&(o[k].v=T.substr(0,b+1)+o[k].v),b=T.indexOf(".")+1,c=x;c<o.length;++c)if(null!=o[c]&&(-1!=="n?(".indexOf(o[c].t)||c===x)){for(i=o[c].v.indexOf(".")>-1&&c===x?o[c].v.indexOf(".")+1:0,A=o[c].v.substr(0,i);i<o[c].v.length;++i)b<T.length&&(A+=T.charAt(b++));o[c].v=A,o[c].t="t",k=c}}}for(c=0;c<o.length;++c)null!=o[c]&&"n?".indexOf(o[c].t)>-1&&(S=r>1&&t<0&&c>0&&"-"===o[c-1].v?-t:t,o[c].v=pf(o[c].t,o[c].v,S),o[c].t="t");var C="";for(c=0;c!==o.length;++c)null!=o[c]&&(C+=o[c].v);return C}(a[1],t,n,a[0])}function Af(e,t){if("number"!=typeof t){t=+t||-1;for(var n=0;n<392;++n)if(void 0!=qh[n]){if(qh[n]==e){t=n;break}}else t<0&&(t=n);t<0&&(t=391)}return qh[t]=e,t}function xf(e){for(var t=0;392!=t;++t)void 0!==e[t]&&Af(e[t],t)}function kf(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',qh=e}var Cf=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var Ef=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),n=0;256!=n;++n)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=n)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[n]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var n=function(e){var t=0,n=0,r=0,a="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(r=0;256!=r;++r)a[r]=e[r];for(r=0;256!=r;++r)for(n=e[r],t=256+r;t<4096;t+=256)n=a[t]=n>>>8^e[255&n];var i=[];for(r=1;16!=r;++r)i[r-1]="undefined"!==typeof Int32Array?a.subarray(256*r,256*r+256):a.slice(256*r,256*r+256);return i}(t),r=n[0],a=n[1],i=n[2],s=n[3],o=n[4],l=n[5],c=n[6],u=n[7],d=n[8],h=n[9],f=n[10],m=n[11],g=n[12],p=n[13],v=n[14];return e.table=t,e.bstr=function(e,n){for(var r=-1^n,a=0,i=e.length;a<i;)r=r>>>8^t[255&(r^e.charCodeAt(a++))];return~r},e.buf=function(e,n){for(var y=-1^n,b=e.length-15,w=0;w<b;)y=v[e[w++]^255&y]^p[e[w++]^y>>8&255]^g[e[w++]^y>>16&255]^m[e[w++]^y>>>24]^f[e[w++]]^h[e[w++]]^d[e[w++]]^u[e[w++]]^c[e[w++]]^l[e[w++]]^o[e[w++]]^s[e[w++]]^i[e[w++]]^a[e[w++]]^r[e[w++]]^t[e[w++]];for(b+=15;w<b;)y=y>>>8^t[255&(y^e[w++])];return~y},e.str=function(e,n){for(var r=-1^n,a=0,i=e.length,s=0,o=0;a<i;)(s=e.charCodeAt(a++))<128?r=r>>>8^t[255&(r^s)]:s<2048?r=(r=r>>>8^t[255&(r^(192|s>>6&31))])>>>8^t[255&(r^(128|63&s))]:s>=55296&&s<57344?(s=64+(1023&s),o=1023&e.charCodeAt(a++),r=(r=(r=(r=r>>>8^t[255&(r^(240|s>>8&7))])>>>8^t[255&(r^(128|s>>2&63))])>>>8^t[255&(r^(128|o>>6&15|(3&s)<<4))])>>>8^t[255&(r^(128|63&o))]):r=(r=(r=r>>>8^t[255&(r^(224|s>>12&15))])>>>8^t[255&(r^(128|s>>6&63))])>>>8^t[255&(r^(128|63&s))];return~r},e}(),If=function(){var e,t={};function n(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function r(e){if("/"==e.charAt(e.length-1))return r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function a(e,t){"string"===typeof t&&(t=new Date(t));var n=t.getHours();n=(n=n<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,n);var r=t.getFullYear()-1980;r=(r=r<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,r)}function i(e){Ag(e,0);for(var t={},n=0;e.l<=e.length-4;){var r=e.read_shift(2),a=e.read_shift(2),i=e.l+a,s={};if(21589===r)1&(n=e.read_shift(1))&&(s.mtime=e.read_shift(4)),a>5&&(2&n&&(s.atime=e.read_shift(4)),4&n&&(s.ctime=e.read_shift(4))),s.mtime&&(s.mt=new Date(1e3*s.mtime));e.l=i,t[r]=s}return t}function s(){return e||(e={})}function o(e,t){if(80==e[0]&&75==e[1])return re(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=T(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var n=t&&t.root||"",r=(xh&&Buffer.isBuffer(e)?e.toString("binary"):T(e)).split("\r\n"),a=0,i="";for(a=0;a<r.length;++a)if(i=r[a],/^Content-Location:/i.test(i)&&(i=i.slice(i.indexOf("file")),n||(n=i.slice(0,i.lastIndexOf("/")+1)),i.slice(0,n.length)!=n))for(;n.length>0&&(n=(n=n.slice(0,n.length-1)).slice(0,n.lastIndexOf("/")+1),i.slice(0,n.length)!=n););var s=(r[1]||"").match(/boundary="(.*?)"/);if(!s)throw new Error("MAD cannot find boundary");var o="--"+(s[1]||""),l=[],c=[],u={FileIndex:l,FullPaths:c};h(u);var d,f=0;for(a=0;a<r.length;++a){var m=r[a];m!==o&&m!==o+"--"||(f++&&ce(u,r.slice(d,a),n),d=a)}return u}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var n,r,a,i,s,o,f=512,m=[],g=e.slice(0,512);Ag(g,0);var p=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(y,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(g);switch(n=p[0]){case 3:f=512;break;case 4:f=4096;break;case 0:if(0==p[1])return re(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+n)}512!==f&&Ag(g=e.slice(0,f),28);var b=e.slice(0,f);!function(e,t){var n=9;switch(e.l+=2,n=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+n);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+n);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+n)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(g,n);var w=g.read_shift(4,"i");if(3===n&&0!==w)throw new Error("# Directory Sectors: Expected 0 saw "+w);g.l+=4,i=g.read_shift(4,"i"),g.l+=4,g.chk("00100000","Mini Stream Cutoff Size: "),s=g.read_shift(4,"i"),r=g.read_shift(4,"i"),o=g.read_shift(4,"i"),a=g.read_shift(4,"i");for(var S=-1,A=0;A<109&&!((S=g.read_shift(4,"i"))<0);++A)m[A]=S;var x=function(e,t){for(var n=Math.ceil(e.length/t)-1,r=[],a=1;a<n;++a)r[a-1]=e.slice(a*t,(a+1)*t);return r[n-1]=e.slice(n*t),r}(e,f);c(o,a,x,f,m);var k=function(e,t,n,r){var a=e.length,i=[],s=[],o=[],l=[],c=r-1,u=0,d=0,h=0,f=0;for(u=0;u<a;++u)if(o=[],(h=u+t)>=a&&(h-=a),!s[h]){l=[];var m=[];for(d=h;d>=0;){m[d]=!0,s[d]=!0,o[o.length]=d,l.push(e[d]);var g=n[Math.floor(4*d/r)];if(r<4+(f=4*d&c))throw new Error("FAT boundary crossed: "+d+" 4 "+r);if(!e[g])break;if(m[d=gg(e[g],f)])break}i[h]={nodes:o,data:Wm([l])}}return i}(x,i,m,f);k[i].name="!Directory",r>0&&s!==v&&(k[s].name="!MiniFAT"),k[m[0]].name="!FAT",k.fat_addrs=m,k.ssz=f;var C=[],E=[],I=[];!function(e,t,n,r,a,i,s,o){for(var c,h=0,f=r.length?2:0,m=t[e].data,g=0,p=0;g<m.length;g+=128){var y=m.slice(g,g+128);Ag(y,64),p=y.read_shift(2),c=Km(y,0,p-f),r.push(c);var b={name:c,type:y.read_shift(1),color:y.read_shift(1),L:y.read_shift(4,"i"),R:y.read_shift(4,"i"),C:y.read_shift(4,"i"),clsid:y.read_shift(16),state:y.read_shift(4,"i"),start:0,size:0};0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.ct=d(y,y.l-8)),0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.mt=d(y,y.l-8)),b.start=y.read_shift(4,"i"),b.size=y.read_shift(4,"i"),b.size<0&&b.start<0&&(b.size=b.type=0,b.start=v,b.name=""),5===b.type?(h=b.start,a>0&&h!==v&&(t[h].name="!StreamData")):b.size>=4096?(b.storage="fat",void 0===t[b.start]&&(t[b.start]=u(n,b.start,t.fat_addrs,t.ssz)),t[b.start].name=b.name,b.content=t[b.start].data.slice(0,b.size)):(b.storage="minifat",b.size<0?b.size=0:h!==v&&b.start!==v&&t[h]&&(b.content=l(b,t[h].data,(t[o]||{}).data))),b.content&&Ag(b.content,0),i[c]=b,s.push(b)}}(i,k,x,C,r,{},E,s),function(e,t,n){for(var r=0,a=0,i=0,s=0,o=0,l=n.length,c=[],u=[];r<l;++r)c[r]=u[r]=r,t[r]=n[r];for(;o<u.length;++o)a=e[r=u[o]].L,i=e[r].R,s=e[r].C,c[r]===r&&(-1!==a&&c[a]!==a&&(c[r]=c[a]),-1!==i&&c[i]!==i&&(c[r]=c[i])),-1!==s&&(c[s]=r),-1!==a&&r!=c[r]&&(c[a]=c[r],u.lastIndexOf(a)<o&&u.push(a)),-1!==i&&r!=c[r]&&(c[i]=c[r],u.lastIndexOf(i)<o&&u.push(i));for(r=1;r<l;++r)c[r]===r&&(-1!==i&&c[i]!==i?c[r]=c[i]:-1!==a&&c[a]!==a&&(c[r]=c[a]));for(r=1;r<l;++r)if(0!==e[r].type){if((o=r)!=c[o])do{o=c[o],t[r]=t[o]+"/"+t[r]}while(0!==o&&-1!==c[o]&&o!=c[o]);c[r]=-1}for(t[0]+="/",r=1;r<l;++r)2!==e[r].type&&(t[r]+="/")}(E,I,C),C.shift();var N={FileIndex:E,FullPaths:I};return t&&t.raw&&(N.raw={header:b,sectors:x}),N}function l(e,t,n){for(var r=e.start,a=e.size,i=[],s=r;n&&a>0&&s>=0;)i.push(t.slice(s*p,s*p+p)),a-=p,s=gg(n,4*s);return 0===i.length?kg(0):_h(i).slice(0,e.size)}function c(e,t,n,r,a){var i=v;if(e===v){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var s=n[e],o=(r>>>2)-1;if(!s)return;for(var l=0;l<o&&(i=gg(s,4*l))!==v;++l)a.push(i);c(gg(s,r-4),t-1,n,r,a)}}function u(e,t,n,r,a){var i=[],s=[];a||(a=[]);var o=r-1,l=0,c=0;for(l=t;l>=0;){a[l]=!0,i[i.length]=l,s.push(e[l]);var u=n[Math.floor(4*l/r)];if(r<4+(c=4*l&o))throw new Error("FAT boundary crossed: "+l+" 4 "+r);if(!e[u])break;l=gg(e[u],c)}return{nodes:i,data:Wm([s])}}function d(e,t){return new Date(1e3*(mg(e,t+4)/1e7*Math.pow(2,32)+mg(e,t)/1e7-11644473600))}function h(e,t){var n=t||{},r=n.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=r+"/",e.FileIndex[0]={name:r,type:5}),n.CLSID&&(e.FileIndex[0].clsid=n.CLSID),function(e){var t="\x01Sh33tJ5";if(If.find(e,"/"+t))return;var n=kg(4);n[0]=55,n[1]=n[3]=50,n[2]=54,e.FileIndex.push({name:t,type:2,content:n,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),f(e)}(e)}function f(e,t){h(e);for(var a=!1,i=!1,s=e.FullPaths.length-1;s>=0;--s){var o=e.FileIndex[s];switch(o.type){case 0:i?a=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:i=!0,isNaN(o.R*o.L*o.C)&&(a=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(a=!0);break;default:a=!0}}if(a||t){var l=new Date(1987,1,19),c=0,u=Object.create?Object.create(null):{},d=[];for(s=0;s<e.FullPaths.length;++s)u[e.FullPaths[s]]=!0,0!==e.FileIndex[s].type&&d.push([e.FullPaths[s],e.FileIndex[s]]);for(s=0;s<d.length;++s){var f=n(d[s][0]);(i=u[f])||(d.push([f,{name:r(f).replace("/",""),type:1,clsid:w,ct:l,mt:l,content:null}]),u[f]=!0)}for(d.sort(function(e,t){return function(e,t){for(var n=e.split("/"),r=t.split("/"),a=0,i=0,s=Math.min(n.length,r.length);a<s;++a){if(i=n[a].length-r[a].length)return i;if(n[a]!=r[a])return n[a]<r[a]?-1:1}return n.length-r.length}(e[0],t[0])}),e.FullPaths=[],e.FileIndex=[],s=0;s<d.length;++s)e.FullPaths[s]=d[s][0],e.FileIndex[s]=d[s][1];for(s=0;s<d.length;++s){var m=e.FileIndex[s],g=e.FullPaths[s];if(m.name=r(g).replace("/",""),m.L=m.R=m.C=-(m.color=1),m.size=m.content?m.content.length:0,m.start=0,m.clsid=m.clsid||w,0===s)m.C=d.length>1?1:-1,m.size=0,m.type=5;else if("/"==g.slice(-1)){for(c=s+1;c<d.length&&n(e.FullPaths[c])!=g;++c);for(m.C=c>=d.length?-1:c,c=s+1;c<d.length&&n(e.FullPaths[c])!=n(g);++c);m.R=c>=d.length?-1:c,m.type=1}else n(e.FullPaths[s+1]||"")==n(g)&&(m.R=s+1),m.type=2}}}function m(e,t){var n=t||{};if("mad"==n.fileType)return function(e,t){for(var n=t||{},r=n.boundary||"SheetJS",a=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(r="------="+r).slice(2)+'"',"","",""],i=e.FullPaths[0],s=i,o=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(s=e.FullPaths[l].slice(i.length),(o=e.FileIndex[l]).size&&o.content&&"\x01Sh33tJ5"!=s){s=s.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var c=o.content,u=xh&&Buffer.isBuffer(c)?c.toString("binary"):T(c),d=0,h=Math.min(1024,u.length),f=0,m=0;m<=h;++m)(f=u.charCodeAt(m))>=32&&f<128&&++d;var g=d>=4*h/5;a.push(r),a.push("Content-Location: "+(n.root||"file:///C:/SheetJS/")+s),a.push("Content-Transfer-Encoding: "+(g?"quoted-printable":"base64")),a.push("Content-Type: "+se(o,s)),a.push(""),a.push(g?le(u):oe(u))}return a.push(r+"--\r\n"),a.join("\r\n")}(e,n);if(f(e),"zip"===n.fileType)return function(e,t){var n=t||{},r=[],i=[],s=kg(1),o=n.compression?8:0,l=0;0;var c=0,u=0,d=0,h=0,f=e.FullPaths[0],m=f,g=e.FileIndex[0],p=[],v=0;for(c=1;c<e.FullPaths.length;++c)if(m=e.FullPaths[c].slice(f.length),(g=e.FileIndex[c]).size&&g.content&&"\x01Sh33tJ5"!=m){var y=d,b=kg(m.length);for(u=0;u<m.length;++u)b.write_shift(1,127&m.charCodeAt(u));b=b.slice(0,b.l),p[h]=Ef.buf(g.content,0);var w=g.content;8==o&&(w=A(w)),(s=kg(30)).write_shift(4,67324752),s.write_shift(2,20),s.write_shift(2,l),s.write_shift(2,o),g.mt?a(s,g.mt):s.write_shift(4,0),s.write_shift(-4,8&l?0:p[h]),s.write_shift(4,8&l?0:w.length),s.write_shift(4,8&l?0:g.content.length),s.write_shift(2,b.length),s.write_shift(2,0),d+=s.length,r.push(s),d+=b.length,r.push(b),d+=w.length,r.push(w),8&l&&((s=kg(12)).write_shift(-4,p[h]),s.write_shift(4,w.length),s.write_shift(4,g.content.length),d+=s.l,r.push(s)),(s=kg(46)).write_shift(4,33639248),s.write_shift(2,0),s.write_shift(2,20),s.write_shift(2,l),s.write_shift(2,o),s.write_shift(4,0),s.write_shift(-4,p[h]),s.write_shift(4,w.length),s.write_shift(4,g.content.length),s.write_shift(2,b.length),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(4,0),s.write_shift(4,y),v+=s.l,i.push(s),v+=b.length,i.push(b),++h}return s=kg(22),s.write_shift(4,101010256),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,h),s.write_shift(2,h),s.write_shift(4,v),s.write_shift(4,d),s.write_shift(2,0),_h([_h(r),_h(i),s])}(e,n);var r=function(e){for(var t=0,n=0,r=0;r<e.FileIndex.length;++r){var a=e.FileIndex[r];if(a.content){var i=a.content.length;i>0&&(i<4096?t+=i+63>>6:n+=i+511>>9)}}for(var s=e.FullPaths.length+3>>2,o=t+127>>7,l=(t+7>>3)+n+s+o,c=l+127>>7,u=c<=109?0:Math.ceil((c-109)/127);l+c+u+127>>7>c;)u=++c<=109?0:Math.ceil((c-109)/127);var d=[1,u,c,o,s,n,t,0];return e.FileIndex[0].size=t<<6,d[7]=(e.FileIndex[0].start=d[0]+d[1]+d[2]+d[3]+d[4]+d[5])+(d[6]+7>>3),d}(e),i=kg(r[7]<<9),s=0,o=0;for(s=0;s<8;++s)i.write_shift(1,b[s]);for(s=0;s<8;++s)i.write_shift(2,0);for(i.write_shift(2,62),i.write_shift(2,3),i.write_shift(2,65534),i.write_shift(2,9),i.write_shift(2,6),s=0;s<3;++s)i.write_shift(2,0);for(i.write_shift(4,0),i.write_shift(4,r[2]),i.write_shift(4,r[0]+r[1]+r[2]+r[3]-1),i.write_shift(4,0),i.write_shift(4,4096),i.write_shift(4,r[3]?r[0]+r[1]+r[2]-1:v),i.write_shift(4,r[3]),i.write_shift(-4,r[1]?r[0]-1:v),i.write_shift(4,r[1]),s=0;s<109;++s)i.write_shift(-4,s<r[2]?r[1]+s:-1);if(r[1])for(o=0;o<r[1];++o){for(;s<236+127*o;++s)i.write_shift(-4,s<r[2]?r[1]+s:-1);i.write_shift(-4,o===r[1]-1?v:o+1)}var l=function(e){for(o+=e;s<o-1;++s)i.write_shift(-4,s+1);e&&(++s,i.write_shift(-4,v))};for(o=s=0,o+=r[1];s<o;++s)i.write_shift(-4,S.DIFSECT);for(o+=r[2];s<o;++s)i.write_shift(-4,S.FATSECT);l(r[3]),l(r[4]);for(var c=0,u=0,d=e.FileIndex[0];c<e.FileIndex.length;++c)(d=e.FileIndex[c]).content&&((u=d.content.length)<4096||(d.start=o,l(u+511>>9)));for(l(r[6]+7>>3);511&i.l;)i.write_shift(-4,S.ENDOFCHAIN);for(o=s=0,c=0;c<e.FileIndex.length;++c)(d=e.FileIndex[c]).content&&(!(u=d.content.length)||u>=4096||(d.start=o,l(u+63>>6)));for(;511&i.l;)i.write_shift(-4,S.ENDOFCHAIN);for(s=0;s<r[4]<<2;++s){var h=e.FullPaths[s];if(h&&0!==h.length){d=e.FileIndex[s],0===s&&(d.start=d.size?d.start-1:v);var m=0===s&&n.root||d.name;if(u=2*(m.length+1),i.write_shift(64,m,"utf16le"),i.write_shift(2,u),i.write_shift(1,d.type),i.write_shift(1,d.color),i.write_shift(-4,d.L),i.write_shift(-4,d.R),i.write_shift(-4,d.C),d.clsid)i.write_shift(16,d.clsid,"hex");else for(c=0;c<4;++c)i.write_shift(4,0);i.write_shift(4,d.state||0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,d.start),i.write_shift(4,d.size),i.write_shift(4,0)}else{for(c=0;c<17;++c)i.write_shift(4,0);for(c=0;c<3;++c)i.write_shift(4,-1);for(c=0;c<12;++c)i.write_shift(4,0)}}for(s=1;s<e.FileIndex.length;++s)if((d=e.FileIndex[s]).size>=4096)if(i.l=d.start+1<<9,xh&&Buffer.isBuffer(d.content))d.content.copy(i,i.l,0,d.size),i.l+=d.size+511&-512;else{for(c=0;c<d.size;++c)i.write_shift(1,d.content[c]);for(;511&c;++c)i.write_shift(1,0)}for(s=1;s<e.FileIndex.length;++s)if((d=e.FileIndex[s]).size>0&&d.size<4096)if(xh&&Buffer.isBuffer(d.content))d.content.copy(i,i.l,0,d.size),i.l+=d.size+63&-64;else{for(c=0;c<d.size;++c)i.write_shift(1,d.content[c]);for(;63&c;++c)i.write_shift(1,0)}if(xh)i.l=i.length;else for(;i.l<i.length;)i.write_shift(1,0);return i}t.version="1.2.1";var g,p=64,v=-2,y="d0cf11e0a1b11ae1",b=[208,207,17,224,161,177,26,225],w="00000000000000000000000000000000",S={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:v,FREESECT:-1,HEADER_SIGNATURE:y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:w,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function T(e){for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function A(e){return g?g.deflateRawSync(e):Y(e)}var x=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],k=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],C=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function E(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var I="undefined"!==typeof Uint8Array,N=I?new Uint8Array(256):[],P=0;P<256;++P)N[P]=E(P);function _(e,t){var n=N[255&e];return t<=8?n>>>8-t:(n=n<<8|N[e>>8&255],t<=16?n>>>16-t:(n=n<<8|N[e>>16&255])>>>24-t)}function O(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=6?0:e[r+1]<<8))>>>n&3}function R(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=5?0:e[r+1]<<8))>>>n&7}function M(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=3?0:e[r+1]<<8))>>>n&31}function D(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=1?0:e[r+1]<<8))>>>n&127}function L(e,t,n){var r=7&t,a=t>>>3,i=(1<<n)-1,s=e[a]>>>r;return n<8-r?s&i:(s|=e[a+1]<<8-r,n<16-r?s&i:(s|=e[a+2]<<16-r,n<24-r?s&i:(s|=e[a+3]<<24-r)&i))}function F(e,t,n){var r=7&t,a=t>>>3;return r<=5?e[a]|=(7&n)<<r:(e[a]|=n<<r&255,e[a+1]=(7&n)>>8-r),t+3}function j(e,t,n){return n=(1&n)<<(7&t),e[t>>>3]|=n,t+1}function U(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=n,t+8}function B(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=255&n,e[r+2]=n>>>8,t+16}function H(e,t){var n=e.length,r=2*n>t?2*n:t+5,a=0;if(n>=t)return e;if(xh){var i=Eh(r);if(e.copy)e.copy(i);else for(;a<e.length;++a)i[a]=e[a];return i}if(I){var s=new Uint8Array(r);if(s.set)s.set(e);else for(;a<n;++a)s[a]=e[a];return s}return e.length=r,e}function z(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=0;return t}function q(e,t,n){var r=1,a=0,i=0,s=0,o=0,l=e.length,c=I?new Uint16Array(32):z(32);for(i=0;i<32;++i)c[i]=0;for(i=l;i<n;++i)e[i]=0;l=e.length;var u=I?new Uint16Array(l):z(l);for(i=0;i<l;++i)c[a=e[i]]++,r<a&&(r=a),u[i]=0;for(c[0]=0,i=1;i<=r;++i)c[i+16]=o=o+c[i-1]<<1;for(i=0;i<l;++i)0!=(o=e[i])&&(u[i]=c[o+16]++);var d=0;for(i=0;i<l;++i)if(0!=(d=e[i]))for(o=_(u[i],r)>>r-d,s=(1<<r+4-d)-1;s>=0;--s)t[o|s<<d]=15&d|i<<4;return r}var W=I?new Uint16Array(512):z(512),V=I?new Uint16Array(32):z(32);if(!I){for(var K=0;K<512;++K)W[K]=0;for(K=0;K<32;++K)V[K]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);q(e,V,32);var n=[];for(t=0;t<=143;t++)n.push(8);for(;t<=255;t++)n.push(9);for(;t<=279;t++)n.push(7);for(;t<=287;t++)n.push(8);q(n,W,288)}();var G=function(){for(var e=I?new Uint8Array(32768):[],t=0,n=0;t<C.length-1;++t)for(;n<C[t+1];++n)e[n]=t;for(;n<32768;++n)e[n]=29;var r=I?new Uint8Array(259):[];for(t=0,n=0;t<k.length-1;++t)for(;n<k[t+1];++n)r[n]=t;return function(t,n){return t.length<8?function(e,t){for(var n=0;n<e.length;){var r=Math.min(65535,e.length-n),a=n+r==e.length;for(t.write_shift(1,+a),t.write_shift(2,r),t.write_shift(2,65535&~r);r-- >0;)t[t.l++]=e[n++]}return t.l}(t,n):function(t,n){for(var a=0,i=0,s=I?new Uint16Array(32768):[];i<t.length;){var o=Math.min(65535,t.length-i);if(o<10){for(7&(a=F(n,a,+!(i+o!=t.length)))&&(a+=8-(7&a)),n.l=a/8|0,n.write_shift(2,o),n.write_shift(2,65535&~o);o-- >0;)n[n.l++]=t[i++];a=8*n.l}else{a=F(n,a,+!(i+o!=t.length)+2);for(var l=0;o-- >0;){var c=t[i],u=-1,d=0;if((u=s[l=32767&(l<<5^c)])&&((u|=-32768&i)>i&&(u-=32768),u<i))for(;t[u+d]==t[i+d]&&d<250;)++d;if(d>2){(c=r[d])<=22?a=U(n,a,N[c+1]>>1)-1:(U(n,a,3),U(n,a+=5,N[c-23]>>5),a+=3);var h=c<8?0:c-4>>2;h>0&&(B(n,a,d-k[c]),a+=h),c=e[i-u],a=U(n,a,N[c]>>3),a-=3;var f=c<4?0:c-2>>1;f>0&&(B(n,a,i-u-C[c]),a+=f);for(var m=0;m<d;++m)s[l]=32767&i,l=32767&(l<<5^t[i]),++i;o-=d-1}else c<=143?c+=48:a=j(n,a,1),a=U(n,a,N[c]),s[l]=32767&i,++i}a=U(n,a,0)-1}}return n.l=(a+7)/8|0,n.l}(t,n)}}();function Y(e){var t=kg(50+Math.floor(1.1*e.length)),n=G(e,t);return t.slice(0,n)}var $=I?new Uint16Array(32768):z(32768),Q=I?new Uint16Array(32768):z(32768),J=I?new Uint16Array(128):z(128),X=1,Z=1;function ee(e,t){var n=M(e,t)+257,r=M(e,t+=5)+1,a=function(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=4?0:e[r+1]<<8))>>>n&15}(e,t+=5)+4;t+=4;for(var i=0,s=I?new Uint8Array(19):z(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=I?new Uint8Array(8):z(8),u=I?new Uint8Array(8):z(8),d=s.length,h=0;h<a;++h)s[x[h]]=i=R(e,t),l<i&&(l=i),c[i]++,t+=3;var f=0;for(c[0]=0,h=1;h<=l;++h)u[h]=f=f+c[h-1]<<1;for(h=0;h<d;++h)0!=(f=s[h])&&(o[h]=u[f]++);var m=0;for(h=0;h<d;++h)if(0!=(m=s[h])){f=N[o[h]]>>8-m;for(var g=(1<<7-m)-1;g>=0;--g)J[f|g<<m]=7&m|h<<3}var p=[];for(l=1;p.length<n+r;)switch(t+=7&(f=J[D(e,t)]),f>>>=3){case 16:for(i=3+O(e,t),t+=2,f=p[p.length-1];i-- >0;)p.push(f);break;case 17:for(i=3+R(e,t),t+=3;i-- >0;)p.push(0);break;case 18:for(i=11+D(e,t),t+=7;i-- >0;)p.push(0);break;default:p.push(f),l<f&&(l=f)}var v=p.slice(0,n),y=p.slice(n);for(h=n;h<286;++h)v[h]=0;for(h=r;h<30;++h)y[h]=0;return X=q(v,$,286),Z=q(y,Q,30),t}function te(e,t){var n=function(e,t){if(3==e[0]&&!(3&e[1]))return[Ch(t),2];for(var n=0,r=0,a=Eh(t||1<<18),i=0,s=a.length>>>0,o=0,l=0;0==(1&r);)if(r=R(e,n),n+=3,r>>>1!=0)for(r>>1==1?(o=9,l=5):(n=ee(e,n),o=X,l=Z);;){!t&&s<i+32767&&(s=(a=H(a,i+32767)).length);var c=L(e,n,o),u=r>>>1==1?W[c]:$[c];if(n+=15&u,0===((u>>>=4)>>>8&255))a[i++]=u;else{if(256==u)break;var d=(u-=257)<8?0:u-4>>2;d>5&&(d=0);var h=i+k[u];d>0&&(h+=L(e,n,d),n+=d),c=L(e,n,l),n+=15&(u=r>>>1==1?V[c]:Q[c]);var f=(u>>>=4)<4?0:u-2>>1,m=C[u];for(f>0&&(m+=L(e,n,f),n+=f),!t&&s<h&&(s=(a=H(a,h+100)).length);i<h;)a[i]=a[i-m],++i}}else{7&n&&(n+=8-(7&n));var g=e[n>>>3]|e[(n>>>3)+1]<<8;if(n+=32,g>0)for(!t&&s<i+g&&(s=(a=H(a,i+g)).length);g-- >0;)a[i++]=e[n>>>3],n+=8}return t?[a,n+7>>>3]:[a.slice(0,i),n+7>>>3]}(e.slice(e.l||0),t);return e.l+=n[1],n[0]}function ne(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function re(e,t){var n=e;Ag(n,0);var r={FileIndex:[],FullPaths:[]};h(r,{root:t.root});for(var a=n.length-4;(80!=n[a]||75!=n[a+1]||5!=n[a+2]||6!=n[a+3])&&a>=0;)--a;n.l=a+4,n.l+=4;var s=n.read_shift(2);n.l+=6;var o=n.read_shift(4);for(n.l=o,a=0;a<s;++a){n.l+=20;var l=n.read_shift(4),c=n.read_shift(4),u=n.read_shift(2),d=n.read_shift(2),f=n.read_shift(2);n.l+=8;var m=n.read_shift(4),g=i(n.slice(n.l+u,n.l+u+d));n.l+=u+d+f;var p=n.l;n.l=m+4,ae(n,l,c,r,g),n.l=p}return r}function ae(e,t,n,r,a){e.l+=2;var s=e.read_shift(2),o=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),n=65535&e.read_shift(2),r=new Date,a=31&n,i=15&(n>>>=5);n>>>=4,r.setMilliseconds(0),r.setFullYear(n+1980),r.setMonth(i-1),r.setDate(a);var s=31&t,o=63&(t>>>=5);return t>>>=6,r.setHours(t),r.setMinutes(o),r.setSeconds(s<<1),r}(e);if(8257&s)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),u=e.read_shift(4),d=e.read_shift(2),h=e.read_shift(2),f="",m=0;m<d;++m)f+=String.fromCharCode(e[e.l++]);if(h){var p=i(e.slice(e.l,e.l+h));(p[21589]||{}).mt&&(l=p[21589].mt),((a||{})[21589]||{}).mt&&(l=a[21589].mt)}e.l+=h;var v=e.slice(e.l,e.l+c);switch(o){case 8:v=function(e,t){if(!g)return te(e,t);var n=new(0,g.InflateRaw),r=n._processChunk(e.slice(e.l),n._finishFlushFlag);return e.l+=n.bytesRead,r}(e,u);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+o)}var y=!1;8&s&&(134695760==e.read_shift(4)&&(e.read_shift(4),y=!0),c=e.read_shift(4),u=e.read_shift(4)),c!=t&&ne(y,"Bad compressed size: "+t+" != "+c),u!=n&&ne(y,"Bad uncompressed size: "+n+" != "+u),ue(r,f,v,{unsafe:!0,mt:l})}var ie={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function se(e,t){if(e.ctype)return e.ctype;var n=e.name||"",r=n.match(/\.([^\.]+)$/);return r&&ie[r[1]]||t&&(r=(n=t).match(/[\.\\]([^\.\\])+$/))&&ie[r[1]]?ie[r[1]]:"application/octet-stream"}function oe(e){for(var t=Th(e),n=[],r=0;r<t.length;r+=76)n.push(t.slice(r,r+76));return n.join("\r\n")+"\r\n"}function le(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)});"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var n=[],r=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),a=0;a<r.length;++a){var i=r[a];if(0!=i.length)for(var s=0;s<i.length;){var o=76,l=i.slice(s,s+o);"="==l.charAt(o-1)?o--:"="==l.charAt(o-2)?o-=2:"="==l.charAt(o-3)&&(o-=3),l=i.slice(s,s+o),(s+=o)<i.length&&(l+="="),n.push(l)}else n.push("")}return n.join("\r\n")}function ce(e,t,n){for(var r,a="",i="",s="",o=0;o<10;++o){var l=t[o];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":a=c[2].trim();break;case"content-type":s=c[2].trim();break;case"content-transfer-encoding":i=c[2].trim()}}switch(++o,i.toLowerCase()){case"base64":r=Ih(Ah(t.slice(o).join("")));break;case"quoted-printable":r=function(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n];n<=e.length&&"="==r.charAt(r.length-1);)r=r.slice(0,r.length-1)+e[++n];t.push(r)}for(var a=0;a<t.length;++a)t[a]=t[a].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return Ih(t.join("\r\n"))}(t.slice(o));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+i)}var u=ue(e,a.slice(n.length),r,{unsafe:!0});s&&(u.ctype=s)}function ue(e,t,n,a){var i=a&&a.unsafe;i||h(e);var s=!i&&If.find(e,t);if(!s){var o=e.FullPaths[0];t.slice(0,o.length)==o?o=t:("/"!=o.slice(-1)&&(o+="/"),o=(o+t).replace("//","/")),s={name:r(t),type:2},e.FileIndex.push(s),e.FullPaths.push(o),i||If.utils.cfb_gc(e)}return s.content=n,s.size=n?n.length:0,a&&(a.CLSID&&(s.clsid=a.CLSID),a.mt&&(s.mt=a.mt),a.ct&&(s.ct=a.ct)),s}return t.find=function(e,t){var n=e.FullPaths.map(function(e){return e.toUpperCase()}),r=n.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),a=!1;47===t.charCodeAt(0)?(a=!0,t=n[0].slice(0,-1)+t):a=-1!==t.indexOf("/");var i=t.toUpperCase(),s=!0===a?n.indexOf(i):r.indexOf(i);if(-1!==s)return e.FileIndex[s];var o=!i.match(Rh);for(i=i.replace(Oh,""),o&&(i=i.replace(Rh,"!")),s=0;s<n.length;++s){if((o?n[s].replace(Rh,"!"):n[s]).replace(Oh,"")==i)return e.FileIndex[s];if((o?r[s].replace(Rh,"!"):r[s]).replace(Oh,"")==i)return e.FileIndex[s]}return null},t.read=function(t,n){var r=n&&n.type;switch(r||xh&&Buffer.isBuffer(t)&&(r="buffer"),r||"base64"){case"file":return function(t,n){return s(),o(e.readFileSync(t),n)}(t,n);case"base64":return o(Ih(Ah(t)),n);case"binary":return o(Ih(t),n)}return o(t,n)},t.parse=o,t.write=function(t,n){var r=m(t,n);switch(n&&n.type||"buffer"){case"file":return s(),e.writeFileSync(n.filename,r),r;case"binary":return"string"==typeof r?r:T(r);case"base64":return Th("string"==typeof r?r:T(r));case"buffer":if(xh)return Buffer.isBuffer(r)?r:kh(r);case"array":return"string"==typeof r?Ih(r):r}return r},t.writeFile=function(t,n,r){s();var a=m(t,r);e.writeFileSync(n,a)},t.utils={cfb_new:function(e){var t={};return h(t,e),t},cfb_add:ue,cfb_del:function(e,t){h(e);var n=If.find(e,t);if(n)for(var r=0;r<e.FileIndex.length;++r)if(e.FileIndex[r]==n)return e.FileIndex.splice(r,1),e.FullPaths.splice(r,1),!0;return!1},cfb_mov:function(e,t,n){h(e);var a=If.find(e,t);if(a)for(var i=0;i<e.FileIndex.length;++i)if(e.FileIndex[i]==a)return e.FileIndex[i].name=r(n),e.FullPaths[i]=n,!0;return!1},cfb_gc:function(e){f(e,!0)},ReadShift:vg,CheckField:Tg,prep_blob:Ag,bconcat:_h,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");g=e}catch(n){console.error("cannot use native zlib: "+(n.message||n))}},_deflateRaw:Y,_inflateRaw:te,consts:S},t}();let Nf;function Pf(e){return"string"===typeof e?Nh(e):Array.isArray(e)?function(e){if("undefined"===typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function _f(e,t,n){if("undefined"!==typeof Nf&&Nf.writeFileSync)return n?Nf.writeFileSync(e,t,n):Nf.writeFileSync(e,t);if("undefined"!==typeof Deno){if(n&&"string"==typeof t)switch(n){case"utf8":t=new TextEncoder(n).encode(t);break;case"binary":t=Nh(t);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,t)}var r="utf8"==n?gm(t):t;if("undefined"!==typeof IE_SaveFile)return IE_SaveFile(r,e);if("undefined"!==typeof Blob){var a=new Blob([Pf(r)],{type:"application/octet-stream"});if("undefined"!==typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if("undefined"!==typeof saveAs)return saveAs(a,e);if("undefined"!==typeof URL&&"undefined"!==typeof document&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if("object"===typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(null!=s.download)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Ph(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function Of(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function Rf(e,t){for(var n=[],r=Of(e),a=0;a!==r.length;++a)null==n[e[r[a]][t]]&&(n[e[r[a]][t]]=r[a]);return n}function Mf(e){for(var t=[],n=Of(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}function Df(e){for(var t=[],n=Of(e),r=0;r!==n.length;++r)t[e[n[r]]]=parseInt(n[r],10);return t}var Lf=new Date(1899,11,30,0,0,0);function Ff(e,t){var n=e.getTime();return t&&(n-=1263168e5),(n-(Lf.getTime()+6e4*(e.getTimezoneOffset()-Lf.getTimezoneOffset())))/864e5}var jf=new Date,Uf=Lf.getTime()+6e4*(jf.getTimezoneOffset()-Lf.getTimezoneOffset()),Bf=jf.getTimezoneOffset();function Hf(e){var t=new Date;return t.setTime(24*e*60*60*1e3+Uf),t.getTimezoneOffset()!==Bf&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-Bf)),t}var zf=new Date("2017-02-19T19:06:09.000Z"),qf=isNaN(zf.getFullYear())?new Date("2/19/17"):zf,Wf=2017==qf.getFullYear();function Vf(e,t){var n=new Date(e);if(Wf)return t>0?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):t<0&&n.setTime(n.getTime()-60*n.getTimezoneOffset()*1e3),n;if(e instanceof Date)return e;if(1917==qf.getFullYear()&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-60*i.getTimezoneOffset()*1e3)),i}function Kf(e,t){if(xh&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return gm(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return gm(vh(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return gm(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return gm(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,function(e){return n[e]||e})}catch(i){}for(var r=[],a=0;a!=e.length;++a)r.push(String.fromCharCode(e[a]));return r.join("")}function Gf(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=Gf(e[n]));return t}function Yf(e,t){for(var n="";n.length<t;)n+=e;return n}function $f(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return isNaN(t=Number(r))?(r=r.replace(/[(](.*)[)]/,function(e,t){return n=-n,t}),isNaN(t=Number(r))?t:t/n):t/n}var Qf=["january","february","march","april","may","june","july","august","september","october","november","december"];function Jf(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return n;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==Qf.indexOf(s))return n}else if(s.match(/[a-z]/))return n;return r<0||r>8099?n:(a>0||i>1)&&101!=r?t:e.match(/[^-0-9:,\/\\]/)?n:t}function Xf(e,t,n){if(e.FullPaths){var r;if("string"==typeof n)return r=xh?kh(n):function(e){for(var t=[],n=0,r=e.length+250,a=Ch(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[n++]=s;else if(s<2048)a[n++]=192|s>>6&31,a[n++]=128|63&s;else if(s>=55296&&s<57344){s=64+(1023&s);var o=1023&e.charCodeAt(++i);a[n++]=240|s>>8&7,a[n++]=128|s>>2&63,a[n++]=128|o>>6&15|(3&s)<<4,a[n++]=128|63&o}else a[n++]=224|s>>12&15,a[n++]=128|s>>6&63,a[n++]=128|63&s;n>r&&(t.push(a.slice(0,n)),n=0,a=Ch(65535),r=65530)}return t.push(a.slice(0,n)),_h(t)}(n),If.utils.cfb_add(e,t,r);If.utils.cfb_add(e,t,n)}else e.file(t,n)}function Zf(){return If.utils.cfb_new()}var em='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n';var tm={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},nm=Mf(tm),rm=/[&<>'"]/g,am=/[\u0000-\u0008\u000b-\u001f]/g;function im(e){return(e+"").replace(rm,function(e){return nm[e]}).replace(am,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function sm(e){return im(e).replace(/ /g,"_x0020_")}var om=/[\u0000-\u001f]/g;function lm(e){return(e+"").replace(rm,function(e){return nm[e]}).replace(/\n/g,"<br/>").replace(om,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function cm(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function um(e){for(var t="",n=0,r=0,a=0,i=0,s=0,o=0;n<e.length;)(r=e.charCodeAt(n++))<128?t+=String.fromCharCode(r):(a=e.charCodeAt(n++),r>191&&r<224?(s=(31&r)<<6,s|=63&a,t+=String.fromCharCode(s)):(i=e.charCodeAt(n++),r<240?t+=String.fromCharCode((15&r)<<12|(63&a)<<6|63&i):(o=((7&r)<<18|(63&a)<<12|(63&i)<<6|63&(s=e.charCodeAt(n++)))-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(1023&o)))));return t}function dm(e){var t,n,r,a=Ch(2*e.length),i=1,s=0,o=0;for(n=0;n<e.length;n+=i)i=1,(r=e.charCodeAt(n))<128?t=r:r<224?(t=64*(31&r)+(63&e.charCodeAt(n+1)),i=2):r<240?(t=4096*(15&r)+64*(63&e.charCodeAt(n+1))+(63&e.charCodeAt(n+2)),i=3):(i=4,t=262144*(7&r)+4096*(63&e.charCodeAt(n+1))+64*(63&e.charCodeAt(n+2))+(63&e.charCodeAt(n+3)),o=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==o&&(a[s++]=255&o,a[s++]=o>>>8,o=0),a[s++]=t%256,a[s++]=t>>>8;return a.slice(0,s).toString("ucs2")}function hm(e){return kh(e,"binary").toString("utf8")}var fm="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",mm=xh&&(hm(fm)==um(fm)&&hm||dm(fm)==um(fm)&&dm)||um,gm=xh?function(e){return kh(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,a=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(63&r)));break;case r>=55296&&r<57344:r-=55296,a=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(63&a)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(63&r)))}return t.join("")},pm=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<e.length;++r)n=n.replace(e[r][0],e[r][1]);return n}}();var vm=/(^\s|\s$|\n)/;function ym(e,t){return"<"+e+(t.match(vm)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function bm(e){return Of(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function wm(e,t,n){return"<"+e+(null!=n?bm(n):"")+(null!=t?(t.match(vm)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Sm(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(n){if(t)throw n}return""}var Tm="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",Am="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",xm="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",km="http://schemas.openxmlformats.org/package/2006/content-types",Cm="http://schemas.openxmlformats.org/package/2006/relationships",Em="http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",Im="http://purl.org/dc/elements/1.1/",Nm="http://purl.org/dc/terms/",Pm="http://purl.org/dc/dcmitype/",_m="http://schemas.openxmlformats.org/officeDocument/2006/relationships",Om="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",Rm="http://www.w3.org/2001/XMLSchema-instance",Mm="http://www.w3.org/2001/XMLSchema",Dm=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Lm="urn:schemas-microsoft-com:office:office",Fm="urn:schemas-microsoft-com:office:excel",jm="urn:schemas-microsoft-com:office:spreadsheet",Um="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",Bm="http://macVmlSchemaUri",Hm="urn:schemas-microsoft-com:vml",zm="http://www.w3.org/TR/REC-html40";var qm=function(e){for(var t=[],n=0;n<e[0].length;++n)if(e[0][n])for(var r=0,a=e[0][n].length;r<a;r+=10240)t.push.apply(t,e[0][n].slice(r,r+10240));return t},Wm=xh?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:kh(e)})):qm(e)}:qm,Vm=function(e,t,n){for(var r=[],a=t;a<n;a+=2)r.push(String.fromCharCode(hg(e,a)));return r.join("").replace(Oh,"")},Km=xh?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(Oh,""):Vm(e,t,n)}:Vm,Gm=function(e,t,n){for(var r=[],a=t;a<t+n;++a)r.push(("0"+e[a].toString(16)).slice(-2));return r.join("")},Ym=xh?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):Gm(e,t,n)}:Gm,$m=function(e,t,n){for(var r=[],a=t;a<n;a++)r.push(String.fromCharCode(dg(e,a)));return r.join("")},Qm=xh?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):$m(e,t,n)}:$m,Jm=function(e,t){var n=mg(e,t);return n>0?Qm(e,t+4,t+4+n-1):""},Xm=Jm,Zm=function(e,t){var n=mg(e,t);return n>0?Qm(e,t+4,t+4+n-1):""},eg=Zm,tg=function(e,t){var n=2*mg(e,t);return n>0?Qm(e,t+4,t+4+n-1):""},ng=tg,rg=function(e,t){var n=mg(e,t);return n>0?Km(e,t+4,t+4+n):""},ag=rg,ig=function(e,t){var n=mg(e,t);return n>0?Qm(e,t+4,t+4+n):""},sg=ig,og=function(e,t){return function(e,t){for(var n=1-2*(e[t+7]>>>7),r=((127&e[t+7])<<4)+(e[t+6]>>>4&15),a=15&e[t+6],i=5;i>=0;--i)a=256*a+e[t+i];return 2047==r?0==a?n*(1/0):NaN:(0==r?r=-1022:(r-=1023,a+=Math.pow(2,52)),n*Math.pow(2,r-52)*a)}(e,t)},lg=og,cg=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function ug(){Km=function(e,t,n){return yh.utils.decode(1200,e.slice(t,n)).replace(Oh,"")},Qm=function(e,t,n){return yh.utils.decode(65001,e.slice(t,n))},Xm=function(e,t){var n=mg(e,t);return n>0?yh.utils.decode(dh,e.slice(t+4,t+4+n-1)):""},eg=function(e,t){var n=mg(e,t);return n>0?yh.utils.decode(uh,e.slice(t+4,t+4+n-1)):""},ng=function(e,t){var n=2*mg(e,t);return n>0?yh.utils.decode(1200,e.slice(t+4,t+4+n-1)):""},ag=function(e,t){var n=mg(e,t);return n>0?yh.utils.decode(1200,e.slice(t+4,t+4+n)):""},sg=function(e,t){var n=mg(e,t);return n>0?yh.utils.decode(65001,e.slice(t+4,t+4+n)):""}}xh&&(Xm=function(e,t){if(!Buffer.isBuffer(e))return Jm(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},eg=function(e,t){if(!Buffer.isBuffer(e))return Zm(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},ng=function(e,t){if(!Buffer.isBuffer(e))return tg(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},ag=function(e,t){if(!Buffer.isBuffer(e))return rg(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},sg=function(e,t){if(!Buffer.isBuffer(e))return ig(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},lg=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):og(e,t)},cg=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof yh&&ug();var dg=function(e,t){return e[t]},hg=function(e,t){return 256*e[t+1]+e[t]},fg=function(e,t){var n=256*e[t+1]+e[t];return n<32768?n:-1*(65535-n+1)},mg=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},gg=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},pg=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function vg(e,t){var n,r,a,i,s,o,l="",c=[];switch(t){case"dbcs":if(o=this.l,xh&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(s=0;s<e;++s)l+=String.fromCharCode(hg(this,o)),o+=2;e*=2;break;case"utf8":l=Qm(this,this.l,this.l+e);break;case"utf16le":e*=2,l=Km(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof yh)return vg.call(this,e,"dbcs");l=yh.utils.decode(uh,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=Xm(this,this.l),e=4+mg(this,this.l);break;case"lpstr-cp":l=eg(this,this.l),e=4+mg(this,this.l);break;case"lpwstr":l=ng(this,this.l),e=4+2*mg(this,this.l);break;case"lpp4":e=4+mg(this,this.l),l=ag(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+mg(this,this.l),l=sg(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(a=dg(this,this.l+e++));)c.push(bh(a));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(a=hg(this,this.l+e));)c.push(bh(a)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",o=this.l,s=0;s<e;++s){if(this.lens&&-1!==this.lens.indexOf(o))return a=dg(this,o),this.l=o+1,i=vg.call(this,e-s,a?"dbcs-cont":"sbcs-cont"),c.join("")+i;c.push(bh(hg(this,o))),o+=2}l=c.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof yh){l=yh.utils.decode(uh,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",o=this.l,s=0;s!=e;++s){if(this.lens&&-1!==this.lens.indexOf(o))return a=dg(this,o),this.l=o+1,i=vg.call(this,e-s,a?"dbcs-cont":"sbcs-cont"),c.join("")+i;c.push(bh(dg(this,o))),o+=1}l=c.join("");break;default:switch(e){case 1:return n=dg(this,this.l),this.l++,n;case 2:return n=("i"===t?fg:hg)(this,this.l),this.l+=2,n;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(n=(e>0?gg:pg)(this,this.l),this.l+=4,n):(r=mg(this,this.l),this.l+=4,r);case 8:case-8:if("f"===t)return r=8==e?lg(this,this.l):lg([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;e=8;case 16:l=Ym(this,this.l,e)}}return this.l+=e,l}var yg=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},bg=function(e,t,n){e[n]=255&t,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},wg=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255};function Sg(e,t,n){var r=0,a=0;if("dbcs"===n){for(a=0;a!=t.length;++a)wg(this,t.charCodeAt(a),this.l+2*a);r=2*t.length}else if("sbcs"===n){if("undefined"!==typeof yh&&874==dh)for(a=0;a!=t.length;++a){var i=yh.utils.encode(dh,t.charAt(a));this[this.l+a]=i[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=255&t.charCodeAt(a);r=t.length}else{if("hex"===n){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}if("utf16le"===n){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=255&o,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}switch(e){case 1:r=1,this[this.l]=255&t;break;case 2:r=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:r=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:r=4,yg(this,t,this.l);break;case 8:if(r=8,"f"===n){!function(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=r?-t:t;isFinite(s)?0==s?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[n+o]=255&i;e[n+6]=(15&a)<<4|15&i,e[n+7]=a>>4|r}(this,t,this.l);break}case 16:break;case-4:r=4,bg(this,t,this.l)}}return this.l+=r,this}function Tg(e,t){var n=Ym(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function Ag(e,t){e.l=t,e.read_shift=vg,e.chk=Tg,e.write_shift=Sg}function xg(e,t){e.l+=t}function kg(e){var t=Ch(e);return Ag(t,0),t}function Cg(){var e=[],t=xh?256:2048,n=function(e){var t=kg(e);return Ag(t,0),t},r=n(t),a=function(){r&&(r.length>r.l&&((r=r.slice(0,r.l)).l=r.length),r.length>0&&e.push(r),r=null)},i=function(e){return r&&e<r.length-r.l?r:(a(),r=n(Math.max(e+1,t)))};return{next:i,push:function(e){a(),null==(r=e).l&&(r.l=r.length),i(t)},end:function(){return a(),_h(e)},_bufs:e}}function Eg(e,t,n,r){var a,i=+t;if(!isNaN(i)){r||(r=zb[i].p||(n||[]).length||0),a=1+(i>=128?1:0)+1,r>=128&&++a,r>=16384&&++a,r>=2097152&&++a;var s=e.next(a);i<=127?s.write_shift(1,i):(s.write_shift(1,128+(127&i)),s.write_shift(1,i>>7));for(var o=0;4!=o;++o){if(!(r>=128)){s.write_shift(1,r);break}s.write_shift(1,128+(127&r)),r>>=7}r>0&&cg(n)&&e.push(n)}}function Ig(e,t,n){var r=Gf(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function Ng(e,t,n){var r=Gf(e);return r.s=Ig(r.s,t.s,n),r.e=Ig(r.e,t.s,n),r}function Pg(e,t){if(e.cRel&&e.c<0)for(e=Gf(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Gf(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=Fg(e);return e.cRel||null==e.cRel||(n=n.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(n=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(n)),n}function _g(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?Pg(e.s,t.biff)+":"+Pg(e.e,t.biff):(e.s.rRel?"":"$")+Rg(e.s.r)+":"+(e.e.rRel?"":"$")+Rg(e.e.r):(e.s.cRel?"":"$")+Dg(e.s.c)+":"+(e.e.cRel?"":"$")+Dg(e.e.c)}function Og(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function Rg(e){return""+(e+1)}function Mg(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function Dg(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Lg(e){for(var t=0,n=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(n=26*n+(a-64))}return{c:n-1,r:t-1}}function Fg(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function jg(e){var t=e.indexOf(":");return-1==t?{s:Lg(e),e:Lg(e)}:{s:Lg(e.slice(0,t)),e:Lg(e.slice(t+1))}}function Ug(e,t){return"undefined"===typeof t||"number"===typeof t?Ug(e.s,e.e):("string"!==typeof e&&(e=Fg(e)),"string"!==typeof t&&(t=Fg(t)),e==t?e:e+":"+t)}function Bg(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,a=0,i=e.length;for(n=0;r<i&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.s.c=--n,n=0;r<i&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;if(t.s.r=--n,r===i||10!=a)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=i&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.e.c=--n,n=0;r!=i&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;return t.e.r=--n,t}function Hg(e,t){var n="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=Tf(e.z,n?Ff(t):t)}catch(r){}try{return e.w=Tf((e.XF||{}).numFmtId||(n?14:0),n?Ff(t):t)}catch(r){return""+t}}function zg(e,t,n){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),"e"==e.t?Ap[e.v]||e.v:Hg(e,void 0==t?e.v:t))}function qg(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function Wg(e,t,n){var r=n||{},a=e?Array.isArray(e):r.dense;var i=e||(a?[]:{}),s=0,o=0;if(i&&null!=r.origin){if("number"==typeof r.origin)s=r.origin;else{var l="string"==typeof r.origin?Lg(r.origin):r.origin;s=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=Bg(i["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),-1==s&&(c.e.r=s=u.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if("undefined"!==typeof t[d][h]){var f={v:t[d][h]},m=s+d,g=o+h;if(c.s.r>m&&(c.s.r=m),c.s.c>g&&(c.s.c=g),c.e.r<m&&(c.e.r=m),c.e.c<g&&(c.e.c=g),!t[d][h]||"object"!==typeof t[d][h]||Array.isArray(t[d][h])||t[d][h]instanceof Date)if(Array.isArray(f.v)&&(f.f=t[d][h][1],f.v=f.v[0]),null===f.v)if(f.f)f.t="n";else if(r.nullError)f.t="e",f.v=0;else{if(!r.sheetStubs)continue;f.t="z"}else"number"===typeof f.v?f.t="n":"boolean"===typeof f.v?f.t="b":f.v instanceof Date?(f.z=r.dateNF||qh[14],r.cellDates?(f.t="d",f.w=Tf(f.z,Ff(f.v))):(f.t="n",f.v=Ff(f.v),f.w=Tf(f.z,f.v))):f.t="s";else f=t[d][h];if(a)i[m]||(i[m]=[]),i[m][g]&&i[m][g].z&&(f.z=i[m][g].z),i[m][g]=f;else{var p=Fg({c:g,r:m});i[p]&&i[p].z&&(f.z=i[p].z),i[p]=f}}}return c.s.c<1e7&&(i["!ref"]=Ug(c)),i}function Vg(e,t){return Wg(null,e,t)}function Kg(e,t){return t||(t=kg(4)),t.write_shift(4,e),t}function Gg(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function Yg(e,t){var n=!1;return null==t&&(n=!0,t=kg(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}function $g(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Qg(e,t){var n=e.l,r=e.read_shift(1),a=Gg(e),i=[],s={t:a,h:a};if(0!==(1&r)){for(var o=e.read_shift(4),l=0;l!=o;++l)i.push($g(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=n+t,s}var Jg=Qg;function Xg(e,t){var n=!1;return null==t&&(n=!0,t=kg(23+4*e.t.length)),t.write_shift(1,1),Yg(e.t,t),t.write_shift(4,1),function(e,t){t||(t=kg(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0)}({ich:0,ifnt:0},t),n?t.slice(0,t.l):t}function Zg(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function ep(e,t){return null==t&&(t=kg(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function tp(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function np(e,t){return null==t&&(t=kg(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var rp=Gg,ap=Yg;function ip(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}function sp(e,t){var n=!1;return null==t&&(n=!0,t=kg(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}var op=Gg,lp=ip,cp=sp;function up(e){var t=e.slice(e.l,e.l+4),n=1&t[0],r=2&t[0];e.l+=4;var a=0===r?lg([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):gg(t,0)>>2;return n?a/100:a}function dp(e,t){null==t&&(t=kg(4));var n=0,r=0,a=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?r=1:a==(0|a)&&a>=-(1<<29)&&a<1<<29&&(r=1,n=1),!r)throw new Error("unsupported RkNumber "+e);t.write_shift(-4,((n?a:e)<<2)+(n+2))}function hp(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var fp=hp,mp=function(e,t){return t||(t=kg(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t};function gp(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function pp(e,t){return(t||kg(8)).write_shift(8,e,"f")}function vp(e,t){if(t||(t=kg(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),t.write_shift(2,n),e.rgb&&null==e.theme){var r=e.rgb||"FFFFFF";"number"==typeof r&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}var yp=80,bp={1:{n:"CodePage",t:2},2:{n:"Category",t:yp},3:{n:"PresentationFormat",t:yp},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:yp},15:{n:"Company",t:yp},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:yp},27:{n:"ContentStatus",t:yp},28:{n:"Language",t:yp},29:{n:"Version",t:yp},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},wp={1:{n:"CodePage",t:2},2:{n:"Title",t:yp},3:{n:"Subject",t:yp},4:{n:"Author",t:yp},5:{n:"Keywords",t:yp},6:{n:"Comments",t:yp},7:{n:"Template",t:yp},8:{n:"LastAuthor",t:yp},9:{n:"RevNumber",t:yp},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:yp},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}};function Sp(e){return e.map(function(e){return[e>>16&255,e>>8&255,255&e]})}var Tp=Gf(Sp([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),Ap={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},xp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},kp={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Cp(e,t){var n,r=function(e){for(var t=[],n=Of(e),r=0;r!==n.length;++r)null==t[e[n[r]]]&&(t[e[n[r]]]=[]),t[e[n[r]]].push(n[r]);return t}(xp),a=[];a[a.length]=em,a[a.length]=wm("Types",null,{xmlns:km,"xmlns:xsd":Mm,"xmlns:xsi":Rm}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(e){return wm("Default",null,{Extension:e[0],ContentType:e[1]})}));var i=function(r){e[r]&&e[r].length>0&&(n=e[r][0],a[a.length]=wm("Override",null,{PartName:("/"==n[0]?"":"/")+n,ContentType:kp[r][t.bookType]||kp[r].xlsx}))},s=function(n){(e[n]||[]).forEach(function(e){a[a.length]=wm("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:kp[n][t.bookType]||kp[n].xlsx})})},o=function(t){(e[t]||[]).forEach(function(e){a[a.length]=wm("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:r[t][0]})})};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var Ep={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ip(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Np(e){var t=[em,wm("Relationships",null,{xmlns:Cm})];return Of(e["!id"]).forEach(function(n){t[t.length]=wm("Relationship",null,e["!id"][n])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Pp(e,t,n,r,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=r,a.Target=n,i?a.TargetMode=i:[Ep.HLINK,Ep.XPATH,Ep.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}function _p(e,t,n){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function Op(e,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+'"/>\n',"  </rdf:Description>\n"].join("")}function Rp(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ch.version+"</meta:generator></office:meta></office:document-meta>"}var Mp=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Dp(e,t,n,r,a){null==a[e]&&null!=t&&""!==t&&(a[e]=t,t=im(t),r[r.length]=n?wm(e,t,n):ym(e,t))}function Lp(e,t){var n=t||{},r=[em,wm("cp:coreProperties",null,{"xmlns:cp":Tm,"xmlns:dc":Im,"xmlns:dcterms":Nm,"xmlns:dcmitype":Pm,"xmlns:xsi":Rm})],a={};if(!e&&!n.Props)return r.join("");e&&(null!=e.CreatedDate&&Dp("dcterms:created","string"===typeof e.CreatedDate?e.CreatedDate:Sm(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,a),null!=e.ModifiedDate&&Dp("dcterms:modified","string"===typeof e.ModifiedDate?e.ModifiedDate:Sm(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,a));for(var i=0;i!=Mp.length;++i){var s=Mp[i],o=n.Props&&null!=n.Props[s[1]]?n.Props[s[1]]:e?e[s[1]]:null;!0===o?o="1":!1===o?o="0":"number"==typeof o&&(o=String(o)),null!=o&&Dp(s[0],o,null,r,a)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var Fp=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],jp=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Up(e){var t=[],n=wm;return e||(e={}),e.Application="SheetJS",t[t.length]=em,t[t.length]=wm("Properties",null,{xmlns:xm,"xmlns:vt":Om}),Fp.forEach(function(r){if(void 0!==e[r[1]]){var a;switch(r[2]){case"string":a=im(String(e[r[1]]));break;case"bool":a=e[r[1]]?"true":"false"}void 0!==a&&(t[t.length]=n(r[0],a))}}),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map(function(e){return"<vt:lpstr>"+im(e)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function Bp(e){var t=[em,wm("Properties",null,{xmlns:Am,"xmlns:vt":Om})];if(!e)return t.join("");var n=1;return Of(e).forEach(function(r){++n,t[t.length]=wm("property",function(e,t){switch(typeof e){case"string":var n=wm("vt:lpwstr",im(e));return t&&(n=n.replace(/&quot;/g,"_x0022_")),n;case"number":return wm((0|e)==e?"vt:i4":"vt:r8",im(String(e)));case"boolean":return wm("vt:bool",e?"true":"false")}if(e instanceof Date)return wm("vt:filetime",Sm(e));throw new Error("Unable to serialize "+e)}(e[r],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:im(r)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Hp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function zp(e,t){var n=kg(4),r=kg(4);switch(n.write_shift(4,80==e?31:e),e){case 3:r.write_shift(-4,t);break;case 5:(r=kg(8)).write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=function(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,n=t%Math.pow(2,32),r=(t-n)/Math.pow(2,32);r*=1e7;var a=(n*=1e7)/Math.pow(2,32)|0;a>0&&(n%=Math.pow(2,32),r+=a);var i=kg(8);return i.write_shift(4,n),i.write_shift(4,r),i}(t);break;case 31:case 80:for((r=kg(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return _h([n,r])}var qp=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Wp(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function Vp(e,t,n){var r=kg(8),a=[],i=[],s=8,o=0,l=kg(8),c=kg(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),i.push(l),a.push(c),s+=8+l.length,!t){(c=kg(8)).write_shift(4,0),a.unshift(c);var u=[kg(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var d=e[o][0];for((l=kg(8+2*(d.length+1)+(d.length%2?0:2))).write_shift(4,o+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=_h(u),i.unshift(l),s+=8+l.length}for(o=0;o<e.length;++o)if((!t||t[e[o][0]])&&!(qp.indexOf(e[o][0])>-1||jp.indexOf(e[o][0])>-1)&&null!=e[o][1]){var h=e[o][1],f=0;if(t){var m=n[f=+t[e[o][0]]];if("version"==m.p&&"string"==typeof h){var g=h.split(".");h=(+g[0]<<16)+(+g[1]||0)}l=zp(m.t,h)}else{var p=Wp(h);-1==p&&(p=31,h=String(h)),l=zp(p,h)}i.push(l),(c=kg(8)).write_shift(4,t?f:2+o),a.push(c),s+=8+l.length}var v=8*(i.length+1);for(o=0;o<i.length;++o)a[o].write_shift(4,v),v+=i[o].length;return r.write_shift(4,s),r.write_shift(4,i.length),_h([r].concat(a).concat(i))}function Kp(e,t,n,r,a,i){var s=kg(a?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,If.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var l=Vp(e,n,r);if(o.push(l),a){var c=Vp(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+l.length),o.push(c)}return _h(o)}function Gp(e,t){return 1===e.read_shift(t)}function Yp(e,t){return t||(t=kg(2)),t.write_shift(2,+!!e),t}function $p(e){return e.read_shift(2,"u")}function Qp(e,t){return t||(t=kg(2)),t.write_shift(2,e),t}function Jp(e,t,n){return n||(n=kg(2)),n.write_shift(1,"e"==t?+e:+!!e),n.write_shift(1,"e"==t?1:0),n}function Xp(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),a="sbcs-cont",i=uh;(n&&n.biff>=8&&(uh=1200),n&&8!=n.biff)?12==n.biff&&(a="wstr"):e.read_shift(1)&&(a="dbcs-cont");n.biff>=2&&n.biff<=5&&(a="cpstr");var s=r?e.read_shift(r,a):"";return uh=i,s}function Zp(e){var t=e.t||"",n=kg(3);n.write_shift(2,t.length),n.write_shift(1,1);var r=kg(2*t.length);return r.write_shift(2*t.length,t,"utf16le"),_h([n,r])}function ev(e,t,n){if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function tv(e,t,n){var r=e.read_shift(n&&2==n.biff?1:2);return 0===r?(e.l++,""):ev(e,r,n)}function nv(e,t,n){if(n.biff>5)return tv(e,0,n);var r=e.read_shift(1);return 0===r?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function rv(e,t,n){return n||(n=kg(3+2*e.length)),n.write_shift(2,e.length),n.write_shift(1,1),n.write_shift(31,e,"utf16le"),n}function av(e,t){t||(t=kg(6+2*e.length)),t.write_shift(4,1+e.length);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function iv(e){var t=kg(512),n=0,r=e.Target;"file://"==r.slice(0,7)&&(r=r.slice(7));var a=r.indexOf("#"),i=a>-1?31:23;switch(r.charAt(0)){case"#":i=28;break;case".":i&=-3}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(n=0;n<s.length;++n)t.write_shift(4,s[n]);if(28==i)av(r=r.slice(1),t);else if(2&i){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<s.length;++n)t.write_shift(1,parseInt(s[n],16));var o=a>-1?r.slice(0,a):r;for(t.write_shift(4,2*(o.length+1)),n=0;n<o.length;++n)t.write_shift(2,o.charCodeAt(n));t.write_shift(2,0),8&i&&av(a>-1?r.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<s.length;++n)t.write_shift(1,parseInt(s[n],16));for(var l=0;"../"==r.slice(3*l,3*l+3)||"..\\"==r.slice(3*l,3*l+3);)++l;for(t.write_shift(2,l),t.write_shift(4,r.length-3*l+1),n=0;n<r.length-3*l;++n)t.write_shift(1,255&r.charCodeAt(n+3*l));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),n=0;n<6;++n)t.write_shift(4,0)}return t.slice(0,t.l)}function sv(e,t,n,r){return r||(r=kg(6)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,n||0),r}function ov(e,t,n){var r=n.biff>8?4:2;return[e.read_shift(r),e.read_shift(r,"i"),e.read_shift(r,"i")]}function lv(e){var t=e.read_shift(2),n=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:n}}}function cv(e,t){return t||(t=kg(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function uv(e,t,n){var r=1536,a=16;switch(n.bookType){case"biff8":case"xla":break;case"biff5":r=1280,a=8;break;case"biff4":r=4,a=6;break;case"biff3":r=3,a=6;break;case"biff2":r=2,a=4;break;default:throw new Error("unsupported BIFF version")}var i=kg(a);return i.write_shift(2,r),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function dv(e,t){var n=!t||t.biff>=8?2:1,r=kg(8+n*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(n*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=r.slice(0,r.l);return a.l=r.l,a}function hv(e,t,n,r){var a=n&&5==n.biff;r||(r=kg(a?3+t.length:5+2*t.length)),r.write_shift(2,e),r.write_shift(a?1:2,t.length),a||r.write_shift(1,1),r.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=r.length>r.l?r.slice(0,r.l):r;return null==i.l&&(i.l=i.length),i}function fv(e,t,n,r){var a=n&&5==n.biff;r||(r=kg(a?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),r.write_shift(4,i),r.write_shift(4,0),a||r.write_shift(4,0),r.write_shift(2,0),r}function mv(e,t,n){if(n.biff<8)return function(e,t,n){3==e[e.l+1]&&e[e.l]++;var r=Xp(e,0,n);return 3==r.charCodeAt(0)?r.slice(1):r}(e,0,n);for(var r=[],a=e.l+t,i=e.read_shift(n.biff>8?4:2);0!==i--;)r.push(ov(e,n.biff,n));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return r}function gv(e){var t=kg(24),n=Lg(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(r[a],16));return _h([t,iv(e[1])])}function pv(e){var t=e[1].Tooltip,n=kg(10+2*(t.length+1));n.write_shift(2,2048);var r=Lg(e[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var a=0;a<t.length;++a)n.write_shift(2,t.charCodeAt(a));return n.write_shift(2,0),n}function vv(e,t,n){if(!n.cellStyles)return xg(e,t);var r=n&&n.biff>=12?4:2,a=e.read_shift(r),i=e.read_shift(r),s=e.read_shift(r),o=e.read_shift(r),l=e.read_shift(2);2==r&&(e.l+=2);var c={s:a,e:i,w:s,ixfe:o,flags:l};return(n.biff>=5||!n.biff)&&(c.level=l>>8&7),c}var yv=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Mf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(t,n){var r=n||{};r.dateNF||(r.dateNF="yyyymmdd");var a=Vg(function(t,n){var r=[],a=Ch(1);switch(n.type){case"base64":a=Ih(Ah(t));break;case"binary":a=Ih(t);break;case"buffer":case"array":a=t}Ag(a,0);var i=a.read_shift(1),s=!!(136&i),o=!1,l=!1;switch(i){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:o=!0,s=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+i.toString(16))}var c=0,u=521;2==i&&(c=a.read_shift(2)),a.l+=3,2!=i&&(c=a.read_shift(4)),c>1048576&&(c=1e6),2!=i&&(u=a.read_shift(2));var d=a.read_shift(2),h=n.codepage||1252;2!=i&&(a.l+=16,a.read_shift(1),0!==a[a.l]&&(h=e[a[a.l]]),a.l+=1,a.l+=2),l&&(a.l+=36);for(var f=[],m={},g=Math.min(a.length,2==i?521:u-10-(o?264:0)),p=l?32:11;a.l<g&&13!=a[a.l];)switch((m={}).name=yh.utils.decode(h,a.slice(a.l,a.l+p)).replace(/[\u0000\r\n].*$/g,""),a.l+=p,m.type=String.fromCharCode(a.read_shift(1)),2==i||l||(m.offset=a.read_shift(4)),m.len=a.read_shift(1),2==i&&(m.offset=a.read_shift(2)),m.dec=a.read_shift(1),m.name.length&&f.push(m),2!=i&&(a.l+=l?13:14),m.type){case"B":o&&8==m.len||!n.WTF||console.log("Skipping "+m.name+":"+m.type);break;case"G":case"P":n.WTF&&console.log("Skipping "+m.name+":"+m.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+m.type)}if(13!==a[a.l]&&(a.l=u-1),13!==a.read_shift(1))throw new Error("DBF Terminator not found "+a.l+" "+a[a.l]);a.l=u;var v=0,y=0;for(r[0]=[],y=0;y!=f.length;++y)r[0][y]=f[y].name;for(;c-- >0;)if(42!==a[a.l])for(++a.l,r[++v]=[],y=0,y=0;y!=f.length;++y){var b=a.slice(a.l,a.l+f[y].len);a.l+=f[y].len,Ag(b,0);var w=yh.utils.decode(h,b);switch(f[y].type){case"C":w.trim().length&&(r[v][y]=w.replace(/\s+$/,""));break;case"D":8===w.length?r[v][y]=new Date(+w.slice(0,4),+w.slice(4,6)-1,+w.slice(6,8)):r[v][y]=w;break;case"F":r[v][y]=parseFloat(w.trim());break;case"+":case"I":r[v][y]=l?2147483648^b.read_shift(-4,"i"):b.read_shift(4,"i");break;case"L":switch(w.trim().toUpperCase()){case"Y":case"T":r[v][y]=!0;break;case"N":case"F":r[v][y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+w+"|")}break;case"M":if(!s)throw new Error("DBF Unexpected MEMO for type "+i.toString(16));r[v][y]="##MEMO##"+(l?parseInt(w.trim(),10):b.read_shift(4));break;case"N":(w=w.replace(/\u0000/g,"").trim())&&"."!=w&&(r[v][y]=+w||0);break;case"@":r[v][y]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":r[v][y]=new Date(864e5*(b.read_shift(4)-2440588)+b.read_shift(4));break;case"Y":r[v][y]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":r[v][y]=-b.read_shift(-8,"f");break;case"B":if(o&&8==f[y].len){r[v][y]=b.read_shift(8,"f");break}case"G":case"P":b.l+=f[y].len;break;case"0":if("_NullFlags"===f[y].name)break;default:throw new Error("DBF Unsupported data type "+f[y].type)}}else a.l+=d;if(2!=i&&a.l<a.length&&26!=a[a.l++])throw new Error("DBF EOF Marker missing "+(a.l-1)+" of "+a.length+" "+a[a.l-1].toString(16));return n&&n.sheetRows&&(r=r.slice(0,n.sheetRows)),n.DBF=f,r}(t,r),r);return a["!cols"]=r.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete r.DBF,a}var r={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return qg(n(e,t),t)}catch(r){if(t&&t.WTF)throw r}return{SheetNames:[],Sheets:{}}},to_sheet:n,from_sheet:function(e,n){var a=n||{};if(+a.codepage>=0&&gh(+a.codepage),"string"==a.type)throw new Error("Cannot write DBF to JS string");var i=Cg(),s=Uw(e,{header:1,raw:!0,cellDates:!0}),o=s[0],l=s.slice(1),c=e["!cols"]||[],u=0,d=0,h=0,f=1;for(u=0;u<o.length;++u)if(((c[u]||{}).DBF||{}).name)o[u]=c[u].DBF.name,++h;else if(null!=o[u]){if(++h,"number"===typeof o[u]&&(o[u]=o[u].toString(10)),"string"!==typeof o[u])throw new Error("DBF Invalid column name "+o[u]+" |"+typeof o[u]+"|");if(o.indexOf(o[u])!==u)for(d=0;d<1024;++d)if(-1==o.indexOf(o[u]+"_"+d)){o[u]+="_"+d;break}}var m=Bg(e["!ref"]),g=[],p=[],v=[];for(u=0;u<=m.e.c-m.s.c;++u){var y="",b="",w=0,S=[];for(d=0;d<l.length;++d)null!=l[d][u]&&S.push(l[d][u]);if(0!=S.length&&null!=o[u]){for(d=0;d<S.length;++d){switch(typeof S[d]){case"number":b="B";break;case"string":default:b="C";break;case"boolean":b="L";break;case"object":b=S[d]instanceof Date?"D":"C"}w=Math.max(w,String(S[d]).length),y=y&&y!=b?"C":b}w>250&&(w=250),"C"==(b=((c[u]||{}).DBF||{}).type)&&c[u].DBF.len>w&&(w=c[u].DBF.len),"B"==y&&"N"==b&&(y="N",v[u]=c[u].DBF.dec,w=c[u].DBF.len),p[u]="C"==y||"N"==b?w:r[y]||0,f+=p[u],g[u]=y}else g[u]="?"}var T=i.next(32);for(T.write_shift(4,318902576),T.write_shift(4,l.length),T.write_shift(2,296+32*h),T.write_shift(2,f),u=0;u<4;++u)T.write_shift(4,0);for(T.write_shift(4,(+t[dh]||3)<<8),u=0,d=0;u<o.length;++u)if(null!=o[u]){var A=i.next(32),x=(o[u].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);A.write_shift(1,x,"sbcs"),A.write_shift(1,"?"==g[u]?"C":g[u],"sbcs"),A.write_shift(4,d),A.write_shift(1,p[u]||r[g[u]]||0),A.write_shift(1,v[u]||0),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(1,0),A.write_shift(4,0),A.write_shift(4,0),d+=p[u]||r[g[u]]||0}var k=i.next(264);for(k.write_shift(4,13),u=0;u<65;++u)k.write_shift(4,0);for(u=0;u<l.length;++u){var C=i.next(f);for(C.write_shift(1,0),d=0;d<o.length;++d)if(null!=o[d])switch(g[d]){case"L":C.write_shift(1,null==l[u][d]?63:l[u][d]?84:70);break;case"B":C.write_shift(8,l[u][d]||0,"f");break;case"N":var E="0";for("number"==typeof l[u][d]&&(E=l[u][d].toFixed(v[d]||0)),h=0;h<p[d]-E.length;++h)C.write_shift(1,32);C.write_shift(1,E,"sbcs");break;case"D":l[u][d]?(C.write_shift(4,("0000"+l[u][d].getFullYear()).slice(-4),"sbcs"),C.write_shift(2,("00"+(l[u][d].getMonth()+1)).slice(-2),"sbcs"),C.write_shift(2,("00"+l[u][d].getDate()).slice(-2),"sbcs")):C.write_shift(8,"00000000","sbcs");break;case"C":var I=String(null!=l[u][d]?l[u][d]:"").slice(0,p[d]);for(C.write_shift(1,I,"sbcs"),h=0;h<p[d]-I.length;++h)C.write_shift(1,32)}}return i.next(1).write_shift(1,26),i.end()}}}(),bv=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+Of(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(t,n){var r=e[n];return"number"==typeof r?wh(r):r},r=function(e,t,n){var r=t.charCodeAt(0)-32<<4|n.charCodeAt(0)-48;return 59==r?e:wh(r)};function a(e,a){var i,s=e.split(/[\n\r]+/),o=-1,l=-1,c=0,u=0,d=[],h=[],f=null,m={},g=[],p=[],v=[],y=0;for(+a.codepage>=0&&gh(+a.codepage);c!==s.length;++c){y=0;var b,w=s[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),S=w.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),T=S[0];if(w.length>0)switch(T){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==S[1].charAt(0)&&h.push(w.slice(3).replace(/;;/g,";"));break;case"C":var A=!1,x=!1,k=!1,C=!1,E=-1,I=-1;for(u=1;u<S.length;++u)switch(S[u].charAt(0)){case"A":case"G":break;case"X":l=parseInt(S[u].slice(1))-1,x=!0;break;case"Y":for(o=parseInt(S[u].slice(1))-1,x||(l=0),i=d.length;i<=o;++i)d[i]=[];break;case"K":'"'===(b=S[u].slice(1)).charAt(0)?b=b.slice(1,b.length-1):"TRUE"===b?b=!0:"FALSE"===b?b=!1:isNaN($f(b))?isNaN(Jf(b).getDate())||(b=Vf(b)):(b=$f(b),null!==f&&yf(f)&&(b=Hf(b))),"undefined"!==typeof yh&&"string"==typeof b&&"string"!=(a||{}).type&&(a||{}).codepage&&(b=yh.utils.decode(a.codepage,b)),A=!0;break;case"E":C=!0;var N=uy(S[u].slice(1),{r:o,c:l});d[o][l]=[d[o][l],N];break;case"S":k=!0,d[o][l]=[d[o][l],"S5S"];break;case"R":E=parseInt(S[u].slice(1))-1;break;case"C":I=parseInt(S[u].slice(1))-1;break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}if(A&&(d[o][l]&&2==d[o][l].length?d[o][l][0]=b:d[o][l]=b,f=null),k){if(C)throw new Error("SYLK shared formula cannot have own formula");var P=E>-1&&d[E][I];if(!P||!P[1])throw new Error("SYLK shared formula cannot find base");d[o][l][1]=fy(P[1],{r:o-E,c:l-I})}break;case"F":var _=0;for(u=1;u<S.length;++u)switch(S[u].charAt(0)){case"X":l=parseInt(S[u].slice(1))-1,++_;break;case"Y":for(o=parseInt(S[u].slice(1))-1,i=d.length;i<=o;++i)d[i]=[];break;case"M":y=parseInt(S[u].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":f=h[parseInt(S[u].slice(1))];break;case"W":for(v=S[u].slice(1).split(" "),i=parseInt(v[0],10);i<=parseInt(v[1],10);++i)y=parseInt(v[2],10),p[i-1]=0===y?{hidden:!0}:{wch:y},Lv(p[i-1]);break;case"C":p[l=parseInt(S[u].slice(1))-1]||(p[l]={});break;case"R":g[o=parseInt(S[u].slice(1))-1]||(g[o]={}),y>0?(g[o].hpt=y,g[o].hpx=Uv(y)):0===y&&(g[o].hidden=!0);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}_<1&&(f=null);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}}return g.length>0&&(m["!rows"]=g),p.length>0&&(m["!cols"]=p),a&&a.sheetRows&&(d=d.slice(0,a.sheetRows)),[d,m]}function i(e,t){var n=function(e,t){switch(t.type){case"base64":return a(Ah(e),t);case"binary":return a(e,t);case"buffer":return a(xh&&Buffer.isBuffer(e)?e.toString("binary"):Ph(e),t);case"array":return a(Kf(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),r=n[0],i=n[1],s=Vg(r,t);return Of(i).forEach(function(e){s[e]=i[e]}),s}function s(e,t,n,r){var a="C;Y"+(n+1)+";X"+(r+1)+";K";switch(e.t){case"n":a+=e.v||0,e.f&&!e.F&&(a+=";E"+hy(e.f,{r:n,c:r}));break;case"b":a+=e.v?"TRUE":"FALSE";break;case"e":a+=e.w||e.v;break;case"d":a+='"'+(e.w||e.v)+'"';break;case"s":a+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return a}return e["|"]=254,{to_workbook:function(e,t){return qg(i(e,t),t)},to_sheet:i,from_sheet:function(e,t){var n,r,a=["ID;PWXL;N;E"],i=[],o=Bg(e["!ref"]),l=Array.isArray(e),c="\r\n";a.push("P;PGeneral"),a.push("F;P0;DG0G8;M255"),e["!cols"]&&(r=a,e["!cols"].forEach(function(e,t){var n="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?n+="0":("number"!=typeof e.width||e.wpx||(e.wpx=Rv(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=Mv(e.wpx)),"number"==typeof e.wch&&(n+=Math.round(e.wch)))," "!=n.charAt(n.length-1)&&r.push(n)})),e["!rows"]&&function(e,t){t.forEach(function(t,n){var r="F;";t.hidden?r+="M0;":t.hpt?r+="M"+20*t.hpt+";":t.hpx&&(r+="M"+20*jv(t.hpx)+";"),r.length>2&&e.push(r+"R"+(n+1))})}(a,e["!rows"]),a.push("B;Y"+(o.e.r-o.s.r+1)+";X"+(o.e.c-o.s.c+1)+";D"+[o.s.c,o.s.r,o.e.c,o.e.r].join(" "));for(var u=o.s.r;u<=o.e.r;++u)for(var d=o.s.c;d<=o.e.c;++d){var h=Fg({r:u,c:d});(n=l?(e[u]||[])[d]:e[h])&&(null!=n.v||n.f&&!n.F)&&i.push(s(n,0,u,d))}return a.join(c)+c+i.join(c)+c+"E"+c}}}(),wv=function(){function e(e,t){for(var n=e.split("\n"),r=-1,a=-1,i=0,s=[];i!==n.length;++i)if("BOT"!==n[i].trim()){if(!(r<0)){for(var o=n[i].trim().split(","),l=o[0],c=o[1],u=n[++i]||"";1&(u.match(/["]/g)||[]).length&&i<n.length-1;)u+="\n"+n[++i];switch(u=u.trim(),+l){case-1:if("BOT"===u){s[++r]=[],a=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?s[r][a]=!0:"FALSE"===u?s[r][a]=!1:isNaN($f(c))?isNaN(Jf(c).getDate())?s[r][a]=c:s[r][a]=Vf(c):s[r][a]=$f(c),++a;break;case 1:(u=(u=u.slice(1,u.length-1)).replace(/""/g,'"'))&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),s[r][a++]=""!==u?u:null}if("EOD"===u)break}}else s[++r]=[],a=0;return t&&t.sheetRows&&(s=s.slice(0,t.sheetRows)),s}function t(t,n){return Vg(function(t,n){switch(n.type){case"base64":return e(Ah(t),n);case"binary":return e(t,n);case"buffer":return e(xh&&Buffer.isBuffer(t)?t.toString("binary"):Ph(t),n);case"array":return e(Kf(t),n)}throw new Error("Unrecognized type "+n.type)}(t,n),n)}return{to_workbook:function(e,n){return qg(t(e,n),n)},to_sheet:t,from_sheet:function(){var e=function(e,t,n,r,a){e.push(t),e.push(n+","+r),e.push('"'+a.replace(/"/g,'""')+'"')},t=function(e,t,n,r){e.push(t+","+n),e.push(1==t?'"'+r.replace(/"/g,'""')+'"':r)};return function(n){var r,a=[],i=Bg(n["!ref"]),s=Array.isArray(n);e(a,"TABLE",0,1,"sheetjs"),e(a,"VECTORS",0,i.e.r-i.s.r+1,""),e(a,"TUPLES",0,i.e.c-i.s.c+1,""),e(a,"DATA",0,0,"");for(var o=i.s.r;o<=i.e.r;++o){t(a,-1,0,"BOT");for(var l=i.s.c;l<=i.e.c;++l){var c=Fg({r:o,c:l});if(r=s?(n[o]||[])[l]:n[c])switch(r.t){case"n":var u=r.w;u||null==r.v||(u=r.v),null==u?r.f&&!r.F?t(a,1,0,"="+r.f):t(a,1,0,""):t(a,0,u,"V");break;case"b":t(a,0,r.v?1:0,r.v?"TRUE":"FALSE");break;case"s":t(a,1,0,isNaN(r.v)?r.v:'="'+r.v+'"');break;case"d":r.w||(r.w=Tf(r.z||qh[14],Ff(Vf(r.v)))),t(a,0,r.w,"V");break;default:t(a,1,0,"")}else t(a,1,0,"")}}t(a,-1,0,"EOD");return a.join("\r\n")}}()}}(),Sv=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function t(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(t,n){return Vg(function(t,n){for(var r=t.split("\n"),a=-1,i=-1,s=0,o=[];s!==r.length;++s){var l=r[s].trim().split(":");if("cell"===l[0]){var c=Lg(l[1]);if(o.length<=c.r)for(a=o.length;a<=c.r;++a)o[a]||(o[a]=[]);switch(a=c.r,i=c.c,l[2]){case"t":o[a][i]=e(l[3]);break;case"v":o[a][i]=+l[3];break;case"vtf":var u=l[l.length-1];case"vtc":"nl"===l[3]?o[a][i]=!!+l[4]:o[a][i]=+l[4],"vtf"==l[2]&&(o[a][i]=[o[a][i],u])}}}return n&&n.sheetRows&&(o=o.slice(0,n.sheetRows)),o}(t,n),n)}var r=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",i=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),s="--SocialCalcSpreadsheetControlSave--";function o(e){if(!e||!e["!ref"])return"";for(var n,r=[],a=[],i="",s=jg(e["!ref"]),o=Array.isArray(e),l=s.s.r;l<=s.e.r;++l)for(var c=s.s.c;c<=s.e.c;++c)if(i=Fg({r:l,c:c}),(n=o?(e[l]||[])[c]:e[i])&&null!=n.v&&"z"!==n.t){switch(a=["cell",i,"t"],n.t){case"s":case"str":a.push(t(n.v));break;case"n":n.f?(a[2]="vtf",a[3]="n",a[4]=n.v,a[5]=t(n.f)):(a[2]="v",a[3]=n.v);break;case"b":a[2]="vt"+(n.f?"f":"c"),a[3]="nl",a[4]=n.v?"1":"0",a[5]=t(n.f||(n.v?"TRUE":"FALSE"));break;case"d":var u=Ff(Vf(n.v));a[2]="vtc",a[3]="nd",a[4]=""+u,a[5]=n.w||Tf(n.z||qh[14],u);break;case"e":continue}r.push(a.join(":"))}return r.push("sheet:c:"+(s.e.c-s.s.c+1)+":r:"+(s.e.r-s.s.r+1)+":tvf:1"),r.push("valueformat:1:text-wiki"),r.join("\n")}return{to_workbook:function(e,t){return qg(n(e,t),t)},to_sheet:n,from_sheet:function(e){return[r,a,i,a,o(e),s].join("\n")}}}(),Tv=function(){function e(e,t,n,r,a){a.raw?t[n][r]=e:""===e||("TRUE"===e?t[n][r]=!0:"FALSE"===e?t[n][r]=!1:isNaN($f(e))?isNaN(Jf(e).getDate())?t[n][r]=e:t[n][r]=Vf(e):t[n][r]=$f(e))}var t={44:",",9:"\t",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function r(e){for(var r={},a=!1,i=0,s=0;i<e.length;++i)34==(s=e.charCodeAt(i))?a=!a:!a&&s in t&&(r[s]=(r[s]||0)+1);for(i in s=[],r)Object.prototype.hasOwnProperty.call(r,i)&&s.push([r[i],i]);if(!s.length)for(i in r=n)Object.prototype.hasOwnProperty.call(r,i)&&s.push([r[i],i]);return s.sort(function(e,t){return e[0]-t[0]||n[e[1]]-n[t[1]]}),t[s.pop()[1]]||44}function a(e,t){var n=t||{},a="";var i=n.dense?[]:{},s={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(a=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(a=e.charAt(4),e=e.slice(6)):a=r(e.slice(0,1024)):a=n&&n.FS?n.FS:r(e.slice(0,1024));var o=0,l=0,c=0,u=0,d=0,h=a.charCodeAt(0),f=!1,m=0,g=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var p=null!=n.dateNF?function(e){var t="number"==typeof e?qh[e]:e;return t=t.replace(Cf,"(\\d+)"),new RegExp("^"+t+"$")}(n.dateNF):null;function v(){var t=e.slice(u,d),r={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)r.t="z";else if(n.raw)r.t="s",r.v=t;else if(0===t.trim().length)r.t="s",r.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(r.t="s",r.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(r.t="n",r.f=t.slice(1)):(r.t="s",r.v=t);else if("TRUE"==t)r.t="b",r.v=!0;else if("FALSE"==t)r.t="b",r.v=!1;else if(isNaN(c=$f(t)))if(!isNaN(Jf(t).getDate())||p&&t.match(p)){r.z=n.dateNF||qh[14];var a=0;p&&t.match(p)&&(t=function(e,t,n){var r=-1,a=-1,i=-1,s=-1,o=-1,l=-1;(t.match(Cf)||[]).forEach(function(e,t){var c=parseInt(n[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":r=c;break;case"d":i=c;break;case"h":s=c;break;case"s":l=c;break;case"m":s>=0?o=c:a=c}}),l>=0&&-1==o&&a>=0&&(o=a,a=-1);var c=(""+(r>=0?r:(new Date).getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==s&&-1==o&&-1==l?c:-1==r&&-1==a&&-1==i?u:c+"T"+u}(0,n.dateNF,t.match(p)||[]),a=1),n.cellDates?(r.t="d",r.v=Vf(t,a)):(r.t="n",r.v=Ff(Vf(t,a))),!1!==n.cellText&&(r.w=Tf(r.z,r.v instanceof Date?Ff(r.v):r.v)),n.cellNF||delete r.z}else r.t="s",r.v=t;else r.t="n",!1!==n.cellText&&(r.w=t),r.v=c;if("z"==r.t||(n.dense?(i[o]||(i[o]=[]),i[o][l]=r):i[Fg({c:l,r:o})]=r),u=d+1,g=e.charCodeAt(u),s.e.c<l&&(s.e.c=l),s.e.r<o&&(s.e.r=o),m==h)++l;else if(l=0,++o,n.sheetRows&&n.sheetRows<=o)return!0}e:for(;d<e.length;++d)switch(m=e.charCodeAt(d)){case 34:34===g&&(f=!f);break;case h:case 10:case 13:if(!f&&v())break e}return d-u>0&&v(),i["!ref"]=Ug(s),i}function i(t,n){return n&&n.PRN?n.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?a(t,n):Vg(function(t,n){var r=n||{},a=[];if(!t||0===t.length)return a;for(var i=t.split(/[\r\n]/),s=i.length-1;s>=0&&0===i[s].length;)--s;for(var o=10,l=0,c=0;c<=s;++c)-1==(l=i[c].indexOf(" "))?l=i[c].length:l++,o=Math.max(o,l);for(c=0;c<=s;++c){a[c]=[];var u=0;for(e(i[c].slice(0,o).trim(),a,c,u,r),u=1;u<=(i[c].length-o)/10+1;++u)e(i[c].slice(o+10*(u-1),o+10*u).trim(),a,c,u,r)}return r.sheetRows&&(a=a.slice(0,r.sheetRows)),a}(t,n),n):a(t,n)}function s(e,t){var n="",r="string"==t.type?[0,0,0,0]:_w(e,t);switch(t.type){case"base64":n=Ah(e);break;case"binary":case"string":n=e;break;case"buffer":n=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof yh?yh.utils.decode(t.codepage,e):xh&&Buffer.isBuffer(e)?e.toString("binary"):Ph(e);break;case"array":n=Kf(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]?n=mm(n.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?n=mm(n):"binary"==t.type&&"undefined"!==typeof yh&&t.codepage&&(n=yh.utils.decode(t.codepage,yh.utils.encode(28591,n))),"socialcalc:version:"==n.slice(0,19)?Sv.to_sheet("string"==t.type?n:mm(n),t):i(n,t)}return{to_workbook:function(e,t){return qg(s(e,t),t)},to_sheet:s,from_sheet:function(e){for(var t,n=[],r=Bg(e["!ref"]),a=Array.isArray(e),i=r.s.r;i<=r.e.r;++i){for(var s=[],o=r.s.c;o<=r.e.c;++o){var l=Fg({r:i,c:o});if((t=a?(e[i]||[])[o]:e[l])&&null!=t.v){for(var c=(t.w||(zg(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";s.push(c+(0===o?" ":""))}else s.push("          ")}n.push(s.join(""))}return n.join("\n")}}}();var Av=function(){function e(e,t,n){if(e){Ag(e,e.l||0);for(var r=n.Enum||v;e.l<e.length;){var a=e.read_shift(2),i=r[a]||r[65535],s=e.read_shift(2),o=e.l+s,l=i.f&&i.f(e,s,n);if(e.l=o,t(l,i,a))return}}}function t(t,n){if(!t)return t;var r=n||{};var a=r.dense?[]:{},i="Sheet1",s="",o=0,l={},c=[],u=[],d={s:{r:0,c:0},e:{r:0,c:0}},h=r.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])r.Enum=v,e(t,function(e,t,n){switch(n){case 0:r.vers=e,e>=4096&&(r.qpro=!0);break;case 6:d=e;break;case 204:e&&(s=e);break;case 222:s=e;break;case 15:case 51:r.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==n&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=r.dateNF||qh[14],r.cellDates&&(e[1].t="d",e[1].v=Hf(e[1].v))),r.qpro&&e[3]>o&&(a["!ref"]=Ug(d),l[i]=a,c.push(i),a=r.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],i=s||"Sheet"+(o+1),s="");var u=r.dense?(a[e[0].r]||[])[e[0].c]:a[Fg(e[0])];if(u){u.t=e[1].t,u.v=e[1].v,null!=e[1].z&&(u.z=e[1].z),null!=e[1].f&&(u.f=e[1].f);break}r.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[Fg(e[0])]=e[1]}},r);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);r.Enum=y,14==t[2]&&(r.qpro=!0,t.l=0),e(t,function(e,t,n){switch(n){case 204:i=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>o&&(a["!ref"]=Ug(d),l[i]=a,c.push(i),a=r.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],i="Sheet"+(o+1)),h>0&&e[0].r>=h)break;r.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[Fg(e[0])]=e[1],d.e.c<e[0].c&&(d.e.c=e[0].c),d.e.r<e[0].r&&(d.e.r=e[0].r);break;case 27:e[14e3]&&(u[e[14e3][0]]=e[14e3][1]);break;case 1537:u[e[0]]=e[1],e[0]==o&&(i=e[1])}},r)}if(a["!ref"]=Ug(d),l[s||i]=a,c.push(s||i),!u.length)return{SheetNames:c,Sheets:l};for(var f={},m=[],g=0;g<u.length;++g)l[c[g]]?(m.push(u[g]||c[g]),f[u[g]]=l[u[g]]||l[c[g]]):(m.push(u[g]),f[u[g]]={"!ref":"A1"});return{SheetNames:m,Sheets:f}}function n(e,t,n){var r=[{c:0,r:0},{t:"n",v:0},0,0];return n.qpro&&20768!=n.vers?(r[0].c=e.read_shift(1),r[3]=e.read_shift(1),r[0].r=e.read_shift(2),e.l+=2):(r[2]=e.read_shift(1),r[0].c=e.read_shift(2),r[0].r=e.read_shift(2)),r}function r(e,t,r){var a=e.l+t,i=n(e,0,r);if(i[1].t="s",20768==r.vers){e.l++;var s=e.read_shift(1);return i[1].v=e.read_shift(s,"utf8"),i}return r.qpro&&e.l++,i[1].v=e.read_shift(a-e.l,"cstr"),i}function a(e,t,n){var r=kg(7+n.length);r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(1,39);for(var a=0;a<r.length;++a){var i=n.charCodeAt(a);r.write_shift(1,i>=128?95:i)}return r.write_shift(1,0),r}function i(e,t,n){var r=kg(7);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,n,"i"),r}function s(e,t,n){var r=kg(13);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(8,n,"f"),r}function o(e,t,n){var r=32768&t;return t=(r?e:0)+((t&=-32769)>=8192?t-16384:t),(r?"":"$")+(n?Dg(t):Rg(t))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function u(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function d(e,t,n,r){var a=kg(6+r.length);a.write_shift(2,e),a.write_shift(1,n),a.write_shift(1,t),a.write_shift(1,39);for(var i=0;i<r.length;++i){var s=r.charCodeAt(i);a.write_shift(1,s>=128?95:s)}return a.write_shift(1,0),a}function h(e,t){var n=u(e),r=e.read_shift(4),a=e.read_shift(4),i=e.read_shift(2);if(65535==i)return 0===r&&3221225472===a?(n[1].t="e",n[1].v=15):0===r&&3489660928===a?(n[1].t="e",n[1].v=42):n[1].v=0,n;var s=32768&i;return i=(32767&i)-16446,n[1].v=(1-2*s)*(a*Math.pow(2,i+32)+r*Math.pow(2,i)),n}function f(e,t,n,r){var a=kg(14);if(a.write_shift(2,e),a.write_shift(1,n),a.write_shift(1,t),0==r)return a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,65535),a;var i,s=0,o=0,l=0;return r<0&&(s=1,r=-r),o=0|Math.log2(r),0==(2147483648&(l=(r/=Math.pow(2,o-31))>>>0))&&(++o,l=(r/=2)>>>0),r-=l,l|=2147483648,l>>>=0,i=(r*=Math.pow(2,32))>>>0,a.write_shift(4,i),a.write_shift(4,l),o+=16383+(s?32768:0),a.write_shift(2,o),a}function m(e,t){var n=u(e),r=e.read_shift(8,"f");return n[1].v=r,n}function g(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function p(e,t){var n=kg(5+e.length);n.write_shift(2,14e3),n.write_shift(2,t);for(var r=0;r<e.length;++r){var a=e.charCodeAt(r);n[n.l++]=a>127?95:a}return n[n.l++]=0,n}var v={0:{n:"BOF",f:$p},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,n){var r={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&n.qpro?(r.s.c=e.read_shift(1),e.l++,r.s.r=e.read_shift(2),r.e.c=e.read_shift(1),e.l++,r.e.r=e.read_shift(2),r):(r.s.c=e.read_shift(2),r.s.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),r.e.c=e.read_shift(2),r.e.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),65535==r.s.c&&(r.s.c=r.e.c=r.s.r=r.e.r=0),r)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,r){var a=n(e,0,r);return a[1].v=e.read_shift(2,"i"),a}},14:{n:"NUMBER",f:function(e,t,r){var a=n(e,0,r);return a[1].v=e.read_shift(8,"f"),a}},15:{n:"LABEL",f:r},16:{n:"FORMULA",f:function(e,t,r){var a=e.l+t,i=n(e,0,r);if(i[1].v=e.read_shift(8,"f"),r.qpro)e.l=a;else{var s=e.read_shift(2);!function(e,t){Ag(e,0);var n=[],r=0,a="",i="",s="",u="";for(;e.l<e.length;){var d=e[e.l++];switch(d){case 0:n.push(e.read_shift(8,"f"));break;case 1:i=o(t[0].c,e.read_shift(2),!0),a=o(t[0].r,e.read_shift(2),!1),n.push(i+a);break;case 2:var h=o(t[0].c,e.read_shift(2),!0),f=o(t[0].r,e.read_shift(2),!1);i=o(t[0].c,e.read_shift(2),!0),a=o(t[0].r,e.read_shift(2),!1),n.push(h+f+":"+i+a);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:n.push("("+n.pop()+")");break;case 5:n.push(e.read_shift(2));break;case 6:for(var m="";d=e[e.l++];)m+=String.fromCharCode(d);n.push('"'+m.replace(/"/g,'""')+'"');break;case 8:n.push("-"+n.pop());break;case 23:n.push("+"+n.pop());break;case 22:n.push("NOT("+n.pop()+")");break;case 20:case 21:u=n.pop(),s=n.pop(),n.push(["AND","OR"][d-20]+"("+s+","+u+")");break;default:if(d<32&&c[d])u=n.pop(),s=n.pop(),n.push(s+c[d]+u);else{if(!l[d])return d<=7?console.error("WK1 invalid opcode "+d.toString(16)):d<=24?console.error("WK1 unsupported op "+d.toString(16)):d<=30?console.error("WK1 invalid opcode "+d.toString(16)):d<=115?console.error("WK1 unsupported function opcode "+d.toString(16)):console.error("WK1 unrecognized opcode "+d.toString(16));if(69==(r=l[d][1])&&(r=e[e.l++]),r>n.length)return void console.error("WK1 bad formula parse 0x"+d.toString(16)+":|"+n.join("|")+"|");var g=n.slice(-r);n.length-=r,n.push(l[d][0]+"("+g.join(",")+")")}}}1==n.length?t[1].f=""+n[0]:console.error("WK1 bad formula parse |"+n.join("|")+"|")}(e.slice(e.l,e.l+s),i),e.l+=s}return i}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:r},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:g},222:{n:"SHEETNAMELP",f:function(e,t){var n=e[e.l++];n>t-1&&(n=t-1);for(var r="";r.length<n;)r+=String.fromCharCode(e[e.l++]);return r}},65535:{n:""}},y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var n=u(e);return n[1].t="s",n[1].v=e.read_shift(t-4,"cstr"),n}},23:{n:"NUMBER17",f:h},24:{n:"NUMBER18",f:function(e,t){var n=u(e);n[1].v=e.read_shift(2);var r=n[1].v>>1;if(1&n[1].v)switch(7&r){case 0:r=5e3*(r>>3);break;case 1:r=500*(r>>3);break;case 2:r=(r>>3)/20;break;case 3:r=(r>>3)/200;break;case 4:r=(r>>3)/2e3;break;case 5:r=(r>>3)/2e4;break;case 6:r=(r>>3)/16;break;case 7:r=(r>>3)/64}return n[1].v=r,n}},25:{n:"FORMULA19",f:function(e,t){var n=h(e);return e.l+=t-14,n}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var n={},r=e.l+t;e.l<r;){var a=e.read_shift(2);if(14e3==a){for(n[a]=[0,""],n[a][0]=e.read_shift(2);e[e.l];)n[a][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return n}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var n=u(e),r=e.read_shift(4);return n[1].v=r>>6,n}},38:{n:"??"},39:{n:"NUMBER27",f:m},40:{n:"FORMULA28",f:function(e,t){var n=m(e);return e.l+=t-10,n}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:g},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,n){if(n.qpro&&!(t<21)){var r=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[r,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var n=t||{};if(+n.codepage>=0&&gh(+n.codepage),"string"==n.type)throw new Error("Cannot write WK1 to JS string");var r=Cg(),o=Bg(e["!ref"]),l=Array.isArray(e),c=[];qb(r,0,function(e){var t=kg(2);return t.write_shift(2,e),t}(1030)),qb(r,6,function(e){var t=kg(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(o));for(var u=Math.min(o.e.r,8191),d=o.s.r;d<=u;++d)for(var h=Rg(d),f=o.s.c;f<=o.e.c;++f){d===o.s.r&&(c[f]=Dg(f));var m=c[f]+h,g=l?(e[d]||[])[f]:e[m];if(g&&"z"!=g.t)if("n"==g.t)(0|g.v)==g.v&&g.v>=-32768&&g.v<=32767?qb(r,13,i(d,f,g.v)):qb(r,14,s(d,f,g.v));else qb(r,15,a(d,f,zg(g).slice(0,239)))}return qb(r,1),r.end()},book_to_wk3:function(e,t){var n=t||{};if(+n.codepage>=0&&gh(+n.codepage),"string"==n.type)throw new Error("Cannot write WK3 to JS string");var r=Cg();qb(r,0,function(e){var t=kg(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var n=0,r=0,a=0,i=0;i<e.SheetNames.length;++i){var s=e.SheetNames[i],o=e.Sheets[s];if(o&&o["!ref"]){++a;var l=jg(o["!ref"]);n<l.e.r&&(n=l.e.r),r<l.e.c&&(r=l.e.c)}}n>8191&&(n=8191);return t.write_shift(2,n),t.write_shift(1,a),t.write_shift(1,r),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var a=0,i=0;a<e.SheetNames.length;++a)(e.Sheets[e.SheetNames[a]]||{})["!ref"]&&qb(r,27,p(e.SheetNames[a],i++));var s=0;for(a=0;a<e.SheetNames.length;++a){var o=e.Sheets[e.SheetNames[a]];if(o&&o["!ref"]){for(var l=Bg(o["!ref"]),c=Array.isArray(o),u=[],h=Math.min(l.e.r,8191),m=l.s.r;m<=h;++m)for(var g=Rg(m),v=l.s.c;v<=l.e.c;++v){m===l.s.r&&(u[v]=Dg(v));var y=u[v]+g,b=c?(o[m]||[])[v]:o[y];if(b&&"z"!=b.t)if("n"==b.t)qb(r,23,f(m,v,s,b.v));else qb(r,22,d(m,v,s,zg(b).slice(0,239)))}++s}}return qb(r,1),r.end()},to_workbook:function(e,n){switch(n.type){case"base64":return t(Ih(Ah(e)),n);case"binary":return t(Ih(e),n);case"buffer":case"array":return t(e,n)}throw"Unsupported type "+n.type}}}();var xv=/^\s|\s$|[\t\n\r]/;function kv(e,t){if(!t.bookSST)return"";var n=[em];n[n.length]=wm("sst",null,{xmlns:Dm[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(null!=e[r]){var a=e[r],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(xv)&&(i+=' xml:space="preserve"'),i+=">"+im(a.t)+"</t>"),i+="</si>",n[n.length]=i}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}var Cv=function(e,t){var n=!1;return null==t&&(n=!0,t=kg(15+4*e.t.length)),t.write_shift(1,0),Yg(e.t,t),n?t.slice(0,t.l):t};function Ev(e){var t=Cg();Eg(t,159,function(e,t){return t||(t=kg(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}(e));for(var n=0;n<e.length;++n)Eg(t,19,Cv(e[n]));return Eg(t,160),t.end()}function Iv(e){if("undefined"!==typeof yh)return yh.utils.encode(dh,e);for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function Nv(e){var t,n,r=0,a=Iv(e),i=a.length+1;for((t=Ch(i))[0]=a.length,n=1;n!=i;++n)t[n]=a[n-1];for(n=i-1;n>=0;--n)r=((0===(16384&r)?0:1)|r<<1&32767)^t[n];return 52811^r}var Pv=function(){function e(e,n){switch(n.type){case"base64":return t(Ah(e),n);case"binary":return t(e,n);case"buffer":return t(xh&&Buffer.isBuffer(e)?e.toString("binary"):Ph(e),n);case"array":return t(Kf(e),n)}throw new Error("Unrecognized type "+n.type)}function t(e,t){var n=(t||{}).dense?[]:{},r=e.match(/\\trowd.*?\\row\b/g);if(!r.length)throw new Error("RTF missing table");var a={s:{c:0,r:0},e:{c:0,r:r.length-1}};return r.forEach(function(e,t){Array.isArray(n)&&(n[t]=[]);for(var r,i=/\\\w+\b/g,s=0,o=-1;r=i.exec(e);){if("\\cell"===r[0]){var l=e.slice(s,i.lastIndex-r[0].length);if(" "==l[0]&&(l=l.slice(1)),++o,l.length){var c={v:l,t:"s"};Array.isArray(n)?n[t][o]=c:n[Fg({r:t,c:o})]=c}}s=i.lastIndex}o>a.e.c&&(a.e.c=o)}),n["!ref"]=Ug(a),n}return{to_workbook:function(t,n){return qg(e(t,n),n)},to_sheet:e,from_sheet:function(e){for(var t,n=["{\\rtf1\\ansi"],r=Bg(e["!ref"]),a=Array.isArray(e),i=r.s.r;i<=r.e.r;++i){n.push("\\trowd\\trautofit1");for(var s=r.s.c;s<=r.e.c;++s)n.push("\\cellx"+(s+1));for(n.push("\\pard\\intbl"),s=r.s.c;s<=r.e.c;++s){var o=Fg({r:i,c:s});(t=a?(e[i]||[])[s]:e[o])&&(null!=t.v||t.f&&!t.F)&&(n.push(" "+(t.w||(zg(t),t.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}}}();function _v(e){for(var t=0,n=1;3!=t;++t)n=256*n+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}var Ov=6;function Rv(e){return Math.floor((e+Math.round(128/Ov)/256)*Ov)}function Mv(e){return Math.floor((e-5)/Ov*100+.5)/100}function Dv(e){return Math.round((e*Ov+5)/Ov*256)/256}function Lv(e){e.width?(e.wpx=Rv(e.width),e.wch=Mv(e.wpx),e.MDW=Ov):e.wpx?(e.wch=Mv(e.wpx),e.width=Dv(e.wch),e.MDW=Ov):"number"==typeof e.wch&&(e.width=Dv(e.wch),e.wpx=Rv(e.width),e.MDW=Ov),e.customWidth&&delete e.customWidth}var Fv=96;function jv(e){return 96*e/Fv}function Uv(e){return e*Fv/96}function Bv(e,t){var n,r=[em,wm("styleSheet",null,{xmlns:Dm[0],"xmlns:vt":Om})];return e.SSF&&null!=(n=function(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)null!=e[r]&&(t[t.length]=wm("numFmt",null,{numFmtId:r,formatCode:im(e[r])}))}),1===t.length?"":(t[t.length]="</numFmts>",t[0]=wm("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(e.SSF))&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=function(e){var t=[];return t[t.length]=wm("cellXfs",null),e.forEach(function(e){t[t.length]=wm("xf",null,e)}),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=wm("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Hv(e,t,n){n||(n=kg(6+4*t.length)),n.write_shift(2,e),Yg(t,n);var r=n.length>n.l?n.slice(0,n.l):n;return null==n.l&&(n.l=n.length),r}function zv(e,t){t||(t=kg(153)),t.write_shift(2,20*e.sz),function(e,t){t||(t=kg(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);t.write_shift(1,n),t.write_shift(1,0)}(e,t),t.write_shift(2,e.bold?700:400);var n=0;"superscript"==e.vertAlign?n=1:"subscript"==e.vertAlign&&(n=2),t.write_shift(2,n),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),vp(e.color,t);var r=0;return"major"==e.scheme&&(r=1),"minor"==e.scheme&&(r=2),t.write_shift(1,r),Yg(e.name,t),t.length>t.l?t.slice(0,t.l):t}var qv,Wv=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Vv=xg;function Kv(e,t){t||(t=kg(84)),qv||(qv=Mf(Wv));var n=qv[e.patternType];null==n&&(n=40),t.write_shift(4,n);var r=0;if(40!=n)for(vp({auto:1},t),vp({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Gv(e,t,n){n||(n=kg(16)),n.write_shift(2,t||0),n.write_shift(2,e.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);return n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function Yv(e,t){return t||(t=kg(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var $v=xg;function Qv(e){var t;Eg(e,613,Kg(1)),Eg(e,46,(t||(t=kg(51)),t.write_shift(1,0),Yv(0,t),Yv(0,t),Yv(0,t),Yv(0,t),Yv(0,t),t.length>t.l?t.slice(0,t.l):t)),Eg(e,614)}function Jv(e){var t,n;Eg(e,619,Kg(1)),Eg(e,48,(t={xfId:0,builtinId:0,name:"Normal"},n||(n=kg(52)),n.write_shift(4,t.xfId),n.write_shift(2,1),n.write_shift(1,+t.builtinId),n.write_shift(1,0),sp(t.name||"",n),n.length>n.l?n.slice(0,n.l):n)),Eg(e,620)}function Xv(e){Eg(e,508,function(e,t,n){var r=kg(2052);return r.write_shift(4,e),sp(t,r),sp(n,r),r.length>r.l?r.slice(0,r.l):r}(0,"TableStyleMedium9","PivotStyleMedium4")),Eg(e,509)}function Zv(e,t){var n=Cg();return Eg(n,278),function(e,t){if(t){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var r=e[0];r<=e[1];++r)null!=t[r]&&++n}),0!=n&&(Eg(e,615,Kg(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)null!=t[r]&&Eg(e,44,Hv(r,t[r]))}),Eg(e,616))}}(n,e.SSF),function(e){Eg(e,611,Kg(1)),Eg(e,43,zv({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Eg(e,612)}(n),function(e){Eg(e,603,Kg(2)),Eg(e,45,Kv({patternType:"none"})),Eg(e,45,Kv({patternType:"gray125"})),Eg(e,604)}(n),Qv(n),function(e){Eg(e,626,Kg(1)),Eg(e,47,Gv({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Eg(e,627)}(n),function(e,t){Eg(e,617,Kg(t.length)),t.forEach(function(t){Eg(e,47,Gv(t,0))}),Eg(e,618)}(n,t.cellXfs),Jv(n),function(e){Eg(e,505,Kg(0)),Eg(e,506)}(n),Xv(n),Eg(n,279),n.end()}function ey(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var n=[em];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function ty(){var e=Cg();return Eg(e,332),Eg(e,334,Kg(1)),Eg(e,335,function(e){var t=kg(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Yg(e.name,t),t.slice(0,t.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),Eg(e,336),Eg(e,339,function(e,t){var n=kg(8+2*t.length);return n.write_shift(4,e),Yg(t,n),n.slice(0,n.l)}(1,"XLDAPR")),Eg(e,52),Eg(e,35,Kg(514)),Eg(e,4096,Kg(0)),Eg(e,4097,Qp(1)),Eg(e,36),Eg(e,53),Eg(e,340),Eg(e,337,function(e,t){var n=kg(8);return n.write_shift(4,e),n.write_shift(4,t?1:0),n}(1,!0)),Eg(e,51,function(e){var t=kg(4+8*e.length);t.write_shift(4,e.length);for(var n=0;n<e.length;++n)t.write_shift(4,e[n][0]),t.write_shift(4,e[n][1]);return t}([[1,0]])),Eg(e,338),Eg(e,333),e.end()}function ny(){var e=[em];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var ry=1024;function ay(e,t){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),a=[wm("xml",null,{"xmlns:v":Hm,"xmlns:o":Lm,"xmlns:x":Fm,"xmlns:mv":Bm}).replace(/\/>/,">"),wm("o:shapelayout",wm("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),wm("v:shapetype",[wm("v:stroke",null,{joinstyle:"miter"}),wm("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];ry<1e3*e;)ry+=1e3;return t.forEach(function(e){var t=Lg(e[0]),n={color2:"#BEFF82",type:"gradient"};"gradient"==n.type&&(n.angle="-180");var r="gradient"==n.type?wm("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,i=wm("v:fill",r,n);++ry,a=a.concat(["<v:shape"+bm({id:"_x0000_s"+ry,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",i,wm("v:shadow",null,{on:"t",obscured:"t"}),wm("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ym("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),ym("x:AutoFill","False"),ym("x:Row",String(t.r)),ym("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function iy(e){var t=[em,wm("comments",null,{xmlns:Dm[0]})],n=[];return t.push("<authors>"),e.forEach(function(e){e[1].forEach(function(e){var r=im(e.a);-1==n.indexOf(r)&&(n.push(r),t.push("<author>"+r+"</author>")),e.T&&e.ID&&-1==n.indexOf("tc="+e.ID)&&(n.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))})}),0==n.length&&(n.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(e){var r=0,a=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?r=n.indexOf("tc="+e[1][0].ID):e[1].forEach(function(e){e.a&&(r=n.indexOf(im(e.a))),a.push(e.t||"")}),t.push('<comment ref="'+e[0]+'" authorId="'+r+'"><text>'),a.length<=1)t.push(ym("t",im(a[0]||"")));else{for(var i="Comment:\n    "+a[0]+"\n",s=1;s<a.length;++s)i+="Reply:\n    "+a[s]+"\n";t.push(ym("t",im(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function sy(e,t,n){var r=[em,wm("ThreadedComments",null,{xmlns:Em}).replace(/[\/]>/,">")];return e.forEach(function(e){var a="";(e[1]||[]).forEach(function(i,s){if(i.T){i.a&&-1==t.indexOf(i.a)&&t.push(i.a);var o={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};0==s?a=o.id:o.parentId=a,i.ID=o.id,i.a&&(o.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),r.push(wm("threadedComment",ym("text",i.t||""),o))}else delete i.ID})}),r.push("</ThreadedComments>"),r.join("")}var oy=Gg;function ly(e){var t=Cg(),n=[];return Eg(t,628),Eg(t,630),e.forEach(function(e){e[1].forEach(function(e){n.indexOf(e.a)>-1||(n.push(e.a.slice(0,54)),Eg(t,632,function(e){return Yg(e.slice(0,54))}(e.a)))})}),Eg(t,631),Eg(t,633),e.forEach(function(e){e[1].forEach(function(r){r.iauthor=n.indexOf(r.a);var a={s:Lg(e[0]),e:Lg(e[0])};Eg(t,635,function(e,t){return null==t&&(t=kg(36)),t.write_shift(4,e[1].iauthor),mp(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}([a,r])),r.t&&r.t.length>0&&Eg(t,637,Xg(r)),Eg(t,636),delete r.iauthor})}),Eg(t,634),Eg(t,629),t.end()}var cy=["xlsb","xlsm","xlam","biff8","xla"];var uy=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(e,n,r,a){var i=!1,s=!1;0==r.length?s=!0:"["==r.charAt(0)&&(s=!0,r=r.slice(1,-1)),0==a.length?i=!0:"["==a.charAt(0)&&(i=!0,a=a.slice(1,-1));var o=r.length>0?0|parseInt(r,10):0,l=a.length>0?0|parseInt(a,10):0;return i?l+=t.c:--l,s?o+=t.r:--o,n+(i?"":"$")+Dg(l)+(s?"":"$")+Rg(o)}return function(r,a){return t=a,r.replace(e,n)}}(),dy=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,hy=function(){return function(e,t){return e.replace(dy,function(e,n,r,a,i,s){var o=Mg(a)-(r?0:t.c),l=Og(s)-(i?0:t.r);return n+"R"+(0==l?"":i?l+1:"["+l+"]")+"C"+(0==o?"":r?o+1:"["+o+"]")})}}();function fy(e,t){return e.replace(dy,function(e,n,r,a,i,s){return n+("$"==r?r+a:Dg(Mg(a)+t.c))+("$"==i?i+s:Rg(Og(s)+t.r))})}function my(e){e.l+=1}function gy(e,t){var n=e.read_shift(1==t?1:2);return[16383&n,n>>14&1,n>>15&1]}function py(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return vy(e);12==n.biff&&(r=4)}var a=e.read_shift(r),i=e.read_shift(r),s=gy(e,2),o=gy(e,2);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function vy(e){var t=gy(e,2),n=gy(e,2),r=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:a,cRel:n[1],rRel:n[2]}}}function yy(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return function(e){var t=gy(e,2),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}(e);var r=e.read_shift(n&&12==n.biff?4:2),a=gy(e,2);return{r:r,c:a[0],cRel:a[1],rRel:a[2]}}function by(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:255&n,fQuoted:!!(16384&n),cRel:n>>15,rRel:n>>15}}function wy(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function Sy(e){return[e.read_shift(1),e.read_shift(1)]}function Ty(e,t){var n=[e.read_shift(1)];if(12==t)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2}switch(n[0]){case 4:n[1]=Gp(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:n[1]=Ap[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:n[1]=gp(e);break;case 2:n[1]=nv(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function Ay(e,t,n){for(var r=e.read_shift(12==n.biff?4:2),a=[],i=0;i!=r;++i)a.push((12==n.biff?fp:lv)(e,8));return a}function xy(e,t,n){var r=0,a=0;12==n.biff?(r=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,0==--a&&(a=256));for(var i=0,s=[];i!=r&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=Ty(e,n.biff);return s}function ky(e,t,n){return e.l+=2,[by(e)]}function Cy(e){return e.l+=6,[]}function Ey(e){return e.l+=2,[$p(e),1&e.read_shift(2)]}var Iy=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var Ny={1:{n:"PtgExp",f:function(e,t,n){return e.l++,n&&12==n.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(n&&2==n.biff?1:2)]}},2:{n:"PtgTbl",f:xg},3:{n:"PtgAdd",f:my},4:{n:"PtgSub",f:my},5:{n:"PtgMul",f:my},6:{n:"PtgDiv",f:my},7:{n:"PtgPower",f:my},8:{n:"PtgConcat",f:my},9:{n:"PtgLt",f:my},10:{n:"PtgLe",f:my},11:{n:"PtgEq",f:my},12:{n:"PtgGe",f:my},13:{n:"PtgGt",f:my},14:{n:"PtgNe",f:my},15:{n:"PtgIsect",f:my},16:{n:"PtgUnion",f:my},17:{n:"PtgRange",f:my},18:{n:"PtgUplus",f:my},19:{n:"PtgUminus",f:my},20:{n:"PtgPercent",f:my},21:{n:"PtgParen",f:my},22:{n:"PtgMissArg",f:my},23:{n:"PtgStr",f:function(e,t,n){return e.l++,Xp(e,0,n)}},26:{n:"PtgSheet",f:function(e,t,n){return e.l+=5,e.l+=2,e.l+=2==n.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,n){return e.l+=2==n.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,Ap[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,gp(e)}},32:{n:"PtgArray",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=2==n.biff?6:12==n.biff?14:7,[r]}},33:{n:"PtgFunc",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(n&&n.biff<=3?1:2);return[Yy[a],Gy[a],r]}},34:{n:"PtgFuncVar",f:function(e,t,n){var r=e[e.l++],a=e.read_shift(1),i=n&&n.biff<=3?[88==r?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[a,(0===i[0]?Gy:Ky)[i[1]]]}},35:{n:"PtgName",f:function(e,t,n){var r=e.read_shift(1)>>>5&3,a=!n||n.biff>=8?4:2,i=e.read_shift(a);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[r,0,i]}},36:{n:"PtgRef",f:function(e,t,n){var r=(96&e[e.l])>>5;return e.l+=1,[r,yy(e,0,n)]}},37:{n:"PtgArea",f:function(e,t,n){return[(96&e[e.l++])>>5,py(e,n.biff>=2&&n.biff,n)]}},38:{n:"PtgMemArea",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=n&&2==n.biff?3:4,[r,e.read_shift(n&&2==n.biff?1:2)]}},39:{n:"PtgMemErr",f:xg},40:{n:"PtgMemNoMem",f:xg},41:{n:"PtgMemFunc",f:function(e,t,n){return[e.read_shift(1)>>>5&3,e.read_shift(n&&2==n.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,12==n.biff&&(e.l+=2),[r]}},43:{n:"PtgAreaErr",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}},44:{n:"PtgRefN",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=function(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return function(e){var t=e.read_shift(2),n=e.read_shift(1),r=(32768&t)>>15,a=(16384&t)>>14;return t&=16383,1==r&&t>=8192&&(t-=16384),1==a&&n>=128&&(n-=256),{r:t,c:n,cRel:a,rRel:r}}(e);var a=e.read_shift(r>=12?4:2),i=e.read_shift(2),s=(16384&i)>>14,o=(32768&i)>>15;if(i&=16383,1==o)for(;a>524287;)a-=1048576;if(1==s)for(;i>8191;)i-=16384;return{r:a,c:i,cRel:s,rRel:o}}(e,0,n);return[r,a]}},45:{n:"PtgAreaN",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=function(e,t,n){if(n.biff<8)return vy(e);var r=e.read_shift(12==n.biff?4:2),a=e.read_shift(12==n.biff?4:2),i=gy(e,2),s=gy(e,2);return{s:{r:r,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}(e,0,n);return[r,a]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,n){return 5==n.biff?function(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(2);return n&&5==n.biff&&(e.l+=12),[r,a,yy(e,0,n)]}},59:{n:"PtgArea3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2,"i");if(n)switch(n.biff){case 5:e.l+=12;break;case 12:0}return[r,a,py(e,0,n)]}},60:{n:"PtgRefErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2),i=4;if(n)switch(n.biff){case 5:i=15;break;case 12:i=6}return e.l+=i,[r,a]}},61:{n:"PtgAreaErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2),i=8;if(n)switch(n.biff){case 5:e.l+=12,i=6;break;case 12:i=12}return e.l+=i,[r,a]}},255:{}},Py={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},_y={1:{n:"PtgElfLel",f:Ey},2:{n:"PtgElfRw",f:ky},3:{n:"PtgElfCol",f:ky},6:{n:"PtgElfRwV",f:ky},7:{n:"PtgElfColV",f:ky},10:{n:"PtgElfRadical",f:ky},11:{n:"PtgElfRadicalS",f:Cy},13:{n:"PtgElfColS",f:Cy},15:{n:"PtgElfColSV",f:Cy},16:{n:"PtgElfRadicalLel",f:Ey},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2);return{ixti:t,coltype:3&n,rt:Iy[n>>2&31],idx:r,c:a,C:i}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},Oy={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=n&&2==n.biff?3:4,[r]}},2:{n:"PtgAttrIf",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,n){e.l+=2;for(var r=e.read_shift(n&&2==n.biff?1:2),a=[],i=0;i<=r;++i)a.push(e.read_shift(n&&2==n.biff?1:2));return a}},8:{n:"PtgAttrGoto",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,n){e.l+=n&&2==n.biff?3:4}},32:{n:"PtgAttrBaxcel",f:wy},33:{n:"PtgAttrBaxcel",f:wy},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),Sy(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),Sy(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function Ry(e,t,n,r){if(r.biff<8)return xg(e,t);for(var a=e.l+t,i=[],s=0;s!==n.length;++s)switch(n[s][0]){case"PtgArray":n[s][1]=xy(e,0,r),i.push(n[s][1]);break;case"PtgMemArea":n[s][2]=Ay(e,n[s][1],r),i.push(n[s][2]);break;case"PtgExp":r&&12==r.biff&&(n[s][1][1]=e.read_shift(4),i.push(n[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[s][0]}return 0!==(t=a-e.l)&&i.push(xg(e,t)),i}function My(e,t,n){for(var r,a,i=e.l+t,s=[];i!=e.l;)t=i-e.l,a=e[e.l],r=Ny[a]||Ny[Py[a]],24!==a&&25!==a||(r=(24===a?_y:Oy)[e[e.l+1]]),r&&r.f?s.push([r.n,r.f(e,t,n)]):xg(e,t);return s}function Dy(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],a=[],i=0;i<r.length;++i){var s=r[i];if(s)if(2===s[0])a.push('"'+s[1].replace(/"/g,'""')+'"');else a.push(s[1]);else a.push("")}t.push(a.join(","))}return t.join(";")}var Ly={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Fy(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var a="";if(n.biff>8)switch(e[r[0]][0]){case 357:return a=-1==r[1]?"#REF":e.SheetNames[r[1]],r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 358:return null!=n.SID?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return a=-1==r[1]?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[r[0]][0][3]?(a=-1==r[1]?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function jy(e,t,n){var r=Fy(e,t,n);return"#REF"==r?r:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(r,n)}function Uy(e,t,n,r,a){var i,s,o,l,c=a&&a.biff||8,u={s:{c:0,r:0},e:{c:0,r:0}},d=[],h=0,f=0,m="";if(!e[0]||!e[0][0])return"";for(var g=-1,p="",v=0,y=e[0].length;v<y;++v){var b=e[0][v];switch(b[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(i=d.pop(),s=d.pop(),g>=0){switch(e[0][g][1][0]){case 0:p=Yf(" ",e[0][g][1][1]);break;case 1:p=Yf("\r",e[0][g][1][1]);break;default:if(p="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}s+=p,g=-1}d.push(s+Ly[b[0]]+i);break;case"PtgIsect":i=d.pop(),s=d.pop(),d.push(s+" "+i);break;case"PtgUnion":i=d.pop(),s=d.pop(),d.push(s+","+i);break;case"PtgRange":i=d.pop(),s=d.pop(),d.push(s+":"+i);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":o=Ig(b[1][1],u,a),d.push(Pg(o,c));break;case"PtgRefN":o=n?Ig(b[1][1],n,a):b[1][1],d.push(Pg(o,c));break;case"PtgRef3d":h=b[1][1],o=Ig(b[1][2],u,a);m=jy(r,h,a);d.push(m+"!"+Pg(o,c));break;case"PtgFunc":case"PtgFuncVar":var w=b[1][0],S=b[1][1];w||(w=0);var T=0==(w&=127)?[]:d.slice(-w);d.length-=w,"User"===S&&(S=T.shift()),d.push(S+"("+T.join(",")+")");break;case"PtgBool":d.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":d.push(b[1]);break;case"PtgNum":d.push(String(b[1]));break;case"PtgStr":d.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=Ng(b[1][1],n?{s:n}:u,a),d.push(_g(l,a));break;case"PtgArea":l=Ng(b[1][1],u,a),d.push(_g(l,a));break;case"PtgArea3d":h=b[1][1],l=b[1][2],m=jy(r,h,a),d.push(m+"!"+_g(l,a));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgName":f=b[1][2];var A=(r.names||[])[f-1]||(r[0]||[])[f],x=A?A.Name:"SH33TJSNAME"+String(f);x&&"_xlfn."==x.slice(0,6)&&!a.xlfn&&(x=x.slice(6)),d.push(x);break;case"PtgNameX":var k,C=b[1][1];if(f=b[1][2],!(a.biff<=5)){var E="";if(14849==((r[C]||[])[0]||[])[0]||(1025==((r[C]||[])[0]||[])[0]?r[C][f]&&r[C][f].itab>0&&(E=r.SheetNames[r[C][f].itab-1]+"!"):E=r.SheetNames[f-1]+"!"),r[C]&&r[C][f])E+=r[C][f].Name;else if(r[0]&&r[0][f])E+=r[0][f].Name;else{var I=(Fy(r,C,a)||"").split(";;");I[f-1]?E=I[f-1]:E+="SH33TJSERRX"}d.push(E);break}C<0&&(C=-C),r[C]&&(k=r[C][f]),k||(k={Name:"SH33TJSERRY"}),d.push(k.Name);break;case"PtgParen":var N="(",P=")";if(g>=0){switch(p="",e[0][g][1][0]){case 2:N=Yf(" ",e[0][g][1][1])+N;break;case 3:N=Yf("\r",e[0][g][1][1])+N;break;case 4:P=Yf(" ",e[0][g][1][1])+P;break;case 5:P=Yf("\r",e[0][g][1][1])+P;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}d.push(N+d.pop()+P);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":d.push("#REF!");break;case"PtgExp":o={c:b[1][1],r:b[1][0]};var _={c:n.c,r:n.r};if(r.sharedf[Fg(o)]){var O=r.sharedf[Fg(o)];d.push(Uy(O,u,_,r,a))}else{var R=!1;for(i=0;i!=r.arrayf.length;++i)if(s=r.arrayf[i],!(o.c<s[0].s.c||o.c>s[0].e.c)&&!(o.r<s[0].s.r||o.r>s[0].e.r)){d.push(Uy(s[1],u,_,r,a)),R=!0;break}R||d.push(b[1])}break;case"PtgArray":d.push("{"+Dy(b[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=v;break;case"PtgMissArg":d.push("");break;case"PtgList":d.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(b))}if(3!=a.biff&&g>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][v][0])){var M=!0;switch((b=e[0][g])[1][0]){case 4:M=!1;case 0:p=Yf(" ",b[1][1]);break;case 5:M=!1;case 1:p=Yf("\r",b[1][1]);break;default:if(p="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}d.push((M?p:"")+d.pop()+(M?"":p)),g=-1}}if(d.length>1&&a.WTF)throw new Error("bad formula stack");return d[0]}function By(e,t,n,r,a){var i=sv(t,n,a),s=function(e){if(null==e){var t=kg(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return pp("number"==typeof e?e:0)}(e.v),o=kg(6);o.write_shift(2,33),o.write_shift(4,0);for(var l=kg(e.bf.length),c=0;c<e.bf.length;++c)l[c]=e.bf[c];return _h([i,s,o,l])}function Hy(e,t,n){var r=e.read_shift(4),a=My(e,r,n),i=e.read_shift(4);return[a,i>0?Ry(e,i,a,n):null]}var zy=Hy,qy=Hy,Wy=Hy,Vy=Hy,Ky={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Gy={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Yy={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function $y(e){return("of:="+e.replace(dy,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function Qy(e){return e.replace(/\./,"!")}var Jy="undefined"!==typeof Map;function Xy(e,t,n){var r=0,a=e.length;if(n){if(Jy?n.has(t):Object.prototype.hasOwnProperty.call(n,t))for(var i=Jy?n.get(t):n[t];r<i.length;++r)if(e[i[r]].t===t)return e.Count++,i[r]}else for(;r<a;++r)if(e[r].t===t)return e.Count++,r;return e[a]={t:t},e.Count++,e.Unique++,n&&(Jy?(n.has(t)||n.set(t,[]),n.get(t).push(a)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t].push(a))),a}function Zy(e,t){var n={min:e+1,max:e+1},r=-1;return t.MDW&&(Ov=t.MDW),null!=t.width?n.customWidth=1:null!=t.wpx?r=Mv(t.wpx):null!=t.wch&&(r=t.wch),r>-1?(n.width=Dv(r),n.customWidth=1):null!=t.width&&(n.width=t.width),t.hidden&&(n.hidden=!0),null!=t.level&&(n.outlineLevel=n.level=t.level),n}function eb(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(n=[1,1,1,1,.5,.5]),null==e.left&&(e.left=n[0]),null==e.right&&(e.right=n[1]),null==e.top&&(e.top=n[2]),null==e.bottom&&(e.bottom=n[3]),null==e.header&&(e.header=n[4]),null==e.footer&&(e.footer=n[5])}}function tb(e,t,n){var r=n.revssf[null!=t.z?t.z:"General"],a=60,i=e.length;if(null==r&&n.ssf)for(;a<392;++a)if(null==n.ssf[a]){Af(t.z,a),n.ssf[a]=t.z,n.revssf[t.z]=r=a;break}for(a=0;a!=i;++a)if(e[a].numFmtId===r)return a;return e[i]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function nb(e,t,n){if(e&&e["!ref"]){var r=Bg(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}var rb=["objects","scenarios","selectLockedCells","selectUnlockedCells"],ab=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function ib(e,t,n,r){if(e.c&&n["!comments"].push([t,e.c]),void 0===e.v&&"string"!==typeof e.f||"z"===e.t&&!e.f)return"";var a="",i=e.t,s=e.v;if("z"!==e.t)switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=Ap[e.v];break;case"d":r&&r.cellDates?a=Vf(e.v,-1).toISOString():((e=Gf(e)).t="n",a=""+(e.v=Ff(Vf(e.v)))),"undefined"===typeof e.z&&(e.z=qh[14]);break;default:a=e.v}var o=ym("v",im(a)),l={r:t},c=tb(r.cellXfs,e,r);switch(0!==c&&(l.s=c),e.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){o=ym("v",""+Xy(r.Strings,e.v,r.revStrings)),l.t="s";break}l.t="str"}if(e.t!=i&&(e.t=i,e.v=s),"string"==typeof e.f&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=wm("f",im(e.f),u)+(null!=e.v?o:"")}return e.l&&n["!links"].push([t,e.l]),e.D&&(l.cm=1),wm("c",o,l)}function sb(e,t,n,r){var a,i=[em,wm("worksheet",null,{xmlns:Dm[0],"xmlns:r":_m})],s=n.SheetNames[e],o="",l=n.Sheets[s];null==l&&(l={});var c=l["!ref"]||"A1",u=Bg(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=Ug(u)}r||(r={}),l["!comments"]=[];var d=[];!function(e,t,n,r,a){var i=!1,s={},o=null;if("xlsx"!==r.bookType&&t.vbaraw){var l=t.SheetNames[n];try{t.Workbook&&(l=t.Workbook.Sheets[n].CodeName||l)}catch(u){}i=!0,s.codeName=gm(im(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+wm("outlinePr",null,c)}(i||o)&&(a[a.length]=wm("sheetPr",o,s))}(l,n,e,t,i),i[i.length]=wm("dimension",null,{ref:c}),i[i.length]=function(e,t,n,r){var a={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),wm("sheetViews",wm("sheetView",null,a),{})}(0,0,0,n),t.sheetFormat&&(i[i.length]=wm("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(i[i.length]=function(e,t){for(var n,r=["<cols>"],a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=wm("col",null,Zy(a,n)));return r[r.length]="</cols>",r.join("")}(0,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(o=function(e,t){var n,r,a=[],i=[],s=Bg(e["!ref"]),o="",l="",c=[],u=0,d=0,h=e["!rows"],f=Array.isArray(e),m={r:l},g=-1;for(d=s.s.c;d<=s.e.c;++d)c[d]=Dg(d);for(u=s.s.r;u<=s.e.r;++u){for(i=[],l=Rg(u),d=s.s.c;d<=s.e.c;++d){n=c[d]+l;var p=f?(e[u]||[])[d]:e[n];void 0!==p&&null!=(o=ib(p,n,e,t))&&i.push(o)}(i.length>0||h&&h[u])&&(m={r:l},h&&h[u]&&((r=h[u]).hidden&&(m.hidden=1),g=-1,r.hpx?g=jv(r.hpx):r.hpt&&(g=r.hpt),g>-1&&(m.ht=g,m.customHeight=1),r.level&&(m.outlineLevel=r.level)),a[a.length]=wm("row",i.join(""),m))}if(h)for(;u<h.length;++u)h&&h[u]&&(m={r:u+1},(r=h[u]).hidden&&(m.hidden=1),g=-1,r.hpx?g=jv(r.hpx):r.hpt&&(g=r.hpt),g>-1&&(m.ht=g,m.customHeight=1),r.level&&(m.outlineLevel=r.level),a[a.length]=wm("row","",m));return a.join("")}(l,t,0,0),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=function(e){var t={sheet:1};return rb.forEach(function(n){null!=e[n]&&e[n]&&(t[n]="1")}),ab.forEach(function(n){null==e[n]||e[n]||(t[n]="0")}),e.password&&(t.password=Nv(e.password).toString(16).toUpperCase()),wm("sheetProtection",null,t)}(l["!protect"])),null!=l["!autofilter"]&&(i[i.length]=function(e,t,n,r){var a="string"==typeof e.ref?e.ref:Ug(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var i=n.Workbook.Names,s=jg(a);s.s.r==s.e.r&&(s.e.r=jg(t["!ref"]).e.r,a=Ug(s));for(var o=0;o<i.length;++o){var l=i[o];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==r){l.Ref="'"+n.SheetNames[r]+"'!"+a;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+a}),wm("autoFilter",null,{ref:a})}(l["!autofilter"],l,n,e)),null!=l["!merges"]&&l["!merges"].length>0&&(i[i.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+Ug(e[n])+'"/>';return t+"</mergeCells>"}(l["!merges"]));var h,f,m=-1,g=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(e){e[1].Target&&(h={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(g=Pp(r,-1,im(e[1].Target).replace(/#.*$/,""),Ep.HLINK),h["r:id"]="rId"+g),(m=e[1].Target.indexOf("#"))>-1&&(h.location=im(e[1].Target.slice(m+1))),e[1].Tooltip&&(h.tooltip=im(e[1].Tooltip)),i[i.length]=wm("hyperlink",null,h))}),i[i.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(i[i.length]=(eb(f=l["!margins"]),wm("pageMargins",null,f))),t&&!t.ignoreEC&&void 0!=t.ignoreEC||(i[i.length]=ym("ignoredErrors",wm("ignoredError",null,{numberStoredAsText:1,sqref:c}))),d.length>0&&(g=Pp(r,-1,"../drawings/drawing"+(e+1)+".xml",Ep.DRAW),i[i.length]=wm("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=d),l["!comments"].length>0&&(g=Pp(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ep.VML),i[i.length]=wm("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function ob(e,t,n,r){var a=function(e,t,n){var r=kg(145),a=(n["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var i=320;a.hpx?i=20*jv(a.hpx):a.hpt&&(i=20*a.hpt),r.write_shift(2,i),r.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),r.write_shift(1,s),r.write_shift(1,0);var o=0,l=r.l;r.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var d=-1,h=-1,f=u<<10;f<u+1<<10;++f)c.c=f,(Array.isArray(n)?(n[c.r]||[])[c.c]:n[Fg(c)])&&(d<0&&(d=f),h=f);d<0||(++o,r.write_shift(4,d),r.write_shift(4,h))}var m=r.l;return r.l=l,r.write_shift(4,o),r.l=m,r.length>r.l?r.slice(0,r.l):r}(r,n,t);(a.length>17||(t["!rows"]||[])[r])&&Eg(e,0,a)}var lb=fp,cb=mp;function ub(e){return[tp(e),gp(e),"n"]}var db=fp,hb=mp;var fb=["left","right","top","bottom","header","footer"];function mb(e,t,n,r,a,i,s){if(void 0===t.v)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":(t=Gf(t)).z=t.z||qh[14],t.v=Ff(Vf(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v}var l={r:n,c:r};switch(l.s=tb(a.cellXfs,t,a),t.l&&i["!links"].push([Fg(l),t.l]),t.c&&i["!comments"].push([Fg(l),t.c]),t.t){case"s":case"str":return a.bookSST?(o=Xy(a.Strings,t.v,a.revStrings),l.t="s",l.v=o,s?Eg(e,18,function(e,t,n){return null==n&&(n=kg(8)),np(t,n),n.write_shift(4,t.v),n}(0,l)):Eg(e,7,function(e,t,n){return null==n&&(n=kg(12)),ep(t,n),n.write_shift(4,t.v),n}(0,l))):(l.t="str",s?Eg(e,17,function(e,t,n){return null==n&&(n=kg(8+4*e.v.length)),np(t,n),Yg(e.v,n),n.length>n.l?n.slice(0,n.l):n}(t,l)):Eg(e,6,function(e,t,n){return null==n&&(n=kg(12+4*e.v.length)),ep(t,n),Yg(e.v,n),n.length>n.l?n.slice(0,n.l):n}(t,l))),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?s?Eg(e,13,function(e,t,n){return null==n&&(n=kg(8)),np(t,n),dp(e.v,n),n}(t,l)):Eg(e,2,function(e,t,n){return null==n&&(n=kg(12)),ep(t,n),dp(e.v,n),n}(t,l)):s?Eg(e,16,function(e,t,n){return null==n&&(n=kg(12)),np(t,n),pp(e.v,n),n}(t,l)):Eg(e,5,function(e,t,n){return null==n&&(n=kg(16)),ep(t,n),pp(e.v,n),n}(t,l)),!0;case"b":return l.t="b",s?Eg(e,15,function(e,t,n){return null==n&&(n=kg(5)),np(t,n),n.write_shift(1,e.v?1:0),n}(t,l)):Eg(e,4,function(e,t,n){return null==n&&(n=kg(9)),ep(t,n),n.write_shift(1,e.v?1:0),n}(t,l)),!0;case"e":return l.t="e",s?Eg(e,14,function(e,t,n){return null==n&&(n=kg(8)),np(t,n),n.write_shift(1,e.v),n.write_shift(2,0),n.write_shift(1,0),n}(t,l)):Eg(e,3,function(e,t,n){return null==n&&(n=kg(9)),ep(t,n),n.write_shift(1,e.v),n}(t,l)),!0}return s?Eg(e,12,function(e,t,n){return null==n&&(n=kg(4)),np(t,n)}(0,l)):Eg(e,1,function(e,t,n){return null==n&&(n=kg(8)),ep(t,n)}(0,l)),!0}function gb(e,t){var n,r;t&&t["!merges"]&&(Eg(e,177,(n=t["!merges"].length,null==r&&(r=kg(4)),r.write_shift(4,n),r)),t["!merges"].forEach(function(t){Eg(e,176,hb(t))}),Eg(e,178))}function pb(e,t){t&&t["!cols"]&&(Eg(e,390),t["!cols"].forEach(function(t,n){t&&Eg(e,60,function(e,t,n){null==n&&(n=kg(18));var r=Zy(e,t);n.write_shift(-4,e),n.write_shift(-4,e),n.write_shift(4,256*(r.width||10)),n.write_shift(4,0);var a=0;return t.hidden&&(a|=1),"number"==typeof r.width&&(a|=2),t.level&&(a|=t.level<<8),n.write_shift(2,a),n}(n,t))}),Eg(e,391))}function vb(e,t){t&&t["!ref"]&&(Eg(e,648),Eg(e,649,function(e){var t=kg(24);return t.write_shift(4,4),t.write_shift(4,1),mp(e,t),t}(Bg(t["!ref"]))),Eg(e,650))}function yb(e,t,n){t["!links"].forEach(function(t){if(t[1].Target){var r=Pp(n,-1,t[1].Target.replace(/#.*$/,""),Ep.HLINK);Eg(e,494,function(e,t){var n=kg(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));mp({s:Lg(e[0]),e:Lg(e[0])},n),cp("rId"+t,n);var r=e[1].Target.indexOf("#");return Yg((-1==r?"":e[1].Target.slice(r+1))||"",n),Yg(e[1].Tooltip||"",n),Yg("",n),n.slice(0,n.l)}(t,r))}}),delete t["!links"]}function bb(e,t,n){Eg(e,133),Eg(e,137,function(e,t,n){null==n&&(n=kg(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}(0,n)),Eg(e,138),Eg(e,134)}function wb(e,t){var n,r;t["!protect"]&&Eg(e,535,(n=t["!protect"],null==r&&(r=kg(66)),r.write_shift(2,n.password?Nv(n.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?r.write_shift(4,null==n[e[0]]||n[e[0]]?0:1):r.write_shift(4,null!=n[e[0]]&&n[e[0]]?0:1)}),r))}function Sb(e,t,n,r){var a=Cg(),i=n.SheetNames[e],s=n.Sheets[i]||{},o=i;try{n&&n.Workbook&&(o=n.Workbook.Sheets[e].CodeName||o)}catch(d){}var l,c,u=Bg(s["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],Eg(a,129),(n.vbaraw||s["!outline"])&&Eg(a,147,function(e,t,n){null==n&&(n=kg(84+4*e.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),n.write_shift(1,r);for(var a=1;a<3;++a)n.write_shift(1,0);return vp({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),ap(e,n),n.slice(0,n.l)}(o,s["!outline"])),Eg(a,148,cb(u)),bb(a,0,n.Workbook),pb(a,s),function(e,t,n,r){var a,i=Bg(t["!ref"]||"A1"),s="",o=[];Eg(e,145);var l=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var u=i.s.r;u<=c;++u){s=Rg(u),ob(e,t,i,u);var d=!1;if(u<=i.e.r)for(var h=i.s.c;h<=i.e.c;++h){u===i.s.r&&(o[h]=Dg(h)),a=o[h]+s;var f=l?(t[u]||[])[h]:t[a];d=!!f&&mb(e,f,u,h,r,t,d)}}Eg(e,146)}(a,s,0,t),wb(a,s),function(e,t,n,r){if(t["!autofilter"]){var a=t["!autofilter"],i="string"===typeof a.ref?a.ref:Ug(a.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var s=n.Workbook.Names,o=jg(i);o.s.r==o.e.r&&(o.e.r=jg(t["!ref"]).e.r,i=Ug(o));for(var l=0;l<s.length;++l){var c=s[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==r){c.Ref="'"+n.SheetNames[r]+"'!"+i;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),Eg(e,161,mp(Bg(i))),Eg(e,162)}}(a,s,n,e),gb(a,s),yb(a,s,r),s["!margins"]&&Eg(a,476,(l=s["!margins"],null==c&&(c=kg(48)),eb(l),fb.forEach(function(e){pp(l[e],c)}),c)),t&&!t.ignoreEC&&void 0!=t.ignoreEC||vb(a,s),function(e,t,n,r){if(t["!comments"].length>0){var a=Pp(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",Ep.VML);Eg(e,551,cp("rId"+a)),t["!legacy"]=a}}(a,s,e,r),Eg(a,130),a.end()}var Tb=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];var Ab="][*?/\\".split("");function xb(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var n=!0;return Ab.forEach(function(r){if(-1!=e.indexOf(r)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");n=!1}}),n}function kb(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t,n,r,a=e.Workbook&&e.Workbook.Sheets||[];t=e.SheetNames,n=a,r=!!e.vbaraw,t.forEach(function(e,a){xb(e);for(var i=0;i<a;++i)if(e==t[i])throw new Error("Duplicate Sheet Name: "+e);if(r){var s=n&&n[a]&&n[a].CodeName||e;if(95==s.charCodeAt(0)&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}});for(var i=0;i<e.SheetNames.length;++i)nb(e.Sheets[e.SheetNames[i]],e.SheetNames[i],i)}function Cb(e){var t=[em];t[t.length]=wm("workbook",null,{xmlns:Dm[0],"xmlns:r":_m});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Tb.forEach(function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(r[t[0]]=e.Workbook.WBProps[t[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=wm("workbookPr",null,r);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&a[i]&&a[i].Hidden;++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:im(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden"}t[t.length]=wm("sheet",null,s)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(e){var n={name:e.Name};e.Comment&&(n.comment=e.Comment),null!=e.Sheet&&(n.localSheetId=""+e.Sheet),e.Hidden&&(n.hidden="1"),e.Ref&&(t[t.length]=wm("definedName",im(e.Ref),n))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Eb(e,t){return t||(t=kg(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),cp(e.strRelID,t),Yg(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Ib(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var n,r,a=t.Workbook.Sheets,i=0,s=-1,o=-1;i<a.length;++i)!a[i]||!a[i].Hidden&&-1==s?s=i:1==a[i].Hidden&&-1==o&&(o=i);if(!(o>s))Eg(e,135),Eg(e,158,(n=s,r||(r=kg(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,n),r.write_shift(4,n),r.write_shift(1,120),r.length>r.l?r.slice(0,r.l):r)),Eg(e,136)}}function Nb(e,t){var n=Cg();return Eg(n,131),Eg(n,128,function(e,t){t||(t=kg(127));for(var n=0;4!=n;++n)t.write_shift(4,0);return Yg("SheetJS",t),Yg(ch.version,t),Yg(ch.version,t),Yg("7262",t),t.length>t.l?t.slice(0,t.l):t}()),Eg(n,153,function(e,t){t||(t=kg(72));var n=0;return e&&e.filterPrivacy&&(n|=8),t.write_shift(4,n),t.write_shift(4,0),ap(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}(e.Workbook&&e.Workbook.WBProps||null)),Ib(n,e),function(e,t){Eg(e,143);for(var n=0;n!=t.SheetNames.length;++n)Eg(e,156,Eb({Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]}));Eg(e,144)}(n,e),Eg(n,132),n.end()}function Pb(e,t,n,r,a){return(".bin"===t.slice(-4)?Sb:sb)(e,n,r,a)}function _b(e,t,n){return(".bin"===t.slice(-4)?ly:iy)(e,n)}function Ob(e,t){var n=[];return e.Props&&n.push(function(e,t){var n=[];return Of(Hp).map(function(e){for(var t=0;t<Mp.length;++t)if(Mp[t][1]==e)return Mp[t];for(t=0;t<Fp.length;++t)if(Fp[t][1]==e)return Fp[t];throw e}).forEach(function(r){if(null!=e[r[1]]){var a=t&&t.Props&&null!=t.Props[r[1]]?t.Props[r[1]]:e[r[1]];"date"===r[2]&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof a?a=String(a):!0===a||!1===a?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),n.push(ym(Hp[r[1]]||r[1],a))}}),wm("DocumentProperties",n.join(""),{xmlns:Lm})}(e.Props,t)),e.Custprops&&n.push(function(e,t){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",a=[];return e&&Of(e).forEach(function(t){if(Object.prototype.hasOwnProperty.call(e,t)){for(var r=0;r<Mp.length;++r)if(t==Mp[r][1])return;for(r=0;r<Fp.length;++r)if(t==Fp[r][1])return;for(r=0;r<n.length;++r)if(t==n[r])return;var i=e[t],s="string";"number"==typeof i?(s="float",i=String(i)):!0===i||!1===i?(s="boolean",i=i?"1":"0"):i=String(i),a.push(wm(sm(t),i,{"dt:dt":s}))}}),t&&Of(t).forEach(function(n){if(Object.prototype.hasOwnProperty.call(t,n)&&(!e||!Object.prototype.hasOwnProperty.call(e,n))){var r=t[n],i="string";"number"==typeof r?(i="float",r=String(r)):!0===r||!1===r?(i="boolean",r=r?"1":"0"):r instanceof Date?(i="dateTime.tz",r=r.toISOString()):r=String(r),a.push(wm(sm(n),r,{"dt:dt":i}))}}),"<"+r+' xmlns="'+Lm+'">'+a.join("")+"</"+r+">"}(e.Props,e.Custprops)),n.join("")}function Rb(e){return wm("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+hy(e.Ref,{r:0,c:0})})}function Mb(e,t,n,r,a,i,s){if(!e||void 0==e.v&&void 0==e.f)return"";var o={};if(e.f&&(o["ss:Formula"]="="+im(hy(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var l=Lg(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=im(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=im(e.l.Tooltip))),n["!merges"])for(var c=n["!merges"],u=0;u!=c.length;++u)c[u].s.c==s.c&&c[u].s.r==s.r&&(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var d="",h="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":d="Number",h=String(e.v);break;case"b":d="Boolean",h=e.v?"1":"0";break;case"e":d="Error",h=Ap[e.v];break;case"d":d="DateTime",h=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||qh[14]);break;case"s":d="String",h=((e.v||"")+"").replace(rm,function(e){return nm[e]}).replace(om,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}var f=tb(r.cellXfs,e,r);o["ss:StyleID"]="s"+(21+f),o["ss:Index"]=s.c+1;var m=null!=e.v?h:"",g="z"==e.t?"":'<Data ss:Type="'+d+'">'+m+"</Data>";return(e.c||[]).length>0&&(g+=e.c.map(function(e){var t=wm("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return wm("Comment",t,{"ss:Author":e.a})}).join("")),wm("Cell",g,o)}function Db(e,t){var n='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Uv(t.hpt)),t.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(n+=' ss:Hidden="1"')),n+">"}function Lb(e,t,n){var r=[],a=n.SheetNames[e],i=n.Sheets[a],s=i?function(e,t,n,r){if(!e)return"";if(!((r||{}).Workbook||{}).Names)return"";for(var a=r.Workbook.Names,i=[],s=0;s<a.length;++s){var o=a[s];o.Sheet==n&&(o.Name.match(/^_xlfn\./)||i.push(Rb(o)))}return i.join("")}(i,0,e,n):"";return s.length>0&&r.push("<Names>"+s+"</Names>"),s=i?function(e,t){if(!e["!ref"])return"";var n=Bg(e["!ref"]),r=e["!merges"]||[],a=0,i=[];e["!cols"]&&e["!cols"].forEach(function(e,t){Lv(e);var n=!!e.width,r=Zy(t,e),a={"ss:Index":t+1};n&&(a["ss:Width"]=Rv(r.width)),e.hidden&&(a["ss:Hidden"]="1"),i.push(wm("Column",null,a))});for(var s=Array.isArray(e),o=n.s.r;o<=n.e.r;++o){for(var l=[Db(o,(e["!rows"]||[])[o])],c=n.s.c;c<=n.e.c;++c){var u=!1;for(a=0;a!=r.length;++a)if(!(r[a].s.c>c)&&!(r[a].s.r>o)&&!(r[a].e.c<c)&&!(r[a].e.r<o)){r[a].s.c==c&&r[a].s.r==o||(u=!0);break}if(!u){var d={r:o,c:c},h=Fg(d),f=s?(e[o]||[])[c]:e[h];l.push(Mb(f,h,e,t,0,0,d))}}l.push("</Row>"),l.length>2&&i.push(l.join(""))}return i.join("")}(i,t):"",s.length>0&&r.push("<Table>"+s+"</Table>"),r.push(function(e,t,n,r){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(wm("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(wm("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(wm("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)a.push(wm("Visible",1==r.Workbook.Sheets[n].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<n&&(!r.Workbook.Sheets[i]||r.Workbook.Sheets[i].Hidden);++i);i==n&&a.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(ym("ProtectContents","True")),e["!protect"].objects&&a.push(ym("ProtectObjects","True")),e["!protect"].scenarios&&a.push(ym("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||a.push(ym("EnableSelection","UnlockedCells")):a.push(ym("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(t){e["!protect"][t[0]]&&a.push("<"+t[1]+"/>")})),0==a.length?"":wm("WorksheetOptions",a.join(""),{xmlns:Fm})}(i,0,e,n)),r.join("")}function Fb(e,t){t||(t={}),e.SSF||(e.SSF=Gf(qh)),e.SSF&&(kf(),xf(e.SSF),t.revssf=Df(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],tb(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(Ob(e,t)),n.push(""),n.push(""),n.push("");for(var r=0;r<e.SheetNames.length;++r)n.push(wm("Worksheet",Lb(r,t,e),{"ss:Name":im(e.SheetNames[r])}));return n[2]=function(e,t){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(e,t){var r=[];r.push(wm("NumberFormat",null,{"ss:Format":im(qh[e.numFmtId])}));var a={"ss:ID":"s"+(21+t)};n.push(wm("Style",r.join(""),a))}),wm("Styles",n.join(""))}(0,t),n[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],r=0;r<t.length;++r){var a=t[r];null==a.Sheet&&(a.Name.match(/^_xlfn\./)||n.push(Rb(a)))}return wm("Names",n.join(""))}(e),em+wm("Workbook",n.join(""),{xmlns:jm,"xmlns:o":Lm,"xmlns:x":Fm,"xmlns:ss":jm,"xmlns:dt":Um,"xmlns:html":zm})}var jb="e0859ff2f94f6810ab9108002b27b3d9",Ub="02d5cdd59c2e1b10939708002b2cf9ae",Bb="05d5cdd59c2e1b10939708002b2cf9ae";function Hb(e,t){var n=t||{},r=If.utils.cfb_new({root:"R"}),a="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":a="/Workbook",n.biff=8;break;case"biff5":a="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return If.utils.cfb_add(r,a,Xb(e,n)),8==n.biff&&(e.Props||e.Custprops)&&function(e,t){var n,r=[],a=[],i=[],s=0,o=Rf(bp,"n"),l=Rf(wp,"n");if(e.Props)for(n=Of(e.Props),s=0;s<n.length;++s)(Object.prototype.hasOwnProperty.call(o,n[s])?r:Object.prototype.hasOwnProperty.call(l,n[s])?a:i).push([n[s],e.Props[n[s]]]);if(e.Custprops)for(n=Of(e.Custprops),s=0;s<n.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},n[s])||(Object.prototype.hasOwnProperty.call(o,n[s])?r:Object.prototype.hasOwnProperty.call(l,n[s])?a:i).push([n[s],e.Custprops[n[s]]]);var c=[];for(s=0;s<i.length;++s)qp.indexOf(i[s][0])>-1||jp.indexOf(i[s][0])>-1||null!=i[s][1]&&c.push(i[s]);a.length&&If.utils.cfb_add(t,"/\x05SummaryInformation",Kp(a,jb,l,wp)),(r.length||c.length)&&If.utils.cfb_add(t,"/\x05DocumentSummaryInformation",Kp(r,Ub,o,bp,c.length?c:null,Bb))}(e,r),8==n.biff&&e.vbaraw&&function(e,t){t.FullPaths.forEach(function(n,r){if(0!=r){var a=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==a.slice(-1)&&If.utils.cfb_add(e,a,t.FileIndex[r].content)}})}(r,If.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),r}var zb={0:{f:function(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=r,7&i&&(n.level=7&i),16&i&&(n.hidden=!0),32&i&&(n.hpt=a/20),n}},1:{f:function(e){return[Zg(e)]}},2:{f:function(e){return[Zg(e),up(e),"n"]}},3:{f:function(e){return[Zg(e),e.read_shift(1),"e"]}},4:{f:function(e){return[Zg(e),e.read_shift(1),"b"]}},5:{f:function(e){return[Zg(e),gp(e),"n"]}},6:{f:function(e){return[Zg(e),Gg(e),"str"]}},7:{f:function(e){return[Zg(e),e.read_shift(4),"s"]}},8:{f:function(e,t,n){var r=e.l+t,a=Zg(e);a.r=n["!row"];var i=[a,Gg(e),"str"];if(n.cellFormula){e.l+=2;var s=qy(e,r-e.l,n);i[3]=Uy(s,0,a,n.supbooks,n)}else e.l=r;return i}},9:{f:function(e,t,n){var r=e.l+t,a=Zg(e);a.r=n["!row"];var i=[a,gp(e),"n"];if(n.cellFormula){e.l+=2;var s=qy(e,r-e.l,n);i[3]=Uy(s,0,a,n.supbooks,n)}else e.l=r;return i}},10:{f:function(e,t,n){var r=e.l+t,a=Zg(e);a.r=n["!row"];var i=[a,e.read_shift(1),"b"];if(n.cellFormula){e.l+=2;var s=qy(e,r-e.l,n);i[3]=Uy(s,0,a,n.supbooks,n)}else e.l=r;return i}},11:{f:function(e,t,n){var r=e.l+t,a=Zg(e);a.r=n["!row"];var i=[a,e.read_shift(1),"e"];if(n.cellFormula){e.l+=2;var s=qy(e,r-e.l,n);i[3]=Uy(s,0,a,n.supbooks,n)}else e.l=r;return i}},12:{f:function(e){return[tp(e)]}},13:{f:function(e){return[tp(e),up(e),"n"]}},14:{f:function(e){return[tp(e),e.read_shift(1),"e"]}},15:{f:function(e){return[tp(e),e.read_shift(1),"b"]}},16:{f:ub},17:{f:function(e){return[tp(e),Gg(e),"str"]}},18:{f:function(e){return[tp(e),e.read_shift(4),"s"]}},19:{f:Qg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=op(e),s=Wy(e,0,n),o=ip(e);e.l=r;var l={Name:i,Ptg:s};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}},40:{},42:{},43:{f:function(e,t,n){var r={};r.sz=e.read_shift(2)/20;var a=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1),700===e.read_shift(2)&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript"}var i=e.read_shift(1);0!=i&&(r.underline=i);var s=e.read_shift(1);s>0&&(r.family=s);var o=e.read_shift(1);switch(o>0&&(r.charset=o),e.l++,r.color=function(e){var t={},n=e.read_shift(1)>>>1,r=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=r;var l=Tp[r];l&&(t.rgb=_v(l));break;case 2:t.rgb=_v([i,s,o]);break;case 3:t.theme=r}return 0!=a&&(t.tint=a>0?a/32767:a/32768),t}(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor"}return r.name=Gg(e),r}},44:{f:function(e,t){return[e.read_shift(2),Gg(e)]}},45:{f:Vv},46:{f:$v},47:{f:function(e,t){var n=e.l+t,r=e.read_shift(2),a=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:a}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:vv},62:{f:function(e){return[Zg(e),Qg(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=Fg(n);var r=e.read_shift(1);return 2&r&&(t.l="1"),8&r&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:xg,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var n={},r=e[e.l];return++e.l,n.above=!(64&r),n.left=!(128&r),e.l+=18,n.name=rp(e,t-19),n}},148:{f:lb,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var a=t>8?Gg(e):"";return a.length>0&&(n.CodeName=a),n.autoCompressPictures=!!(65536&r),n.backupFile=!!(64&r),n.checkCompatibility=!!(4096&r),n.date1904=!!(1&r),n.filterPrivacy=!!(8&r),n.hidePivotFieldList=!!(1024&r),n.promptedSolutions=!!(16&r),n.publishItems=!!(2048&r),n.refreshAllConnections=!!(262144&r),n.saveExternalLinkValues=!!(128&r),n.showBorderUnselectedTables=!!(4&r),n.showInkAnnotation=!!(32&r),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(32768&r),n.updateLinks=["userSet","never","always"][r>>8&3],n}},154:{},155:{},156:{f:function(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=lp(e,t-8),n.name=Gg(e),n}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:fp},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:db},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Gg(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:lp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:mv},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,n){var r=e.l+t,a=hp(e),i=e.read_shift(1),s=[a];if(s[2]=i,n.cellFormula){var o=zy(e,r-e.l,n);s[1]=o}else e.l=r;return s}},427:{f:function(e,t,n){var r=e.l+t,a=[fp(e,16)];if(n.cellFormula){var i=Vy(e,r-e.l,n);a[1]=i,e.l=r}else e.l=r;return a}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return fb.forEach(function(n){t[n]=gp(e)}),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var n=e.l+t,r=fp(e,16),a=ip(e),i=Gg(e),s=Gg(e),o=Gg(e);e.l=n;var l={rfx:r,relId:a,loc:i,display:o};return s&&(l.Tooltip=s),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:lp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:oy},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var n=fp(e,16);return t.rfx=n.s,t.ref=Fg(n.s),e.l+=16,t}},636:{T:-1},637:{f:Jg},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:Gg(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function qb(e,t,n,r){var a=t;if(!isNaN(a)){var i=r||(n||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&cg(n)&&e.push(n)}}function Wb(e,t,n){return e||(e=kg(7)),e.write_shift(2,t),e.write_shift(2,n),e.write_shift(2,0),e.write_shift(1,0),e}function Vb(e,t,n,r){if(null!=t.v)switch(t.t){case"d":case"n":var a="d"==t.t?Ff(Vf(t.v)):t.v;return void(a==(0|a)&&a>=0&&a<65536?qb(e,2,function(e,t,n){var r=kg(9);return Wb(r,e,t),r.write_shift(2,n),r}(n,r,a)):qb(e,3,function(e,t,n){var r=kg(15);return Wb(r,e,t),r.write_shift(8,n,"f"),r}(n,r,a)));case"b":case"e":return void qb(e,5,function(e,t,n,r){var a=kg(9);return Wb(a,e,t),Jp(n,r||"b",a),a}(n,r,t.v,t.t));case"s":case"str":return void qb(e,4,function(e,t,n){var r=kg(8+2*n.length);return Wb(r,e,t),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}(n,r,(t.v||"").slice(0,255)))}qb(e,1,Wb(null,n,r))}function Kb(e,t){var n=t||{};for(var r=Cg(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==n.sheet&&(a=i);if(0==a&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return qb(r,4==n.biff?1033:3==n.biff?521:9,uv(0,16,n)),function(e,t,n,r){var a,i=Array.isArray(t),s=Bg(t["!ref"]||"A1"),o="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=Ug(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Rg(c);for(var u=s.s.c;u<=s.e.c;++u){c===s.s.r&&(l[u]=Dg(u)),a=l[u]+o;var d=i?(t[c]||[])[u]:t[a];d&&Vb(e,d,c,u)}}}(r,e.Sheets[e.SheetNames[a]],0,n),qb(r,10),r.end()}function Gb(e,t,n){qb(e,49,function(e,t){var n=e.name||"Arial",r=t&&5==t.biff,a=kg(r?15+n.length:16+2*n.length);return a.write_shift(2,20*(e.sz||12)),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,n.length),r||a.write_shift(1,1),a.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),a}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},n))}function Yb(e,t){if(t){var n=0;t.forEach(function(t,r){++n<=256&&t&&qb(e,125,function(e,t){var n=kg(12);n.write_shift(2,t),n.write_shift(2,t),n.write_shift(2,256*e.width),n.write_shift(2,0);var r=0;return e.hidden&&(r|=1),n.write_shift(1,r),r=e.level||0,n.write_shift(1,r),n.write_shift(2,0),n}(Zy(r,t),r))})}}function $b(e,t,n,r,a){var i=16+tb(a.cellXfs,t,a);if(null!=t.v||t.bf)if(t.bf)qb(e,6,By(t,n,r,0,i));else switch(t.t){case"d":case"n":qb(e,515,function(e,t,n,r){var a=kg(14);return sv(e,t,r,a),pp(n,a),a}(n,r,"d"==t.t?Ff(Vf(t.v)):t.v,i));break;case"b":case"e":qb(e,517,function(e,t,n,r,a,i){var s=kg(8);return sv(e,t,r,s),Jp(n,i,s),s}(n,r,t.v,i,0,t.t));break;case"s":case"str":if(a.bookSST)qb(e,253,function(e,t,n,r){var a=kg(10);return sv(e,t,r,a),a.write_shift(4,n),a}(n,r,Xy(a.Strings,t.v,a.revStrings),i));else qb(e,516,function(e,t,n,r,a){var i=!a||8==a.biff,s=kg(+i+8+(1+i)*n.length);return sv(e,t,r,s),s.write_shift(2,n.length),i&&s.write_shift(1,1),s.write_shift((1+i)*n.length,n,i?"utf16le":"sbcs"),s}(n,r,(t.v||"").slice(0,255),i,a));break;default:qb(e,513,sv(n,r,i))}else qb(e,513,sv(n,r,i))}function Qb(e,t,n){var r,a=Cg(),i=n.SheetNames[e],s=n.Sheets[i]||{},o=(n||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(s),u=8==t.biff,d="",h=[],f=Bg(s["!ref"]||"A1"),m=u?65536:16384;if(f.e.c>255||f.e.r>=m){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,m-1)}qb(a,2057,uv(0,16,t)),qb(a,13,Qp(1)),qb(a,12,Qp(100)),qb(a,15,Yp(!0)),qb(a,17,Yp(!1)),qb(a,16,pp(.001)),qb(a,95,Yp(!0)),qb(a,42,Yp(!1)),qb(a,43,Yp(!1)),qb(a,130,Qp(1)),qb(a,128,function(e){var t=kg(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}([0,0])),qb(a,131,Yp(!1)),qb(a,132,Yp(!1)),u&&Yb(a,s["!cols"]),qb(a,512,function(e,t){var n=8!=t.biff&&t.biff?2:4,r=kg(2*n+6);return r.write_shift(n,e.s.r),r.write_shift(n,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}(f,t)),u&&(s["!links"]=[]);for(var g=f.s.r;g<=f.e.r;++g){d=Rg(g);for(var p=f.s.c;p<=f.e.c;++p){g===f.s.r&&(h[p]=Dg(p)),r=h[p]+d;var v=c?(s[g]||[])[p]:s[r];v&&($b(a,v,g,p,t),u&&v.l&&s["!links"].push([r,v.l]))}}var y=l.CodeName||l.name||i;return u&&qb(a,574,function(e){var t=kg(18),n=1718;return e&&e.RTL&&(n|=64),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&qb(a,229,function(e){var t=kg(2+8*e.length);t.write_shift(2,e.length);for(var n=0;n<e.length;++n)cv(e[n],t);return t}(s["!merges"])),u&&function(e,t){for(var n=0;n<t["!links"].length;++n){var r=t["!links"][n];qb(e,440,gv(r)),r[1].Tooltip&&qb(e,2048,pv(r))}delete t["!links"]}(a,s),qb(a,442,rv(y)),u&&function(e,t){var n=kg(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),qb(e,2151,n),(n=kg(39)).write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),cv(Bg(t["!ref"]||"A1"),n),n.write_shift(4,4),qb(e,2152,n)}(a,s),qb(a,10),a.end()}function Jb(e,t,n){var r=Cg(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},o=8==n.biff,l=5==n.biff;(qb(r,2057,uv(0,5,n)),"xla"==n.bookType&&qb(r,135),qb(r,225,o?Qp(1200):null),qb(r,193,function(e,t){t||(t=kg(e));for(var n=0;n<e;++n)t.write_shift(1,0);return t}(2)),l&&qb(r,191),l&&qb(r,192),qb(r,226),qb(r,92,function(e,t){var n=!t||8==t.biff,r=kg(n?112:54);for(r.write_shift(8==t.biff?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}(0,n)),qb(r,66,Qp(o?1200:1252)),o&&qb(r,353,Qp(0)),o&&qb(r,448),qb(r,317,function(e){for(var t=kg(2*e),n=0;n<e;++n)t.write_shift(2,n+1);return t}(e.SheetNames.length)),o&&e.vbaraw&&qb(r,211),o&&e.vbaraw)&&qb(r,442,rv(s.CodeName||"ThisWorkbook"));qb(r,156,Qp(17)),qb(r,25,Yp(!1)),qb(r,18,Yp(!1)),qb(r,19,Qp(0)),o&&qb(r,431,Yp(!1)),o&&qb(r,444,Qp(0)),qb(r,61,function(){var e=kg(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}()),qb(r,64,Yp(!1)),qb(r,141,Qp(0)),qb(r,34,Yp("true"==function(e){return e.Workbook&&e.Workbook.WBProps&&cm(e.Workbook.WBProps.date1904)?"true":"false"}(e))),qb(r,14,Yp(!0)),o&&qb(r,439,Yp(!1)),qb(r,218,Qp(0)),Gb(r,0,n),function(e,t,n){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)null!=t[a]&&qb(e,1054,hv(a,t[a],n))})}(r,e.SSF,n),function(e,t){for(var n=0;n<16;++n)qb(e,224,fv({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){qb(e,224,fv(n,0,t))})}(r,n),o&&qb(r,352,Yp(!1));var c,u=r.end(),d=Cg();o&&qb(d,140,(c||(c=kg(4)),c.write_shift(2,1),c.write_shift(2,1),c)),o&&n.Strings&&function(e,t,n,r){var a=r||(n||[]).length||0;if(a<=8224)return qb(e,t,n,a);var i=t;if(!isNaN(i)){for(var s=n.parts||[],o=0,l=0,c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,c),e.push(n.slice(l,l+c)),l+=c;l<a;){for((u=e.next(4)).write_shift(2,60),c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;u.write_shift(2,c),e.push(n.slice(l,l+c)),l+=c}}}(d,252,function(e){var t=kg(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var n=[],r=0;r<e.length;++r)n[r]=Zp(e[r]);var a=_h([t].concat(n));return a.parts=[t.length].concat(n.map(function(e){return e.length})),a}(n.Strings)),qb(d,10);var h=d.end(),f=Cg(),m=0,g=0;for(g=0;g<e.SheetNames.length;++g)m+=(o?12:11)+(o?2:1)*e.SheetNames[g].length;var p=u.length+m+h.length;for(g=0;g<e.SheetNames.length;++g){qb(f,133,dv({pos:p,hs:(i[g]||{}).Hidden||0,dt:0,name:e.SheetNames[g]},n)),p+=t[g].length}var v=f.end();if(m!=v.length)throw new Error("BS8 "+m+" != "+v.length);var y=[];return u.length&&y.push(u),v.length&&y.push(v),h.length&&y.push(h),_h(y)}function Xb(e,t){for(var n=0;n<=e.SheetNames.length;++n){var r=e.Sheets[e.SheetNames[n]];if(r&&r["!ref"])jg(r["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}var a=t||{};switch(a.biff||2){case 8:case 5:return function(e,t){var n=t||{},r=[];e&&!e.SSF&&(e.SSF=Gf(qh)),e&&e.SSF&&(kf(),xf(e.SSF),n.revssf=Df(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Iw(n),n.cellXfs=[],tb(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)r[r.length]=Qb(a,n,e);return r.unshift(Jb(e,r,n)),_h(r)}(e,t);case 4:case 3:case 2:return Kb(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function Zb(e,t,n,r){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>n||a[c].s.c>s)&&!(a[c].e.r<n||a[c].e.c<s)){if(a[c].s.r<n||a[c].s.c<s){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var u=Fg({r:n,c:s}),d=r.dense?(e[n]||[])[s]:e[u],h=d&&null!=d.v&&(d.h||lm(d.w||(zg(d),d.w)||""))||"",f={};o>1&&(f.rowspan=o),l>1&&(f.colspan=l),r.editable?h='<span contenteditable="true">'+h+"</span>":d&&(f["data-t"]=d&&d.t||"z",null!=d.v&&(f["data-v"]=d.v),null!=d.z&&(f["data-z"]=d.z),d.l&&"#"!=(d.l.Target||"#").charAt(0)&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),f.id=(r.id||"sjs")+"-"+u,i.push(wm("td",h,f))}}return"<tr>"+i.join("")+"</tr>"}var ew='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',tw="</body></html>";function nw(e,t,n){return[].join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function rw(e,t){var n=t||{},r=null!=n.header?n.header:ew,a=null!=n.footer?n.footer:tw,i=[r],s=jg(e["!ref"]);n.dense=Array.isArray(e),i.push(nw(0,0,n));for(var o=s.s.r;o<=s.e.r;++o)i.push(Zb(e,s,o,n));return i.push("</table>"+a),i.join("")}function aw(e,t,n){var r=n||{};var a=0,i=0;if(null!=r.origin)if("number"==typeof r.origin)a=r.origin;else{var s="string"==typeof r.origin?Lg(r.origin):r.origin;a=s.r,i=s.c}var o=t.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var u=jg(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),-1==a&&(c.e.r=a=u.e.r+1)}var d=[],h=0,f=e["!rows"]||(e["!rows"]=[]),m=0,g=0,p=0,v=0,y=0,b=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&g<l;++m){var w=o[m];if(sw(w)){if(r.display)continue;f[g]={hidden:!0}}var S=w.children;for(p=v=0;p<S.length;++p){var T=S[p];if(!r.display||!sw(T)){var A=T.hasAttribute("data-v")?T.getAttribute("data-v"):T.hasAttribute("v")?T.getAttribute("v"):pm(T.innerHTML),x=T.getAttribute("data-z")||T.getAttribute("z");for(h=0;h<d.length;++h){var k=d[h];k.s.c==v+i&&k.s.r<g+a&&g+a<=k.e.r&&(v=k.e.c+1-i,h=-1)}b=+T.getAttribute("colspan")||1,((y=+T.getAttribute("rowspan")||1)>1||b>1)&&d.push({s:{r:g+a,c:v+i},e:{r:g+a+(y||1)-1,c:v+i+(b||1)-1}});var C={t:"s",v:A},E=T.getAttribute("data-t")||T.getAttribute("t")||"";null!=A&&(0==A.length?C.t=E||"z":r.raw||0==A.trim().length||"s"==E||("TRUE"===A?C={t:"b",v:!0}:"FALSE"===A?C={t:"b",v:!1}:isNaN($f(A))?isNaN(Jf(A).getDate())||(C={t:"d",v:Vf(A)},r.cellDates||(C={t:"n",v:Ff(C.v)}),C.z=r.dateNF||qh[14]):C={t:"n",v:$f(A)})),void 0===C.z&&null!=x&&(C.z=x);var I="",N=T.getElementsByTagName("A");if(N&&N.length)for(var P=0;P<N.length&&(!N[P].hasAttribute("href")||"#"==(I=N[P].getAttribute("href")).charAt(0));++P);I&&"#"!=I.charAt(0)&&(C.l={Target:I}),r.dense?(e[g+a]||(e[g+a]=[]),e[g+a][v+i]=C):e[Fg({c:v+i,r:g+a})]=C,c.e.c<v+i&&(c.e.c=v+i),v+=b}}++g}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,g-1+a),e["!ref"]=Ug(c),g>=l&&(e["!fullref"]=Ug((c.e.r=o.length-m+g-1+a,c))),e}function iw(e,t){return aw((t||{}).dense?[]:{},e,t)}function sw(e){var t="",n=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}var ow=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+bm({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return em+t}}(),lw=function(){var e=function(e){return im(e).replace(/  +/g,function(e){return'<text:s text:c="'+e.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t="          <table:table-cell />\n",n=function(n,r,a){var i=[];i.push('      <table:table table:name="'+im(r.SheetNames[a])+'" table:style-name="ta1">\n');var s=0,o=0,l=jg(n["!ref"]||"A1"),c=n["!merges"]||[],u=0,d=Array.isArray(n);if(n["!cols"])for(o=0;o<=l.e.c;++o)i.push("        <table:table-column"+(n["!cols"][o]?' table:style-name="co'+n["!cols"][o].ods+'"':"")+"></table:table-column>\n");var h="",f=n["!rows"]||[];for(s=0;s<l.s.r;++s)h=f[s]?' table:style-name="ro'+f[s].ods+'"':"",i.push("        <table:table-row"+h+"></table:table-row>\n");for(;s<=l.e.r;++s){for(h=f[s]?' table:style-name="ro'+f[s].ods+'"':"",i.push("        <table:table-row"+h+">\n"),o=0;o<l.s.c;++o)i.push(t);for(;o<=l.e.c;++o){var m=!1,g={},p="";for(u=0;u!=c.length;++u)if(!(c[u].s.c>o)&&!(c[u].s.r>s)&&!(c[u].e.c<o)&&!(c[u].e.r<s)){c[u].s.c==o&&c[u].s.r==s||(m=!0),g["table:number-columns-spanned"]=c[u].e.c-c[u].s.c+1,g["table:number-rows-spanned"]=c[u].e.r-c[u].s.r+1;break}if(m)i.push("          <table:covered-table-cell/>\n");else{var v=Fg({r:s,c:o}),y=d?(n[s]||[])[o]:n[v];if(y&&y.f&&(g["table:formula"]=im($y(y.f)),y.F&&y.F.slice(0,v.length)==v)){var b=jg(y.F);g["table:number-matrix-columns-spanned"]=b.e.c-b.s.c+1,g["table:number-matrix-rows-spanned"]=b.e.r-b.s.r+1}if(y){switch(y.t){case"b":p=y.v?"TRUE":"FALSE",g["office:value-type"]="boolean",g["office:boolean-value"]=y.v?"true":"false";break;case"n":p=y.w||String(y.v||0),g["office:value-type"]="float",g["office:value"]=y.v||0;break;case"s":case"str":p=null==y.v?"":y.v,g["office:value-type"]="string";break;case"d":p=y.w||Vf(y.v).toISOString(),g["office:value-type"]="date",g["office:date-value"]=Vf(y.v).toISOString(),g["table:style-name"]="ce1";break;default:i.push(t);continue}var w=e(p);if(y.l&&y.l.Target){var S=y.l.Target;"#"==(S="#"==S.charAt(0)?"#"+Qy(S.slice(1)):S).charAt(0)||S.match(/^\w+:/)||(S="../"+S),w=wm("text:a",w,{"xlink:href":S.replace(/&/g,"&amp;")})}i.push("          "+wm("table:table-cell",wm("text:p",w,{}),g)+"\n")}else i.push(t)}}i.push("        </table:table-row>\n")}return i.push("      </table:table>\n"),i.join("")};return function(e,t){var r=[em],a=bm({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),i=bm({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==t.bookType?(r.push("<office:document"+a+i+">\n"),r.push(Rp().replace(/office:document-meta/g,"office:meta"))):r.push("<office:document-content"+a+">\n"),function(e,t){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var n=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!cols"])for(var r=0;r<t["!cols"].length;++r)if(t["!cols"][r]){var a=t["!cols"][r];if(null==a.width&&null==a.wpx&&null==a.wch)continue;Lv(a),a.ods=n;var i=t["!cols"][r].wpx+"px";e.push('  <style:style style:name="co'+n+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+i+'"/>\n'),e.push("  </style:style>\n"),++n}});var r=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!rows"])for(var n=0;n<t["!rows"].length;++n)if(t["!rows"][n]){t["!rows"][n].ods=r;var a=t["!rows"][n].hpx+"px";e.push('  <style:style style:name="ro'+r+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+a+'"/>\n'),e.push("  </style:style>\n"),++r}}),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")}(r,e),r.push("  <office:body>\n"),r.push("    <office:spreadsheet>\n");for(var s=0;s!=e.SheetNames.length;++s)r.push(n(e.Sheets[e.SheetNames[s]],e,s));return r.push("    </office:spreadsheet>\n"),r.push("  </office:body>\n"),"fods"==t.bookType?r.push("</office:document>"):r.push("</office:document-content>"),r.join("")}}();function cw(e,t){if("fods"==t.bookType)return lw(e,t);var n=Zf(),r="",a=[],i=[];return Xf(n,r="mimetype","application/vnd.oasis.opendocument.spreadsheet"),Xf(n,r="content.xml",lw(e,t)),a.push([r,"text/xml"]),i.push([r,"ContentFile"]),Xf(n,r="styles.xml",ow(e,t)),a.push([r,"text/xml"]),i.push([r,"StylesFile"]),Xf(n,r="meta.xml",em+Rp()),a.push([r,"text/xml"]),i.push([r,"MetadataFile"]),Xf(n,r="manifest.rdf",function(e){var t=[em];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var n=0;n!=e.length;++n)t.push(_p(e[n][0],e[n][1])),t.push(Op("",e[n][0]));return t.push(_p("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(i)),a.push([r,"application/rdf+xml"]),Xf(n,r="META-INF/manifest.xml",function(e){var t=[em];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(a)),n}function uw(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function dw(e){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):Ih(gm(e))}function hw(e){var t=e.reduce(function(e,t){return e+t.length},0),n=new Uint8Array(t),r=0;return e.forEach(function(e){n.set(e,r),r+=e.length}),n}function fw(e,t){var n=t?t[0]:0,r=127&e[n];e:if(e[n++]>=128){if(r|=(127&e[n])<<7,e[n++]<128)break e;if(r|=(127&e[n])<<14,e[n++]<128)break e;if(r|=(127&e[n])<<21,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,28),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,35),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,42),++n,e[n++]<128)break e}return t&&(t[0]=n),r}function mw(e){var t=new Uint8Array(7);t[0]=127&e;var n=1;e:if(e>127){if(t[n-1]|=128,t[n]=e>>7&127,++n,e<=16383)break e;if(t[n-1]|=128,t[n]=e>>14&127,++n,e<=2097151)break e;if(t[n-1]|=128,t[n]=e>>21&127,++n,e<=268435455)break e;if(t[n-1]|=128,t[n]=e/256>>>21&127,++n,e<=34359738367)break e;if(t[n-1]|=128,t[n]=e/65536>>>21&127,++n,e<=4398046511103)break e;t[n-1]|=128,t[n]=e/16777216>>>21&127,++n}return t.slice(0,n)}function gw(e){var t=0,n=127&e[t];e:if(e[t++]>=128){if(n|=(127&e[t])<<7,e[t++]<128)break e;if(n|=(127&e[t])<<14,e[t++]<128)break e;if(n|=(127&e[t])<<21,e[t++]<128)break e;n|=(127&e[t])<<28}return n}function pw(e){for(var t=[],n=[0];n[0]<e.length;){var r,a=n[0],i=fw(e,n),s=7&i,o=0;if(0==(i=Math.floor(i/8)))break;switch(s){case 0:for(var l=n[0];e[n[0]++]>=128;);r=e.slice(l,n[0]);break;case 5:o=4,r=e.slice(n[0],n[0]+o),n[0]+=o;break;case 1:o=8,r=e.slice(n[0],n[0]+o),n[0]+=o;break;case 2:o=fw(e,n),r=e.slice(n[0],n[0]+o),n[0]+=o;break;default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(a))}var c={data:r,type:s};null==t[i]?t[i]=[c]:t[i].push(c)}return t}function vw(e){var t=[];return e.forEach(function(e,n){e.forEach(function(e){e.data&&(t.push(mw(8*n+e.type)),2==e.type&&t.push(mw(e.data.length)),t.push(e.data))})}),hw(t)}function yw(e){for(var t,n=[],r=[0];r[0]<e.length;){var a=fw(e,r),i=pw(e.slice(r[0],r[0]+a));r[0]+=a;var s={id:gw(i[1][0].data),messages:[]};i[2].forEach(function(t){var n=pw(t.data),a=gw(n[3][0].data);s.messages.push({meta:n,data:e.slice(r[0],r[0]+a)}),r[0]+=a}),(null==(t=i[3])?void 0:t[0])&&(s.merge=gw(i[3][0].data)>>>0>0),n.push(s)}return n}function bw(e){var t=[];return e.forEach(function(e){var n=[];n[1]=[{data:mw(e.id),type:0}],n[2]=[],null!=e.merge&&(n[3]=[{data:mw(+!!e.merge),type:0}]);var r=[];e.messages.forEach(function(e){r.push(e.data),e.meta[3]=[{type:0,data:mw(e.data.length)}],n[2].push({data:vw(e.meta),type:2})});var a=vw(n);t.push(mw(a.length)),t.push(a),r.forEach(function(e){return t.push(e)})}),hw(t)}function ww(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=fw(t,n),a=[];n[0]<t.length;){var i=3&t[n[0]];if(0!=i){var s=0,o=0;if(1==i?(o=4+(t[n[0]]>>2&7),s=(224&t[n[0]++])<<3,s|=t[n[0]++]):(o=1+(t[n[0]++]>>2),2==i?(s=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(s=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),a=[hw(a)],0==s)throw new Error("Invalid offset 0");if(s>a[0].length)throw new Error("Invalid offset beyond length");if(o>=s)for(a.push(a[0].slice(-s)),o-=s;o>=a[a.length-1].length;)a.push(a[a.length-1]),o-=a[a.length-1].length;a.push(a[0].slice(-s,-s+o))}else{var l=t[n[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[n[0]],c>1&&(l|=t[n[0]+1]<<8),c>2&&(l|=t[n[0]+2]<<16),c>3&&(l|=t[n[0]+3]<<24),l>>>=0,l++,n[0]+=c}a.push(t.slice(n[0],n[0]+l)),n[0]+=l}}var u=hw(a);if(u.length!=r)throw new Error("Unexpected length: ".concat(u.length," != ").concat(r));return u}function Sw(e){for(var t=[],n=0;n<e.length;){var r=e[n++],a=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(ww(r,e.slice(n,n+a))),n+=a}if(n!==e.length)throw new Error("data is not a valid framed stream!");return hw(t)}function Tw(e){for(var t=[],n=0;n<e.length;){var r=Math.min(e.length-n,268435455),a=new Uint8Array(4);t.push(a);var i=mw(r),s=i.length;t.push(i),r<=60?(s++,t.push(new Uint8Array([r-1<<2]))):r<=256?(s+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(s+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(s+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(s+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(e.slice(n,n+r)),s+=r,a[0]=0,a[1]=255&s,a[2]=s>>8&255,a[3]=s>>16&255,n+=r}return hw(t)}function Aw(e,t){var n=new Uint8Array(32),r=uw(n),a=12,i=0;switch(n[0]=5,e.t){case"n":n[1]=2,function(e,t,n){var r=Math.floor(0==n?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,a=n/Math.pow(10,r-6176);e[t+15]|=r>>7,e[t+14]|=(127&r)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=255&a;e[t+15]|=n>=0?0:128}(n,a,e.v),i|=1,a+=16;break;case"b":n[1]=6,r.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));n[1]=3,r.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,i,!0),n.slice(0,a)}function xw(e,t){var n=new Uint8Array(32),r=uw(n),a=12,i=0;switch(n[0]=3,e.t){case"n":n[2]=2,r.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":n[2]=6,r.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));n[2]=3,r.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,i,!0),n.slice(0,a)}function kw(e){return fw(pw(e)[1][0].data)}function Cw(e,t,n){var r,a,i,s;if(!(null==(r=e[6])?void 0:r[0])||!(null==(a=e[7])?void 0:a[0]))throw"Mutation only works on post-BNC storages!";if((null==(s=null==(i=e[8])?void 0:i[0])?void 0:s.data)&&gw(e[8][0].data)>0||!1)throw"Math only works with normal offsets";for(var o=0,l=uw(e[7][0].data),c=0,u=[],d=uw(e[4][0].data),h=0,f=[],m=0;m<t.length;++m)if(null!=t[m]){var g,p;switch(l.setUint16(2*m,c,!0),d.setUint16(2*m,h,!0),typeof t[m]){case"string":g=Aw({t:"s",v:t[m]},n),p=xw({t:"s",v:t[m]},n);break;case"number":g=Aw({t:"n",v:t[m]},n),p=xw({t:"n",v:t[m]},n);break;case"boolean":g=Aw({t:"b",v:t[m]},n),p=xw({t:"b",v:t[m]},n);break;default:throw new Error("Unsupported value "+t[m])}u.push(g),c+=g.length,f.push(p),h+=p.length,++o}else l.setUint16(2*m,65535,!0),d.setUint16(2*m,65535);for(e[2][0].data=mw(o);m<e[7][0].data.length/2;++m)l.setUint16(2*m,65535,!0),d.setUint16(2*m,65535,!0);return e[6][0].data=hw(u),e[3][0].data=hw(f),o}function Ew(e){return function(t){for(var n=0;n!=e.length;++n){var r=e[n];void 0===t[r[0]]&&(t[r[0]]=r[1]),"n"===r[2]&&(t[r[0]]=Number(t[r[0]]))}}}function Iw(e){Ew([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Nw(e,t){return"ods"==t.bookType?cw(e,t):"numbers"==t.bookType?function(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=jg(n["!ref"]);r.s.r=r.s.c=0;var a=!1;r.e.c>9&&(a=!0,r.e.c=9),r.e.r>49&&(a=!0,r.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Ug(r)));var i=Uw(n,{range:r,header:1}),s=["~Sh33tJ5~"];i.forEach(function(e){return e.forEach(function(e){"string"==typeof e&&s.push(e)})});var o={},l=[],c=If.read(t.numbers,{type:"base64"});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0],n=e[1];2==t.type&&t.name.match(/\.iwa/)&&yw(Sw(t.content)).forEach(function(e){l.push(e.id),o[e.id]={deps:[],location:n,type:gw(e.messages[0].meta[1][0].data)}})}),l.sort(function(e,t){return e-t});var u=l.filter(function(e){return e>1}).map(function(e){return[e,mw(e)]});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0];e[1],t.name.match(/\.iwa/)&&yw(Sw(t.content)).forEach(function(e){e.messages.forEach(function(t){u.forEach(function(t){e.messages.some(function(e){return 11006!=gw(e.meta[1][0].data)&&function(e,t){e:for(var n=0;n<=e.length-t.length;++n){for(var r=0;r<t.length;++r)if(e[n+r]!=t[r])continue e;return!0}return!1}(e.data,t[1])})&&o[t[0]].deps.push(e.id)})})})});for(var d,h=If.find(c,o[1].location),f=yw(Sw(h.content)),m=0;m<f.length;++m){var g=f[m];1==g.id&&(d=g)}var p=kw(pw(d.messages[0].data)[1][0].data);for(f=yw(Sw((h=If.find(c,o[p].location)).content)),m=0;m<f.length;++m)(g=f[m]).id==p&&(d=g);for(p=kw(pw(d.messages[0].data)[2][0].data),f=yw(Sw((h=If.find(c,o[p].location)).content)),m=0;m<f.length;++m)(g=f[m]).id==p&&(d=g);for(p=kw(pw(d.messages[0].data)[2][0].data),f=yw(Sw((h=If.find(c,o[p].location)).content)),m=0;m<f.length;++m)(g=f[m]).id==p&&(d=g);var v=pw(d.messages[0].data);v[6][0].data=mw(r.e.r+1),v[7][0].data=mw(r.e.c+1);for(var y=kw(v[46][0].data),b=If.find(c,o[y].location),w=yw(Sw(b.content)),S=0;S<w.length&&w[S].id!=y;++S);if(w[S].id!=y)throw"Bad ColumnRowUIDMapArchive";var T=pw(w[S].messages[0].data);T[1]=[],T[2]=[],T[3]=[];for(var A=0;A<=r.e.c;++A){var x=[];x[1]=x[2]=[{type:0,data:mw(A+420690)}],T[1].push({type:2,data:vw(x)}),T[2].push({type:0,data:mw(A)}),T[3].push({type:0,data:mw(A)})}T[4]=[],T[5]=[],T[6]=[];for(var k=0;k<=r.e.r;++k)(x=[])[1]=x[2]=[{type:0,data:mw(k+726270)}],T[4].push({type:2,data:vw(x)}),T[5].push({type:0,data:mw(k)}),T[6].push({type:0,data:mw(k)});w[S].messages[0].data=vw(T),b.content=Tw(bw(w)),b.size=b.content.length,delete v[46];var C=pw(v[4][0].data);C[7][0].data=mw(r.e.r+1);var E=kw(pw(C[1][0].data)[2][0].data);if((w=yw(Sw((b=If.find(c,o[E].location)).content)))[0].id!=E)throw"Bad HeaderStorageBucket";var I=pw(w[0].messages[0].data);for(k=0;k<i.length;++k){var N=pw(I[2][0].data);N[1][0].data=mw(k),N[4][0].data=mw(i[k].length),I[2][k]={type:I[2][0].type,data:vw(N)}}w[0].messages[0].data=vw(I),b.content=Tw(bw(w)),b.size=b.content.length;var P=kw(C[2][0].data);if((w=yw(Sw((b=If.find(c,o[P].location)).content)))[0].id!=P)throw"Bad HeaderStorageBucket";for(I=pw(w[0].messages[0].data),A=0;A<=r.e.c;++A)(N=pw(I[2][0].data))[1][0].data=mw(A),N[4][0].data=mw(r.e.r+1),I[2][A]={type:I[2][0].type,data:vw(N)};w[0].messages[0].data=vw(I),b.content=Tw(bw(w)),b.size=b.content.length;var _=kw(C[4][0].data);!function(){for(var e,t=If.find(c,o[_].location),n=yw(Sw(t.content)),r=0;r<n.length;++r){var a=n[r];a.id==_&&(e=a)}var i=pw(e.messages[0].data);i[3]=[];var l=[];s.forEach(function(e,t){l[1]=[{type:0,data:mw(t)}],l[2]=[{type:0,data:mw(1)}],l[3]=[{type:2,data:dw(e)}],i[3].push({type:2,data:vw(l)})}),e.messages[0].data=vw(i);var u=Tw(bw(n));t.content=u,t.size=t.content.length}();var O=pw(C[3][0].data),R=O[1][0];delete O[2];var M=pw(R.data),D=kw(M[2][0].data);!function(){for(var e,t=If.find(c,o[D].location),n=yw(Sw(t.content)),a=0;a<n.length;++a){var l=n[a];l.id==D&&(e=l)}var u=pw(e.messages[0].data);delete u[6],delete O[7];var d=new Uint8Array(u[5][0].data);u[5]=[];for(var h=0,f=0;f<=r.e.r;++f){var m=pw(d);h+=Cw(m,i[f],s),m[1][0].data=mw(f),u[5].push({data:vw(m),type:2})}u[1]=[{type:0,data:mw(r.e.c+1)}],u[2]=[{type:0,data:mw(r.e.r+1)}],u[3]=[{type:0,data:mw(h)}],u[4]=[{type:0,data:mw(r.e.r+1)}],e.messages[0].data=vw(u);var g=Tw(bw(n));t.content=g,t.size=t.content.length}(),R.data=vw(M),C[3][0].data=vw(O),v[4][0].data=vw(C),d.messages[0].data=vw(v);var L=Tw(bw(f));return h.content=L,h.size=h.content.length,c}(e,t):"xlsb"==t.bookType?function(e,t){ry=1024,e&&!e.SSF&&(e.SSF=Gf(qh));e&&e.SSF&&(kf(),xf(e.SSF),t.revssf=Df(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF);t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Jy?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xlsb"==t.bookType?"bin":"xml",r=cy.indexOf(t.bookType)>-1,a={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Iw(t=t||{});var i=Zf(),s="",o=0;t.cellXfs=[],tb(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});if(Xf(i,s="docProps/core.xml",Lp(e.Props,t)),a.coreprops.push(s),Pp(t.rels,2,s,Ep.CORE_PROPS),s="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,Xf(i,s,Up(e.Props)),a.extprops.push(s),Pp(t.rels,3,s,Ep.EXT_PROPS),e.Custprops!==e.Props&&Of(e.Custprops||{}).length>0&&(Xf(i,s="docProps/custom.xml",Bp(e.Custprops)),a.custprops.push(s),Pp(t.rels,4,s,Ep.CUST_PROPS));for(o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},d=e.Sheets[e.SheetNames[o-1]];(d||{})["!type"];if(Xf(i,s="xl/worksheets/sheet"+o+"."+n,Pb(o-1,s,t,e,u)),a.sheets.push(s),Pp(t.wbrels,-1,"worksheets/sheet"+o+"."+n,Ep.WS[0]),d){var h=d["!comments"],f=!1,m="";h&&h.length>0&&(Xf(i,m="xl/comments"+o+"."+n,_b(h,m,t)),a.comments.push(m),Pp(u,-1,"../comments"+o+"."+n,Ep.CMNT),f=!0),d["!legacy"]&&f&&Xf(i,"xl/drawings/vmlDrawing"+o+".vml",ay(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}u["!id"].rId1&&Xf(i,Ip(s),Np(u))}null!=t.Strings&&t.Strings.length>0&&(Xf(i,s="xl/sharedStrings."+n,function(e,t,n){return(".bin"===t.slice(-4)?Ev:kv)(e,n)}(t.Strings,s,t)),a.strs.push(s),Pp(t.wbrels,-1,"sharedStrings."+n,Ep.SST));Xf(i,s="xl/workbook."+n,function(e,t,n){return(".bin"===t.slice(-4)?Nb:Cb)(e,n)}(e,s,t)),a.workbooks.push(s),Pp(t.rels,1,s,Ep.WB),Xf(i,s="xl/theme/theme1.xml",ey(e.Themes,t)),a.themes.push(s),Pp(t.wbrels,-1,"theme/theme1.xml",Ep.THEME),Xf(i,s="xl/styles."+n,function(e,t,n){return(".bin"===t.slice(-4)?Zv:Bv)(e,n)}(e,s,t)),a.styles.push(s),Pp(t.wbrels,-1,"styles."+n,Ep.STY),e.vbaraw&&r&&(Xf(i,s="xl/vbaProject.bin",e.vbaraw),a.vba.push(s),Pp(t.wbrels,-1,"vbaProject.bin",Ep.VBA));return Xf(i,s="xl/metadata."+n,function(e){return(".bin"===e.slice(-4)?ty:ny)()}(s)),a.metadata.push(s),Pp(t.wbrels,-1,"metadata."+n,Ep.XLMETA),Xf(i,"[Content_Types].xml",Cp(a,t)),Xf(i,"_rels/.rels",Np(t.rels)),Xf(i,"xl/_rels/workbook."+n+".rels",Np(t.wbrels)),delete t.revssf,delete t.ssf,i}(e,t):Pw(e,t)}function Pw(e,t){ry=1024,e&&!e.SSF&&(e.SSF=Gf(qh)),e&&e.SSF&&(kf(),xf(e.SSF),t.revssf=Df(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Jy?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xml",r=cy.indexOf(t.bookType)>-1,a={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Iw(t=t||{});var i=Zf(),s="",o=0;if(t.cellXfs=[],tb(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),Xf(i,s="docProps/core.xml",Lp(e.Props,t)),a.coreprops.push(s),Pp(t.rels,2,s,Ep.CORE_PROPS),s="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,Xf(i,s,Up(e.Props)),a.extprops.push(s),Pp(t.rels,3,s,Ep.EXT_PROPS),e.Custprops!==e.Props&&Of(e.Custprops||{}).length>0&&(Xf(i,s="docProps/custom.xml",Bp(e.Custprops)),a.custprops.push(s),Pp(t.rels,4,s,Ep.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},h=e.Sheets[e.SheetNames[o-1]];(h||{})["!type"];if(Xf(i,s="xl/worksheets/sheet"+o+"."+n,sb(o-1,t,e,d)),a.sheets.push(s),Pp(t.wbrels,-1,"worksheets/sheet"+o+"."+n,Ep.WS[0]),h){var f=h["!comments"],m=!1,g="";if(f&&f.length>0){var p=!1;f.forEach(function(e){e[1].forEach(function(e){1==e.T&&(p=!0)})}),p&&(Xf(i,g="xl/threadedComments/threadedComment"+o+"."+n,sy(f,u,t)),a.threadedcomments.push(g),Pp(d,-1,"../threadedComments/threadedComment"+o+"."+n,Ep.TCMNT)),Xf(i,g="xl/comments"+o+"."+n,iy(f)),a.comments.push(g),Pp(d,-1,"../comments"+o+"."+n,Ep.CMNT),m=!0}h["!legacy"]&&m&&Xf(i,"xl/drawings/vmlDrawing"+o+".vml",ay(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&Xf(i,Ip(s),Np(d))}return null!=t.Strings&&t.Strings.length>0&&(Xf(i,s="xl/sharedStrings."+n,kv(t.Strings,t)),a.strs.push(s),Pp(t.wbrels,-1,"sharedStrings."+n,Ep.SST)),Xf(i,s="xl/workbook."+n,Cb(e)),a.workbooks.push(s),Pp(t.rels,1,s,Ep.WB),Xf(i,s="xl/theme/theme1.xml",ey(e.Themes,t)),a.themes.push(s),Pp(t.wbrels,-1,"theme/theme1.xml",Ep.THEME),Xf(i,s="xl/styles."+n,Bv(e,t)),a.styles.push(s),Pp(t.wbrels,-1,"styles."+n,Ep.STY),e.vbaraw&&r&&(Xf(i,s="xl/vbaProject.bin",e.vbaraw),a.vba.push(s),Pp(t.wbrels,-1,"vbaProject.bin",Ep.VBA)),Xf(i,s="xl/metadata."+n,ny()),a.metadata.push(s),Pp(t.wbrels,-1,"metadata."+n,Ep.XLMETA),u.length>1&&(Xf(i,s="xl/persons/person.xml",function(e){var t=[em,wm("personList",null,{xmlns:Em,"xmlns:x":Dm[0]}).replace(/[\/]>/,">")];return e.forEach(function(e,n){t.push(wm("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}(u)),a.people.push(s),Pp(t.wbrels,-1,"persons/person.xml",Ep.PEOPLE)),Xf(i,"[Content_Types].xml",Cp(a,t)),Xf(i,"_rels/.rels",Np(t.rels)),Xf(i,"xl/_rels/workbook.xml.rels",Np(t.wbrels)),delete t.revssf,delete t.ssf,i}function _w(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=Ah(e.slice(0,12));break;case"binary":n=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function Ow(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return _f(t.file,If.write(e,{type:xh?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return If.write(e,t)}function Rw(e,t){var n={},r=xh?"nodebuffer":"undefined"!==typeof Uint8Array?"array":"string";if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=r;else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?If.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!t.compression}):e.generate(n);if("undefined"!==typeof Deno&&"string"==typeof a){if("binary"==t.type||"base64"==t.type)return a;a=new Uint8Array(Nh(a))}return t.password&&"undefined"!==typeof encrypt_agile?Ow(encrypt_agile(a,t.password),t):"file"===t.type?_f(t.file,a):"string"==t.type?mm(a):a}function Mw(e,t,n){n||(n="");var r=n+e;switch(t.type){case"base64":return Th(gm(r));case"binary":return gm(r);case"string":return e;case"file":return _f(t.file,r,"utf8");case"buffer":return xh?kh(r,"utf8"):"undefined"!==typeof TextEncoder?(new TextEncoder).encode(r):Mw(r,{type:"binary"}).split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Dw(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",r=0;r<e.length;++r)n+=String.fromCharCode(e[r]);return"base64"==t.type?Th(n):"string"==t.type?mm(n):n;case"file":return _f(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Lw(e,t){ph(),kb(e);var n=Gf(t||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),"array"==n.type){n.type="binary";var r=Lw(e,n);return n.type="array",Nh(r)}var a=0;if(n.sheet&&(a="number"==typeof n.sheet?n.sheet:e.SheetNames.indexOf(n.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return Mw(Fb(e,n),n);case"slk":case"sylk":return Mw(bv.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"htm":case"html":return Mw(rw(e.Sheets[e.SheetNames[a]],n),n);case"txt":return function(e,t){switch(t.type){case"base64":return Th(e);case"binary":case"string":return e;case"file":return _f(t.file,e,"binary");case"buffer":return xh?kh(e,"binary"):e.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}(qw(e.Sheets[e.SheetNames[a]],n),n);case"csv":return Mw(zw(e.Sheets[e.SheetNames[a]],n),n,"\ufeff");case"dif":return Mw(wv.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"dbf":return Dw(yv.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"prn":return Mw(Tv.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"rtf":return Mw(Pv.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"eth":return Mw(Sv.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"fods":return Mw(cw(e,n),n);case"wk1":return Dw(Av.sheet_to_wk1(e.Sheets[e.SheetNames[a]],n),n);case"wk3":return Dw(Av.book_to_wk3(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),Dw(Xb(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),function(e,t){var n=t||{};return Ow(Hb(e,n),n)}(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function(e,t){var n=Gf(t||{});return Rw(Nw(e,n),n)}(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function Fw(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}function jw(e,t,n,r,a,i,s,o){var l=Rg(n),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,h=1===a?[]:{};if(1!==a)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:n,enumerable:!1})}catch(p){h.__rowNum__=n}else h.__rowNum__=n;if(!s||e[n])for(var f=t.s.c;f<=t.e.c;++f){var m=s?e[n][f]:e[r[f]+l];if(void 0!==m&&void 0!==m.t){var g=m.v;switch(m.t){case"z":if(null==g)break;continue;case"e":g=0==g?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(null!=i[f]){if(null==g)if("e"==m.t&&null===g)h[i[f]]=null;else if(void 0!==c)h[i[f]]=c;else{if(!u||null!==g)continue;h[i[f]]=null}else h[i[f]]=u&&("n"!==m.t||"n"===m.t&&!1!==o.rawNumbers)?g:zg(m,g,o);null!=g&&(d=!1)}}else{if(void 0===c)continue;null!=i[f]&&(h[i[f]]=c)}}return{row:h,isempty:d}}function Uw(e,t){if(null==e||null==e["!ref"])return[];var n={t:"n",v:0},r=0,a=1,i=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=null!=c.range?c.range:e["!ref"];switch(1===c.header?r=1:"A"===c.header?r=2:Array.isArray(c.header)?r=3:null==c.header&&(r=0),typeof u){case"string":l=Bg(u);break;case"number":(l=Bg(e["!ref"])).s.r=u;break;default:l=u}r>0&&(a=0);var d=Rg(l.s.r),h=[],f=[],m=0,g=0,p=Array.isArray(e),v=l.s.r,y=0,b={};p&&!e[v]&&(e[v]=[]);var w=c.skipHidden&&e["!cols"]||[],S=c.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(w[y]||{}).hidden)switch(h[y]=Dg(y),n=p?e[v][y]:e[h[y]+d],r){case 1:i[y]=y-l.s.c;break;case 2:i[y]=h[y];break;case 3:i[y]=c.header[y-l.s.c];break;default:if(null==n&&(n={w:"__EMPTY",t:"s"}),o=s=zg(n,null,c),g=b[s]||0){do{o=s+"_"+g++}while(b[o]);b[s]=g,b[o]=1}else b[s]=1;i[y]=o}for(v=l.s.r+a;v<=l.e.r;++v)if(!(S[v]||{}).hidden){var T=jw(e,l,v,h,r,i,p,c);(!1===T.isempty||(1===r?!1!==c.blankrows:c.blankrows))&&(f[m++]=T.row)}return f.length=m,f}var Bw=/"/g;function Hw(e,t,n,r,a,i,s,o){for(var l=!0,c=[],u="",d=Rg(n),h=t.s.c;h<=t.e.c;++h)if(r[h]){var f=o.dense?(e[n]||[])[h]:e[r[h]+d];if(null==f)u="";else if(null!=f.v){l=!1,u=""+(o.rawNumbers&&"n"==f.t?f.v:zg(f,null,o));for(var m=0,g=0;m!==u.length;++m)if((g=u.charCodeAt(m))===a||g===i||34===g||o.forceQuotes){u='"'+u.replace(Bw,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==f.f||f.F?u="":(l=!1,(u="="+f.f).indexOf(",")>=0&&(u='"'+u.replace(Bw,'""')+'"'));c.push(u)}return!1===o.blankrows&&l?null:c.join(s)}function zw(e,t){var n=[],r=null==t?{}:t;if(null==e||null==e["!ref"])return"";var a=Bg(e["!ref"]),i=void 0!==r.FS?r.FS:",",s=i.charCodeAt(0),o=void 0!==r.RS?r.RS:"\n",l=o.charCodeAt(0),c=new RegExp(("|"==i?"\\|":i)+"+$"),u="",d=[];r.dense=Array.isArray(e);for(var h=r.skipHidden&&e["!cols"]||[],f=r.skipHidden&&e["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(h[m]||{}).hidden||(d[m]=Dg(m));for(var g=0,p=a.s.r;p<=a.e.r;++p)(f[p]||{}).hidden||null!=(u=Hw(e,a,p,d,s,l,i,r))&&(r.strip&&(u=u.replace(c,"")),(u||!1!==r.blankrows)&&n.push((g++?o:"")+u));return delete r.dense,n.join("")}function qw(e,t){t||(t={}),t.FS="\t",t.RS="\n";var n=zw(e,t);if("undefined"==typeof yh||"string"==t.type)return n;var r=yh.utils.encode(1200,n,"str");return String.fromCharCode(255)+String.fromCharCode(254)+r}function Ww(e,t,n){var r,a=n||{},i=+!a.skipHeader,s=e||{},o=0,l=0;if(s&&null!=a.origin)if("number"==typeof a.origin)o=a.origin;else{var c="string"==typeof a.origin?Lg(a.origin):a.origin;o=c.r,l=c.c}var u={s:{c:0,r:0},e:{c:l,r:o+t.length-1+i}};if(s["!ref"]){var d=Bg(s["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),-1==o&&(o=d.e.r+1,u.e.r=o+t.length-1+i)}else-1==o&&(o=0,u.e.r=t.length-1+i);var h=a.header||[],f=0;t.forEach(function(e,t){Of(e).forEach(function(n){-1==(f=h.indexOf(n))&&(h[f=h.length]=n);var c=e[n],u="z",d="",m=Fg({c:l+f,r:o+t+i});r=Vw(s,m),!c||"object"!==typeof c||c instanceof Date?("number"==typeof c?u="n":"boolean"==typeof c?u="b":"string"==typeof c?u="s":c instanceof Date?(u="d",a.cellDates||(u="n",c=Ff(c)),d=a.dateNF||qh[14]):null===c&&a.nullError&&(u="e",c=0),r?(r.t=u,r.v=c,delete r.w,delete r.R,d&&(r.z=d)):s[m]=r={t:u,v:c},d&&(r.z=d)):s[m]=c})}),u.e.c=Math.max(u.e.c,l+h.length-1);var m=Rg(o);if(i)for(f=0;f<h.length;++f)s[Dg(f+l)+m]={t:"s",v:h[f]};return s["!ref"]=Ug(u),s}function Vw(e,t,n){if("string"==typeof t){if(Array.isArray(e)){var r=Lg(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return Vw(e,Fg("number"!=typeof t?t:{r:t,c:n||0}))}function Kw(){return{SheetNames:[],Sheets:{}}}function Gw(e,t,n,r){var a=1;if(!n)for(;a<=65535&&-1!=e.SheetNames.indexOf(n="Sheet"+a);++a,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var i=n.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||n;for(++a;a<=65535&&-1!=e.SheetNames.indexOf(n=s+a);++a);}if(xb(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function Yw(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}var $w={encode_col:Dg,encode_row:Rg,encode_cell:Fg,encode_range:Ug,decode_col:Mg,decode_row:Og,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Lg,decode_range:jg,format_cell:zg,sheet_add_aoa:Wg,sheet_add_json:Ww,sheet_add_dom:aw,aoa_to_sheet:Vg,json_to_sheet:function(e,t){return Ww(null,e,t)},table_to_sheet:iw,table_to_book:function(e,t){return qg(iw(e,t),t)},sheet_to_csv:zw,sheet_to_txt:qw,sheet_to_json:Uw,sheet_to_html:rw,sheet_to_formulae:function(e){var t,n="",r="";if(null==e||null==e["!ref"])return[];var a,i=Bg(e["!ref"]),s="",o=[],l=[],c=Array.isArray(e);for(a=i.s.c;a<=i.e.c;++a)o[a]=Dg(a);for(var u=i.s.r;u<=i.e.r;++u)for(s=Rg(u),a=i.s.c;a<=i.e.c;++a)if(n=o[a]+s,r="",void 0!==(t=c?(e[u]||[])[a]:e[n])){if(null!=t.F){if(n=t.F,!t.f)continue;r=t.f,-1==n.indexOf(":")&&(n=n+":"+n)}if(null!=t.f)r=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)r=""+t.v;else if("b"==t.t)r=t.v?"TRUE":"FALSE";else if(void 0!==t.w)r="'"+t.w;else{if(void 0===t.v)continue;r="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=n+"="+r}return l},sheet_to_row_object_array:Uw,sheet_get_cell:Vw,book_new:Kw,book_append_sheet:Gw,book_set_sheet_visibility:function(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:Yw,cell_set_internal_link:function(e,t,n){return Yw(e,"#"+t,n)},cell_add_comment:function(e,t,n){e.c||(e.c=[]),e.c.push({t:t,a:n||"SheetJS"})},sheet_set_array_formula:function(e,t,n,r){for(var a="string"!=typeof t?t:Bg(t),i="string"==typeof t?t:Ug(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var l=Vw(e,s,o);l.t="n",l.F=i,delete l.v,s==a.s.r&&o==a.s.c&&(l.f=n,r&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};ch.version;class Qw{static exportSchedule(e,t,n,r){try{const a=$w.book_new(),i=this.generateScheduleData(e,t,n),s=this.generateAbsencesData(t,n),o=$w.aoa_to_sheet(i),l=$w.aoa_to_sheet(s);o["!cols"]=[{wch:25},{wch:15},{wch:30},{wch:30}],l["!cols"]=[{wch:25},{wch:15},{wch:20}],$w.book_append_sheet(a,o,"Schedule"),$w.book_append_sheet(a,l,"Staff Attendance");const c=r.toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\//g,"-"),u="Schedule_".concat(c,".xlsx");return function(e,t,n){var r=n||{};r.type="file",r.file=t,Fw(r),Lw(e,r)}(a,u),console.log("\u2705 Exported schedule to ".concat(u)),!0}catch(a){throw console.error("Error exporting schedule:",a),new Error("Failed to export schedule: ".concat(a.message))}}static generateScheduleData(e,t,n){const r=[];r.push(["Client","Program","AM Staff","PM Staff"]);return t.filter(e=>e.isActive).sort((e,t)=>e.name.localeCompare(t.name)).forEach(t=>{var a,i;const s=e.assignments.filter(e=>e.studentId===t.id&&"AM"===e.session),o=e.assignments.filter(e=>e.studentId===t.id&&"PM"===e.session),l="2:1"===t.ratioAM?2:1,c="2:1"===t.ratioPM?2:1;s.length>l&&(console.log("\u26a0\ufe0f ".concat(t.name," has ").concat(s.length," AM assignments but ratio is ").concat(t.ratioAM," (expected ").concat(l,")")),console.log("  AM assignments:",s.map(e=>{var t;return{staffId:e.staffId,staffName:null===(t=n.find(t=>t.id===e.staffId))||void 0===t?void 0:t.name}}))),o.length>c&&(console.log("\u26a0\ufe0f ".concat(t.name," has ").concat(o.length," PM assignments but ratio is ").concat(t.ratioPM," (expected ").concat(c,")")),console.log("  PM assignments:",o.map(e=>{var t;return{staffId:e.staffId,staffName:null===(t=n.find(t=>t.id===e.staffId))||void 0===t?void 0:t.name}})));const u=null===(a=e.traineeAssignments)||void 0===a?void 0:a.find(e=>e.studentId===t.id&&"AM"===e.session),d=null===(i=e.traineeAssignments)||void 0===i?void 0:i.find(e=>e.studentId===t.id&&"PM"===e.session),h=s.map(e=>{const t=n.find(t=>t.id===e.staffId);return t?t.name:"Unknown"}),f=[...new Set(h)].join(", "),m=o.map(e=>{const t=n.find(t=>t.id===e.staffId);return t?t.name:"Unknown"}),g=[...new Set(m)].join(", "),p=!t.isAvailableForSession("AM"),v=!t.isAvailableForSession("PM");if(p&&v||r.push([t.name,t.program,p?"ABSENT":f||"",v?"ABSENT":g||""]),u&&!p){const e=n.find(e=>e.id===u.staffId);e&&r.push([t.name+" (Trainee)",t.program,e.name,""])}if(d&&!v){const e=n.find(e=>e.id===d.staffId);e&&r.push([t.name+" (Trainee)",t.program,"",e.name])}}),r}static generateAbsencesData(e,t){const n=[];n.push(["Name","Role","Status"]);const r=[];return t.forEach(e=>{if(!e.isActive)return;let t="Present";e.absentFullDay||e.absentAM&&e.absentPM?t="Absent Full Day":e.absentAM?t="Absent AM":e.absentPM?t="Absent PM":e.outOfSessionFullDay||e.outOfSessionAM&&e.outOfSessionPM?t="Out Session Full Day":e.outOfSessionAM?t="Out Session AM":e.outOfSessionPM&&(t="Out Session PM"),r.push({name:e.name,role:e.role,status:t})}),r.sort((e,t)=>e.name.localeCompare(t.name)),r.forEach(e=>{n.push([e.name,e.role,e.status])}),0===r.length&&n.push(["No active staff found","",""]),n}}const Jw=v("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),Xw=v("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),Zw=v("graduation-cap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]),eS=v("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),tS=v("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var nS=n(414);const rS=e=>{let{schedule:t,staff:n,students:a,onAssignmentLock:i,onAssignmentUnlock:s,onAssignmentRemove:o,onManualAssignment:l,selectedDate:u}=e;console.log("\ud83d\udd0d ScheduleTableView rendering with:",{studentsCount:a.length,staffCount:n.length,assignmentsCount:t.assignments.length});const[d,h]=(0,r.useState)({}),[f,m]=(0,r.useState)(new Set),[g,p]=(0,r.useState)({});(0,r.useEffect)(()=>{console.log("\ud83d\udd04 Schedule changed, syncing state..."),console.log("  Total assignments:",t.assignments.length);const e=new Set;t.assignments.forEach(t=>{const n=b(t.studentId,t.session);e.add(n)}),m(e),h(e=>{const n=c({},e);return t.assignments.forEach(e=>{const t=b(e.studentId,e.session);n[t]&&delete n[t]}),n})},[t.assignments.length]);const v=[...new Set(a.filter(e=>e.isActive).map(e=>e.program))],y=e=>{let t=[];return e.team&&e.team.length>0&&(t=e.team.map(e=>{const t=e.title||e.DisplayName||e.LookupValue;if(!t)return null;let r=null,a=e.email;return e.email&&(r=n.find(t=>t.email&&t.email.toLowerCase()===e.email.toLowerCase())),!r&&e.id&&(r=n.find(t=>t.id===e.id)),r?{id:e.id,name:t,role:r.role,email:a}:(console.log("\u26a0\ufe0f Skipping deleted staff member: ".concat(t," (not in active staff list)")),null)}).filter(Boolean)),t},b=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return"".concat(e,"_").concat(t,"_").concat(n)},w=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const i=b(e,t,r);if(console.log("\ud83d\udcdd Staff selected: Student ".concat(e,", Session ").concat(t,", Staff ").concat(n,", Index ").concat(r)),!n)return void h(e=>c(c({},e),{},{[i]:null}));const s=parseInt(n),o=a.find(t=>t.id===e);if(o&&l&&(console.log("\ud83d\udd12 AUTO-LOCKING assignment: ".concat(s," \u2192 ").concat(o.name," (").concat(t,")")),l({staffId:s,studentId:e,session:t,program:o.program}),m(e=>new Set([...e,i])),console.log("\u2705 Assignment auto-locked successfully"),o.isPaired&&o.isPaired())){const e=o.getPairedStudent(a);if(e){console.log("\ud83d\udd17 LINKED PAIR: Also assigning ".concat(s," to pair partner ").concat(e.name));const n="AM"===t?e.ratioAM:e.ratioPM;if("1:2"===n){l({staffId:s,studentId:e.id,session:t,program:e.program});const n=b(e.id,t,r);m(e=>new Set([...e,n])),console.log("\u2705 Pair partner assignment auto-locked: ".concat(e.name," with same staff"))}else console.log("\u26a0\ufe0f Pair partner ".concat(e.name," has ratio ").concat(n,", not auto-assigning"))}}},S=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=b(e,t,n);console.log("\ud83d\udd13 Unlocking assignment: Student ".concat(e,", Session ").concat(t,", Index ").concat(n));const i=a.find(t=>t.id===e),l=k(i,t)[n];if(l){console.log("\ud83d\uddd1\ufe0f Removing assignment ID: ".concat(l.id," (Index ").concat(n,")"));const e=l.staffId;if(o&&o(l.id),s&&s(l.id),i.isPaired&&i.isPaired()){const r=i.getPairedStudent(a);if(r){console.log("\ud83d\udd17 LINKED PAIR: Also removing ".concat(e," from pair partner ").concat(r.name));const a=k(r,t).find(t=>t.staffId===e);if(a){console.log("\ud83d\uddd1\ufe0f Removing paired assignment ID: ".concat(a.id)),o&&o(a.id),s&&s(a.id);const e=b(r.id,t,n);m(t=>{const n=new Set(t);return n.delete(e),n}),console.log("\u2705 Pair partner assignment unlocked: ".concat(r.name))}}}}m(e=>{const t=new Set(e);return t.delete(r),t}),h(e=>c(c({},e),{},{[r]:null})),console.log("\u2705 Assignment unlocked successfully")},T=(e,t)=>{const n=b(e,t);return f.has(n)},A=e=>{let t=e.name;if(e.isPaired()){const n=e.getPairedStudent(a);n&&(t+=" (paired: ".concat(n.name,")"))}return t},x=e=>{const t={[j.ONE_TO_ONE]:"bg-blue-100 text-blue-800",[j.TWO_TO_ONE]:"bg-red-100 text-red-800",[j.ONE_TO_TWO]:"bg-green-100 text-green-800"};return(0,nS.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(t[e.ratio]||"bg-gray-100 text-gray-800"),children:e.ratio})},k=(e,n)=>t&&t.assignments?t.assignments.filter(t=>t.studentId===e.id&&t.session===n&&t.program===e.program):[],C=(e,r)=>{if(!e.isAvailableForSession(r))return(0,nS.jsxs)("div",{className:"flex items-center gap-2",children:[(0,nS.jsx)("div",{className:"text-sm px-3 py-2 bg-gray-100 text-gray-400 rounded border border-gray-200 italic",children:"ABSENT"}),(0,nS.jsx)("span",{className:"px-2 py-1 bg-red-100 text-red-600 rounded text-xs font-medium",children:e.absentFullDay?"Full Day":"AM"===r?"Absent AM":"Absent PM"})]});const a=y(e),i=((e,t)=>{switch("AM"===t?e.ratioAM:e.ratioPM){case j.TWO_TO_ONE:return 2;case j.ONE_TO_ONE:case j.ONE_TO_TWO:default:return 1}})(e,r),s=k(e,r);console.log("\ud83d\udd0d DROPDOWN RENDER for ".concat(e.name," ").concat(r,":")),console.log("  Required staff:",i),console.log("  Current assignments:",s.length);const o=a.filter(a=>{if(s.some(e=>e.staffId===a.id||e.staffId==a.id))return!0;const i=e.getStaffTrainingStatus?e.getStaffTrainingStatus(a.id):W;if(i===z||i===H)return console.log("\ud83d\udeab Excluding ".concat(a.name," from regular staff dropdown - in training (").concat(i,")")),!1;const o=n.find(e=>e.id===a.id||e.id==a.id);return!!o&&(o.isAvailableForSession(r)?t.isStaffAvailable(o.id,r,e.program):(console.log("\ud83d\udeab Excluding ".concat(a.name," from dropdown - absent for ").concat(r)),!1))});if(0===o.length)return(0,nS.jsx)("span",{className:"text-gray-400 text-sm",children:"No available team"});const l=[];for(let t=0;t<i;t++){const a=s[t],c="".concat(e.id,"_").concat(r,"_").concat(t),u=(T(e.id,r),(null===a||void 0===a?void 0:a.staffId)||d[c]||""),h=s.filter((e,n)=>n!==t).map(e=>e.staffId),f=o.filter(e=>!h.includes(e.id)||e.id===u);l.push((0,nS.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,nS.jsxs)("select",{value:u,onChange:n=>w(e.id,r,n.target.value,t),disabled:!!a,className:"text-sm border rounded px-2 py-1 min-w-[160px] ".concat(a?(()=>{const e=n.find(e=>e.id===a.staffId);if(!e)return"bg-gray-100 text-gray-600 font-bold";return{RBT:"bg-purple-100 text-purple-700 font-bold",BS:"bg-blue-100 text-blue-700 font-bold",BCBA:"bg-orange-100 text-orange-700 font-bold",EA:"bg-green-100 text-green-700 font-bold",MHA:"bg-yellow-100 text-yellow-800 font-bold",CC:"bg-red-100 text-red-700 font-bold",Teacher:"bg-pink-100 text-pink-700 font-bold",Director:"bg-gray-100 text-gray-800 font-bold"}[e.role]||"bg-gray-100 text-gray-600 font-bold"})():"bg-white"),children:[(0,nS.jsx)("option",{value:"",children:"Select staff..."}),f.map(t=>{const n=(e.getStaffTrainingStatus?e.getStaffTrainingStatus(t.id):W)===q;return(0,nS.jsxs)("option",{value:t.id,children:[n?"\u2b50 ":"",t.name," (",t.role,")"]},t.id)})]}),i>1&&(0,nS.jsxs)("span",{className:"text-xs text-gray-500",children:["#",t+1]}),a&&(0,nS.jsx)("button",{onClick:()=>S(e.id,r,t),className:"p-1 text-red-600 hover:text-red-800 hover:bg-red-50 rounded",title:"Remove this assignment",children:(0,nS.jsx)(Jw,{className:"w-4 h-4"})})]},c))}return(0,nS.jsxs)("div",{className:"space-y-1",children:[l,i>1&&(0,nS.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Requires ",i," staff"]})]})},E=(e,r)=>{if(!e.isAvailableForSession(r))return null;const i=y(e),s="".concat(e.id,"_").concat(r),o=g[s]||"",l=i.filter(t=>{const n=e.getStaffTrainingStatus?e.getStaffTrainingStatus(t.id):W,r=n===z||n===H;return console.log("\ud83c\udf93 Checking ".concat(t.name," for trainee dropdown:"),{trainingStatus:n,isInTraining:r,isOverlapStaff:n===z,isOverlapBCBA:n===H}),r}).filter(a=>{if(o&&a.id==o)return!0;const i=n.find(e=>e.id===a.id||e.id==a.id);return!!i&&(i.isAvailableForSession(r)?t.isStaffAvailable(i.id,r,e.program):(console.log("\ud83d\udeab Excluding ".concat(a.name," from trainee dropdown - absent for ").concat(r)),!1))});console.log("\ud83c\udf93 Trainees available for ".concat(e.name," ").concat(r,":"),l.map(e=>e.name));return(0,nS.jsx)("div",{className:"mt-2 pt-2 border-t border-gray-200",children:(0,nS.jsxs)("div",{className:"flex items-center gap-2",children:[(0,nS.jsxs)("select",{value:o,onChange:n=>{const i=n.target.value?parseInt(n.target.value):null;if(console.log("\ud83c\udf93 Trainee selected: ".concat(i," for ").concat(e.name," ").concat(r)),i){p(e=>c(c({},e),{},{[s]:i}));const n={staffId:i,studentId:e.id,session:r,program:e.program,isTrainee:!0};if(t.removeTraineeAssignment&&t.removeTraineeAssignment(e.id,r),t.addTraineeAssignment&&t.addTraineeAssignment(n),e.isPaired&&e.isPaired()){const n=e.getPairedStudent(a);if(n){console.log("\ud83d\udd17 LINKED PAIR TRAINEE: Also assigning trainee ".concat(i," to pair partner ").concat(n.name));const e="".concat(n.id,"_").concat(r);p(t=>c(c({},t),{},{[e]:i}));const a={staffId:i,studentId:n.id,session:r,program:n.program,isTrainee:!0};t.removeTraineeAssignment&&t.removeTraineeAssignment(n.id,r),t.addTraineeAssignment&&t.addTraineeAssignment(a),console.log("\u2705 Pair partner trainee assigned: ".concat(n.name))}}}else{if(p(e=>{const t=c({},e);return delete t[s],t}),t.removeTraineeAssignment&&t.removeTraineeAssignment(e.id,r),e.isPaired&&e.isPaired()){const n=e.getPairedStudent(a);if(n){console.log("\ud83d\udd17 LINKED PAIR TRAINEE: Also removing trainee from pair partner ".concat(n.name));const e="".concat(n.id,"_").concat(r);p(t=>{const n=c({},t);return delete n[e],n}),t.removeTraineeAssignment&&t.removeTraineeAssignment(n.id,r),console.log("\u2705 Pair partner trainee removed: ".concat(n.name))}}console.log("\ud83d\uddd1\ufe0f Trainee removed")}},className:"text-sm border rounded px-2 py-1 min-w-[160px] bg-orange-50 border-orange-300",children:[(0,nS.jsx)("option",{value:"",children:"Trainee (optional)..."}),l.map(e=>(0,nS.jsxs)("option",{value:e.id,children:["\ud83c\udf93 ",e.name," (",e.role,")"]},e.id))]}),o&&(0,nS.jsx)("button",{onClick:()=>{if(p(e=>{const t=c({},e);return delete t[s],t}),t.removeTraineeAssignment&&t.removeTraineeAssignment(e.id,r),e.isPaired&&e.isPaired()){const n=e.getPairedStudent(a);if(n){console.log("\ud83d\udd17 LINKED PAIR TRAINEE: Also removing trainee from pair partner ".concat(n.name));const e="".concat(n.id,"_").concat(r);p(t=>{const n=c({},t);return delete n[e],n}),t.removeTraineeAssignment&&t.removeTraineeAssignment(n.id,r),console.log("\u2705 Pair partner trainee removed: ".concat(n.name))}}},className:"p-1 text-red-600 hover:text-red-800 hover:bg-red-50 rounded",title:"Remove trainee",children:(0,nS.jsx)(Jw,{className:"w-4 h-4"})})]})})};return(0,nS.jsx)("div",{className:"space-y-6",children:v.map(e=>{const t=a.filter(t=>t.program===e&&t.isActive).sort((e,t)=>e.name.localeCompare(t.name));return(0,nS.jsxs)("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[(0,nS.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-4",children:[(0,nS.jsx)("h3",{className:"text-lg font-bold",children:e.toUpperCase()}),(0,nS.jsxs)("p",{className:"text-blue-100 text-sm",children:[t.length," students"]})]}),(0,nS.jsx)("div",{className:"overflow-x-auto",children:(0,nS.jsxs)("table",{className:"w-full",children:[(0,nS.jsx)("thead",{className:"bg-gray-50",children:(0,nS.jsxs)("tr",{children:[(0,nS.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r",children:"Client"}),(0,nS.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r",children:"AM Staff Assignment"}),(0,nS.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r",children:"PM Staff Assignment"}),(0,nS.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Full Team"})]})}),(0,nS.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map((e,t)=>{const n=y(e),r=t%2===0;return(0,nS.jsxs)("tr",{className:r?"bg-white":"bg-gray-50",children:[(0,nS.jsx)("td",{className:"px-6 py-4 whitespace-nowrap border-r",children:(0,nS.jsx)("div",{className:"flex items-center",children:(0,nS.jsxs)("div",{children:[(0,nS.jsx)("div",{className:"text-sm font-medium text-gray-900",children:A(e)}),(0,nS.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[x(e),e.isPaired()&&(0,nS.jsx)("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 rounded text-xs font-medium",children:"Paired"})]})]})})}),(0,nS.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap border-r",children:[C(e,"AM"),E(e,"AM")]}),(0,nS.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap border-r",children:[C(e,"PM"),E(e,"PM")]}),(0,nS.jsx)("td",{className:"px-6 py-4",children:(0,nS.jsx)("div",{className:"flex flex-wrap gap-1",children:n.length>0?n.map((t,n)=>{const r=e.getStaffTrainingStatus?e.getStaffTrainingStatus(t.id):W;return(0,nS.jsxs)("div",{className:"flex items-center gap-1",children:[r===q&&(0,nS.jsx)(Xw,{className:"w-3.5 h-3.5 text-yellow-500 fill-yellow-500 flex-shrink-0",title:"Trainer"}),r===z&&(0,nS.jsx)(Zw,{className:"w-3.5 h-3.5 text-red-600 flex-shrink-0",title:"Needs Staff Overlap"}),r===H&&(0,nS.jsx)(Zw,{className:"w-3.5 h-3.5 text-yellow-600 flex-shrink-0",title:"Needs BCBA Overlap"}),(0,nS.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat((a=t.role,{RBT:"bg-purple-100 text-purple-700 font-bold",BS:"bg-blue-100 text-blue-700 font-bold",BCBA:"bg-orange-100 text-orange-700 font-bold",EA:"bg-green-100 text-green-700 font-bold",MHA:"bg-yellow-100 text-yellow-800 font-bold",CC:"bg-red-100 text-red-700 font-bold",Teacher:"bg-pink-100 text-pink-700 font-bold",Director:"bg-gray-100 text-gray-800 font-bold"}[a]||"bg-gray-100 text-gray-800 font-bold")),children:t.name})]},n);var a}):(0,nS.jsx)("span",{className:"text-gray-400 text-sm",children:"No team assigned"})})})]},e.id)})})]})})]},e)})})},aS=e=>{let{schedule:t,staff:n,students:r,session:a,program:i}=e;const s=t.getAssignmentsForSession(a,i),o=r.filter(e=>e.program===i&&e.isActive).sort((e,t)=>e.name.localeCompare(t.name)),l=n.filter(e=>e.isActive&&!e.isAvailableForSession(a)),c=r.filter(e=>e.isActive&&e.program===i&&!e.isAvailableForSession(a)),u=o.filter(e=>e.isAvailableForSession(a)),d=new Set(s.map(e=>e.studentId)),h=u.length-d.size,f={},m=new Set(s.map(e=>e.staffId));s.forEach(e=>{const t=n.find(t=>t.id===e.staffId);if(t){const e=t.role;f[e]||(f[e]=new Set),f[e].add(t.id)}});const g={};Object.keys(f).forEach(e=>{g[e]=f[e].size});const p=o.filter(e=>!d.has(e.id)&&e.isAvailableForSession(a)),v=n.filter(e=>{if(!e.isActive)return!1;if(!e.isAvailableForSession(a))return!1;return("Primary"===i?e.primaryProgram:e.secondaryProgram)&&!m.has(e.id)}),y={};v.forEach(e=>{const t=e.role;y[t]||(y[t]=[]),y[t].push(e)});const b=e=>({RBT:"bg-purple-100 text-purple-800",BS:"bg-indigo-100 text-indigo-800",BCBA:"bg-blue-100 text-blue-800",EA:"bg-green-100 text-green-800",MHA:"bg-yellow-100 text-yellow-800",CC:"bg-orange-100 text-orange-800",Teacher:"bg-pink-100 text-pink-800",Trainer:"bg-gray-100 text-gray-800",Director:"bg-red-100 text-red-800"}[e]||"bg-gray-100 text-gray-800");return(0,nS.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,nS.jsxs)("h3",{className:"font-semibold text-gray-900 mb-3",children:[i," ",a," Summary"]}),(0,nS.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,nS.jsxs)("div",{className:"flex justify-between",children:[(0,nS.jsx)("span",{children:"Total Students:"}),(0,nS.jsx)("span",{className:"font-medium",children:o.length})]}),(0,nS.jsxs)("div",{className:"flex justify-between",children:[(0,nS.jsx)("span",{children:"Assigned:"}),(0,nS.jsx)("span",{className:"font-medium",children:d.size})]}),(0,nS.jsxs)("div",{className:"flex justify-between",children:[(0,nS.jsx)("span",{children:"Unassigned:"}),(0,nS.jsx)("span",{className:"font-medium ".concat(0===h?"text-green-600":h<=2?"text-yellow-600":"text-red-600"),children:h})]}),(0,nS.jsxs)("div",{className:"flex justify-between",children:[(0,nS.jsx)("span",{children:"Staff Used:"}),(0,nS.jsx)("span",{className:"font-medium",children:m.size})]})]}),Object.keys(g).length>0&&(0,nS.jsxs)("div",{className:"mt-3 border-t pt-3",children:[(0,nS.jsx)("div",{className:"text-xs font-medium text-gray-600 mb-2",children:"Staff by Role:"}),(0,nS.jsx)("div",{className:"space-y-1",children:Object.entries(g).sort((e,t)=>{let[n]=e,[r]=t;return n.localeCompare(r)}).map(e=>{let[t,n]=e;return(0,nS.jsxs)("div",{className:"flex justify-between items-center",children:[(0,nS.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-medium ".concat(b(t)),children:t}),(0,nS.jsx)("span",{className:"text-xs font-semibold",children:n})]},t)})})]}),l.length>0&&(0,nS.jsxs)("div",{className:"mt-3 border-t pt-3",children:[(0,nS.jsxs)("div",{className:"text-xs font-medium text-red-600 mb-2",children:["Absent Staff (",l.length,"):"]}),(0,nS.jsx)("div",{className:"space-y-1 max-h-20 overflow-y-auto",children:l.map(e=>(0,nS.jsxs)("div",{className:"text-xs flex items-center gap-2",children:[(0,nS.jsx)("span",{className:"px-2 py-0.5 rounded ".concat(b(e.role)),children:e.role}),(0,nS.jsx)("span",{className:"text-gray-700",children:e.name}),(0,nS.jsx)("span",{className:"text-red-600 text-[10px]",children:e.absentFullDay?"(Full Day)":"AM"===a?"(AM)":"(PM)"})]},e.id))})]}),c.length>0&&(0,nS.jsxs)("div",{className:"mt-3 border-t pt-3",children:[(0,nS.jsxs)("div",{className:"text-xs font-medium text-red-600 mb-2",children:["Absent Clients (",c.length,"):"]}),(0,nS.jsx)("div",{className:"space-y-1 max-h-20 overflow-y-auto",children:c.map(e=>(0,nS.jsxs)("div",{className:"text-xs text-gray-700 flex items-center gap-2",children:[(0,nS.jsx)("span",{children:e.name}),(0,nS.jsx)("span",{className:"text-red-600 text-[10px]",children:e.absentFullDay?"(Full Day)":"AM"===a?"(AM)":"(PM)"})]},e.id))})]}),p.length>0&&(0,nS.jsxs)("div",{className:"mt-3 border-t pt-3",children:[(0,nS.jsx)("div",{className:"text-xs font-medium text-gray-600 mb-2",children:"Unassigned Students:"}),(0,nS.jsx)("div",{className:"space-y-1 max-h-20 overflow-y-auto",children:p.map(e=>(0,nS.jsxs)("div",{className:"text-xs text-gray-700 flex justify-between",children:[(0,nS.jsx)("span",{children:e.name}),(0,nS.jsx)("span",{className:"text-gray-500",children:"AM"===a?e.ratioAM:e.ratioPM})]},e.id))})]}),Object.keys(y).length>0&&(0,nS.jsxs)("div",{className:"mt-3 border-t pt-3",children:[(0,nS.jsx)("div",{className:"text-xs font-medium text-gray-600 mb-2",children:"Available Staff:"}),(0,nS.jsx)("div",{className:"space-y-1 max-h-20 overflow-y-auto",children:Object.entries(y).sort((e,t)=>{let[n]=e,[r]=t;return n.localeCompare(r)}).map(e=>{let[t,n]=e;return(0,nS.jsxs)("div",{className:"space-y-0.5",children:[(0,nS.jsxs)("div",{className:"px-2 py-0.5 rounded text-xs font-medium inline-block ".concat(b(t)),children:[t," (",n.length,")"]}),(0,nS.jsx)("div",{className:"ml-2 space-y-0.5",children:n.map(e=>(0,nS.jsx)("div",{className:"text-xs text-gray-600",children:e.name},e.id))})]},t)})})]}),0===h?(0,nS.jsxs)("div",{className:"mt-3 flex items-center gap-2 text-green-600",children:[(0,nS.jsx)(eS,{className:"w-4 h-4"}),(0,nS.jsx)("span",{className:"text-sm font-medium",children:"Complete"})]}):(0,nS.jsxs)("div",{className:"mt-3 flex items-center gap-2 text-amber-600",children:[(0,nS.jsx)(tS,{className:"w-4 h-4"}),(0,nS.jsx)("span",{className:"text-sm font-medium",children:"Incomplete"})]})]})},iS=v("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),sS=v("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),oS=e=>{let{schedule:t,staff:n,students:a,onValidationChange:i}=e;const[s,o]=(0,r.useState)({errors:[],warnings:[],isValid:!0,lastValidated:null}),[l,c]=(0,r.useState)(!1),[u,d]=(0,r.useState)(!1);(0,r.useEffect)(()=>{h()},[t,n,a]);const h=async()=>{c(!0);try{const e=[],r=[],s=Y.validateSchedule(t,n,a);e.push(...s);const l=f();e.push(...l.errors),r.push(...l.warnings);const c={errors:e,warnings:r,isValid:0===e.length,lastValidated:new Date};o(c),i&&i(c)}catch(e){console.error("Validation error:",e),o({errors:["Validation failed: ".concat(e.message)],warnings:[],isValid:!1,lastValidated:new Date})}finally{c(!1)}},f=()=>{const e=[],t=[],r=(a.filter(e=>e.isActive),n.filter(e=>e.isActive),m());e.push(...r);const i=g();e.push(...i);const s=p();t.push(...s);const o=v();e.push(...o);const l=y();t.push(...l);const c=w();return t.push(...c),{errors:e,warnings:t}},m=()=>{const e=[],n=a.filter(e=>e.isActive);for(const r of n){const n=t.getStudentAssignments(r.id);for(const t of["AM","PM"]){const a=n.filter(e=>e.session===t),i=r.ratio===j.TWO_TO_ONE?2:1;a.length>0&&a.length<i&&e.push("".concat(r.name," requires ").concat(i," staff but has only ").concat(a.length," assigned in ").concat(t," session"))}}return e},g=()=>{const e=[],r=a.filter(e=>e.isActive);for(const a of r){const r=t.getStudentAssignments(a.id).map(e=>e.staffId),i=[...new Set(r)];if(r.length!==i.length){const t=r.filter((e,t)=>r.indexOf(e)!==t).map(e=>{const t=n.find(t=>t.id===e);return t?t.name:"Staff ID ".concat(e)});e.push("".concat(a.name," has the same staff member(s) assigned multiple times: ").concat([...new Set(t)].join(", ")))}}return e},p=()=>{const e=[],r=n.filter(e=>e.isActive);for(const n of r){const r=t.getStaffAssignments(n.id),a={AM:0,PM:0};r.forEach(e=>{a[e.session]++}),Object.entries(a).forEach(t=>{let[r,a]=t;a>n.maxStudents&&e.push("".concat(n.name," is assigned to ").concat(a," students in ").concat(r," session (max: ").concat(n.maxStudents,")"))}),0===r.length&&e.push("".concat(n.name," has no assignments"))}return e},v=()=>{const e=[];for(const r of t.assignments){const t=n.find(e=>e.id===r.staffId),i=a.find(e=>e.id===r.studentId);t&&i&&(t.canWorkProgram(r.program)||e.push("".concat(t.name," is assigned to ").concat(i.name," in ").concat(r.program," program, but is not qualified for this program")),i.program!==r.program&&e.push("".concat(i.name," is assigned to ").concat(r.program," program but belongs to ").concat(i.program," program")))}return e},y=()=>{const e=[],n=a.filter(e=>e.isActive);for(const r of n){const n=t.getStudentAssignments(r.id),a=["AM","PM"];for(const t of a){0===n.filter(e=>e.session===t).length&&e.push("".concat(r.name," has no assignment for ").concat(t," session"))}}return e},w=()=>{const e=[],r=n.filter(e=>e.isActive).map(e=>({name:e.name,count:t.getStaffAssignments(e.id).length}));if(r.length>0){const t=Math.max(...r.map(e=>e.count)),n=Math.min(...r.map(e=>e.count));t-n>2&&e.push("Uneven workload distribution: some staff have ".concat(t," assignments while others have ").concat(n))}return e};return(0,nS.jsxs)("div",{className:"bg-white rounded-lg shadow-lg",children:[(0,nS.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,nS.jsxs)("div",{className:"flex items-center justify-between",children:[(0,nS.jsxs)("div",{className:"flex items-center gap-3",children:[l?(0,nS.jsx)(b,{className:"w-5 h-5 animate-spin"}):s.isValid&&0===s.warnings.length?(0,nS.jsx)(eS,{className:"w-5 h-5 text-green-600"}):s.errors.length>0?(0,nS.jsx)(iS,{className:"w-5 h-5 text-red-600"}):(0,nS.jsx)(tS,{className:"w-5 h-5 text-yellow-600"}),(0,nS.jsxs)("div",{children:[(0,nS.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Schedule Validation"}),(0,nS.jsx)("p",{className:"text-sm text-gray-600",children:l?"Validating...":s.isValid&&0===s.warnings.length?"All constraints satisfied":s.errors.length>0?"".concat(s.errors.length," error(s) found"):"".concat(s.warnings.length," warning(s)")})]})]}),(0,nS.jsxs)("div",{className:"flex items-center gap-2",children:[(0,nS.jsxs)("button",{onClick:h,disabled:l,className:"px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 flex items-center gap-1",children:[(0,nS.jsx)(b,{className:"w-4 h-4 ".concat(l?"animate-spin":"")}),"Revalidate"]}),(0,nS.jsx)("button",{onClick:()=>d(!u),className:"px-3 py-1 text-sm border border-gray-300 rounded hover:bg-gray-50",children:u?"Hide Details":"Show Details"})]})]})}),u&&(0,nS.jsxs)("div",{className:"p-4 space-y-4",children:[(0,nS.jsx)(lS,{schedule:t,staff:n,students:a}),s.errors.length>0&&(0,nS.jsxs)("div",{className:"space-y-2",children:[(0,nS.jsxs)("h4",{className:"font-medium text-red-900 flex items-center gap-2",children:[(0,nS.jsx)(iS,{className:"w-4 h-4"}),"Errors (",s.errors.length,")"]}),(0,nS.jsx)("div",{className:"space-y-1",children:s.errors.map((e,t)=>(0,nS.jsx)("div",{className:"text-sm text-red-700 bg-red-50 p-2 rounded",children:e},t))})]}),s.warnings.length>0&&(0,nS.jsxs)("div",{className:"space-y-2",children:[(0,nS.jsxs)("h4",{className:"font-medium text-yellow-900 flex items-center gap-2",children:[(0,nS.jsx)(tS,{className:"w-4 h-4"}),"Warnings (",s.warnings.length,")"]}),(0,nS.jsx)("div",{className:"space-y-1",children:s.warnings.map((e,t)=>(0,nS.jsx)("div",{className:"text-sm text-yellow-700 bg-yellow-50 p-2 rounded",children:e},t))})]}),s.isValid&&0===s.warnings.length&&(0,nS.jsxs)("div",{className:"text-sm text-green-700 bg-green-50 p-3 rounded flex items-center gap-2",children:[(0,nS.jsx)(eS,{className:"w-4 h-4"}),"Schedule passes all validation checks"]}),s.lastValidated&&(0,nS.jsxs)("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[(0,nS.jsx)(sS,{className:"w-3 h-3"}),"Last validated: ",s.lastValidated.toLocaleTimeString()]})]})]})},lS=e=>{let{schedule:t,staff:n,students:r}=e;const a=r.filter(e=>e.isActive),i=n.filter(e=>e.isActive),s=t.assignments.length,o=new Set(t.assignments.map(e=>e.studentId)).size,l=new Set(t.assignments.map(e=>e.staffId)).size,c=t.assignments.filter(e=>t.isAssignmentLocked(e.id)).length,u=a.length>0?o/a.length*100:0,d=i.length>0?l/i.length*100:0,h=[{label:"Total Assignments",value:s,color:"text-blue-600"},{label:"Students Assigned",value:"".concat(o,"/").concat(a.length),percentage:u,color:100===u?"text-green-600":"text-yellow-600"},{label:"Staff Utilized",value:"".concat(l,"/").concat(i.length),percentage:d,color:"text-blue-600"},{label:"Locked Assignments",value:c,color:"text-yellow-600"}];return(0,nS.jsxs)("div",{className:"space-y-3",children:[(0,nS.jsx)("h4",{className:"font-medium text-gray-900",children:"Summary"}),(0,nS.jsx)("div",{className:"grid grid-cols-2 gap-4",children:h.map((e,t)=>(0,nS.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded",children:[(0,nS.jsxs)("div",{className:"text-lg font-semibold ".concat(e.color),children:[e.value,void 0!==e.percentage&&(0,nS.jsxs)("span",{className:"text-sm ml-1",children:["(",e.percentage.toFixed(0),"%)"]})]}),(0,nS.jsx)("div",{className:"text-xs text-gray-600",children:e.label})]},t))})]})},cS=()=>(0,nS.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,nS.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,nS.jsx)(sS,{className:"w-5 h-5"}),"Scheduling Rules & Constraints"]}),(0,nS.jsx)("div",{className:"space-y-6",children:[{title:"Staff-Student Ratios",description:"Each student must have the correct number of staff assigned based on their ratio requirement",examples:["1:1 ratio = 1 staff member","2:1 ratio = 2 staff members","1:2 ratio = 1 staff for up to 2 students"]},{title:"Same-Day Restriction",description:"No staff member can be assigned to the same student for both AM and PM sessions",examples:["If John works with Student A in AM, he cannot work with Student A in PM"]},{title:"Program Qualifications",description:"Staff can only be assigned to programs they are qualified for",examples:["Primary program staff cannot be assigned to Secondary program students"]},{title:"Role Hierarchy",description:"Staff assignments follow the established hierarchy for optimal matches",examples:["RBT \u2192 BS \u2192 BCBA \u2192 EA \u2192 MHA \u2192 CC \u2192 Teacher \u2192 Director"]},{title:"Session Times",description:"Assignments must respect program-specific session times",examples:["Primary AM: 8:45-11:30, PM: 12:00-15:00","Secondary AM: 8:45-12:00, PM: 12:30-15:00"]}].map((e,t)=>(0,nS.jsxs)("div",{className:"border-l-4 border-blue-500 pl-4",children:[(0,nS.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:e.title}),(0,nS.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.description}),(0,nS.jsx)("ul",{className:"text-xs text-gray-500 space-y-1",children:e.examples.map((e,t)=>(0,nS.jsxs)("li",{className:"flex items-start gap-1",children:[(0,nS.jsx)("span",{className:"text-blue-500 mt-1",children:"\u2022"}),(0,nS.jsx)("span",{children:e})]},t))})]},t))})]}),uS=v("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),dS=v("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),hS=v("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]),fS=v("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),mS=v("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),gS=v("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),pS=e=>{let{selectedUsers:t=[],onSelectionChange:n,placeholder:a="Search for people...",maxSelections:i=null,disabled:s=!1,peoplePickerService:o}=e;const[l,c]=(0,r.useState)(!1),[u,d]=(0,r.useState)(""),[h,f]=(0,r.useState)([]),[m,g]=(0,r.useState)(!1),[p,v]=(0,r.useState)([]),b=(0,r.useRef)(null);(0,r.useEffect)(()=>{o&&w()},[o]),(0,r.useEffect)(()=>{const e=e=>{b.current&&!b.current.contains(e.target)&&c(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const w=async()=>{try{const e=await o.getAllSiteUsers(!0);v(e)}catch(e){console.error("Error loading users:",e)}},S=(u.trim()?h:p.slice(0,10)).filter(e=>!t.some(t=>t.id===e.id));return(0,nS.jsxs)("div",{className:"relative",ref:b,children:[t.length>0&&(0,nS.jsx)("div",{className:"mb-2 flex flex-wrap gap-2",children:t.map(e=>{const r="string"===typeof e.title?e.title:"string"===typeof e.name?e.name:"Unknown User";return(0,nS.jsxs)("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:[(0,nS.jsx)(y,{className:"w-3 h-3"}),(0,nS.jsx)("span",{children:r}),!s&&(0,nS.jsx)("button",{onClick:()=>(e=>{if(s)return;const r=t.filter(t=>t.id!==e);n(r)})(e.id),className:"hover:bg-blue-200 rounded-full p-0.5",children:(0,nS.jsx)(fS,{className:"w-3 h-3"})})]},e.id||Math.random())})}),(0,nS.jsxs)("div",{className:"relative",children:[(0,nS.jsxs)("div",{className:"flex items-center border border-gray-300 rounded-md",children:[(0,nS.jsxs)("div",{className:"flex-1 flex items-center",children:[(0,nS.jsx)(mS,{className:"w-4 h-4 text-gray-400 ml-3"}),(0,nS.jsx)("input",{type:"text",value:u,onChange:e=>(async e=>{if(d(e),e.trim()){g(!0);try{if(p.length>0){const t=p.filter(t=>t.title.toLowerCase().includes(e.toLowerCase())||t.email.toLowerCase().includes(e.toLowerCase())).slice(0,10);f(t)}else{const t=await o.searchUsers(e);f(t.slice(0,10))}}catch(t){console.error("Error searching users:",t),f([])}finally{g(!1)}}else f([])})(e.target.value),onFocus:()=>c(!0),placeholder:a,disabled:s,className:"w-full pl-2 pr-3 py-2 border-0 focus:outline-none focus:ring-0"})]}),(0,nS.jsx)("button",{onClick:()=>c(!l),disabled:s,className:"px-3 py-2 border-l border-gray-300 hover:bg-gray-50 disabled:opacity-50",children:(0,nS.jsx)(gS,{className:"w-4 h-4 transition-transform ".concat(l?"rotate-180":"")})})]}),l&&!s&&(0,nS.jsxs)("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:[m&&(0,nS.jsx)("div",{className:"px-4 py-3 text-gray-500 text-sm",children:"Searching..."}),!m&&0===S.length&&(0,nS.jsx)("div",{className:"px-4 py-3 text-gray-500 text-sm",children:u.trim()?"No users found":"No users available"}),!m&&S.map(e=>{const r="string"===typeof e.title?e.title:"string"===typeof e.name?e.name:"Unknown",a="string"===typeof e.email?e.email:"",o=r.charAt(0).toUpperCase();return(0,nS.jsx)("button",{onClick:()=>(e=>{if(s)return;if(t.some(t=>t.id===e.id))return;if(i&&t.length>=i)return;const r=[...t,e];n(r),d(""),f([]),c(!1)})(e),className:"w-full px-4 py-3 text-left hover:bg-gray-50 focus:bg-gray-50 focus:outline-none border-b border-gray-100 last:border-b-0",children:(0,nS.jsxs)("div",{className:"flex items-center gap-3",children:[(0,nS.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-medium",children:o}),(0,nS.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,nS.jsx)("div",{className:"font-medium text-gray-900 truncate",children:r}),a&&(0,nS.jsx)("div",{className:"text-sm text-gray-500 truncate",children:a})]})]})},e.id||Math.random())}),i&&t.length>=i&&(0,nS.jsxs)("div",{className:"px-4 py-3 text-amber-600 text-sm bg-amber-50 border-t",children:["Maximum ",i," selection",1!==i?"s":""," reached"]})]})]}),i&&(0,nS.jsxs)("div",{className:"mt-1 text-xs text-gray-500",children:[t.length," of ",i," selected"]})]})},vS=e=>{let{selectedUser:t=null,onSelectionChange:n,placeholder:r="Search for a person...",disabled:a=!1,peoplePickerService:i}=e;return(0,nS.jsx)(pS,{selectedUsers:t?[t]:[],onSelectionChange:e=>n(e[0]||null),placeholder:r,maxSelections:1,disabled:a,peoplePickerService:i})},yS=e=>{let{selectedStaff:t=[],onSelectionChange:n,allStaff:a=[],disabled:i=!1,peoplePickerService:s}=e;const[o,l]=(0,r.useState)(""),[c,u]=(0,r.useState)(!1),d=(0,r.useRef)(null);(0,r.useEffect)(()=>{const e=e=>{d.current&&!d.current.contains(e.target)&&u(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const h=(()=>{if(!o.trim())return a.filter(e=>!t.some(t=>t.id===e.id));const e=o.toLowerCase();return a.filter(n=>{var r,a;if(t.some(e=>e.id===n.id))return!1;const i=null===(r=n.name)||void 0===r?void 0:r.toLowerCase().includes(e),s=null===(a=n.email)||void 0===a?void 0:a.toLowerCase().includes(e);return i||s})})();return(0,nS.jsxs)("div",{className:"relative",ref:d,children:[t.length>0&&(0,nS.jsx)("div",{className:"mb-2 flex flex-wrap gap-2",children:t.map(e=>{const r=e.title||e.name||e.DisplayName||e.LookupValue||"Unknown";return(0,nS.jsxs)("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:[(0,nS.jsx)(y,{className:"w-3 h-3"}),(0,nS.jsx)("span",{children:r}),!i&&(0,nS.jsx)("button",{onClick:()=>(e=>{if(i)return;const r=t.filter(t=>t.id!==e);n(r)})(e.id),className:"hover:bg-blue-200 rounded-full p-0.5",children:(0,nS.jsx)(fS,{className:"w-3 h-3"})})]},e.id||Math.random())})}),(0,nS.jsxs)("div",{className:"relative",children:[(0,nS.jsxs)("div",{className:"flex items-center border border-gray-300 rounded-md",children:[(0,nS.jsxs)("div",{className:"flex-1 flex items-center",children:[(0,nS.jsx)(mS,{className:"w-4 h-4 text-gray-400 ml-3"}),(0,nS.jsx)("input",{type:"text",value:o,onChange:e=>l(e.target.value),onFocus:()=>u(!0),placeholder:"Search staff members...",disabled:i,className:"w-full pl-2 pr-3 py-2 border-0 focus:outline-none focus:ring-0"})]}),(0,nS.jsx)("button",{onClick:()=>u(!c),disabled:i,className:"px-3 py-2 border-l border-gray-300 hover:bg-gray-50 disabled:opacity-50",children:(0,nS.jsx)(gS,{className:"w-4 h-4 transition-transform ".concat(c?"rotate-180":"")})})]}),c&&!i&&(0,nS.jsxs)("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:[0===h.length&&(0,nS.jsx)("div",{className:"px-4 py-3 text-gray-500 text-sm",children:o.trim()?"No staff members found matching your search":0===a.length?"No staff members available":"All staff members have been selected"}),h.map(e=>{const r=e.name||"Unknown",a=e.email||"",s=r.charAt(0).toUpperCase(),o="object"===typeof e.role?e.role.name:e.role;return(0,nS.jsx)("button",{onClick:()=>(e=>{if(i)return;const r={id:e.id,title:e.name,email:e.email,name:e.name,DisplayName:e.name,LookupValue:e.name},a=[...t,r];n(a),l(""),u(!1)})(e),className:"w-full px-4 py-3 text-left hover:bg-gray-50 focus:bg-gray-50 focus:outline-none border-b border-gray-100 last:border-b-0",children:(0,nS.jsxs)("div",{className:"flex items-center gap-3",children:[(0,nS.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-medium",children:s}),(0,nS.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,nS.jsxs)("div",{className:"font-medium text-gray-900 truncate",children:[r,o&&(0,nS.jsxs)("span",{className:"ml-2 text-xs text-gray-500",children:["(",o,")"]})]}),a&&(0,nS.jsx)("div",{className:"text-sm text-gray-500 truncate",children:a})]})]})},e.id)})]})]}),(0,nS.jsxs)("div",{className:"mt-1 text-xs text-gray-500",children:[t.length," staff member",1!==t.length?"s":""," selected \u2022 Only showing active staff from Staff list"]})]})},bS=e=>{var t;let{staff:n=null,onSave:a,onCancel:i,peoplePickerService:s}=e;const[o,l]=(0,r.useState)({name:(null===n||void 0===n?void 0:n.name)||"",role:(null===n||void 0===n?void 0:n.role)||D.RBT,email:(null===n||void 0===n?void 0:n.email)||"",phone:(null===n||void 0===n?void 0:n.phone)||"",isActive:null===(t=null===n||void 0===n?void 0:n.isActive)||void 0===t||t,primaryProgram:(null===n||void 0===n?void 0:n.primaryProgram)||!1,secondaryProgram:(null===n||void 0===n?void 0:n.secondaryProgram)||!1,certificationExpiry:(null===n||void 0===n?void 0:n.certificationExpiry)||"",userId:(null===n||void 0===n?void 0:n.userId)||"",staffPerson:(null===n||void 0===n?void 0:n.staffPerson)||null}),[u,d]=(0,r.useState)(null!==n&&void 0!==n&&n.staffPerson?{id:n.userId,title:n.name,email:n.email}:null),[h,f]=(0,r.useState)({}),m=(e,t)=>{l(n=>c(c({},n),{},{[e]:t})),h[e]&&f(t=>c(c({},t),{},{[e]:null}))};return(0,nS.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,nS.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,nS.jsx)("div",{className:"bg-blue-600 text-white p-4 rounded-t-lg",children:(0,nS.jsxs)("h2",{className:"text-xl font-bold flex items-center gap-2",children:[(0,nS.jsx)(uS,{className:"w-5 h-5"}),n?"Edit Staff Member":"Add Staff Member"]})}),(0,nS.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!(()=>{const e={};return o.name.trim()||(e.name="Name is required"),o.email.trim()?/\S+@\S+\.\S+/.test(o.email)||(e.email="Email is invalid"):e.email="Email is required",o.role||(e.role="Role is required"),o.primaryProgram||o.secondaryProgram||(e.programs="At least one program must be selected"),f(e),0===Object.keys(e).length})())return;const t=c({id:(null===n||void 0===n?void 0:n.id)||Date.now()},o);a(new U(t))},className:"p-6 space-y-6",children:[(0,nS.jsxs)("div",{children:[(0,nS.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Staff Member *"}),(0,nS.jsx)(vS,{selectedUser:u,onSelectionChange:e=>{d(e),l(e?t=>c(c({},t),{},{name:e.title,email:e.email,userId:e.id.toString(),staffPerson:e}):e=>c(c({},e),{},{name:"",email:"",userId:"",staffPerson:null}))},placeholder:"Search for staff member...",peoplePickerService:s}),h.name&&(0,nS.jsx)("p",{className:"mt-1 text-sm text-red-600",children:h.name})]}),(0,nS.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,nS.jsxs)("div",{children:[(0,nS.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name *"}),(0,nS.jsx)("input",{type:"text",value:o.name,onChange:e=>m("name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:u}),h.name&&(0,nS.jsx)("p",{className:"mt-1 text-sm text-red-600",children:h.name})]}),(0,nS.jsxs)("div",{children:[(0,nS.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role *"}),(0,nS.jsx)("select",{value:o.role,onChange:e=>m("role",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:Object.values(D).map(e=>(0,nS.jsx)("option",{value:e,children:e},e))}),h.role&&(0,nS.jsx)("p",{className:"mt-1 text-sm text-red-600",children:h.role})]})]}),(0,nS.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,nS.jsxs)("div",{children:[(0,nS.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,nS.jsx)(dS,{className:"w-4 h-4 inline mr-1"}),"Email *"]}),(0,nS.jsx)("input",{type:"email",value:o.email,onChange:e=>m("email",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:u}),h.email&&(0,nS.jsx)("p",{className:"mt-1 text-sm text-red-600",children:h.email})]}),(0,nS.jsxs)("div",{children:[(0,nS.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,nS.jsx)(hS,{className:"w-4 h-4 inline mr-1"}),"Phone"]}),(0,nS.jsx)("input",{type:"tel",value:o.phone,onChange:e=>m("phone",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,nS.jsxs)("div",{children:[(0,nS.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,nS.jsx)(S,{className:"w-4 h-4 inline mr-1"}),"Certification Expiry"]}),(0,nS.jsx)("input",{type:"date",value:o.certificationExpiry,onChange:e=>m("certificationExpiry",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,nS.jsxs)("div",{children:[(0,nS.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Programs *"}),(0,nS.jsxs)("div",{className:"space-y-2",children:[(0,nS.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,nS.jsx)("input",{type:"checkbox",checked:o.primaryProgram,onChange:e=>m("primaryProgram",e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,nS.jsx)("span",{className:"text-sm",children:"Primary Program"})]}),(0,nS.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,nS.jsx)("input",{type:"checkbox",checked:o.secondaryProgram,onChange:e=>m("secondaryProgram",e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,nS.jsx)("span",{className:"text-sm",children:"Secondary Program"})]})]}),h.programs&&(0,nS.jsx)("p",{className:"mt-1 text-sm text-red-600",children:h.programs})]}),(0,nS.jsx)("div",{children:(0,nS.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,nS.jsx)("input",{type:"checkbox",checked:o.isActive,onChange:e=>m("isActive",e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,nS.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Active"})]})}),(0,nS.jsxs)("div",{className:"flex gap-3 pt-4 border-t",children:[(0,nS.jsxs)("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 flex items-center justify-center gap-2",children:[(0,nS.jsx)(A,{className:"w-4 h-4"}),n?"Update Staff":"Add Staff"]}),(0,nS.jsxs)("button",{type:"button",onClick:i,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 flex items-center justify-center gap-2",children:[(0,nS.jsx)(fS,{className:"w-4 h-4"}),"Cancel"]})]})]})]})})},wS=e=>{var t;let{student:n=null,onSave:a,onCancel:i,allStaff:s=[],peoplePickerService:o}=e;const[l,u]=(0,r.useState)({name:(null===n||void 0===n?void 0:n.name)||"",program:(null===n||void 0===n?void 0:n.program)||L.PRIMARY,ratioAM:(null===n||void 0===n?void 0:n.ratioAM)||j.ONE_TO_ONE,ratioPM:(null===n||void 0===n?void 0:n.ratioPM)||j.ONE_TO_ONE,team:(null===n||void 0===n?void 0:n.team)||[],isActive:null===(t=null===n||void 0===n?void 0:n.isActive)||void 0===t||t,notes:(null===n||void 0===n?void 0:n.notes)||"",dateStarted:(null===n||void 0===n?void 0:n.dateStarted)||"",teamTrainingStatus:(null===n||void 0===n?void 0:n.teamTrainingStatus)||{},pairedWith:(null===n||void 0===n?void 0:n.pairedWith)||null}),[d,h]=(0,r.useState)({}),f=(e,t)=>{u(n=>c(c({},n),{},{[e]:t})),d[e]&&h(t=>c(c({},t),{},{[e]:null}))};return(0,nS.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,nS.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,nS.jsx)("div",{className:"bg-green-600 text-white p-4 rounded-t-lg",children:(0,nS.jsxs)("h2",{className:"text-xl font-bold flex items-center gap-2",children:[(0,nS.jsx)(y,{className:"w-5 h-5"}),n?"Edit Student":"Add Student"]})}),(0,nS.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!(()=>{const e={};return l.name.trim()||(e.name="Name is required"),l.program||(e.program="Program is required"),l.ratioAM||(e.ratioAM="AM ratio is required"),l.ratioPM||(e.ratioPM="PM ratio is required"),h(e),0===Object.keys(e).length})())return;const t=c({id:(null===n||void 0===n?void 0:n.id)||Date.now()},l);a(new V(t))},className:"p-6 space-y-6",children:[(0,nS.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,nS.jsxs)("div",{children:[(0,nS.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name *"}),(0,nS.jsx)("input",{type:"text",value:l.name,onChange:e=>f("name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"}),d.name&&(0,nS.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.name})]}),(0,nS.jsxs)("div",{children:[(0,nS.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Program *"}),(0,nS.jsx)("select",{value:l.program,onChange:e=>f("program",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",children:Object.values(L).map(e=>(0,nS.jsx)("option",{value:e,children:e},e))}),d.program&&(0,nS.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.program})]})]}),(0,nS.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,nS.jsxs)("div",{children:[(0,nS.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"AM Ratio *"}),(0,nS.jsx)("select",{value:l.ratioAM,onChange:e=>f("ratioAM",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",children:Object.values(j).map(e=>(0,nS.jsx)("option",{value:e,children:e},e))}),d.ratioAM&&(0,nS.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.ratioAM})]}),(0,nS.jsxs)("div",{children:[(0,nS.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"PM Ratio *"}),(0,nS.jsx)("select",{value:l.ratioPM,onChange:e=>f("ratioPM",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",children:Object.values(j).map(e=>(0,nS.jsx)("option",{value:e,children:e},e))}),d.ratioPM&&(0,nS.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d.ratioPM})]})]}),(0,nS.jsxs)("div",{children:[(0,nS.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,nS.jsx)(S,{className:"w-4 h-4 inline mr-1"}),"Date Started"]}),(0,nS.jsx)("input",{type:"date",value:l.dateStarted,onChange:e=>f("dateStarted",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"})]}),(0,nS.jsxs)("div",{children:[(0,nS.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Team Members"}),(0,nS.jsx)(yS,{selectedStaff:l.team,onSelectionChange:e=>{u(t=>c(c({},t),{},{team:e}))},allStaff:s,peoplePickerService:o}),(0,nS.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Select staff members who work with this client"})]}),(0,nS.jsxs)("div",{children:[(0,nS.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),(0,nS.jsx)("textarea",{value:l.notes,onChange:e=>f("notes",e.target.value),rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Additional notes about the student..."})]}),(0,nS.jsx)("div",{children:(0,nS.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,nS.jsx)("input",{type:"checkbox",checked:l.isActive,onChange:e=>f("isActive",e.target.checked),className:"rounded border-gray-300 text-green-600 focus:ring-green-500"}),(0,nS.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Active"})]})}),(0,nS.jsxs)("div",{className:"flex gap-3 pt-4 border-t",children:[(0,nS.jsxs)("button",{type:"submit",className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 flex items-center justify-center gap-2",children:[(0,nS.jsx)(A,{className:"w-4 h-4"}),n?"Update Student":"Add Student"]}),(0,nS.jsxs)("button",{type:"button",onClick:i,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 flex items-center justify-center gap-2",children:[(0,nS.jsx)(fS,{className:"w-4 h-4"}),"Cancel"]})]})]})]})})},SS=v("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]),TS=v("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),AS=e=>{let{staff:t,students:n,onEditStudent:a,onEditStaff:i,onCleanupDeletedStaff:s,onUpdateTrainingStatus:o}=e;const[l,c]=(0,r.useState)(()=>localStorage.getItem("teamManagement_view")||"clients-by-staff"),[u,d]=(0,r.useState)(()=>localStorage.getItem("teamManagement_searchTerm")||""),[h,f]=(0,r.useState)(()=>localStorage.getItem("teamManagement_selectedProgram")||"");(0,r.useEffect)(()=>{localStorage.setItem("teamManagement_view",l)},[l]),(0,r.useEffect)(()=>{localStorage.setItem("teamManagement_searchTerm",u)},[u]),(0,r.useEffect)(()=>{localStorage.setItem("teamManagement_selectedProgram",h)},[h]);const m=(0,r.useMemo)(()=>{var e;console.log("\ud83d\udd0d TeamManagement: Building clientsByStaff mapping"),console.log("\ud83d\udd0d TeamManagement: Staff data:",t),console.log("\ud83d\udd0d TeamManagement: Students data:",n),console.log("\ud83d\udd0d TeamManagement: Sample student team data:",null===n||void 0===n||null===(e=n[0])||void 0===e?void 0:e.team);const r={};return t.filter(e=>e.isActive).forEach(e=>{console.log("\ud83d\udd0d Processing staff: ".concat(e.name," (ID: ").concat(e.id,")"));const t=n.filter(t=>{if(!t.isActive)return!1;if(console.log("  \ud83d\udd0d Checking student: ".concat(t.name)),console.log("    Team data:",t.team),!t.team||0===t.team.length)return console.log("    \u26a0\ufe0f No team data for ".concat(t.name)),!1;const n=t.team.some(n=>{var r,a,i,s,o;console.log("    \ud83d\udd0d Checking team member:",n);const l=null===(r=e.email)||void 0===r?void 0:r.toLowerCase().trim(),c=null===(a=n.email)||void 0===a?void 0:a.toLowerCase().trim();if(l&&c&&l===c)return console.log("    \u2705 EMAIL MATCH: ".concat(e.name," found in ").concat(t.name,"'s team")),!0;if(e.id&&n.id&&e.id===n.id)return console.log("    \u2705 ID MATCH: ".concat(e.name," found in ").concat(t.name,"'s team")),!0;const u=null===(i=e.name)||void 0===i?void 0:i.toLowerCase().trim(),d=(null===(s=n.title)||void 0===s?void 0:s.toLowerCase().trim())||(null===(o=n.name)||void 0===o?void 0:o.toLowerCase().trim());return!(!u||!d||u!==d)&&(console.log("    \u2705 NAME MATCH: ".concat(e.name," found in ").concat(t.name,"'s team")),!0)});return n&&console.log("  \u2705 ".concat(t.name," assigned to ").concat(e.name)),n});r[e.id]={staff:e,clients:t},console.log("\u2705 ".concat(e.name," has ").concat(t.length," clients:"),t.map(e=>e.name))}),console.log("\ud83d\udcca Final clientsByStaff mapping:",r),r},[t,n]),g=(0,r.useMemo)(()=>{console.log("\ud83d\udd0d TeamManagement: Building staffByClient mapping");const e={};return n.filter(e=>e.isActive).forEach(n=>{console.log("\ud83d\udd0d Processing student: ".concat(n.name)),console.log("  Team data:",n.team);const r=n.team.map(e=>{console.log("  \ud83d\udd0d Processing team member:",e);const n=t.find(t=>{var n,r,a,i,s;const o=null===(n=t.email)||void 0===n?void 0:n.toLowerCase().trim(),l=null===(r=e.email)||void 0===r?void 0:r.toLowerCase().trim();if(o&&l&&o===l)return console.log("    \u2705 EMAIL MATCH: Found staff ".concat(t.name," for team member")),!0;if(t.id&&e.id&&t.id===e.id)return console.log("    \u2705 ID MATCH: Found staff ".concat(t.name," for team member")),!0;const c=null===(a=t.name)||void 0===a?void 0:a.toLowerCase().trim(),u=(null===(i=e.title)||void 0===i?void 0:i.toLowerCase().trim())||(null===(s=e.name)||void 0===s?void 0:s.toLowerCase().trim());return!(!c||!u||c!==u)&&(console.log("    \u2705 NAME MATCH: Found staff ".concat(t.name," for team member")),!0)});var r;return n?{id:n.id,name:e.title||e.DisplayName||e.LookupValue||n.name,role:(null===(r=n.role)||void 0===r?void 0:r.name)||n.role,email:n.email}:(console.log("    \u26a0\ufe0f No staff match found for team member:",e),{id:e.id,name:e.title||e.DisplayName||e.LookupValue,role:"Unknown",email:e.email})}).filter(Boolean),a={CC:1,BCBA:2,Teacher:3,EA:4,BS:5,RBT:6,MHA:7,Director:8};r.sort((e,t)=>{const n=a[e.role]||999,r=a[t.role]||999;return n!==r?n-r:e.name.localeCompare(t.name)}),e[n.id]={student:n,teamMembers:r},console.log("\u2705 ".concat(n.name," has ").concat(r.length," team members:"),r.map(e=>e.name))}),console.log("\ud83d\udcca Final staffByClient mapping:",e),e},[t,n]),p=(0,r.useMemo)(()=>{const e={BCBA:1,CC:2,Teacher:3,EA:4,BS:5,RBT:6,MHA:7,Director:8};let t;return"clients-by-staff"===l?(t=Object.values(m).filter(e=>{const t=e.staff.name.toLowerCase().includes(u.toLowerCase()),n=!h||"Primary"===h&&e.staff.primaryProgram||"Secondary"===h&&e.staff.secondaryProgram;return t&&n}),t.sort((t,n)=>{const r=e=>{var t;return"string"===typeof e.role?e.role:"object"===typeof e.role&&null!==(t=e.role)&&void 0!==t&&t.name?e.role.name:"Unknown"},a=e[r(t.staff)]||999,i=e[r(n.staff)]||999;return a!==i?a-i:t.staff.name.localeCompare(n.staff.name)})):(t=Object.values(g).filter(e=>{const t=e.student.name.toLowerCase().includes(u.toLowerCase()),n=!h||e.student.program===h;return t&&n}),t.sort((e,t)=>e.student.name.localeCompare(t.student.name))),t},[l,m,g,u,h]),v=(e,t,n)=>e.filter(e=>e.getSessionRatio(n)===t).length,b=e=>({RBT:"bg-purple-100 text-purple-700 font-bold",BS:"bg-blue-100 text-blue-700 font-bold",BCBA:"bg-orange-100 text-orange-700 font-bold",EA:"bg-green-100 text-green-700 font-bold",MHA:"bg-yellow-100 text-yellow-800 font-bold",CC:"bg-red-100 text-red-700 font-bold",Teacher:"bg-pink-100 text-pink-700 font-bold",Director:"bg-gray-100 text-gray-800 font-bold"}[e]||"bg-gray-100 text-gray-800 font-bold");return(0,nS.jsxs)("div",{className:"bg-white rounded-lg shadow-lg",children:[(0,nS.jsx)("div",{className:"bg-indigo-600 text-white p-4 rounded-t-lg",children:(0,nS.jsxs)("div",{className:"flex justify-between items-center",children:[(0,nS.jsxs)("h2",{className:"text-xl font-bold flex items-center gap-2",children:[(0,nS.jsx)(y,{className:"w-5 h-5"}),"Team Management"]}),s&&(0,nS.jsxs)("button",{onClick:s,className:"px-4 py-2 bg-white text-indigo-600 rounded-md hover:bg-indigo-50 transition-colors text-sm font-medium flex items-center gap-2",title:"Remove deleted staff from all student teams",children:[(0,nS.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,nS.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Clean Up Teams"]})]})}),(0,nS.jsxs)("div",{className:"p-6",children:[(0,nS.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:[(0,nS.jsxs)("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[(0,nS.jsxs)("button",{onClick:()=>c("clients-by-staff"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("clients-by-staff"===l?"bg-white text-indigo-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:[(0,nS.jsx)(y,{className:"w-4 h-4 inline mr-2"}),"Clients by Staff"]}),(0,nS.jsxs)("button",{onClick:()=>c("staff-by-client"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("staff-by-client"===l?"bg-white text-indigo-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:[(0,nS.jsx)(uS,{className:"w-4 h-4 inline mr-2"}),"Staff by Client"]})]}),(0,nS.jsxs)("div",{className:"flex gap-3 flex-1",children:[(0,nS.jsxs)("div",{className:"relative flex-1",children:[(0,nS.jsx)(mS,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,nS.jsx)("input",{type:"text",value:u,onChange:e=>d(e.target.value),placeholder:"Search ".concat("clients-by-staff"===l?"staff":"clients","..."),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),(0,nS.jsxs)("div",{className:"relative",children:[(0,nS.jsx)(SS,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,nS.jsxs)("select",{value:h,onChange:e=>f(e.target.value),className:"pl-10 pr-8 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 appearance-none bg-white",children:[(0,nS.jsx)("option",{value:"",children:"All Programs"}),(0,nS.jsx)("option",{value:"Primary",children:"Primary"}),(0,nS.jsx)("option",{value:"Secondary",children:"Secondary"})]})]})]})]}),(0,nS.jsx)("div",{className:"space-y-4",children:0===p.length?(0,nS.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,nS.jsx)(y,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),(0,nS.jsxs)("p",{children:["No ","clients-by-staff"===l?"staff":"clients"," found"]})]}):p.map((e,t)=>{var n,r,i,s,c,u,d,h;return(0,nS.jsx)("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50",children:"clients-by-staff"===l?(0,nS.jsxs)("div",{children:[(0,nS.jsx)("div",{className:"flex justify-between items-start mb-3",children:(0,nS.jsxs)("div",{className:"flex items-center gap-3",children:[(0,nS.jsx)("div",{className:"w-10 h-10 bg-indigo-500 rounded-full flex items-center justify-center text-white font-medium",children:"string"===typeof e.staff.name?e.staff.name.charAt(0):(null===(n=e.staff.name)||void 0===n||null===(r=n.toString)||void 0===r?void 0:r.call(n).charAt(0))||"?"}),(0,nS.jsxs)("div",{children:[(0,nS.jsx)("h3",{className:"font-semibold text-gray-900",children:"string"===typeof e.staff.name?e.staff.name:(null===(i=e.staff.name)||void 0===i||null===(s=i.toString)||void 0===s?void 0:s.call(i))||JSON.stringify(e.staff.name)}),(0,nS.jsxs)("div",{className:"flex items-center gap-2",children:[(0,nS.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(b("object"===typeof e.staff.role?e.staff.role.name:e.staff.role)),children:"object"===typeof e.staff.role?e.staff.role.name:"string"===typeof e.staff.role?e.staff.role:JSON.stringify(e.staff.role)}),(0,nS.jsxs)("div",{className:"flex gap-1",children:[e.staff.primaryProgram&&(0,nS.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs",children:"Primary"}),e.staff.secondaryProgram&&(0,nS.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded text-xs",children:"Secondary"})]})]})]})]})}),(0,nS.jsxs)("div",{className:"ml-13",children:[(0,nS.jsxs)("div",{className:"flex items-center gap-4 mb-2",children:[(0,nS.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:["Clients: ",e.clients.length]}),e.clients.length>0&&(0,nS.jsxs)(nS.Fragment,{children:[(0,nS.jsxs)("span",{className:"text-xs text-gray-500",children:["AM: ",v(e.clients,"1:1","AM")," (1:1),",v(e.clients,"2:1","AM")," (2:1),",v(e.clients,"1:2","AM")," (1:2)"]}),(0,nS.jsxs)("span",{className:"text-xs text-gray-500",children:["PM: ",v(e.clients,"1:1","PM")," (1:1),",v(e.clients,"2:1","PM")," (2:1),",v(e.clients,"1:2","PM")," (1:2)"]})]})]}),e.clients.length>0&&(0,nS.jsx)("div",{className:"flex flex-wrap gap-2",children:e.clients.map(e=>{var t,n,r,a,i,s;return(0,nS.jsxs)("div",{className:"flex items-center gap-2 bg-gray-100 rounded-full px-3 py-1",children:[(0,nS.jsx)("span",{className:"text-sm",children:"string"===typeof e.name?e.name:(null===(t=e.name)||void 0===t||null===(n=t.toString)||void 0===n?void 0:n.call(t))||JSON.stringify(e.name)}),(0,nS.jsxs)("div",{className:"flex gap-1",children:[(0,nS.jsxs)("span",{className:"text-xs bg-blue-200 text-blue-700 px-1 rounded",children:["AM: ","string"===typeof e.ratioAM?e.ratioAM:(null===(r=e.ratioAM)||void 0===r||null===(a=r.toString)||void 0===a?void 0:a.call(r))||JSON.stringify(e.ratioAM)]}),(0,nS.jsxs)("span",{className:"text-xs bg-green-200 text-green-700 px-1 rounded",children:["PM: ","string"===typeof e.ratioPM?e.ratioPM:(null===(i=e.ratioPM)||void 0===i||null===(s=i.toString)||void 0===s?void 0:s.call(i))||JSON.stringify(e.ratioPM)]})]})]},e.id)})})]})]}):(0,nS.jsxs)("div",{children:[(0,nS.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,nS.jsxs)("div",{className:"flex items-center gap-3",children:[(0,nS.jsx)("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center text-white font-medium",children:"string"===typeof e.student.name?e.student.name.charAt(0):(null===(c=e.student.name)||void 0===c||null===(u=c.toString)||void 0===u?void 0:u.call(c).charAt(0))||"?"}),(0,nS.jsxs)("div",{children:[(0,nS.jsx)("h3",{className:"font-semibold text-gray-900",children:"string"===typeof e.student.name?e.student.name:(null===(d=e.student.name)||void 0===d||null===(h=d.toString)||void 0===h?void 0:h.call(d))||JSON.stringify(e.student.name)}),(0,nS.jsxs)("div",{className:"flex items-center gap-2",children:[(0,nS.jsx)("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs",children:e.student.program}),(0,nS.jsxs)("span",{className:"text-xs bg-blue-200 text-blue-700 px-2 py-1 rounded",children:["AM: ",e.student.ratioAM]}),(0,nS.jsxs)("span",{className:"text-xs bg-green-200 text-green-700 px-2 py-1 rounded",children:["PM: ",e.student.ratioPM]})]})]})]}),(0,nS.jsx)("button",{onClick:()=>a&&a(e.student),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded",children:(0,nS.jsx)(TS,{className:"w-4 h-4"})})]}),(0,nS.jsxs)("div",{className:"ml-13",children:[(0,nS.jsx)("div",{className:"flex items-center gap-4 mb-2",children:(0,nS.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:["Team Members: ",e.teamMembers.length]})}),e.teamMembers.length>0?(0,nS.jsx)("div",{className:"space-y-2",children:e.teamMembers.map(t=>{var n,r,a,i;const s=e.student.getStaffTrainingStatus?e.student.getStaffTrainingStatus(t.id):W;return(0,nS.jsxs)("div",{className:"flex items-center justify-between bg-indigo-50 rounded-lg px-4 py-3 border border-indigo-200",children:[(0,nS.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,nS.jsx)("div",{className:"w-8 h-8 bg-indigo-500 rounded-full flex items-center justify-center text-white font-medium text-sm",children:"string"===typeof t.name?t.name.charAt(0):(null===(n=t.name)||void 0===n||null===(r=n.toString)||void 0===r?void 0:r.call(n).charAt(0))||"?"}),(0,nS.jsx)("div",{className:"flex-1",children:(0,nS.jsxs)("div",{className:"flex items-center gap-2",children:[(0,nS.jsx)("span",{className:"text-sm font-medium",children:"string"===typeof t.name?t.name:(null===(a=t.name)||void 0===a||null===(i=a.toString)||void 0===i?void 0:i.call(a))||JSON.stringify(t.name)}),(0,nS.jsx)("span",{className:"text-xs px-2 py-0.5 rounded ".concat(b("object"===typeof t.role?t.role.name:"string"===typeof t.role?t.role:JSON.stringify(t.role))),children:"object"===typeof t.role?t.role.name:"string"===typeof t.role?t.role:JSON.stringify(t.role)})]})})]}),(0,nS.jsxs)("div",{className:"flex items-center gap-2",children:[(0,nS.jsx)(Zw,{className:"w-4 h-4 text-gray-400"}),(0,nS.jsxs)("select",{value:s,onChange:n=>(async(e,t,n)=>{o&&await o(e,t,n)})(e.student.id,t.id,n.target.value),className:"text-xs px-3 py-1.5 rounded-md border font-medium focus:outline-none focus:ring-2 focus:ring-indigo-500 ".concat((l=s,{[B]:"bg-green-100 text-green-800 border-green-300",[q]:"bg-purple-100 text-purple-800 border-purple-300",[H]:"bg-orange-100 text-orange-800 border-orange-300",[z]:"bg-yellow-100 text-yellow-800 border-yellow-300",[W]:"bg-green-100 text-green-800 border-green-300 font-bold"}[l]||"bg-green-100 text-green-800 border-green-300 font-bold")),children:[(0,nS.jsx)("option",{value:q,children:"\u2b50 Trainer"}),(0,nS.jsx)("option",{value:H,children:"\ud83d\udd36 Overlap BCBA"}),(0,nS.jsx)("option",{value:z,children:"\ud83d\udd37 Overlap Staff"}),(0,nS.jsx)("option",{value:W,children:"\u2713 Solo"})]})]})]},t.id);var l})}):(0,nS.jsx)("p",{className:"text-sm text-gray-500 italic",children:"No team members assigned"})]})]})},t)})}),(0,nS.jsxs)("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4 bg-gray-50 rounded-lg p-4",children:[(0,nS.jsxs)("div",{className:"text-center",children:[(0,nS.jsx)("div",{className:"text-2xl font-bold text-indigo-600",children:t.filter(e=>e.isActive).length}),(0,nS.jsx)("div",{className:"text-sm text-gray-600",children:"Active Staff"})]}),(0,nS.jsxs)("div",{className:"text-center",children:[(0,nS.jsx)("div",{className:"text-2xl font-bold text-green-600",children:n.filter(e=>e.isActive).length}),(0,nS.jsx)("div",{className:"text-sm text-gray-600",children:"Active Clients"})]}),(0,nS.jsxs)("div",{className:"text-center",children:[(0,nS.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:Object.values(g).reduce((e,t)=>e+t.teamMembers.length,0)}),(0,nS.jsx)("div",{className:"text-sm text-gray-600",children:"Total Team Assignments"})]})]})]})]})},xS=v("user-x",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),kS=e=>{let{staff:t,students:n,currentDate:a,onUpdateStaffAttendance:i,onUpdateStudentAttendance:s,onResetAllAttendance:o}=e;const[l,c]=(0,r.useState)("staff"),[u,d]=(0,r.useState)(""),h=(0,r.useMemo)(()=>t.filter(e=>e.isActive&&e.name.toLowerCase().includes(u.toLowerCase())),[t,u]),f=(0,r.useMemo)(()=>n.filter(e=>e.isActive&&e.name.toLowerCase().includes(u.toLowerCase())),[n,u]),m=(0,r.useMemo)(()=>{const e=h.filter(e=>e.absentAM||e.absentFullDay).length,t=h.filter(e=>e.absentPM||e.absentFullDay).length,n=f.filter(e=>e.absentAM||e.absentFullDay).length,r=f.filter(e=>e.absentPM||e.absentFullDay).length;return{staffAbsentAM:e,staffAbsentPM:t,clientsAbsentAM:n,clientsAbsentPM:r,staffPresent:h.length-e-t+h.filter(e=>e.absentFullDay).length,clientsPresent:f.length-n-r+f.filter(e=>e.absentFullDay).length}},[h,f]),g=(e,t,n)=>{const r={absentAM:e.absentAM||!1,absentPM:e.absentPM||!1,absentFullDay:e.absentFullDay||!1,outOfSessionAM:e.outOfSessionAM||!1,outOfSessionPM:e.outOfSessionPM||!1,outOfSessionFullDay:e.outOfSessionFullDay||!1};"absentFullDay"===t?(r.absentFullDay=n,r.absentAM=n,r.absentPM=n):"absentAM"===t?(r.absentAM=n,n||r.absentPM||(r.absentFullDay=!1)):"absentPM"===t?(r.absentPM=n,n||r.absentAM||(r.absentFullDay=!1)):"outOfSessionFullDay"===t?(r.outOfSessionFullDay=n,r.outOfSessionAM=n,r.outOfSessionPM=n):"outOfSessionAM"===t?(r.outOfSessionAM=n,n||r.outOfSessionPM||(r.outOfSessionFullDay=!1)):"outOfSessionPM"===t&&(r.outOfSessionPM=n,n||r.outOfSessionAM||(r.outOfSessionFullDay=!1)),i(e.id,r)},p=(e,t,n)=>{const r={absentAM:e.absentAM||!1,absentPM:e.absentPM||!1,absentFullDay:e.absentFullDay||!1};"absentFullDay"===t?(r.absentFullDay=n,r.absentAM=n,r.absentPM=n):"absentAM"===t?(r.absentAM=n,n||r.absentPM||(r.absentFullDay=!1)):"absentPM"===t&&(r.absentPM=n,n||r.absentAM||(r.absentFullDay=!1)),s(e.id,r)},v=e=>{const t=e.getAttendanceStatus();return"Present"===t?(0,nS.jsxs)("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium flex items-center gap-1",children:[(0,nS.jsx)(_,{className:"w-3 h-3"}),"Present"]}):"Absent Full Day"===t?(0,nS.jsxs)("span",{className:"px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs font-medium flex items-center gap-1",children:[(0,nS.jsx)(xS,{className:"w-3 h-3"}),"Absent Full Day"]}):"Absent AM"===t?(0,nS.jsxs)("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 rounded-full text-xs font-medium flex items-center gap-1",children:[(0,nS.jsx)(N,{className:"w-3 h-3"}),"Absent AM"]}):"Absent PM"===t?(0,nS.jsxs)("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 rounded-full text-xs font-medium flex items-center gap-1",children:[(0,nS.jsx)(N,{className:"w-3 h-3"}),"Absent PM"]}):"Out Full Day"===t?(0,nS.jsxs)("span",{className:"px-2 py-1 bg-cyan-100 text-cyan-800 rounded-full text-xs font-medium flex items-center gap-1",children:[(0,nS.jsx)(N,{className:"w-3 h-3"}),"Out Full Day"]}):"Out AM"===t?(0,nS.jsxs)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium flex items-center gap-1",children:[(0,nS.jsx)(N,{className:"w-3 h-3"}),"Out AM"]}):"Out PM"===t?(0,nS.jsxs)("span",{className:"px-2 py-1 bg-indigo-100 text-indigo-800 rounded-full text-xs font-medium flex items-center gap-1",children:[(0,nS.jsx)(N,{className:"w-3 h-3"}),"Out PM"]}):void 0};return(0,nS.jsxs)("div",{className:"bg-white rounded-lg shadow-lg",children:[(0,nS.jsxs)("div",{className:"bg-purple-600 text-white p-4 rounded-t-lg",children:[(0,nS.jsxs)("h2",{className:"text-xl font-bold flex items-center gap-2",children:[(0,nS.jsx)(S,{className:"w-5 h-5"}),"Attendance Management"]}),(0,nS.jsx)("p",{className:"text-purple-100 text-sm mt-1",children:new Date(a).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),(0,nS.jsxs)("div",{className:"p-6",children:[(0,nS.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,nS.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4",children:[(0,nS.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:h.length}),(0,nS.jsx)("div",{className:"text-sm text-blue-800",children:"Total Staff"}),(0,nS.jsxs)("div",{className:"text-xs text-blue-600 mt-1",children:[m.staffAbsentAM+m.staffAbsentPM," absent today"]})]}),(0,nS.jsxs)("div",{className:"bg-green-50 rounded-lg p-4",children:[(0,nS.jsx)("div",{className:"text-2xl font-bold text-green-600",children:f.length}),(0,nS.jsx)("div",{className:"text-sm text-green-800",children:"Total Clients"}),(0,nS.jsxs)("div",{className:"text-xs text-green-600 mt-1",children:[m.clientsAbsentAM+m.clientsAbsentPM," absent today"]})]}),(0,nS.jsxs)("div",{className:"bg-orange-50 rounded-lg p-4",children:[(0,nS.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:m.staffAbsentAM+m.clientsAbsentAM}),(0,nS.jsx)("div",{className:"text-sm text-orange-800",children:"Absent AM"}),(0,nS.jsxs)("div",{className:"text-xs text-orange-600 mt-1",children:[m.staffAbsentAM," staff, ",m.clientsAbsentAM," clients"]})]}),(0,nS.jsxs)("div",{className:"bg-purple-50 rounded-lg p-4",children:[(0,nS.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:m.staffAbsentPM+m.clientsAbsentPM}),(0,nS.jsx)("div",{className:"text-sm text-purple-800",children:"Absent PM"}),(0,nS.jsxs)("div",{className:"text-xs text-purple-600 mt-1",children:[m.staffAbsentPM," staff, ",m.clientsAbsentPM," clients"]})]})]}),(0,nS.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[(0,nS.jsxs)("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[(0,nS.jsxs)("button",{onClick:()=>c("staff"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("staff"===l?"bg-white text-purple-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:[(0,nS.jsx)(y,{className:"w-4 h-4 inline mr-2"}),"Staff (",h.length,")"]}),(0,nS.jsxs)("button",{onClick:()=>c("clients"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("clients"===l?"bg-white text-purple-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:[(0,nS.jsx)(uS,{className:"w-4 h-4 inline mr-2"}),"Clients (",f.length,")"]})]}),(0,nS.jsx)("input",{type:"text",value:u,onChange:e=>d(e.target.value),placeholder:"Search...",className:"flex-1 px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"}),o&&(0,nS.jsx)("button",{onClick:()=>{window.confirm("Clear all attendance for all staff and clients? This will mark everyone as present.")&&o()},className:"px-4 py-2 bg-red-50 text-red-600 border border-red-200 rounded-md hover:bg-red-100 transition-colors font-medium whitespace-nowrap",children:"Reset All"})]}),"staff"===l&&(0,nS.jsx)("div",{className:"space-y-3",children:0===h.length?(0,nS.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No staff members found"}):h.map(e=>(0,nS.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-purple-300 transition-colors",children:[(0,nS.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,nS.jsxs)("div",{className:"flex items-center gap-3",children:[(0,nS.jsx)("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-medium",children:e.name.charAt(0)}),(0,nS.jsxs)("div",{children:[(0,nS.jsx)("h3",{className:"font-semibold text-gray-900",children:e.name}),(0,nS.jsx)("span",{className:"text-sm text-gray-600",children:e.role})]})]}),v(e)]}),(0,nS.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,nS.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,nS.jsx)("input",{type:"checkbox",checked:e.absentAM||e.absentFullDay,onChange:t=>g(e,"absentAM",t.target.checked),disabled:e.absentFullDay,className:"rounded border-gray-300 text-orange-600 focus:ring-orange-500"}),(0,nS.jsx)("span",{className:"text-sm text-gray-700",children:"Absent AM"})]}),(0,nS.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,nS.jsx)("input",{type:"checkbox",checked:e.absentPM||e.absentFullDay,onChange:t=>g(e,"absentPM",t.target.checked),disabled:e.absentFullDay,className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),(0,nS.jsx)("span",{className:"text-sm text-gray-700",children:"Absent PM"})]}),(0,nS.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,nS.jsx)("input",{type:"checkbox",checked:e.absentFullDay,onChange:t=>g(e,"absentFullDay",t.target.checked),className:"rounded border-gray-300 text-red-600 focus:ring-red-500"}),(0,nS.jsx)("span",{className:"text-sm text-gray-700 font-medium",children:"Full Day"})]})]}),(0,nS.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[(0,nS.jsx)("div",{className:"text-xs text-gray-500 font-medium mb-2",children:"Out of Session (Meetings, etc.)"}),(0,nS.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,nS.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,nS.jsx)("input",{type:"checkbox",checked:e.outOfSessionAM||e.outOfSessionFullDay,onChange:t=>g(e,"outOfSessionAM",t.target.checked),disabled:e.outOfSessionFullDay||e.absentAM||e.absentFullDay,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,nS.jsx)("span",{className:"text-sm text-gray-700",children:"Out AM"})]}),(0,nS.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,nS.jsx)("input",{type:"checkbox",checked:e.outOfSessionPM||e.outOfSessionFullDay,onChange:t=>g(e,"outOfSessionPM",t.target.checked),disabled:e.outOfSessionFullDay||e.absentPM||e.absentFullDay,className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),(0,nS.jsx)("span",{className:"text-sm text-gray-700",children:"Out PM"})]}),(0,nS.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,nS.jsx)("input",{type:"checkbox",checked:e.outOfSessionFullDay,onChange:t=>g(e,"outOfSessionFullDay",t.target.checked),disabled:e.absentFullDay,className:"rounded border-gray-300 text-cyan-600 focus:ring-cyan-500"}),(0,nS.jsx)("span",{className:"text-sm text-gray-700 font-medium",children:"Out Full Day"})]})]})]})]},e.id))}),"clients"===l&&(0,nS.jsx)("div",{className:"space-y-3",children:0===f.length?(0,nS.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No clients found"}):f.map(e=>(0,nS.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-purple-300 transition-colors",children:[(0,nS.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,nS.jsxs)("div",{className:"flex items-center gap-3",children:[(0,nS.jsx)("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center text-white font-medium",children:e.name.charAt(0)}),(0,nS.jsxs)("div",{children:[(0,nS.jsx)("h3",{className:"font-semibold text-gray-900",children:e.name}),(0,nS.jsxs)("div",{className:"flex items-center gap-2",children:[(0,nS.jsx)("span",{className:"text-sm text-gray-600",children:e.program}),(0,nS.jsxs)("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-0.5 rounded",children:["AM: ",e.ratioAM]}),(0,nS.jsxs)("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-0.5 rounded",children:["PM: ",e.ratioPM]})]})]})]}),v(e)]}),(0,nS.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,nS.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,nS.jsx)("input",{type:"checkbox",checked:e.absentAM||e.absentFullDay,onChange:t=>p(e,"absentAM",t.target.checked),disabled:e.absentFullDay,className:"rounded border-gray-300 text-orange-600 focus:ring-orange-500"}),(0,nS.jsx)("span",{className:"text-sm text-gray-700",children:"Absent AM"})]}),(0,nS.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,nS.jsx)("input",{type:"checkbox",checked:e.absentPM||e.absentFullDay,onChange:t=>p(e,"absentPM",t.target.checked),disabled:e.absentFullDay,className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),(0,nS.jsx)("span",{className:"text-sm text-gray-700",children:"Absent PM"})]}),(0,nS.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,nS.jsx)("input",{type:"checkbox",checked:e.absentFullDay,onChange:t=>p(e,"absentFullDay",t.target.checked),className:"rounded border-gray-300 text-red-600 focus:ring-red-500"}),(0,nS.jsx)("span",{className:"text-sm text-gray-700 font-medium",children:"Full Day"})]})]})]},e.id))}),(0,nS.jsx)("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,nS.jsxs)("div",{className:"flex items-start gap-2",children:[(0,nS.jsx)(N,{className:"w-5 h-5 text-blue-600 mt-0.5"}),(0,nS.jsxs)("div",{className:"text-sm text-blue-800",children:[(0,nS.jsx)("p",{className:"font-medium mb-1",children:"Attendance Notes:"}),(0,nS.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-blue-700",children:[(0,nS.jsx)("li",{children:'Marking "Full Day" will automatically mark both AM and PM as absent'}),(0,nS.jsx)("li",{children:"Absent staff will be excluded from auto-scheduling"}),(0,nS.jsx)("li",{children:"Absent clients will not be assigned staff in auto-scheduling"}),(0,nS.jsx)("li",{children:"Attendance changes are saved immediately"})]})]})]})})]})]})},CS=[new U({id:1,name:"Sarah Johnson",role:"RBT",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new U({id:2,name:"Mike Chen",role:"RBT",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new U({id:3,name:"Emily Rodriguez",role:"RBT",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new U({id:4,name:"David Kim",role:"RBT",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new U({id:5,name:"Jessica Williams",role:"RBT",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new U({id:6,name:"Alex Thompson",role:"RBT",primaryProgram:!0,secondaryProgram:!0,isActive:!0}),new U({id:7,name:"Maria Garcia",role:"RBT",primaryProgram:!0,secondaryProgram:!0,isActive:!0}),new U({id:8,name:"Chris Lee",role:"RBT",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new U({id:9,name:"Amanda Davis",role:"RBT",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new U({id:10,name:"Ryan Martinez",role:"RBT",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new U({id:11,name:"Nicole Brown",role:"RBT",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new U({id:12,name:"Kevin Wilson",role:"RBT",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new U({id:13,name:"Stephanie Taylor",role:"RBT",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new U({id:14,name:"Brandon White",role:"RBT",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new U({id:15,name:"Melissa Adams",role:"RBT",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new U({id:16,name:"Jordan Smith",role:"RBT",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new U({id:17,name:"Taylor Jones",role:"RBT",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new U({id:18,name:"Morgan Clark",role:"RBT",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new U({id:19,name:"Casey Green",role:"RBT",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new U({id:20,name:"Riley Miller",role:"RBT",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new U({id:41,name:"Dr. Jennifer Parker",role:"BS",primaryProgram:!0,secondaryProgram:!0,isActive:!0}),new U({id:42,name:"Lisa Anderson",role:"BS",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new U({id:43,name:"Mark Roberts",role:"BS",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new U({id:44,name:"Amy Foster",role:"BS",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new U({id:45,name:"Daniel Cooper",role:"BS",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new U({id:61,name:"Dr. Michael Stevens",role:"BCBA",primaryProgram:!0,secondaryProgram:!0,isActive:!0}),new U({id:62,name:"Dr. Sarah Mitchell",role:"BCBA",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new U({id:63,name:"Dr. Robert Turner",role:"BCBA",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new U({id:64,name:"Dr. Linda Campbell",role:"BCBA",primaryProgram:!0,secondaryProgram:!0,isActive:!0}),new U({id:71,name:"Carol Henderson",role:"EA",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new U({id:72,name:"Janet Phillips",role:"EA",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new U({id:73,name:"Robert Evans",role:"EA",primaryProgram:!0,secondaryProgram:!1,isActive:!0}),new U({id:76,name:"Patricia Young",role:"MHA",primaryProgram:!0,secondaryProgram:!0,isActive:!0}),new U({id:77,name:"Thomas Hall",role:"MHA",primaryProgram:!1,secondaryProgram:!0,isActive:!0}),new U({id:78,name:"Michelle Lewis",role:"CC",primaryProgram:!0,secondaryProgram:!0,isActive:!0}),new U({id:79,name:"Elizabeth Murphy",role:"Teacher",primaryProgram:!0,secondaryProgram:!0,isActive:!0}),new U({id:80,name:"James Wilson",role:"Director",primaryProgram:L.PRIMARY,secondaryProgram:L.SECONDARY,isActive:!0})],ES=[new V({id:101,name:"Alex Martinez",program:L.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:102,name:"Emma Thompson",program:L.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:103,name:"Liam Johnson",program:L.PRIMARY,ratio:j.TWO_TO_ONE,isActive:!0}),new V({id:104,name:"Sophie Chen",program:L.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:105,name:"Noah Davis",program:L.PRIMARY,ratio:j.ONE_TO_TWO,isActive:!0}),new V({id:106,name:"Isabella Garcia",program:L.PRIMARY,ratio:j.ONE_TO_TWO,isActive:!0}),new V({id:107,name:"Mason Williams",program:L.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:108,name:"Olivia Brown",program:L.PRIMARY,ratio:j.TWO_TO_ONE,isActive:!0}),new V({id:109,name:"Lucas Wilson",program:L.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0,pairedWith:110}),new V({id:110,name:"Ava Rodriguez",program:L.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0,pairedWith:109}),new V({id:111,name:"Ethan Taylor",program:L.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:112,name:"Mia Anderson",program:L.PRIMARY,ratio:j.ONE_TO_TWO,isActive:!0}),new V({id:113,name:"Jacob Miller",program:L.PRIMARY,ratio:j.ONE_TO_TWO,isActive:!0}),new V({id:114,name:"Charlotte Lee",program:L.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0,pairedWith:115}),new V({id:115,name:"Michael White",program:L.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0,pairedWith:114}),new V({id:116,name:"Amelia Harris",program:L.PRIMARY,ratio:j.TWO_TO_ONE,isActive:!0}),new V({id:117,name:"Benjamin Clark",program:L.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:118,name:"Harper Lewis",program:L.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:119,name:"Daniel Walker",program:L.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:120,name:"Ella Young",program:L.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:121,name:"Matthew King",program:L.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:122,name:"Avery Scott",program:L.PRIMARY,ratio:j.ONE_TO_TWO,isActive:!0}),new V({id:123,name:"Logan Green",program:L.PRIMARY,ratio:j.ONE_TO_TWO,isActive:!0}),new V({id:124,name:"Luna Adams",program:L.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:125,name:"Owen Baker",program:L.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:126,name:"Layla Hall",program:L.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:127,name:"Carter Rivera",program:L.PRIMARY,ratio:j.TWO_TO_ONE,isActive:!0}),new V({id:128,name:"Zoe Campbell",program:L.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:129,name:"Grayson Nelson",program:L.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:130,name:"Lily Mitchell",program:L.PRIMARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:201,name:"Adrian Torres",program:L.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0,pairedWith:202}),new V({id:202,name:"Cesar Flores",program:L.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0,pairedWith:201}),new V({id:203,name:"Maya Patel",program:L.SECONDARY,ratio:j.TWO_TO_ONE,isActive:!0}),new V({id:204,name:"Diego Santos",program:L.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:205,name:"Zara Ahmed",program:L.SECONDARY,ratio:j.ONE_TO_TWO,isActive:!0}),new V({id:206,name:"Kai Thompson",program:L.SECONDARY,ratio:j.ONE_TO_TWO,isActive:!0}),new V({id:207,name:"Nora Kim",program:L.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:208,name:"Mateo Gonzalez",program:L.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:209,name:"Aria Parker",program:L.SECONDARY,ratio:j.TWO_TO_ONE,isActive:!0}),new V({id:210,name:"Felix Rodriguez",program:L.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:211,name:"Ivy Chen",program:L.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:212,name:"Jaxon Davis",program:L.SECONDARY,ratio:j.ONE_TO_TWO,isActive:!0}),new V({id:213,name:"Vera Martinez",program:L.SECONDARY,ratio:j.ONE_TO_TWO,isActive:!0}),new V({id:214,name:"Ezra Wilson",program:L.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:215,name:"Sage Anderson",program:L.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:216,name:"Phoenix Taylor",program:L.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:217,name:"River Johnson",program:L.SECONDARY,ratio:j.TWO_TO_ONE,isActive:!0}),new V({id:218,name:"Luna Garcia",program:L.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:219,name:"Atlas Brown",program:L.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0}),new V({id:220,name:"Nova Lee",program:L.SECONDARY,ratio:j.ONE_TO_ONE,isActive:!0})],IS=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;const t=new G({date:e});return[{staffId:1,studentId:101,session:"AM",program:L.PRIMARY},{staffId:2,studentId:102,session:"AM",program:L.PRIMARY},{staffId:4,studentId:107,session:"AM",program:L.PRIMARY},{staffId:9,studentId:101,session:"PM",program:L.PRIMARY},{staffId:11,studentId:102,session:"PM",program:L.PRIMARY},{staffId:3,studentId:201,session:"AM",program:L.SECONDARY},{staffId:5,studentId:202,session:"AM",program:L.SECONDARY}].forEach((n,r)=>{const a=new K({id:"test_".concat(r+1),staffId:n.staffId,studentId:n.studentId,session:n.session,program:n.program,date:e,isLocked:!1,assignedBy:"manual"});t.addAssignment(a)}),t.lockAssignment("test_1"),t.lockAssignment("test_6"),t},NS=()=>({validScenario:{description:"All constraints satisfied",schedule:IS(),expectedErrors:0,expectedWarnings:0},sameDayViolation:{description:"Staff assigned to same student twice in one day",schedule:(()=>{const e=IS(),t=new K({id:"violation_1",staffId:1,studentId:101,session:"PM",program:L.PRIMARY,date:new Date,isLocked:!1,assignedBy:"manual"});return e.addAssignment(t),e})(),expectedErrors:1,expectedWarnings:0},ratioViolation:{description:"2:1 student with only one staff assigned",schedule:(()=>{const e=new G({date:new Date}),t=new K({id:"ratio_violation",staffId:1,studentId:103,session:"AM",program:L.PRIMARY,date:new Date,isLocked:!1,assignedBy:"manual"});return e.addAssignment(t),e})(),expectedErrors:1,expectedWarnings:0}});class PS{constructor(){this.testResults=[],this.autoAssignEngine=new lh,this.autoAssignEngine.setDebugMode(!0)}async runAllTests(){return console.log("\ud83e\uddea Starting ABA Scheduler Test Suite...\n"),this.testResults=[],await this.testDataModels(),await this.testValidationRules(),await this.testAutoAssignment(),await this.testPerformance(),await this.testIntegration(),this.printSummary(),this.testResults}async testDataModels(){console.log("\ud83d\udccb Testing Data Models..."),this.test("Staff role hierarchy",()=>{const e=CS.find(e=>"RBT"===e.role),t=CS.find(e=>"BCBA"===e.role),n=CS.find(e=>"Director"===e.role);return e.getRoleLevel()<t.getRoleLevel()&&t.getRoleLevel()<n.getRoleLevel()}),this.test("Staff program qualification",()=>{const e=CS[0],t=e.canWorkProgram("Primary"),n=e.canWorkProgram("Secondary");return(!e.primaryProgram||t)&&(!e.secondaryProgram||n)}),this.test("Student ratio requirements",()=>{const e=ES.find(e=>"1:1"===e.ratio),t=ES.find(e=>"2:1"===e.ratio),n=ES.find(e=>"1:2"===e.ratio);return!e.requiresMultipleStaff()&&t.requiresMultipleStaff()&&n.isSmallGroup()}),this.test("Schedule assignment management",()=>{const e=IS(),t=e.assignments.length,n={id:"test_new",staffId:99,studentId:199,session:"AM",program:"Primary",date:new Date};return e.addAssignment(n),e.removeAssignment("test_new"),e.assignments.length===t}),this.test("Assignment ID generation",()=>{const e=Q.generateAssignmentId();return e!==Q.generateAssignmentId()&&e.includes("assignment_")}),this.test("Staff hierarchy sorting",()=>{const e=Q.sortStaffByHierarchy(CS.slice(0,5));for(let t=1;t<e.length;t++)if(e[t].getRoleLevel()<e[t-1].getRoleLevel())return!1;return!0}),console.log("\u2705 Data Models tests completed\n")}async testValidationRules(){console.log("\ud83d\udd0d Testing Validation Rules...");const e=NS();this.test("Valid schedule passes validation",()=>{const t=e.validScenario;return Y.validateSchedule(t.schedule,CS,ES).length===t.expectedErrors}),this.test("Same-day violation detected",()=>{const t=e.sameDayViolation;return Y.validateSchedule(t.schedule,CS,ES).length>=t.expectedErrors}),this.test("Ratio violation detected",()=>{const t=e.ratioViolation;return Y.validateSchedule(t.schedule,CS,ES).length>=t.expectedErrors}),this.test("Individual assignment validation",()=>{const e=IS(),t=e.assignments[0],n=new G({date:e.date,assignments:e.assignments.filter(e=>e.id!==t.id),lockedAssignments:e.lockedAssignments,isFinalized:e.isFinalized});return 0===Y.validateAssignment(t,n,CS,ES).length}),console.log("\u2705 Validation Rules tests completed\n")}async testAutoAssignment(){console.log("\ud83e\udd16 Testing Auto-Assignment..."),this.test("Auto-assignment creates assignments",async()=>{const e=IS(),t=(e.assignments.length,await this.autoAssignEngine.autoAssignSchedule(e,CS,ES));return t&&t.assignments&&t.assignments.length>=0}),this.test("Auto-assignment respects staff hierarchy",async()=>{const e=IS(),t=ES.find(t=>"1:1"===t.ratio&&!e.assignments.some(e=>e.studentId===t.id));if(!t)return!0;const n=await this.autoAssignEngine.autoAssignSchedule(e,CS,ES);if(!n||!n.assignments)return!1;const r=n.assignments.find(e=>e.studentId===t.id);if(r){const e=CS.find(e=>e.id===r.staffId);return e&&e.canWorkProgram(r.program)}return!0}),this.test("Auto-assignment respects constraints",async()=>{const e=IS(),t=await this.autoAssignEngine.autoAssignSchedule(e,CS,ES);if(!t||!t.assignments)return!1;const n=[...e.assignments,...t.assignments];return 0===Y.validateSchedule(c(c({},e),{},{assignments:n}),CS,ES).length}),this.test("Auto-assignment preserves locked assignments",async()=>{const e=IS(),t=[...e.lockedAssignments],n=await this.autoAssignEngine.autoAssignSchedule(e,CS,ES);return!(!n||!n.assignments)&&t.every(t=>e.assignments.some(e=>e.id===t))}),console.log("\u2705 Auto-Assignment tests completed\n")}async testPerformance(){console.log("\u26a1 Testing Performance..."),this.test("Handles large datasets efficiently",async()=>{const e=Date.now(),t=CS.slice(0,20),n=ES.slice(0,15),r=IS(),a=await this.autoAssignEngine.autoAssignSchedule(r,t,n),i=Date.now()-e;return console.log("  Auto-assignment completed in ".concat(i,"ms")),a&&a.assignments&&i<5e3}),this.test("Validation performs efficiently",()=>{const e=IS(),t=Date.now();for(let r=0;r<10;r++)Y.validateSchedule(e,CS,ES);const n=Date.now()-t;return console.log("  10 validation runs completed in ".concat(n,"ms")),n<1e3}),console.log("\u2705 Performance tests completed\n")}async testIntegration(){console.log("\ud83d\udd17 Testing Integration Scenarios..."),this.test("Complete scheduling workflow",async()=>{const e=IS();e.assignments.length;e.assignments.length>0&&e.lockAssignment(e.assignments[0].id);const t=await this.autoAssignEngine.autoAssignSchedule(e,CS,ES);if(!t||!t.assignments)return!1;const n=Y.validateSchedule(e,CS,ES);return t.assignments.length>=0&&0===n.length}),this.test("Handles mixed ratio requirements",async()=>{const e=IS(),t=ES.filter(e=>"1:1"===e.ratio),n=ES.filter(e=>"2:1"===e.ratio),r=ES.filter(e=>"1:2"===e.ratio);console.log("  Testing with ".concat(t.length," 1:1, ").concat(n.length," 2:1, ").concat(r.length," 1:2 students"));const a=await this.autoAssignEngine.autoAssignSchedule(e,CS,ES);return a&&a.errors&&0===a.errors.length}),this.test("Maintains program separation",async()=>{const e=IS(),t=await this.autoAssignEngine.autoAssignSchedule(e,CS,ES);if(!t||!t.assignments)return!1;const n=[...e.assignments,...t.assignments].filter(e=>"Primary"===e.program).every(e=>{const t=CS.find(t=>t.id===e.staffId);return t&&t.canWorkProgram("Primary")}),r=[...e.assignments,...t.assignments].filter(e=>"Secondary"===e.program).every(e=>{const t=CS.find(t=>t.id===e.staffId);return t&&t.canWorkProgram("Secondary")});return n&&r}),console.log("\u2705 Integration tests completed\n")}test(e,t){try{const n=Date.now(),r=t(),a=Date.now()-n;return r instanceof Promise?r.then(t=>{const r=Date.now()-n;return this.recordTest(e,t,null,r),t}).catch(t=>{const r=Date.now()-n;return this.recordTest(e,!1,t,r),!1}):(this.recordTest(e,r,null,a),r)}catch(n){return this.recordTest(e,!1,n,0),!1}}recordTest(e,t,n,r){const a={name:e,passed:t,error:n?n.message:null,duration:r};this.testResults.push(a);const i=t?"\u2705":"\u274c",s=r>0?" (".concat(r,"ms)"):"";console.log("  ".concat(i," ").concat(e).concat(s)),n&&console.log("    Error: ".concat(n.message))}printSummary(){const e=this.testResults.filter(e=>e.passed).length,t=this.testResults.length-e,n=this.testResults.reduce((e,t)=>e+t.duration,0);console.log("\n\ud83d\udcca Test Summary:"),console.log("   Total Tests: ".concat(this.testResults.length)),console.log("   Passed: ".concat(e)),console.log("   Failed: ".concat(t)),console.log("   Total Duration: ".concat(n,"ms")),console.log("   Success Rate: ".concat((e/this.testResults.length*100).toFixed(1),"%")),t>0&&(console.log("\n\u274c Failed Tests:"),this.testResults.filter(e=>!e.passed).forEach(e=>{console.log("   - ".concat(e.name,": ").concat(e.error||"Unknown error"))})),console.log(0===t?"\n\ud83c\udf89 All tests passed!":"\n\u26a0\ufe0f  Some tests failed.")}generateReport(){return{summary:{total:this.testResults.length,passed:this.testResults.filter(e=>e.passed).length,failed:this.testResults.filter(e=>!e.passed).length,duration:this.testResults.reduce((e,t)=>e+t.duration,0)},results:this.testResults,timestamp:(new Date).toISOString()}}}class _S extends r.Component{constructor(e){super(e),this.handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null}),this.props.onReset&&this.props.onReset()},this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){console.error("Error caught by boundary:",e,t),this.setState({error:e,errorInfo:t})}render(){return this.state.hasError?(0,nS.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center p-4",children:(0,nS.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-2xl w-full",children:[(0,nS.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,nS.jsx)(tS,{className:"text-red-500",size:32}),(0,nS.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Something went wrong"})]}),(0,nS.jsx)("p",{className:"text-gray-700 mb-4",children:"The application encountered an unexpected error. This has been logged for review."}),this.state.error&&(0,nS.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded p-4 mb-4",children:[(0,nS.jsx)("h3",{className:"font-semibold text-red-900 mb-2",children:"Error Details:"}),(0,nS.jsx)("pre",{className:"text-sm text-red-800 overflow-auto",children:this.state.error.toString()})]}),!1,(0,nS.jsxs)("div",{className:"flex gap-3",children:[(0,nS.jsx)("button",{onClick:this.handleReset,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Try Again"}),(0,nS.jsx)("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors",children:"Reload Page"})]}),(0,nS.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:(0,nS.jsx)("p",{className:"text-sm text-gray-600",children:"If this problem persists, please contact support with the error details above."})})]})}):this.props.children}}const OS=_S,RS=()=>{const[e]=(0,r.useState)({siteUrl:"https://evokebehavioralhealthcom.sharepoint.com/sites/Clinistrators",staffListName:"Staff",studentsListName:"Clients",scheduleListName:"ScheduleHistory",clientId:"c9f70b7e-8ffb-403d-af93-80b95b38a0bb",tenantId:"a4adcc38-7b4e-485c-80f9-7d9ca4e83d64",redirectUri:"localhost"===window.location.hostname?"http://localhost:3000":"https://mlr3037.github.io/EvokeSchedule2.0"}),[t]=(0,r.useState)(()=>new sh(e)),[n]=(0,r.useState)(()=>new oh(e)),[a]=(0,r.useState)(()=>new lh),[i,s]=(0,r.useState)(!1),[o,l]=(0,r.useState)(null),[u,d]=(0,r.useState)([]),[h,f]=(0,r.useState)([]),[m,g]=(0,r.useState)(new Date),[p,v]=(0,r.useState)(new G({date:new Date})),[M,D]=(0,r.useState)(null),[L,F]=(0,r.useState)("schedule"),[j,B]=(0,r.useState)(!1),[H,z]=(0,r.useState)(!1),[q,W]=(0,r.useState)(!1),[Y,$]=(0,r.useState)(null),[J,X]=(0,r.useState)(!1),[Z,ee]=(0,r.useState)(!1),[te,ne]=(0,r.useState)(null),[re,ae]=(0,r.useState)(null),[ie,se]=(0,r.useState)(!1),[oe,le]=(0,r.useState)(null),[ce,ue]=(0,r.useState)(!1);(0,r.useEffect)(()=>{de()},[]);const de=async()=>{try{await t.initializeMSAL();const e=await t.checkAuthentication();s(e),l(t.accessToken),t.accessToken&&n.setAccessToken(t.accessToken),e&&await he()}catch(e){console.error("Error initializing app:",e),(e.message.includes("session has expired")||e.message.includes("Authentication"))&&(s(!1),l(null))}},he=async()=>{B(!0);try{const[e,n,r]=await Promise.all([t.loadStaff().catch(e=>(console.error("Failed to load staff:",e),[])),t.loadStudents().catch(e=>(console.error("Failed to load students:",e),[])),t.loadSchedule(m).catch(e=>(console.error("Failed to load schedule:",e),{assignments:[],date:m}))]);d(e),f(n),v(r),D(new Date),console.log("\u2705 Loaded ".concat(e.length," staff, ").concat(n.length," students at ").concat((new Date).toLocaleTimeString()));const a=e.filter(e=>e.absentAM||e.absentPM||e.absentFullDay),i=n.filter(e=>e.absentAM||e.absentPM||e.absentFullDay);(a.length>0||i.length>0)&&console.log("\ud83d\udcca Attendance after load: ".concat(a.length," staff absent, ").concat(i.length," students absent")),0===e.length&&0===n.length&&console.warn("\u26a0\ufe0f No data loaded. Check authentication and SharePoint list names.")}catch(e){console.error("\ud83d\udca5 Error loading data:",e),d([]),f([]),v({assignments:[],date:m})}finally{B(!1)}},fe=async()=>{try{B(!0);await t.login()&&(s(!0),l(t.accessToken),t.accessToken&&n.setAccessToken(t.accessToken),await he())}catch(e){console.error("Login error:",e),alert("Login failed: ".concat(e.message))}finally{B(!1)}};return i?(0,nS.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,nS.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,nS.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,nS.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,nS.jsxs)("div",{className:"flex items-center gap-3",children:[(0,nS.jsx)(y,{className:"w-8 h-8 text-blue-600"}),(0,nS.jsxs)("div",{children:[(0,nS.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"ABA Scheduler"}),(0,nS.jsx)("p",{className:"text-sm text-gray-500",children:"Staff & Student Scheduling"})]})]}),(0,nS.jsxs)("div",{className:"flex items-center gap-4",children:[(0,nS.jsxs)("div",{className:"flex items-center gap-2",children:[(0,nS.jsx)(S,{className:"w-5 h-5 text-gray-500"}),(0,nS.jsx)("input",{type:"date",value:m.toISOString().split("T")[0],onChange:e=>(async e=>{if(i)try{const r=m.toDateString(),a=e.toDateString();if(r!==a){console.log("\ud83d\udcc5 Date changed from",r,"to",a),console.log("\ud83d\udcbe Saving attendance history for",r),await t.saveAttendanceHistory(u,h,m);const e=u.map(e=>new U(c(c({},e),{},{absentAM:!1,absentPM:!1,absentFullDay:!1}))),i=h.map(e=>new V(c(c({},e),{},{absentAM:!1,absentPM:!1,absentFullDay:!1})));d(e),f(i),console.log("\u2705 Local attendance state cleared for",e.length,"staff and",i.length,"students"),console.log("\ud83e\uddf9 Clearing attendance in SharePoint...");try{await t.clearAllAttendanceInSharePoint(e,i),console.log("\u2705 SharePoint attendance cleared")}catch(n){console.error("\u26a0\ufe0f Error clearing SharePoint attendance:",n)}}g(e);const i=await t.loadSchedule(e);v(i)}catch(r){console.error("Error loading schedule for new date:",r)}else g(e)})(new Date(e.target.value)),className:"border border-gray-300 rounded px-3 py-1 text-sm"})]}),(0,nS.jsxs)("div",{className:"flex items-center gap-2",children:[(0,nS.jsxs)("button",{onClick:async()=>{W(!0);try{const e=await a.autoAssignSchedule(p,u,h);if(e.assignments.length>0){const t=p.assignments.filter(e=>"manual"===e.assignedBy||e.isLocked);let n=[...t,...e.assignments];n=n.filter(e=>{const t=u.find(t=>t.id===e.staffId);if(!t)return!0;return!("AM"===e.session?t.absentAM||t.absentFullDay:t.absentPM||t.absentFullDay)||(console.warn("\u26a0\ufe0f SAFETY CHECK: Removed assignment for absent staff: ".concat(t.name," (").concat(e.session,")")),!1)});const r={};n.forEach(e=>{const t="".concat(e.studentId,"-").concat(e.session);r[t]||(r[t]=[]),r[t].push(e)});let a=[];Object.entries(r).forEach(e=>{let[t,n]=e;const[r,i]=t.split("-"),s=h.find(e=>e.id==r);if(!s)return void a.push(...n);const o="AM"===i?s.ratioAM:s.ratioPM,l="2:1"===o?2:1,c=n.sort((e,t)=>"manual"===e.assignedBy||e.isLocked?-1:"manual"===t.assignedBy||t.isLocked?1:0);a.push(...c.slice(0,l)),c.length>l&&console.warn("\u26a0\ufe0f ".concat(s.name," ").concat(i,": Trimmed ").concat(c.length," assignments to ").concat(l," (ratio: ").concat(o,")"))});const i={};a=a.filter(e=>{const t="".concat(e.staffId,"-").concat(e.session);if(i[t]){const n=i[t],r=h.find(t=>t.id===e.studentId),a=h.find(e=>e.id===n.studentId);if(!(r&&a&&r.isPaired()&&r.pairedWith===a.id)){const t=u.find(t=>t.id===e.staffId);return console.warn("\u26a0\ufe0f BLOCKED DOUBLE-BOOKING: ".concat((null===t||void 0===t?void 0:t.name)||"Staff"," cannot be assigned to ").concat((null===r||void 0===r?void 0:r.name)||"student"," - already assigned to ").concat((null===a||void 0===a?void 0:a.name)||"another student"," in ").concat(e.session)),!1}}return i[t]=e,!0}),console.log("\ud83d\udd04 Auto-assign: ".concat(p.assignments.length," existing \u2192 ").concat(t.length," manual + ").concat(e.assignments.length," new auto \u2192 ").concat(a.length," final (after safety checks)"));const s=new G({date:p.date,assignments:a,traineeAssignments:[...p.traineeAssignments||[]],lockedAssignments:p.lockedAssignments,isFinalized:p.isFinalized});v(s)}e.errors.length>0&&console.warn("Auto-assignment errors:",e.errors)}catch(e){console.error("Auto-assignment failed:",e),alert("Auto-assignment failed. Please check the console for details.")}finally{W(!1)}},disabled:q||j,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 disabled:opacity-50 flex items-center gap-2",title:"Automatically assign staff to students (includes smart swap optimization)",children:[q?(0,nS.jsx)(b,{className:"w-4 h-4 animate-spin"}):(0,nS.jsx)(T,{className:"w-4 h-4"}),"Auto Assign"]}),(0,nS.jsxs)("button",{onClick:async()=>{W(!0);try{console.log("\ud83d\udd00 Starting Smart Swap Optimization...");const e=await a.performSwapOptimization(p,u,h);if(e.swapsMade>0||e.newAssignments.length>0){console.log("\u2705 Smart Swap Results: ".concat(e.swapsMade," swaps, ").concat(e.gapsFilled," gaps filled"));let t=[...p.assignments];for(const s of e.swaps)s.oldAssignment&&(t=t.filter(e=>e.id!==s.oldAssignment.id));t=[...t,...e.newAssignments];const n={};t.forEach(e=>{const t="".concat(e.studentId,"-").concat(e.session);n[t]||(n[t]=[]),n[t].push(e)});let r=[];Object.entries(n).forEach(e=>{let[t,n]=e;const[a,i]=t.split("-"),s=h.find(e=>e.id==a);if(!s)return void r.push(...n);const o="AM"===i?s.ratioAM:s.ratioPM,l="2:1"===o?2:1,c=n.sort((e,t)=>"manual"===e.assignedBy||e.isLocked?-1:"manual"===t.assignedBy||t.isLocked?1:0);r.push(...c.slice(0,l)),c.length>l&&console.warn("\u26a0\ufe0f SMART SWAP: ".concat(s.name," ").concat(i,": Trimmed ").concat(c.length," assignments to ").concat(l," (ratio: ").concat(o,")"))});const a={};r=r.filter(e=>{const t="".concat(e.staffId,"-").concat(e.session);if(a[t]){const n=a[t],r=h.find(t=>t.id===e.studentId),i=h.find(e=>e.id===n.studentId);if(!(r&&i&&r.isPaired()&&r.pairedWith===i.id)){const t=u.find(t=>t.id===e.staffId);return console.warn("\u26a0\ufe0f SMART SWAP BLOCKED DOUBLE-BOOKING: ".concat((null===t||void 0===t?void 0:t.name)||"Staff"," cannot be assigned to ").concat((null===r||void 0===r?void 0:r.name)||"student"," - already assigned to ").concat((null===i||void 0===i?void 0:i.name)||"another student"," in ").concat(e.session)),!1}}return a[t]=e,!0});const i=new G({date:p.date,assignments:r,traineeAssignments:[...p.traineeAssignments||[]],lockedAssignments:p.lockedAssignments,isFinalized:p.isFinalized});v(i),alert("\u2705 Smart Swap Complete!\n\n".concat(e.swapsMade," swaps made\n").concat(e.gapsFilled," gaps filled\n\nCheck the schedule for improvements."))}else alert("\u2139\ufe0f No beneficial swaps found.\n\nAll gaps may require staff who are already assigned or unavailable.")}catch(e){console.error("Smart swap failed:",e),alert("Smart swap failed. Please check the console for details.")}finally{W(!1)}},disabled:q||j||0===p.assignments.length,className:"bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 disabled:opacity-50 flex items-center gap-2",title:"Fill gaps by swapping staff to enable team member assignments",children:[q?(0,nS.jsx)(b,{className:"w-4 h-4 animate-spin"}):"\ud83d\udd00","Smart Swap"]}),(0,nS.jsxs)("button",{onClick:async()=>{if(p.lastModified&&M){const e=new Date(p.lastModified);if(e>M){const t=Math.floor((e-M)/1e3/60),n="\u26a0\ufe0f WARNING: This schedule was modified by ".concat(p.lastModifiedBy," ").concat(t," minute").concat(1!==t?"s":"",' after you loaded the page.\n\nSaving now may overwrite their changes.\n\nRecommendation: Click "Cancel", then click the "Refresh" button to see their changes before making your edits.\n\nDo you want to save anyway and potentially overwrite their work?');if(!window.confirm(n))return}}z(!0);try{var e;const n=(null===(e=t.currentUser)||void 0===e?void 0:e.displayName)||"Unknown User",r=(new Date).toISOString(),a=new G(c(c({},p),{},{date:m.toISOString().split("T")[0],lastModified:r,lastModifiedBy:n}));await t.saveSchedule(a)?(v(a),D(new Date),console.log("\u2705 Schedule saved successfully to SharePoint"),alert("Schedule saved successfully! Historical data is now available for rule checking.")):(console.log("\u2139\ufe0f Schedule save failed - check browser console for details"),alert("Failed to save schedule. Please check the browser console (F12 \u2192 Console) for detailed error information. This might be due to missing SharePoint lists, permissions, or column naming issues."))}catch(n){console.error("\u274c Error saving schedule:",n);let e="An error occurred while saving the schedule.";e=n.message.includes("Authentication required")?"Authentication expired. Please refresh the page and sign in again.":n.message.includes("fetch")?"Network connection error. Please check your internet connection and try again.":n.message.includes("TypeError")?"Configuration error. Please check the browser console (F12 \u2192 Console) for technical details.":"Error: ".concat(n.message),alert(e+"\n\nFor technical details, check the browser console (F12 \u2192 Console).")}finally{z(!1)}},disabled:H||j,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2",children:[H?(0,nS.jsx)(b,{className:"w-4 h-4 animate-spin"}):(0,nS.jsx)(A,{className:"w-4 h-4"}),"Save"]}),(0,nS.jsxs)("button",{onClick:()=>{try{Qw.exportSchedule(p,h,u,m),console.log("\u2705 Schedule exported to Excel successfully")}catch(e){console.error("\u274c Error exporting schedule:",e),alert("Failed to export schedule: ".concat(e.message))}},disabled:j||0===p.assignments.length,className:"bg-emerald-600 text-white px-4 py-2 rounded hover:bg-emerald-700 disabled:opacity-50 flex items-center gap-2",title:"Export schedule to Excel",children:[(0,nS.jsx)(x,{className:"w-4 h-4"}),"Export"]}),(0,nS.jsxs)("button",{onClick:he,disabled:j,className:"bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 disabled:opacity-50 flex items-center gap-2",children:[(0,nS.jsx)(b,{className:"w-4 h-4 ".concat(j?"animate-spin":"")}),"Refresh"]}),(0,nS.jsx)("button",{onClick:()=>{localStorage.removeItem("sp_access_token"),localStorage.removeItem("sp_token_expiry"),t.accessToken=null,t.tokenExpiry=null,s(!1),l(null),alert("Authentication cache cleared. Please refresh the page and log in again.")},className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 flex items-center gap-2",title:"Clear authentication cache to fix 401 errors",children:"\ud83d\udd04 Clear Auth"})]}),(0,nS.jsx)("div",{className:"relative",children:(0,nS.jsxs)("button",{onClick:()=>{t.forceLogout(),s(!1),l(null),d([]),f([]),v(new G({date:m}))},className:"flex items-center gap-2 text-gray-700 hover:text-gray-900",children:[(0,nS.jsx)(k,{className:"w-5 h-5"}),"Sign Out"]})})]})]})})}),(0,nS.jsx)("nav",{className:"bg-white border-b border-gray-200",children:(0,nS.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,nS.jsx)("div",{className:"flex space-x-8",children:[{id:"schedule",label:"Schedule",icon:C},{id:"staff",label:"Staff",icon:y},{id:"students",label:"Students",icon:y},{id:"teams",label:"Teams",icon:y},{id:"attendance",label:"Attendance",icon:S},{id:"validation",label:"Validation",icon:E},{id:"rules",label:"Rules",icon:I},{id:"tests",label:"Tests",icon:T}].map(e=>{const t=e.icon;return(0,nS.jsxs)("button",{onClick:()=>F(e.id),className:"py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 ".concat(L===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,nS.jsx)(t,{className:"w-4 h-4"}),e.label]},e.id)})})})}),(0,nS.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[j&&(0,nS.jsxs)("div",{className:"flex justify-center items-center py-12",children:[(0,nS.jsx)(b,{className:"w-8 h-8 animate-spin text-blue-600"}),(0,nS.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading..."})]}),!j&&(0,nS.jsxs)(nS.Fragment,{children:["schedule"===L&&(0,nS.jsxs)("div",{className:"space-y-6",children:[p.lastModified&&(0,nS.jsx)("div",{className:"bg-amber-50 border-l-4 border-amber-400 p-4 rounded-r-lg shadow-sm",children:(0,nS.jsxs)("div",{className:"flex items-start",children:[(0,nS.jsx)(N,{className:"w-5 h-5 text-amber-600 mt-0.5 mr-3 flex-shrink-0"}),(0,nS.jsxs)("div",{className:"flex-1",children:[(0,nS.jsx)("h3",{className:"text-sm font-semibold text-amber-800",children:"Schedule Status"}),(0,nS.jsxs)("p",{className:"text-sm text-amber-700 mt-1",children:["Last saved by ",(0,nS.jsx)("span",{className:"font-medium",children:p.lastModifiedBy})," at"," ",(0,nS.jsx)("span",{className:"font-medium",children:new Date(p.lastModified).toLocaleString()})]}),(0,nS.jsx)("p",{className:"text-xs text-amber-600 mt-2",children:"\u26a0\ufe0f If someone else is editing this schedule, their changes may overwrite yours. Click Refresh before making changes to see the latest version."})]})]})}),!p.lastModified&&(0,nS.jsx)("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 rounded-r-lg shadow-sm",children:(0,nS.jsxs)("div",{className:"flex items-start",children:[(0,nS.jsx)(N,{className:"w-5 h-5 text-blue-600 mt-0.5 mr-3 flex-shrink-0"}),(0,nS.jsxs)("div",{className:"flex-1",children:[(0,nS.jsx)("h3",{className:"text-sm font-semibold text-blue-800",children:"New Schedule"}),(0,nS.jsx)("p",{className:"text-sm text-blue-700 mt-1",children:'This schedule hasn\'t been saved yet. Click "Save Schedule" to preserve your changes.'}),(0,nS.jsx)("p",{className:"text-xs text-blue-600 mt-2",children:"\ud83d\udca1 Save frequently if multiple people are working on schedules to avoid losing your work."})]})]})}),(0,nS.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 mb-6",children:[(0,nS.jsx)(aS,{schedule:p,staff:u,students:h,session:"AM",program:"Primary"}),(0,nS.jsx)(aS,{schedule:p,staff:u,students:h,session:"PM",program:"Primary"}),(0,nS.jsx)(aS,{schedule:p,staff:u,students:h,session:"AM",program:"Secondary"}),(0,nS.jsx)(aS,{schedule:p,staff:u,students:h,session:"PM",program:"Secondary"})]}),(0,nS.jsx)(rS,{schedule:p,staff:u,students:h,onAssignmentLock:e=>{p.lockAssignment(e);const t=new G({date:p.date,assignments:[...p.assignments],traineeAssignments:[...p.traineeAssignments||[]],lockedAssignments:new Set(p.lockedAssignments),isFinalized:p.isFinalized});v(t)},onAssignmentUnlock:e=>{p.unlockAssignment(e);const t=new G({date:p.date,assignments:[...p.assignments],traineeAssignments:[...p.traineeAssignments||[]],lockedAssignments:new Set(p.lockedAssignments),isFinalized:p.isFinalized});v(t)},onAssignmentRemove:e=>{console.log("\ud83d\uddd1\ufe0f Removing assignment:",e),p.removeAssignment(e),p.unlockAssignment(e);const t=new G({date:p.date,assignments:[...p.assignments],traineeAssignments:[...p.traineeAssignments||[]],lockedAssignments:new Set(p.lockedAssignments),isFinalized:p.isFinalized});v(t),console.log("\u2705 Assignment removed. Total assignments:",t.assignments.length)},onManualAssignment:e=>{let{staffId:t,studentId:n,session:r,program:a}=e;const i=u.find(e=>e.id===t),s=h.find(e=>e.id===n);if(!i||!s)return void console.error("\u274c Cannot assign: Staff or student not found");if(!s.teamIds.includes(t))return alert("\u274c Cannot assign ".concat(i.name," to ").concat(s.name,".\n\n").concat(i.name," is not on ").concat(s.name,"'s team.\n\nOnly team members can be assigned to a student.")),void console.warn("\u26a0\ufe0f Blocked assignment: ".concat(i.name," is not on ").concat(s.name,"'s team"));const o=p.assignments.find(e=>e.staffId===t&&e.session===r);if(o){const e=s.isPaired(),t=h.find(e=>e.id===o.studentId);if(!(e&&t&&s.pairedWith===t.id)){const e=t?t.name:"unknown student";return alert("\u274c Cannot assign ".concat(i.name," to ").concat(s.name," in ").concat(r," session.\n\n").concat(i.name," is already assigned to ").concat(e," in the ").concat(r," session.\n\nStaff can only be assigned to multiple students if they are in a 1:2 paired group.")),void console.warn("\u26a0\ufe0f Blocked double-booking: ".concat(i.name," already assigned to ").concat(e," in ").concat(r))}}const l=new K({id:Q.generateAssignmentId(),staffId:t,staffName:i.name,studentId:n,studentName:s.name,session:r,program:a,date:m,isLocked:!1,assignedBy:"manual"});p.addAssignment(l);const c=new G({date:p.date,assignments:[...p.assignments],traineeAssignments:[...p.traineeAssignments||[]],lockedAssignments:new Set(p.lockedAssignments),isFinalized:p.isFinalized});v(c)},selectedDate:m})]}),"staff"===L&&(0,nS.jsxs)("div",{className:"space-y-6",children:[(0,nS.jsxs)("div",{className:"flex justify-between items-center",children:[(0,nS.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Staff Management"}),(0,nS.jsxs)("button",{onClick:()=>X(!0),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 flex items-center gap-2",children:[(0,nS.jsx)(P,{className:"w-4 h-4"}),"Add Staff"]})]}),(0,nS.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:[(0,nS.jsx)("h3",{className:"text-lg font-semibold text-yellow-800 mb-2",children:"Debug Information"}),(0,nS.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,nS.jsxs)("div",{children:[(0,nS.jsx)("strong",{children:"Authentication Status:"})," ",i?"\u2705 Authenticated":"\u274c Not Authenticated"]}),(0,nS.jsxs)("div",{children:[(0,nS.jsx)("strong",{children:"Access Token:"})," ",o?"\u2705 Present":"\u274c Missing"]}),(0,nS.jsxs)("div",{children:[(0,nS.jsx)("strong",{children:"Staff Count:"})," ",u.length]}),(0,nS.jsxs)("div",{children:[(0,nS.jsx)("strong",{children:"Students Count:"})," ",h.length]}),(0,nS.jsxs)("div",{className:"col-span-2",children:[(0,nS.jsx)("strong",{children:"SharePoint Site:"})," ",e.siteUrl]}),(0,nS.jsxs)("div",{children:[(0,nS.jsx)("strong",{children:"Staff List:"})," ",e.staffListName]}),(0,nS.jsxs)("div",{children:[(0,nS.jsx)("strong",{children:"Students List:"})," ",e.studentsListName]})]})]}),(0,nS.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,nS.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,nS.jsx)("thead",{className:"bg-gray-50",children:(0,nS.jsxs)("tr",{children:[(0,nS.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,nS.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),(0,nS.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Primary Program"}),(0,nS.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Secondary Program"}),(0,nS.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,nS.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,nS.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:[...u].sort((e,t)=>e.name.localeCompare(t.name)).map(e=>(0,nS.jsxs)("tr",{children:[(0,nS.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.name}),(0,nS.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.role}),(0,nS.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.primaryProgram?(0,nS.jsx)(_,{className:"w-5 h-5 text-green-600"}):(0,nS.jsx)("span",{className:"text-gray-300",children:"-"})}),(0,nS.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.secondaryProgram?(0,nS.jsx)(_,{className:"w-5 h-5 text-green-600"}):(0,nS.jsx)("span",{className:"text-gray-300",children:"-"})}),(0,nS.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,nS.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(e.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.isActive?"Active":"Inactive"})}),(0,nS.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[(0,nS.jsx)("button",{onClick:()=>{ne(e),X(!0)},className:"text-blue-600 hover:text-blue-900 mr-3",children:(0,nS.jsx)(O,{className:"w-4 h-4"})}),(0,nS.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this staff member?"))try{const n=u.find(t=>t.id===e);if(!n)return console.error("Staff member not found:",e),void alert("Staff member not found");const r=n.listItemId||n.id;console.log("\ud83d\uddd1\ufe0f Deleting staff: ".concat(n.name," (User ID: ").concat(e,", List Item ID: ").concat(r,")")),console.log("\ud83d\uddd1\ufe0f Removing staff ID ".concat(e," from all student teams..."));const a=h.map(t=>{if(t.teamIds.includes(e)){console.log("  Removing staff from ".concat(t.name,"'s team"));const n=t.team.filter(t=>t.id!==e),r=t.teamIds.filter(t=>t!==e);return new V(c(c({},t),{},{team:n,teamIds:r}))}return t}).filter((t,n)=>h[n].teamIds.includes(e));a.length>0&&(console.log("\ud83d\udcdd Updating ".concat(a.length," students in SharePoint...")),await Promise.all(a.map(e=>t.saveStudent(e,!0))),console.log("\u2705 Student teams updated")),await t.deleteStaff(r),console.log("\u2705 Staff member deleted"),await he()}catch(n){console.error("Error deleting staff:",n),alert("Failed to delete staff: ".concat(n.message))}})(e.id),className:"text-red-600 hover:text-red-900",children:(0,nS.jsx)(R,{className:"w-4 h-4"})})]})]},e.id))})]})})]}),"students"===L&&(0,nS.jsxs)("div",{className:"space-y-6",children:[(0,nS.jsxs)("div",{className:"flex justify-between items-center",children:[(0,nS.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Student Management"}),(0,nS.jsxs)("button",{onClick:()=>ee(!0),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 flex items-center gap-2",children:[(0,nS.jsx)(P,{className:"w-4 h-4"}),"Add Student"]})]}),(0,nS.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,nS.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,nS.jsx)("thead",{className:"bg-gray-50",children:(0,nS.jsxs)("tr",{children:[(0,nS.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,nS.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Program"}),(0,nS.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ratio AM"}),(0,nS.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ratio PM"}),(0,nS.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,nS.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,nS.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:h.map(e=>(0,nS.jsxs)("tr",{children:[(0,nS.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.name}),(0,nS.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.program}),(0,nS.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,nS.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs font-medium",children:e.ratioAM})}),(0,nS.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,nS.jsx)("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 rounded text-xs font-medium",children:e.ratioPM})}),(0,nS.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,nS.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(e.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.isActive?"Active":"Inactive"})}),(0,nS.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[(0,nS.jsx)("button",{onClick:()=>{ae(e),ee(!0)},className:"text-blue-600 hover:text-blue-900 mr-3",children:(0,nS.jsx)(O,{className:"w-4 h-4"})}),(0,nS.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this student?"))try{await t.deleteStudent(e),await he()}catch(n){console.error("Error deleting student:",n)}})(e.id),className:"text-red-600 hover:text-red-900",children:(0,nS.jsx)(R,{className:"w-4 h-4"})})]})]},e.id))})]})})]}),"teams"===L&&(0,nS.jsx)(AS,{staff:u,students:h,onEditStaff:e=>{ne(e),X(!0)},onEditStudent:e=>{ae(e),ee(!0)},onCleanupDeletedStaff:async()=>{if(window.confirm("This will remove deleted staff members from all student teams. This action cannot be undone. Continue?")){z(!0);try{console.log("\ud83e\uddf9 Starting cleanup of deleted staff from student teams...");const e=new Set(u.filter(e=>e.isActive).map(e=>e.id)),n=new Set(u.filter(e=>e.isActive&&e.email).map(e=>e.email.toLowerCase()));let r=0;const a=[];for(const t of h){if(!t.team||0===t.team.length)continue;const i=t.team.length,s=t.team.filter(r=>{if(r.email){if(n.has(r.email.toLowerCase()))return!0}if(r.id){if(e.has(r.id))return!0}return console.log('  \ud83d\uddd1\ufe0f Removing deleted staff "'.concat(r.title||r.name,'" from ').concat(t.name,"'s team")),!1});if(s.length!==i){const e=i-s.length;r+=e,console.log("  \u2705 Cleaned ".concat(e," deleted staff from ").concat(t.name,"'s team"));const n=new V(c(c({},t),{},{team:s,teamIds:s.map(e=>e.id)}));a.push(n)}}if(0===a.length)return void alert("No deleted staff found in student teams. All teams are clean!");console.log("\ud83d\udcbe Saving ".concat(a.length," students with cleaned teams..."));for(const i of a)await t.saveStudent(i,!0);await he(),alert("Successfully cleaned up ".concat(r," deleted staff member(s) from ").concat(a.length," student team(s)!")),console.log("\u2705 Cleanup complete: ".concat(r," deleted staff removed from ").concat(a.length," student teams"))}catch(e){console.error("\u274c Error cleaning up deleted staff:",e),alert("Failed to clean up deleted staff: ".concat(e.message))}finally{z(!1)}}},onUpdateTrainingStatus:async(e,n,r)=>{try{const a=h.find(t=>t.id===e);if(!a)return void console.error("Student not found:",e);const i=h.map(t=>{if(t.id===e){const e=new V(c({},t));return e.setStaffTrainingStatus(n,r),e}return t});f(i);const s=new V(c({},a));s.setStaffTrainingStatus(n,r),await t.saveStudent(s,!0),console.log("\u2705 Training status updated:",a.name,n,r)}catch(a){console.error("Error updating training status:",a),console.warn("\u26a0\ufe0f Training status updated locally but not saved to SharePoint")}}}),"attendance"===L&&(0,nS.jsx)(kS,{staff:u,students:h,currentDate:m,onUpdateStaffAttendance:async(e,n)=>{try{const r=u.find(t=>t.id===e);if(!r)return void console.error("Staff member not found:",e);const a=u.map(t=>t.id===e?new U(c(c({},t),{},{absentAM:n.absentAM,absentPM:n.absentPM,absentFullDay:n.absentFullDay,outOfSessionAM:n.outOfSessionAM,outOfSessionPM:n.outOfSessionPM,outOfSessionFullDay:n.outOfSessionFullDay})):t);d(a);const i=n.absentAM||n.absentFullDay||n.outOfSessionAM||n.outOfSessionFullDay,s=n.absentPM||n.absentFullDay||n.outOfSessionPM||n.outOfSessionFullDay;if(i||s){console.log("\ud83d\uddd1\ufe0f Staff ".concat(r.name," marked unavailable - removing from schedule..."));const t=[];n.absentFullDay||n.outOfSessionFullDay?t.push("AM","PM"):(i&&t.push("AM"),s&&t.push("PM"));const a=p.removeStaffFromSessions(e,t);a>0&&(console.log("  \u2705 Removed ".concat(a," assignment(s) for ").concat(r.name)),v(new G(c(c({},p),{},{assignments:[...p.assignments],traineeAssignments:[...p.traineeAssignments]}))))}const o=new U(c(c({},r),{},{absentAM:n.absentAM,absentPM:n.absentPM,absentFullDay:n.absentFullDay,outOfSessionAM:n.outOfSessionAM,outOfSessionPM:n.outOfSessionPM,outOfSessionFullDay:n.outOfSessionFullDay}));await t.saveStaff(o,!0),console.log("\u2705 Staff attendance updated:",r.name,n)}catch(r){console.error("Error updating staff attendance:",r),console.warn("\u26a0\ufe0f Attendance updated locally but not saved to SharePoint")}},onUpdateStudentAttendance:async(e,n)=>{try{const r=h.find(t=>t.id===e);if(!r)return void console.error("Student not found:",e);const a=h.map(t=>t.id===e?new V(c(c({},t),{},{absentAM:n.absentAM,absentPM:n.absentPM,absentFullDay:n.absentFullDay})):t);if(f(a),n.absentAM||n.absentPM||n.absentFullDay){console.log("\ud83d\uddd1\ufe0f Student ".concat(r.name," marked absent - removing from schedule..."));const t=[];n.absentFullDay?t.push("AM","PM"):(n.absentAM&&t.push("AM"),n.absentPM&&t.push("PM"));const a=p.removeStudentFromSessions(e,t);a>0&&(console.log("  \u2705 Removed ".concat(a," assignment(s) for ").concat(r.name," - staff are now available")),v(new G(c(c({},p),{},{assignments:[...p.assignments],traineeAssignments:[...p.traineeAssignments]}))))}const i=new V(c(c({},r),{},{absentAM:n.absentAM,absentPM:n.absentPM,absentFullDay:n.absentFullDay}));await t.saveStudent(i,!0),console.log("\u2705 Student attendance updated:",r.name,n)}catch(r){console.error("Error updating student attendance:",r),console.warn("\u26a0\ufe0f Attendance updated locally but not saved to SharePoint")}},onResetAllAttendance:async()=>{try{const e=u.map(e=>new U(c(c({},e),{},{absentAM:!1,absentPM:!1,absentFullDay:!1,outOfSessionAM:!1,outOfSessionPM:!1,outOfSessionFullDay:!1}))),n=h.map(e=>new V(c(c({},e),{},{absentAM:!1,absentPM:!1,absentFullDay:!1})));d(e),f(n);const r=[...e.map(e=>t.saveStaff(e,!0).catch(t=>console.error("Failed to clear attendance for staff ".concat(e.name,":"),t))),...n.map(e=>t.saveStudent(e,!0).catch(t=>console.error("Failed to clear attendance for student ".concat(e.name,":"),t)))];await Promise.all(r),console.log("\u2705 All attendance and out-of-session status cleared for new day")}catch(e){console.error("Error clearing attendance:",e)}}}),"validation"===L&&(0,nS.jsx)(oS,{schedule:p,staff:u,students:h,onValidationChange:e=>{$(e)}}),"rules"===L&&(0,nS.jsx)(cS,{}),"tests"===L&&(0,nS.jsxs)("div",{className:"space-y-6",children:[(0,nS.jsxs)("div",{className:"flex justify-between items-center",children:[(0,nS.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Test Suite"}),(0,nS.jsxs)("button",{onClick:async()=>{ue(!0),le(null);try{console.log("\ud83e\uddea Starting test suite...");const e=await(async()=>{const e=new PS;return await e.runAllTests(),e.generateReport()})();le(e),console.log("\u2705 Test suite completed")}catch(e){console.error("\u274c Test suite failed:",e),le({summary:{total:0,passed:0,failed:1,duration:0},results:[],error:e.message})}finally{ue(!1)}},disabled:ce,className:"bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700 disabled:opacity-50 flex items-center gap-2",children:[ce?(0,nS.jsx)(b,{className:"w-5 h-5 animate-spin"}):(0,nS.jsx)(T,{className:"w-5 h-5"}),ce?"Running Tests...":"Run All Tests"]})]}),oe&&(0,nS.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,nS.jsxs)("div",{className:"mb-6",children:[(0,nS.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Test Results Summary"}),(0,nS.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,nS.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg text-center",children:[(0,nS.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:oe.summary.total}),(0,nS.jsx)("div",{className:"text-sm text-blue-800",children:"Total Tests"})]}),(0,nS.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg text-center",children:[(0,nS.jsx)("div",{className:"text-2xl font-bold text-green-600",children:oe.summary.passed}),(0,nS.jsx)("div",{className:"text-sm text-green-800",children:"Passed"})]}),(0,nS.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg text-center",children:[(0,nS.jsx)("div",{className:"text-2xl font-bold text-red-600",children:oe.summary.failed}),(0,nS.jsx)("div",{className:"text-sm text-red-800",children:"Failed"})]}),(0,nS.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg text-center",children:[(0,nS.jsxs)("div",{className:"text-2xl font-bold text-gray-600",children:[oe.summary.duration,"ms"]}),(0,nS.jsx)("div",{className:"text-sm text-gray-800",children:"Duration"})]})]}),(0,nS.jsxs)("div",{className:"mt-4",children:[(0,nS.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-1",children:[(0,nS.jsx)("span",{children:"Success Rate"}),(0,nS.jsxs)("span",{children:[oe.summary.total>0?(oe.summary.passed/oe.summary.total*100).toFixed(1):0,"%"]})]}),(0,nS.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,nS.jsx)("div",{className:"h-2 rounded-full ".concat(0===oe.summary.failed?"bg-green-500":"bg-yellow-500"),style:{width:"".concat(oe.summary.total>0?oe.summary.passed/oe.summary.total*100:0,"%")}})})]})]}),oe.results&&oe.results.length>0&&(0,nS.jsxs)("div",{children:[(0,nS.jsx)("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Test Details"}),(0,nS.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:oe.results.map((e,t)=>(0,nS.jsxs)("div",{className:"p-3 rounded border-l-4 ".concat(e.passed?"bg-green-50 border-green-400":"bg-red-50 border-red-400"),children:[(0,nS.jsxs)("div",{className:"flex items-center justify-between",children:[(0,nS.jsx)("div",{className:"flex items-center gap-2",children:(0,nS.jsxs)("span",{className:"text-sm font-medium ".concat(e.passed?"text-green-800":"text-red-800"),children:[e.passed?"\u2705":"\u274c"," ",e.name]})}),(0,nS.jsxs)("span",{className:"text-xs text-gray-500",children:[e.duration,"ms"]})]}),e.error&&(0,nS.jsx)("div",{className:"mt-2 text-sm text-red-700 font-mono bg-red-100 p-2 rounded",children:e.error})]},t))})]}),oe.error&&(0,nS.jsxs)("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded",children:[(0,nS.jsx)("h4",{className:"text-red-800 font-medium",children:"Test Suite Error"}),(0,nS.jsx)("p",{className:"text-red-700 text-sm mt-1",children:oe.error})]})]}),(0,nS.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[(0,nS.jsx)("h3",{className:"text-lg font-semibold text-blue-900 mb-3",children:"About the Test Suite"}),(0,nS.jsxs)("div",{className:"text-blue-800 space-y-2",children:[(0,nS.jsx)("p",{children:"This comprehensive test suite validates all core functionality of the ABA Scheduling System:"}),(0,nS.jsxs)("ul",{className:"list-disc list-inside space-y-1 ml-4",children:[(0,nS.jsxs)("li",{children:[(0,nS.jsx)("strong",{children:"Data Models:"})," Staff and Student object validation, role hierarchies"]}),(0,nS.jsxs)("li",{children:[(0,nS.jsx)("strong",{children:"Validation Rules:"})," Schedule constraints, ratio requirements, program separation"]}),(0,nS.jsxs)("li",{children:[(0,nS.jsx)("strong",{children:"Auto-Assignment:"})," Automated scheduling algorithms and optimization"]}),(0,nS.jsxs)("li",{children:[(0,nS.jsx)("strong",{children:"Performance:"})," Large dataset handling and response times"]}),(0,nS.jsxs)("li",{children:[(0,nS.jsx)("strong",{children:"Integration:"})," End-to-end workflow testing"]})]}),(0,nS.jsxs)("p",{className:"mt-3 text-sm",children:[(0,nS.jsx)("strong",{children:"Note:"})," Tests run using sample data and do not affect your actual schedule or database."]})]})]})]})]})]}),J&&(0,nS.jsx)(bS,{staff:te,onSave:te?async e=>{z(!0);try{const n=new U(c(c({},e),{},{id:te.id}));await t.saveStaff(n,!0),await he(),ne(null),X(!1),alert("Staff member updated successfully!")}catch(n){console.error("Error updating staff:",n),alert("Failed to update staff: ".concat(n.message))}finally{z(!1)}}:async e=>{z(!0);try{const n=new U(e);await t.saveStaff(n),await he(),X(!1),alert("Staff member added successfully!")}catch(n){console.error("Error adding staff:",n),alert("Failed to add staff: ".concat(n.message))}finally{z(!1)}},onCancel:()=>{X(!1),ne(null)},peoplePickerService:n}),Z&&(0,nS.jsx)(wS,{student:re,onSave:re?async e=>{z(!0);try{const n=new V(c(c({},e),{},{id:re.id}));await t.saveStudent(n,!0),await he(),ae(null),ee(!1),alert("Student updated successfully!")}catch(n){console.error("Error updating student:",n),alert("Failed to update student: ".concat(n.message))}finally{z(!1)}}:async e=>{z(!0);try{const n=new V(e);await t.saveStudent(n),await he(),ee(!1),alert("Student added successfully!")}catch(n){console.error("Error adding student:",n),alert("Failed to add student: ".concat(n.message))}finally{z(!1)}},onCancel:()=>{ee(!1),ae(null)},allStaff:u,peoplePickerService:n})]}):(0,nS.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,nS.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-lg max-w-md w-full mx-4",children:[(0,nS.jsxs)("div",{className:"text-center mb-6",children:[(0,nS.jsx)(y,{className:"w-12 h-12 text-blue-600 mx-auto mb-4"}),(0,nS.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"ABA Scheduler"}),(0,nS.jsx)("p",{className:"text-gray-600",children:"Staff & Student Scheduling System"})]}),(0,nS.jsx)("button",{onClick:fe,disabled:j,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:j?(0,nS.jsxs)(nS.Fragment,{children:[(0,nS.jsx)(b,{className:"w-5 h-5 animate-spin"}),"Signing in..."]}):(0,nS.jsxs)(nS.Fragment,{children:[(0,nS.jsx)(w,{className:"w-5 h-5"}),"Sign in with Microsoft"]})}),(0,nS.jsx)("div",{className:"mt-6 text-sm text-gray-500 text-center",children:(0,nS.jsx)("p",{children:"Sign in to access the ABA scheduling system"})})]})})},MS=()=>(0,nS.jsx)(OS,{children:(0,nS.jsx)(RS,{})}),DS=e=>{e&&e instanceof Function&&n.e(206).then(n.bind(n,206)).then(t=>{let{getCLS:n,getFID:r,getFCP:a,getLCP:i,getTTFB:s}=t;n(e),r(e),a(e),i(e),s(e)})};a.createRoot(document.getElementById("root")).render((0,nS.jsx)(r.StrictMode,{children:(0,nS.jsx)(MS,{})})),DS()})();